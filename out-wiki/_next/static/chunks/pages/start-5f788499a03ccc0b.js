(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3876],{27284:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11037).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},28619:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>J});var n=r(14232),a=r(89099),o=r(27788),s=r(31931),i=r(28742),u=r(83872),c=r(94566),l=r(74231),d=r(96898),m=r(99977);(0,r(11037).A)("circle-minus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);var p=r(74473),f=r(83587),g=r(80360),h=r(37746),v=r(42009),b=r(13848),y=r(10637),S=r(81229),x=r(48230),w=r.n(x),k=r(19732),E=r(93504),I=r(38791),j=r(85253),G=r(42471),P=r(23872),T=r(99897),R=r(31225),N=r(67096),A=r(37790),C=r(37876),L=["joined","newMember"];function O(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||W(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach(function(t){var n,a,o;n=e,a=t,o=r[t],(a=function(e){var t=function(e,t){if("object"!=B(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=B(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==B(t)?t:t+""}(a))in n?Object.defineProperty(n,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[a]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function U(){U=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var s,i,u,c,l=Object.create((r&&r.prototype instanceof h?r:h).prototype);return a(l,"_invoke",{value:(s=t,i=n,u=new G(o||[]),c=m,function(t,r){if(c===p)throw Error("Generator is already running");if(c===f){if("throw"===t)throw r;return{value:e,done:!0}}for(u.method=t,u.arg=r;;){var n=u.delegate;if(n){var a=function t(r,n){var a=n.method,o=r.iterator[a];if(o===e)return n.delegate=null,"throw"===a&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+a+"' method")),g;var s=d(o,r.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,g;var i=s.arg;return i?i.done?(n[r.resultName]=i.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,g)}(n,u);if(a){if(a===g)continue;return a}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(c===m)throw c=f,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c=p;var o=d(s,i,u);if("normal"===o.type){if(c=u.done?f:"suspendedYield",o.arg===g)continue;return{value:o.arg,done:u.done}}"throw"===o.type&&(c=f,u.method="throw",u.arg=o.arg)}})}),l}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var m="suspendedStart",p="executing",f="completed",g={};function h(){}function v(){}function b(){}var y={};c(y,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(P([])));x&&x!==r&&n.call(x,s)&&(y=x);var w=b.prototype=h.prototype=Object.create(y);function k(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){var r;a(this,"_invoke",{value:function(a,o){function s(){return new t(function(r,s){!function r(a,o,s,i){var u=d(e[a],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==B(l)&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,s,i)},function(e){r("throw",e,s,i)}):t.resolve(l).then(function(e){c.value=e,s(c)},function(e){return r("throw",e,s,i)})}i(u.arg)}(a,o,r,s)})}return r=r?r.then(s,s):s()}})}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function G(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw TypeError(B(t)+" is not iterable")}return v.prototype=b,a(w,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:v,configurable:!0}),v.displayName=c(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},k(E.prototype),c(E.prototype,i,function(){return this}),t.AsyncIterator=E,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var s=new E(l(e,r,n,a),o);return t.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(w),c(w,u,"Generator"),c(w,s,function(){return this}),c(w,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,G.prototype={constructor:G,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return i.type="throw",i.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],i=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;j(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function M(e,t,r,n,a,o,s){try{var i=e[o](s),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,a)}function _(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){M(o,n,a,s,i,"next",e)}function i(e){M(o,n,a,s,i,"throw",e)}s(void 0)})}}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,s,i=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(i.push(n.value),i.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return i}}(e,t)||W(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){if(e){if("string"==typeof e)return H(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(e,t):void 0}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e){return e&&"object"===B(e)&&"toDate"in e&&"function"==typeof e.toDate}var q=function(e){return"loading"===e||"idle"===e};let J=function(){var e,t,x,F,M,W,H=(0,o.useAuthStore)(),B=H.user,J=H.status,Y=H.isAuthenticated,K=H.isGuest,Z=(0,s.Q5)(),$=Z.currentGroup,Q=Z.userGroups,X=Z.status,ee=Z.error,et=Z.clearError;Z.setCurrentGroupId,Z.setError,Z.lastSettingsUpdateTimestamp;var er=(0,i.useGameStore)(),en=(0,u.useJassStore)(),ea=(0,i.useGameStore)(function(e){return e.isGameStarted&&!e.isGameCompleted}),eo=(0,a.useRouter)(),es=(0,c.useUIStore)(function(e){return e.setPageCta}),ei=(0,c.useUIStore)(function(e){return e.resetPageCta}),eu=(0,c.useUIStore)(function(e){return e.showNotification}),ec=(0,c.useUIStore)(function(e){return e.setResumableGameId}),el=(0,c.useUIStore)(function(e){return e.clearResumableGameId}),ed=(0,c.useUIStore)(function(e){return e.resumableGameId});(0,c.useUIStore)(function(e){return e.setLoading});var em=(0,n.useRef)(null),ep=z((0,n.useState)(null),2),ef=ep[0],eg=ep[1],eh=z((0,n.useState)(null),2),ev=eh[0],eb=eh[1],ey=z((0,n.useState)(!1),2),eS=ey[0],ex=ey[1],ew=z((0,n.useState)(!1),2),ek=ew[0],eE=ew[1],eI=z((0,n.useState)(null),2),ej=eI[0],eG=eI[1],eP=z((0,n.useState)(!1),2),eT=eP[0],eR=eP[1],eN=z((0,n.useState)(null),2),eA=eN[0],eC=eN[1],eL=z((0,n.useState)(!1),2),eO=eL[0],eF=eL[1],eD=z((0,n.useState)(null),2),eU=eD[0],eM=eD[1],e_=z((0,n.useState)([]),2),ez=e_[0],eW=e_[1],eH=z((0,n.useState)(!0),2),eB=eH[0],eV=eH[1],eq=z((0,n.useState)(null),2),eJ=eq[0],eY=eq[1],eK=z((0,n.useState)([]),2),eZ=eK[0],e$=eK[1],eQ=z((0,n.useState)(!0),2),eX=eQ[0],e0=eQ[1],e1=z((0,n.useState)(null),2),e2=e1[0],e3=e1[1],e4=z((0,n.useState)([]),2),e7=e4[0],e8=e4[1],e5=z((0,n.useState)(!0),2),e6=e5[0],e9=e5[1],te=z((0,n.useState)(null),2),tt=te[0],tr=te[1],tn=z((0,n.useState)(null),2),ta=tn[0],to=tn[1],ts=z((0,n.useState)(!0),2),ti=ts[0],tu=ts[1],tc=z((0,n.useState)(null),2),tl=tc[0],td=tc[1],tm=z((0,n.useState)(!1),2),tp=tm[0],tf=tm[1],tg=$&&B&&$.adminIds.includes(B.uid),th=z((0,n.useState)(!1),2),tv=th[0],tb=th[1],ty=z((0,n.useState)(!1),2),tS=ty[0],tx=ty[1],tw=(null==$?void 0:$.theme)||"yellow",tk=R.lt[tw]||R.lt.yellow,tE=(0,n.useRef)(null),tI=(0,n.useRef)(null),tj=(0,n.useRef)(null),tG=(0,n.useRef)(null),tP=(0,n.useRef)(null),tT=(0,n.useRef)(null),tR=(0,n.useRef)(null),tN=(0,n.useRef)(null),tA=(0,n.useRef)(null),tC=(0,n.useRef)(null),tL=(0,n.useRef)(null),tO=(0,n.useRef)(null),tF=(0,n.useRef)(null),tD=(0,n.useRef)(null),tU=(0,n.useRef)(null),tM=(0,n.useRef)(null),t_=(0,n.useRef)(null),tz=(0,n.useRef)(null);(0,N.F)(tE),(0,N.F)(tI),(0,N.F)(tj),(0,N.F)(tG),(0,N.F)(tP),(0,N.F)(tT),(0,N.F)(tR),(0,N.F)(tN),(0,N.F)(tA),(0,N.F)(tC),(0,N.F)(tL),(0,N.F)(tO),(0,N.F)(tF),(0,N.F)(tD),(0,N.F)(tU),(0,N.F)(tM),(0,N.F)(t_),(0,N.F)(tz),(0,n.useMemo)(function(){if(!(null!=ta&&ta.trumpfStatistik)||0===ta.totalTrumpfCount)return[];var e={};return Object.entries(ta.trumpfStatistik).forEach(function(t){var r=z(t,2),n=r[0],a=r[1],o=n.toLowerCase(),s=o;"eicheln"===o?s="eichel":"une"===o&&(s="unde"),e[s]=(e[s]||0)+a}),Object.entries(e).map(function(e){var t=z(e,2),r=t[0],n=t[1];return{farbe:r,anzahl:n,anteil:n/ta.totalTrumpfCount}}).sort(function(e,t){return t.anzahl-e.anzahl})},[ta]),(0,n.useEffect)(function(){if(null!=$&&$.id){tu(!0),td(null);var e=(0,P.q$)($.id,function(e){to(e),tu(!1)},null==$?void 0:$.mainLocationZip);return function(){return e()}}},[$]),(0,n.useEffect)(function(){if(null!=$&&$.logoUrl&&1){var e=document.createElement("link");e.rel="preload",e.as="image",e.href=$.logoUrl,e.type="image/jpeg",document.head.appendChild(e);var t=setTimeout(function(){document.head.contains(e)&&document.head.removeChild(e)},1e4);return function(){clearTimeout(t),document.head.contains(e)&&document.head.removeChild(e)}}},[null==$?void 0:$.logoUrl]),(0,n.useEffect)(function(){if("loading"!==J&&"idle"!==J)return"unauthenticated"!==J||o.useAuthStore.getState().isGuest||eo.push("/"),et(),function(){et(),eY(null),ev&&URL.revokeObjectURL(ev),el()}},[J,eo,et,ev,el]),(0,n.useEffect)(function(){var e;(e=_(U().mark(function e(){return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!$){e.next=6;break}return eV(!0),e.prev=1,e.next=2,(0,g.YY)($.id);case 2:eW(e.sent),e.next=4;break;case 3:e.prev=3,console.error("Fehler beim Laden der Gruppenmitglieder:",e.catch(1)),eY("Mitglieder konnten nicht geladen werden."),eu({message:"Fehler beim Laden der Gruppenmitglieder.",type:"error"});case 4:return e.prev=4,eV(!1),e.finish(4);case 5:e.next=7;break;case 6:eW([]),eV(!1);case 7:case"end":return e.stop()}},e,null,[[1,3,4,5]])})),function(){return e.apply(this,arguments)})()},[null==$?void 0:$.id,eu]),(0,n.useEffect)(function(){var e;(e=_(U().mark(function e(){var t,r;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!$){e.next=11;break}return e0(!0),e3(null),e.prev=1,e.next=2,(0,S.CI)($.id);case 2:e$(e.sent),e.next=4;break;case 3:e.prev=3,console.error("Fehler beim Laden der abgeschlossenen Gruppensessions:",t=e.catch(1)),e3(t instanceof Error?t.message:"Abgeschlossene Partien konnten nicht geladen werden.");case 4:return e.prev=4,e0(!1),e.finish(4);case 5:return e9(!0),tr(null),e.prev=6,e.next=7,(0,E.fetchTournamentInstancesForGroup)($.id);case 7:e8(e.sent.filter(function(e){return"active"===e.status||"upcoming"===e.status||"completed"===e.status})),e.next=9;break;case 8:e.prev=8,console.error("Fehler beim Laden der Gruppen-Turniere:",r=e.catch(6)),tr(r instanceof Error?r.message:"Turniere konnten nicht geladen werden.");case 9:return e.prev=9,e9(!1),e.finish(9);case 10:e.next=12;break;case 11:e$([]),e8([]),e0(!1),e9(!1);case 12:case"end":return e.stop()}},e,null,[[1,3,4,5],[6,8,9,10]])})),function(){return e.apply(this,arguments)})()},[$,eu]),(0,n.useEffect)(function(){if("authenticated"===J&&B){(e=_(U().mark(function e(){var t,n,a,o,s,i,u,c,l,d,m,p,f,g,h,y,S,x,w,k,E,I,j,G;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!(null!=B&&B.uid)||!(null!=B&&B.playerId))){e.next=1;break}return e.abrupt("return");case 1:return e.prev=1,t=(0,v.getFirestore)(b.firebaseApp),n=(0,v.collection)(t,"activeGames"),a=(0,v.query)(n,(0,v.where)("participantUids","array-contains",B.uid)),o=(0,v.query)(n,(0,v.where)("participantUids","array-contains",B.playerId)),e.next=2,Promise.all([(0,v.getDocs)(a),(0,v.getDocs)(o)]);case 2:if(i=(s=z(e.sent,2))[0],u=s[1],c=new Map,i.forEach(function(e){return c.set(e.id,e)}),u.forEach(function(e){return c.set(e.id,e)}),!((l=Array.from(c.values())).length>0)||!((d=l.filter(function(e){var t=e.data();return"aborted"!==t.status&&"completed"!==t.status})).length>0)){e.next=6;break}if(S=(y=(h=d.sort(function(e,t){var r,n,a=e.data(),o=t.data(),s=function(e){var t,r,n,a,o=0+100*(e.currentRound||1)+(((null==(t=e.scores)?void 0:t.top)||0)+((null==(r=e.scores)?void 0:r.bottom)||0)),s=(null==(n=e.striche)?void 0:n.top)||{},i=(null==(a=e.striche)?void 0:a.bottom)||{};return o+(Object.values(s).reduce(function(e,t){return e+(t||0)},0)+Object.values(i).reduce(function(e,t){return e+(t||0)},0))*50},i=s(a),u=s(o);if(i!==u)return u-i;var c=(null==(r=a.createdAt)?void 0:r.toMillis())||0;return((null==(n=o.createdAt)?void 0:n.toMillis())||0)-c}))[0]).id,w=(x=y.data()).currentRound>1||(null==(m=x.scores)?void 0:m.top)>0||(null==(p=x.scores)?void 0:p.bottom)>0||Object.values((null==(f=x.striche)?void 0:f.top)||{}).some(function(e){return e>0})||Object.values((null==(g=x.striche)?void 0:g.bottom)||{}).some(function(e){return e>0}),E=(k=x.createdAt?Date.now()-(x.createdAt.toMillis?x.createdAt.toMillis():x.createdAt):0)<12e4,I=x.gameStartTime&&x.gameStartTime!==x.createdAt||k>3e5||E,w||I){e.next=5;break}if(console.log("[StartPage] ⚠️ EMPTY GAME DETECTED: Game ".concat(S," appears to be empty, marking as aborted and skipping")),Promise.resolve().then(r.bind(r,99407)).then(function(e){(0,e.updateGameStatus)(S,"aborted").catch(function(e){return console.warn("[StartPage] Failed to mark empty game as aborted:",e)})}),!(h.length>1)){e.next=3;break}G=(j=h[1]).id,j.data(),ec(G);try{sessionStorage.setItem("resumableGameId_".concat(B.uid),G)}catch(e){console.warn("[StartPage] Could not persist resumableGameId to sessionStorage:",e)}return e.abrupt("return");case 3:el();try{sessionStorage.removeItem("resumableGameId_".concat(B.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}return e.abrupt("return");case 4:e.next=5;break;case 5:ec(S);try{sessionStorage.setItem("resumableGameId_".concat(B.uid),S)}catch(e){console.warn("[StartPage] Could not persist resumableGameId to sessionStorage:",e)}return e.abrupt("return");case 6:el();try{sessionStorage.removeItem("resumableGameId_".concat(B.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}e.next=8;break;case 7:e.prev=7,console.error("[StartPage] Error checking for resumable games:",e.catch(1));case 8:case"end":return e.stop()}},e,null,[[1,7]])})),function(){return e.apply(this,arguments)})();var e,t,n=null;(t=_(U().mark(function e(){var t,a,o;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=(0,v.getFirestore)(b.firebaseApp),a=(0,v.collection)(t,"activeGames"),o=(0,v.query)(a,(0,v.where)("participantUids","array-contains",B.uid)),n=(0,v.onSnapshot)(o,function(e){if(e.empty){el();try{sessionStorage.removeItem("resumableGameId_".concat(B.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}}else{var t=e.docs.filter(function(e){var t=e.data();return"aborted"!==t.status&&"completed"!==t.status});if(t.length>0){var n=t.sort(function(e,t){var r,n,a=e.data(),o=t.data(),s=function(e){var t,r,n,a,o=0+100*(e.currentRound||1),s=((null==(t=e.scores)?void 0:t.top)||0)+((null==(r=e.scores)?void 0:r.bottom)||0);o+=s;var i=(null==(n=e.striche)?void 0:n.top)||{},u=(null==(a=e.striche)?void 0:a.bottom)||{},c=Object.values(i).reduce(function(e,t){return e+(t||0)},0),l=Object.values(u).reduce(function(e,t){return e+(t||0)},0);return o+=(c+l)*50},i=s(a),u=s(o);if(i!==u)return u-i;var c=(null==(r=a.createdAt)?void 0:r.toMillis())||0;return((null==(n=o.createdAt)?void 0:n.toMillis())||0)-c})[0],a=n.id,o=n.data();if(c.useUIStore.getState().resumableGameId!==a){var s,i,u,l,d=o.currentRound>1||(null==(s=o.scores)?void 0:s.top)>0||(null==(i=o.scores)?void 0:i.bottom)>0||Object.values((null==(u=o.striche)?void 0:u.top)||{}).some(function(e){return e>0})||Object.values((null==(l=o.striche)?void 0:l.bottom)||{}).some(function(e){return e>0}),m=o.createdAt?Date.now()-(o.createdAt.toMillis?o.createdAt.toMillis():o.createdAt):0,p=m<12e4,f=o.roundHistory&&o.roundHistory.length>0||o.gameStartTime&&o.gameStartTime!==o.createdAt||m>3e5||p;if(!(d||f)){console.log("[StartPage] Real-time: Empty game ".concat(a," detected (no content AND no activity), marking as aborted")),Promise.resolve().then(r.bind(r,99407)).then(function(e){(0,e.updateGameStatus)(a,"aborted").catch(function(e){return console.warn("[StartPage] Real-time: Failed to mark empty game as aborted:",e)})}),el();try{sessionStorage.removeItem("resumableGameId_".concat(B.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}return}ec(a);try{sessionStorage.setItem("resumableGameId_".concat(B.uid),a)}catch(e){console.warn("[StartPage] Could not persist resumableGameId to sessionStorage:",e)}}}else{el();try{sessionStorage.removeItem("resumableGameId_".concat(B.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}}}},function(e){console.error("[StartPage] Error in resumable games listener:",e)})}catch(e){console.error("[StartPage] Error setting up resumable games listener:",e)}case 1:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})();try{var a=sessionStorage.getItem("resumableGameId_".concat(B.uid));if(a&&!c.useUIStore.getState().resumableGameId){var o=(0,v.getFirestore)(b.firebaseApp),s=(0,v.doc)(o,"activeGames",a);(0,v.getDoc)(s).then(function(e){var t,r,n,o;e.exists()&&(null==(t=e.data())?void 0:t.status)!=="aborted"&&(null==(r=e.data())?void 0:r.status)!=="completed"&&(null!=(n=e.data())&&null!=(n=n.participantUids)&&n.includes(B.uid)||B.playerId&&null!=(o=e.data())&&null!=(o=o.participantUids)&&o.includes(B.playerId))?ec(a):sessionStorage.removeItem("resumableGameId_".concat(B.uid))}).catch(function(e){console.error("[StartPage] Error verifying stored resumable game ".concat(a,":"),e)})}}catch(e){console.warn("[StartPage] Could not check sessionStorage for resumableGameId:",e)}return function(){n&&n()}}if(el(),B)try{sessionStorage.removeItem("resumableGameId_".concat(B.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}return function(){}},[J,B,ec,el]),(0,n.useEffect)(function(){var e=!q(J),t="authenticated"!==J||!q(X);e&&t?tf(!0):tf(!1)},[J,X]),(0,n.useEffect)(function(){if(tp)return"unauthenticated"!==J||o.useAuthStore.getState().isGuest||eo.push("/"),et(),function(){et(),eY(null),ev&&URL.revokeObjectURL(ev),el()}},[tp,J,eo,et,ev,el]);var tW=(e=_(U().mark(function e(t){var n,a,o,l,d,m,p,f,g,h,S,x,w,k,E,P,T,R,N,A,C,L,O,F,M,_,z,W,H,B,V,q,J,Y,K,Z,$,Q;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return tb(!0),e.prev=1,n=(0,v.getFirestore)(b.firebaseApp),a=(0,v.doc)(n,"activeGames",t),e.next=2,(0,v.getDoc)(a);case 2:if((o=e.sent).exists()){e.next=3;break}throw Error("Aktives Spiel mit ID ".concat(t," nicht gefunden."));case 3:if("aborted"!==(l=o.data()).status&&"completed"!==l.status){e.next=4;break}return console.warn("[StartPage] Versuch, ein bereits beendetes/abgebrochenes Spiel fortzusetzen (ID: ".concat(t,", Status: ").concat(l.status,"). Breche ab.")),eu({type:"warning",message:"Dieses Spiel wurde bereits beendet oder abgebrochen."}),el(),tb(!1),e.abrupt("return");case 4:if(d=l.sessionId){e.next=5;break}throw Error("Session-ID im aktiven Spiel fehlt.");case 5:return e.prev=5,N=[],e.prev=6,e.next=7,Promise.resolve().then(r.bind(r,99407));case 7:return A=e.sent.fetchCompletedGamesFromFirestore,e.next=8,A(d);case 8:N=e.sent,e.next=10;break;case 9:e.prev=9,K=e.catch(6),console.error("[StartPage] Fehler beim Laden abgeschlossener Spiele aus jassGameSummaries/".concat(d,"/completedGames:"),K),eu({type:"warning",message:"Abgeschlossene Spiele konnten nicht vollst\xe4ndig geladen werden."});case 10:return C=[],e.prev=11,e.next=12,Promise.resolve().then(r.bind(r,99407));case 12:return L=e.sent.loadRoundsFromFirestore,e.next=13,L(t);case 13:C=e.sent,e.next=15;break;case 14:e.prev=14,Z=e.catch(11),console.error("[StartPage] Error loading rounds from Firestore for game ".concat(t,":"),Z),eu({type:"warning",message:"Rundenverlauf konnte nicht vollst\xe4ndig geladen werden."});case 15:return O=l.createdAt instanceof v.Timestamp?l.createdAt.toMillis():Date.now(),F=null,console.log("[StartPage] \uD83D\uDEE1️ VEREINFACHTE FALLBACK-HIERARCHIE f\xfcr Settings wird gestartet..."),e.prev=16,M=(0,v.doc)(n,"sessions",d),e.next=17,(0,v.getDoc)(M);case 17:if(!(_=e.sent).exists()){e.next=20;break}if(!((z=_.data()).currentFarbeSettings&&z.currentScoreSettings&&z.currentStrokeSettings)){e.next=18;break}console.log("[StartPage] ✅ ERSTE PRIORIT\xc4T: Einstellungen aus sessions-Dokument geladen:",{farbeCardStyle:(F={farbeSettings:z.currentFarbeSettings,scoreSettings:z.currentScoreSettings,strokeSettings:z.currentStrokeSettings}).farbeSettings.cardStyle,scoreWerte:F.scoreSettings.values,strokeSchneider:F.strokeSettings.schneider}),e.next=19;break;case 18:throw Error("Einstellungen in sessions unvollst\xe4ndig");case 19:e.next=21;break;case 20:throw Error("sessions-Dokument nicht gefunden");case 21:case 25:case 32:e.next=34;break;case 22:if(e.prev=22,console.warn("[StartPage] ❌ ERSTE PRIORIT\xc4T fehlgeschlagen:",e.catch(16)),e.prev=23,!(l.activeFarbeSettings&&l.activeScoreSettings&&l.activeStrokeSettings)){e.next=24;break}console.log("[StartPage] ✅ ZWEITE PRIORIT\xc4T: Einstellungen aus activeGame-Dokument geladen:",{farbeCardStyle:(F={farbeSettings:l.activeFarbeSettings,scoreSettings:l.activeScoreSettings,strokeSettings:l.activeStrokeSettings}).farbeSettings.cardStyle,scoreWerte:F.scoreSettings.values,strokeSchneider:F.strokeSettings.schneider}),e.next=25;break;case 24:throw Error("Einstellungen in activeGame unvollst\xe4ndig");case 26:if(e.prev=26,console.warn("[StartPage] ❌ ZWEITE PRIORIT\xc4T fehlgeschlagen:",e.catch(23)),e.prev=27,!(W=l.groupId)){e.next=31;break}return console.log("[StartPage] \uD83D\uDD04 DRITTE PRIORIT\xc4T: Lade Gruppen-Settings aus Firestore f\xfcr Gruppe",W),H=(0,v.doc)(n,"groups",W),e.next=28,(0,v.getDoc)(H);case 28:if(!(B=e.sent).exists()){e.next=29;break}console.log("[StartPage] ✅ DRITTE PRIORIT\xc4T: Einstellungen aus Gruppen-Dokument geladen:",{farbeCardStyle:(F={farbeSettings:(V=B.data()).farbeSettings||j.FT,scoreSettings:D(D({},I.$d),V.scoreSettings||{}),strokeSettings:V.strokeSettings||G.zh}).farbeSettings.cardStyle,scoreWerte:F.scoreSettings.values,strokeSchneider:F.strokeSettings.schneider}),e.next=30;break;case 29:throw Error("Gruppen-Dokument nicht gefunden");case 30:e.next=32;break;case 31:throw Error("Keine groupId verf\xfcgbar");case 33:e.prev=33,console.warn("[StartPage] ❌ DRITTE PRIORIT\xc4T fehlgeschlagen:",e.catch(27)),F={farbeSettings:j.FT,scoreSettings:I.$d,strokeSettings:G.zh},console.log("[StartPage] ⚠️ LETZTE RETTUNG: Default-Einstellungen werden verwendet");case 34:q={id:l.currentGameNumber,activeGameId:t,timestamp:O,teams:{top:D(D({},(0,u.createInitialTeamStand)()),{},{striche:l.striche.top,total:l.scores.top,weisPoints:null!=(m=null==(p=l.weisPoints)?void 0:p.top)?m:0}),bottom:D(D({},(0,u.createInitialTeamStand)()),{},{striche:l.striche.bottom,total:l.scores.bottom,weisPoints:null!=(f=null==(g=l.weisPoints)?void 0:g.bottom)?f:0})},sessionId:d,currentRound:l.currentRound,startingPlayer:l.startingPlayer,initialStartingPlayer:l.initialStartingPlayer,currentPlayer:l.currentPlayer,roundHistory:C,currentHistoryIndex:C.length-1,historyState:{lastNavigationTimestamp:Date.now()},isGameStarted:!0,isRoundCompleted:null!=(h=l.isRoundCompleted)&&h,isGameCompleted:!1},u.useJassStore.setState({isJassStarted:!0,currentGameId:l.currentGameNumber,games:[q],currentSession:{id:d,gruppeId:null!=(S=l.groupId)?S:"",startedAt:O,playerNames:l.playerNames,games:[l.currentGameNumber],currentScoreLimit:null!=(x=null==(w=s.Q5.getState().currentGroup)||null==(w=w.scoreSettings)?void 0:w.values.sieg)?x:I.$d.values.sieg,completedGamesCount:l.currentGameNumber>0?l.currentGameNumber-1:0,metadata:{},participantUids:l.participantUids,statistics:{gamesPlayed:1,scores:{top:0,bottom:0},weisCount:0,stricheCount:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},currentFarbeSettings:F.farbeSettings,currentScoreSettings:F.scoreSettings,currentStrokeSettings:F.strokeSettings},isJassCompleted:!1,currentRound:l.currentRound,teams:q.teams,onlineCompletedGames:N,currentGameCache:null,jassSessionId:d}),i.useGameStore.setState({activeGameId:t,currentPlayer:l.currentPlayer,startingPlayer:l.startingPlayer,initialStartingPlayer:l.initialStartingPlayer,isGameStarted:!0,currentRound:l.currentRound,weisPoints:null!=(k=l.weisPoints)?k:{top:0,bottom:0},jassPoints:null!=(E=l.currentJassPoints)?E:{top:0,bottom:0},scores:l.scores,striche:l.striche,roundHistory:C,currentRoundWeis:null!=(P=l.currentRoundWeis)?P:[],isGameCompleted:!1,isRoundCompleted:null!=(T=l.isRoundCompleted)&&T,playerNames:l.playerNames,gamePlayers:null!=(R=l.gamePlayers)?R:null,currentHistoryIndex:C.length-1,historyState:{lastNavigationTimestamp:Date.now()},farbeSettings:F.farbeSettings,scoreSettings:F.scoreSettings,strokeSettings:F.strokeSettings}),J=l.jassStartTime instanceof v.Timestamp?l.jassStartTime.toMillis():null,Y=l.gameStartTime instanceof v.Timestamp?l.gameStartTime.toMillis():null,y.useTimerStore.getState().restoreTimers(J,Y),c.useUIStore.getState().setStartScreenState("complete"),el(),tb(!1),eo.push("/jass"),e.next=36;break;case 35:throw e.prev=35,console.error("[StartPage] Error in inner try block:",$=e.catch(5)),$;case 36:e.next=38;break;case 37:e.prev=37,console.error("[StartPage] Error resuming game: ",Q=e.catch(1)),eu({type:"error",message:Q instanceof Error?Q.message:"Fehler beim Laden des Spiels."}),el(),tb(!1);case 38:case"end":return e.stop()}},e,null,[[1,37],[5,35],[6,9],[11,14],[16,22],[23,26],[27,33]])})),function(t){return e.apply(this,arguments)}),tH=(0,n.useCallback)(function(){if(ed)tW(ed);else{if(!$&&Q.length>0)return void eu({message:"Bitte zuerst eine Gruppe ausw\xe4hlen.",type:"warning"});if($&&!eB&&ez.length<4)return void eu({message:"F\xfcr Gruppenspiele mit Statistik braucht es mindestens vier Mitglieder. Du kannst aber trotzdem im Gastmodus jassen.",type:"info",actions:[{label:"Gastmodus",onClick:function(){return eo.push("/")}},{label:"Einladen",onClick:function(){}}]});eo.push("/game/new")}},[ed,eo,tW,$,Q,eu,ez,J]);(0,n.useEffect)(function(){var e;return tv?void es({isVisible:!0,text:"Laden...",onClick:function(){},loading:!0,disabled:!0,variant:"info"}):((null==(e=en.currentSession)?void 0:e.isTournamentSession)&&er.isGameStarted&&!er.isGameCompleted?ei():ed?es({isVisible:!0,text:"Laufendem Jass beitreten",onClick:tH,loading:!1,disabled:!1,variant:"info"}):$?es({isVisible:!0,text:ea?"Jass fortsetzen":"Neuen Jass starten",onClick:tH,loading:!1,disabled:!1,variant:ea?"info":"default"}):0!==Q.length||$||"loading"===J?ei():es({isVisible:!0,text:"Neue Gruppe erstellen",onClick:function(){return eo.push("/groups/new")},loading:!1,disabled:!1,variant:"warning"}),function(){ei()})},[$,ea,es,ei,Q,eo,ed,J,tH,tv,en.currentSession,er.isGameStarted,er.isGameCompleted]);var tB=(t=_(U().mark(function e(t){var r,n;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=t.target.files)&&r.length>0)){e.next=3;break}if((n=r[0]).type.startsWith("image/")){e.next=1;break}return eu({message:"Bitte w\xe4hlen Sie eine Bilddatei (JPEG oder PNG)..",type:"error"}),e.abrupt("return");case 1:if(!(n.size>5242880)){e.next=2;break}return eu({message:"Die Datei ist zu gro\xdf (max. 5 MB).",type:"error"}),e.abrupt("return");case 2:et(),ev&&URL.revokeObjectURL(ev),eb(null),eg(null),eG(URL.createObjectURL(n)),eE(!0);case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),tV=(x=_(U().mark(function e(t){var r,n;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(eE(!1),ej&&(URL.revokeObjectURL(ej),eG(null)),t){e.next=1;break}return em.current&&(em.current.value=""),ex(!1),e.abrupt("return");case 1:return ex(!0),r={maxSizeMB:.2,maxWidthOrHeight:1024,useWebWorker:!0,fileType:"image/jpeg",initialQuality:.8},e.prev=2,e.next=3,(0,f.A)(new File([t],"cropped_logo.jpg",{type:"image/jpeg"}),r);case 3:n=e.sent,eb(URL.createObjectURL(n)),eg(new File([n],"group_logo.jpg",{type:"image/jpeg"})),ex(!1),e.next=5;break;case 4:e.prev=4,console.error("Fehler bei der Komprimierung des zugeschnittenen Gruppenlogos:",e.catch(2)),eu({message:"Fehler bei der Bildkomprimierung.",type:"error"}),eg(null),eb(null),em.current&&(em.current.value=""),ex(!1);case 5:case"end":return e.stop()}},e,null,[[2,4]])})),function(e){return x.apply(this,arguments)}),tq=(F=_(U().mark(function e(){var t,r;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!ef||!$)){e.next=1;break}return e.abrupt("return");case 1:if(tg){e.next=2;break}return eu({message:"Nur Gruppenadministratoren k\xf6nnen das Gruppenbild aktualisieren.",type:"warning",actions:[{label:"Verstanden",onClick:function(){}}]}),e.abrupt("return");case 2:return ex(!0),e.prev=3,e.next=4,(0,g.ie)($.id,ef);case 4:eu({message:"Gruppenlogo erfolgreich aktualisiert.",type:"success"}),eg(null),eb(null),em.current&&(em.current.value=""),e.next=6;break;case 5:e.prev=5,console.error("Fehler beim Hochladen des Gruppenlogos:",r=e.catch(3)),(t=r instanceof Error?r.message:"Hochladen fehlgeschlagen.").includes("unauthorized")||t.includes("permission")?eu({message:"Keine Berechtigung: Nur Gruppenadministratoren k\xf6nnen das Gruppenbild \xe4ndern.",type:"error"}):eu({message:t,type:"error"});case 6:return e.prev=6,ex(!1),e.finish(6);case 7:case"end":return e.stop()}},e,null,[[3,5,6,7]])})),function(){return F.apply(this,arguments)}),tJ=(M=_(U().mark(function e(){var t,r,n,a,o;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($){e.next=1;break}return e.abrupt("return");case 1:if(tg){e.next=2;break}return eu({message:"Nur Gruppenadministratoren k\xf6nnen Einladungen erstellen.",type:"info",actions:[{label:"Verstanden",onClick:function(){}}]}),e.abrupt("return");case 2:return eR(!0),eF(!0),eM(null),eC(null),e.prev=3,t=(0,h.Uz)(void 0,"europe-west1"),r=(0,h.Qg)(t,"generateGroupInviteToken"),e.next=4,r({groupId:$.id});case 4:if(n=e.sent.data.token){e.next=5;break}throw Error("Kein Token vom Server erhalten.");case 5:eC(n),e.next=7;break;case 6:e.prev=6,a=(o=e.catch(3))instanceof Error?o.message:"Unbekannter Fehler beim Generieren des Codes.",console.error("Error calling generateGroupInviteToken:",o),eM(a);case 7:return e.prev=7,eF(!1),e.finish(7);case 8:case"end":return e.stop()}},e,null,[[3,6,7,8]])})),function(){return M.apply(this,arguments)}),tY=function(){eR(!1)},tK=function(){tJ()},tZ=(0,n.useMemo)(function(){var e=eZ.filter(function(e){return("completed"===e.status||"completed_empty"===e.status)&&!e.tournamentId}).map(function(e){return D(D({},e),{},{type:"session"})}),t=e7.map(function(e){return D(D({},e),{},{type:"tournament"})}),r=[].concat(O(e),O(t));return r.sort(function(e,t){var r,n,a="session"===e.type?e.startedAt:null!=(r=e.instanceDate)?r:e.createdAt,o="session"===t.type?t.startedAt:null!=(n=t.instanceDate)?n:t.createdAt,s=V(a)?a.toMillis():"number"==typeof a?a:a&&"function"==typeof a.isEqual?Date.now():0;return(V(o)?o.toMillis():"number"==typeof o?o:o&&"function"==typeof o.isEqual?Date.now():0)-s}),r},[eZ,e7]),t$=tZ.reduce(function(e,t){var r,n="session"===t.type?t.startedAt:null!=(r=t.instanceDate)?r:t.createdAt,a=V(n)?n.toDate().getFullYear().toString():"number"==typeof n?new Date(n).getFullYear().toString():"Unbekannt";return e[a]||(e[a]=[]),e[a].push(t),e},{}),tQ=Object.keys(t$).sort(function(e,t){return parseInt(t)-parseInt(e)}),tX=eo.query,t0=tX.mainTab,t1=tX.statsSubTab,t2=tX.joined,t3=tX.newMember,t4="string"==typeof t0&&["statistics","archive","members"].includes(t0)?t0:"statistics",t7="string"==typeof t1&&["overview","players","teams"].includes(t1)?t1:"overview",t8="string"==typeof t2?t2:null;(0,n.useEffect)(function(){if(t8&&eo.isReady){var e=setTimeout(function(){var e=eo.query,t=(e.joined,e.newMember,function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,L));eo.replace({pathname:eo.pathname,query:t},void 0,{shallow:!0})},3e3);return function(){return clearTimeout(e)}}},[t8,eo]);var t5=(0,n.useCallback)((W=_(U().mark(function e(t,r){var n;return U().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!eu||!eo)){e.next=1;break}return console.error("showNotification oder router nicht initialisiert in handleProcessInviteInput"),e.abrupt("return");case 1:tx(!0),(n=(0,T.g)(t,r)).token?"group"===n.type?(console.log("[StartPage] Navigiere zu /join mit Gruppentoken: ".concat(n.token)),eo.push("/join?token=".concat(n.token))):"tournament"===n.type?(console.log("[StartPage] Navigiere zu /join mit Turniertoken: ".concat(n.token)),eo.push("/join?tournamentToken=".concat(n.token))):"ambiguous"===n.type?eu({message:n.error||"Der Typ des Codes (Gruppe/Turnier) ist unklar. Bitte pr\xfcfen Sie Ihre Eingabe.",type:"error"}):eu({message:n.error||"Ung\xfcltige Eingabe.",type:"error"}):eu({message:n.error||"Eingabe konnte nicht verarbeitet werden.",type:"error"}),tx(!1);case 2:case"end":return e.stop()}},e)})),function(e,t){return W.apply(this,arguments)}),[eo,eu]),t6=(0,n.useMemo)(function(){var e=new Map;return ez.forEach(function(t){t.displayName&&e.set(t.displayName.toLowerCase(),t)}),e},[ez]);return((0,n.useEffect)(function(){if(!tp||!eo.isReady){var e=setTimeout(function(){console.warn("[Watchdog] App h\xe4ngt beim Laden (isDataLoadDetermined:",tp,", router.isReady:",eo.isReady,") - pr\xfcfe Recovery-Status...");try{var e=sessionStorage.getItem("watchdog-triggered");if("true"===e){console.warn("[Watchdog] Recovery bereits versucht - erzwinge einfachen Reload"),window.location.reload();return}sessionStorage.setItem("watchdog-triggered","true"),console.warn("[Watchdog] Erster Recovery-Versuch - leite zu Kill-SW weiter"),window.location.href="/kill-sw.html?auto=true&source=startpage"}catch(e){console.error("[Watchdog] Fehler beim Session-Check, f\xfchre einfachen Reload durch:",e),window.location.reload()}},2e4);return function(){return clearTimeout(e)}}},[tp,eo.isReady]),tp&&eo.isReady)?(0,C.jsx)(A.J,{currentGroup:$,user:B,isGuest:K,userGroups:Q,isAuthenticated:Y,isPublicView:!1,handleProcessInviteInput:t5,isProcessingInvite:tS,showNotification:eu,groupStatus:X,groupError:ee,joinedGroupName:t8,isNewMember:"string"==typeof t3?"true"===t3:null,isAdmin:tg,selectedFile:ef,previewUrl:ev,isUploading:eS,handleSelectClick:function(){if(!tg)return void eu({message:"Nur Gruppenadministratoren k\xf6nnen das Gruppenbild \xe4ndern.",type:"info",actions:[{label:"Verstanden",onClick:function(){}}]});em.current&&em.current.click()},handleUpload:tq,handleCancelSelection:function(){ev&&URL.revokeObjectURL(ev),eg(null),eb(null),em.current&&(em.current.value="")},handleInviteClick:tJ,router:eo,fileInputRef:em,handleFileChange:tB,cropModalOpen:ek,imageToCrop:ej,handleCropComplete:tV,activeMainTab:t4,activeStatsSubTab:t7,groupTheme:tw,statsLoading:ti,statsError:tl,members:ez,membersLoading:eB,membersError:eJ,completedSessions:eZ,groupTournaments:e7,combinedArchiveItems:tZ,groupedArchiveByYear:t$,sortedYears:tQ,renderArchiveItem:function(e){if("session"===e.type){var t,r=e.id,n=(e.startedAt,e.playerNames),a=e.finalScores,o=e.status,s=e.finalStriche,i=e.participantUids,u=null==B?void 0:B.uid;if("completed"===o&&a&&u&&i.includes(u)){var c=null;n&&null!=B&&B.displayName&&(n["1"]===B.displayName||n["3"]===B.displayName?c="bottom":(n["2"]===B.displayName||n["4"]===B.displayName)&&(c="top")),c&&(a.top===a.bottom||"top"===c&&a.top>a.bottom||"bottom"===c&&(a.bottom,a.top))}d.A,m.A;var l="completed"===o?(0,C.jsx)(d.A,{className:"w-4 h-4 text-green-500"}):(0,C.jsx)(m.A,{className:"w-4 h-4 text-red-500"}),f=(null==$?void 0:$.name)||"Partie",g=function(e,t){return e?(e.berg||0)+(e.sieg||0)+(e.matsch||0)+(e.schneider||0)+(e.kontermatsch||0):0},h=null!=(t=null==$?void 0:$.strokeSettings)?t:G.zh,b="completed"===o&&s?g(s.bottom,h):null,y="completed"===o&&s?g(s.top,h):null,S=null;"completed"===o&&e.endedAt&&V(e.endedAt)?S=e.endedAt:e.startedAt&&(S=e.startedAt);var x=V(S)?S.toDate():"number"==typeof S?new Date(S):null,E=x?(0,k.GP)(x,"dd.MM.yy, HH:mm"):"Unbekannt";return(0,C.jsx)(w(),{href:"/view/session/".concat(r),passHref:!0,children:(0,C.jsxs)("div",{className:"px-3 py-2 md:px-4 md:py-2.5 lg:px-6 lg:py-3 bg-gray-700/50 rounded-lg hover:bg-gray-600/50 transition-colors duration-150 cursor-pointer mb-2",children:[(0,C.jsx)("div",{className:"flex justify-between items-center mb-1.5",children:(0,C.jsxs)("div",{className:"flex items-center flex-grow",children:[(0,C.jsxs)("span",{className:"text-base md:text-lg lg:text-xl font-medium text-white mr-2",children:[f," - ",E]}),(0,C.jsx)("div",{className:"flex-shrink-0",children:l})]})}),(0,C.jsxs)("div",{className:"space-y-1",children:[(0,C.jsxs)("div",{className:"flex justify-between items-center text-base md:text-lg lg:text-xl text-gray-400",children:[(0,C.jsx)("div",{children:(0,C.jsxs)("span",{className:"block",children:["Team 1:\xa0",(0,C.jsxs)("span",{className:"text-white",children:[n["1"]||"?"," + ",n["3"]||"?"]})]})}),(0,C.jsx)("span",{className:"text-xl md:text-2xl lg:text-2xl font-semibold text-white pl-2",children:null!==b?b:"-"})]}),(0,C.jsxs)("div",{className:"flex justify-between items-center text-base md:text-lg lg:text-xl text-gray-400",children:[(0,C.jsx)("div",{children:(0,C.jsxs)("span",{className:"block",children:["Team 2:\xa0",(0,C.jsxs)("span",{className:"text-white",children:[n["2"]||"?"," + ",n["4"]||"?"]})]})}),(0,C.jsx)("span",{className:"text-xl md:text-2xl lg:text-2xl font-semibold text-white pl-2",children:null!==y?y:"-"})]})]})]})},"session-".concat(r))}if("tournament"===e.type){var I=e.id,j=e.name,P=e.instanceDate,T=e.status,R=P instanceof v.Timestamp?P.toDate():"number"==typeof P?new Date(P):null,N=R?(0,k.GP)(R,"dd.MM.yyyy"):null;return(0,C.jsx)(w(),{href:"/view/tournament/".concat(I),passHref:!0,children:(0,C.jsx)("div",{className:"px-3 py-2 md:px-4 md:py-2.5 lg:px-6 lg:py-3 bg-purple-900/30 rounded-lg hover:bg-purple-800/40 transition-colors duration-150 cursor-pointer mb-2 border border-purple-700/50",children:(0,C.jsxs)("div",{className:"flex justify-between items-center",children:[(0,C.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,C.jsx)(p.A,{className:"w-6 h-6 md:w-7 md:h-7 lg:w-9 lg:h-9 text-purple-400 flex-shrink-0"}),(0,C.jsxs)("div",{className:"flex flex-col",children:[(0,C.jsx)("span",{className:"text-base md:text-lg lg:text-xl font-medium text-white",children:j}),N&&(0,C.jsx)("span",{className:"text-base md:text-lg lg:text-xl text-gray-400",children:N})]})]}),(0,C.jsx)("span",{className:"text-base md:text-lg lg:text-xl px-2 py-0.5 rounded-full ".concat("completed"===T?"bg-gray-600 text-gray-300":"active"===T?"bg-green-600 text-white":"bg-blue-500 text-white"),children:"completed"===T?"Abgeschlossen":"active"===T?"Aktiv":"Anstehend"})]})})},"tournament-".concat(I))}return null},sessionsLoading:eX,sessionsError:e2,tournamentsLoading:e6,tournamentsError:tt,groupStats:ta,theme:tk,findPlayerByName:function(e){return e?t6.get(e.toLowerCase()):void 0},findPlayerPhotoByName:function(e){if(e){var t=t6.get(e.toLowerCase());return(null==t?void 0:t.photoURL)||void 0}},isInviteModalOpen:eT,onCloseInviteModal:tY,inviteLoading:eO,inviteError:eU,inviteToken:eA,onGenerateNewInvite:tK,handleCloseInviteModal:tY,isGeneratingInvite:eO,handleGenerateNewInvite:tK}):(0,C.jsx)(l.A,{children:(0,C.jsx)("div",{className:"flex flex-1 flex-col items-center justify-center min-h-[calc(100vh-112px)]",children:(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:"mx-auto h-8 w-8 rounded-full border-2 border-t-transparent border-white animate-spin"}),(0,C.jsx)("span",{className:"ml-3 text-white",children:"Laden..."})]})})})}},33615:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11037).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},35485:(e,t,r)=>{"use strict";r.d(t,{t:()=>s});var n=r(48230),a=r.n(n),o=r(37876),s=function(){return(0,o.jsxs)("footer",{className:"mt-6 pb-4 text-center",children:[(0,o.jsxs)("div",{className:"flex flex-wrap justify-center items-center gap-4 text-xs text-gray-500 mb-2",children:[(0,o.jsx)(a(),{href:"/impressum",className:"hover:text-gray-300 transition-colors",children:"Impressum"}),(0,o.jsx)("span",{className:"text-gray-700",children:"•"}),(0,o.jsx)(a(),{href:"/datenschutz",className:"hover:text-gray-300 transition-colors",children:"Datenschutz"}),(0,o.jsx)("span",{className:"text-gray-700",children:"•"}),(0,o.jsx)(a(),{href:"/agb",className:"hover:text-gray-300 transition-colors",children:"AGB"})]}),(0,o.jsxs)("p",{className:"text-xs text-gray-600",children:["\xa9 ",new Date().getFullYear()," jassguru.ch - Alle Rechte vorbehalten"]})]})}},52896:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(11037).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},94733:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/start",function(){return r(28619)}])},99897:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var n=/^[a-f0-9]{48}$/i,a=function(e,t){var r,a=e.trim(),o="invalid",s=null;try{if(a.toLowerCase().startsWith("http")||a.includes("?")){var i=new URL(a.startsWith("http")?a:"https://dummybase".concat(a.startsWith("/")?"":"/").concat(a)),u=i.searchParams.get("token"),c=i.searchParams.get("tournamentToken");if(u)o="group",a=u;else{if(!c)return{type:"invalid",token:null,error:"Link enth\xe4lt keinen g\xfcltigen Einladungscode."};o="tournament",a=c}}else o=t||"ambiguous";if(48!==a.length?r="Ung\xfcltige Code-L\xe4nge. Erwartet: ".concat(48," Zeichen."):n.test(a)||(r="Ung\xfcltiges Code-Format. Nur Zahlen (0-9) und Buchstaben (a-f) erlaubt."),r)return{type:"invalid",token:null,error:r};if(s=a,"ambiguous"===o)return{type:"ambiguous",token:s,error:"Der Typ des Codes (Gruppe/Turnier) konnte nicht automatisch bestimmt werden."};return{type:o,token:s}}catch(e){return{type:"invalid",token:null,error:"Eingabe konnte nicht verarbeitet werden. Ist es ein g\xfcltiger Link oder Code?"}}}}},e=>{e.O(0,[7141,8067,8230,4587,9517,4455,3546,9732,5643,1629,4628,5047,679,4231,3602,9491,4777,1487,5282,636,6593,8792],()=>e(e.s=94733)),_N_E=e.O()}]);