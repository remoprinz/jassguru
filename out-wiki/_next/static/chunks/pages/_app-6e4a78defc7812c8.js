(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{92:(e,r,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(9780)}])},2205:(e,r,n)=>{"use strict";n.d(r,{B:()=>i});let i="undefined"!=typeof window},3866:(e,r,n)=>{"use strict";n.d(r,{t:()=>i});let i=(0,n(14232).createContext)(null)},4319:(e,r,n)=>{"use strict";n.d(r,{KU:()=>u,Zr:()=>l,lt:()=>a});let i=new Map,o=e=>{let r=i.get(e);return r?Object.fromEntries(Object.entries(r.stores).map(([e,r])=>[e,r.getState()])):{}},a=(e,r={})=>(n,a,u)=>{let c,{enabled:l,anonymousActionType:h,store:d,...f}=r;try{c=(null==l||l)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(e){}if(!c)return e(n,a,u);let{connection:p,...m}=((e,r,n)=>{if(void 0===e)return{type:"untracked",connection:r.connect(n)};let o=i.get(n.name);if(o)return{type:"tracked",store:e,...o};let a={connection:r.connect(n),stores:{}};return i.set(n.name,a),{type:"tracked",store:e,...a}})(d,c,f),g=!0;u.setState=(e,r,i)=>{let s=n(e,r);if(!g)return s;let c=void 0===i?{type:h||(e=>{var r,n;if(!e)return;let i=e.split("\n"),o=i.findIndex(e=>e.includes("api.setState"));if(o<0)return;let a=(null==(r=i[o+1])?void 0:r.trim())||"";return null==(n=/.+ (.+) .+/.exec(a))?void 0:n[1]})(Error().stack)||"anonymous"}:"string"==typeof i?{type:i}:i;return void 0===d?null==p||p.send(c,a()):null==p||p.send({...c,type:`${d}/${c.type}`},{...o(f.name),[d]:u.getState()}),s},u.devtools={cleanup:()=>{p&&"function"==typeof p.unsubscribe&&p.unsubscribe(),((e,r)=>{if(void 0===r)return;let n=i.get(e);n&&(delete n.stores[r],0===Object.keys(n.stores).length&&i.delete(e))})(f.name,d)}};let y=(...e)=>{let r=g;g=!1,n(...e),g=r},v=e(u.setState,a,u);if("untracked"===m.type?null==p||p.init(v):(m.stores[m.store]=u,null==p||p.init(Object.fromEntries(Object.entries(m.stores).map(([e,r])=>[e,e===m.store?v:r.getState()])))),u.dispatchFromDevtools&&"function"==typeof u.dispatch){let e=!1,r=u.dispatch;u.dispatch=(...n)=>{"__setState"!==n[0].type||e||(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),e=!0),r(...n)}}return p.subscribe(e=>{var r;switch(e.type){case"ACTION":if("string"!=typeof e.payload)return void console.error("[zustand devtools middleware] Unsupported action format");return s(e.payload,e=>{if("__setState"===e.type){if(void 0===d)return void y(e.state);1!==Object.keys(e.state).length&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let r=e.state[d];return void(null==r||JSON.stringify(u.getState())!==JSON.stringify(r)&&y(r))}u.dispatchFromDevtools&&"function"==typeof u.dispatch&&u.dispatch(e)});case"DISPATCH":switch(e.payload.type){case"RESET":if(y(v),void 0===d)return null==p?void 0:p.init(u.getState());return null==p?void 0:p.init(o(f.name));case"COMMIT":if(void 0===d){null==p||p.init(u.getState());break}return null==p?void 0:p.init(o(f.name));case"ROLLBACK":return s(e.state,e=>{if(void 0===d){y(e),null==p||p.init(u.getState());return}y(e[d]),null==p||p.init(o(f.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return s(e.state,e=>{if(void 0===d)return void y(e);JSON.stringify(u.getState())!==JSON.stringify(e[d])&&y(e[d])});case"IMPORT_STATE":{let{nextLiftedState:n}=e.payload,i=null==(r=n.computedStates.slice(-1)[0])?void 0:r.state;if(!i)return;void 0===d?y(i):y(i[d]),null==p||p.send(null,n);break}case"PAUSE_RECORDING":return g=!g}return}}),v},s=(e,r)=>{let n;try{n=JSON.parse(e)}catch(e){console.error("[zustand devtools middleware] Could not parse the received json",e)}void 0!==n&&r(n)};function u(e,r){let n;try{n=e()}catch(e){return}return{getItem:e=>{var i;let o=e=>null===e?null:JSON.parse(e,null==r?void 0:r.reviver),a=null!=(i=n.getItem(e))?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(e,i)=>n.setItem(e,JSON.stringify(i,null==r?void 0:r.replacer)),removeItem:e=>n.removeItem(e)}}let c=e=>r=>{try{let n=e(r);if(n instanceof Promise)return n;return{then:e=>c(e)(n),catch(e){return this}}}catch(e){return{then(e){return this},catch:r=>c(r)(e)}}},l=(e,r)=>(n,i,o)=>{let a,s={storage:u(()=>localStorage),partialize:e=>e,version:0,merge:(e,r)=>({...r,...e}),...r},l=!1,h=new Set,d=new Set,f=s.storage;if(!f)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...e)},i,o);let p=()=>{let e=s.partialize({...i()});return f.setItem(s.name,{state:e,version:s.version})},m=o.setState;o.setState=(e,r)=>{m(e,r),p()};let g=e((...e)=>{n(...e),p()},i,o);o.getInitialState=()=>g;let y=()=>{var e,r;if(!f)return;l=!1,h.forEach(e=>{var r;return e(null!=(r=i())?r:g)});let o=(null==(r=s.onRehydrateStorage)?void 0:r.call(s,null!=(e=i())?e:g))||void 0;return c(f.getItem.bind(f))(s.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===s.version)return[!1,e.state];else{if(s.migrate){let r=s.migrate(e.state,e.version);return r instanceof Promise?r.then(e=>[!0,e]):[!0,r]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var r;let[o,u]=e;if(n(a=s.merge(u,null!=(r=i())?r:g),!0),o)return p()}).then(()=>{null==o||o(a,void 0),a=i(),l=!0,d.forEach(e=>e(a))}).catch(e=>{null==o||o(void 0,e)})};return o.persist={setOptions:e=>{s={...s,...e},e.storage&&(f=e.storage)},clearStorage:()=>{null==f||f.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>y(),hasHydrated:()=>l,onHydrate:e=>(h.add(e),()=>{h.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},s.skipHydration||y(),a||g}},4902:(e,r,n)=>{"use strict";n.d(r,{C6:()=>o,Cl:()=>a,Tt:()=>s,fX:()=>u});var i=function(e,r){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(e,r)};function o(e,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}i(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function s(e,r){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>r.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)0>r.indexOf(i[o])&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]]);return n}Object.create;function u(e,r,n){if(n||2==arguments.length)for(var i,o=0,a=r.length;o<a;o++)!i&&o in r||(i||(i=Array.prototype.slice.call(r,0,o)),i[o]=r[o]);return e.concat(i||Array.prototype.slice.call(r))}Object.create,"function"==typeof SuppressedError&&SuppressedError},5048:(e,r,n)=>{"use strict";n.d(r,{L:()=>i});let i=(0,n(14232).createContext)({})},7990:(e,r,n)=>{"use strict";n.d(r,{s:()=>o});var i=n(97594);function o(e){return(0,i.G)(e)&&"offsetHeight"in e}},8106:(e,r,n)=>{"use strict";n.d(r,{v:()=>s});var i=n(14232);let o=e=>{let r,n=new Set,i=(e,i)=>{let o="function"==typeof e?e(r):e;if(!Object.is(o,r)){let e=r;r=(null!=i?i:"object"!=typeof o||null===o)?o:Object.assign({},r,o),n.forEach(n=>n(r,e))}},o=()=>r,a={setState:i,getState:o,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=r=e(i,o,a);return a},a=e=>{let r=(e=>e?o(e):o)(e),n=e=>(function(e,r=e=>e){let n=i.useSyncExternalStore(e.subscribe,()=>r(e.getState()),()=>r(e.getInitialState()));return i.useDebugValue(n),n})(r,e);return Object.assign(n,r),n},s=e=>e?a(e):a},9780:(e,r,n)=>{"use strict";n.r(r),n.d(r,{default:()=>ej});var i=n(14232);n(65454);var o=n(89099),a=n(37876);function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}var u=(0,i.createContext)({isPWA:!1}),c=function(e){var r,n=e.children,o=function(e){if(Array.isArray(e))return e}(r=(0,i.useState)(!1))||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(r,2)||function(e,r){if(e){if("string"==typeof e)return s(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,r):void 0}}(r,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),c=o[0],l=o[1];return(0,i.useEffect)(function(){l(window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone||document.referrer.includes("android-app://"))},[]),(0,a.jsx)(u.Provider,{value:{isPWA:c},children:n})},l=n(77328),h=n.n(l);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){f=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=p(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=p(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==d(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(d(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=l(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function p(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function m(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,r)||function(e,r){if(e){if("string"==typeof e)return g(e,r);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,r):void 0}}(e,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}var y=n(49397),v=n(27788),b=n(66534);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(){S=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=b.prototype=y.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==w(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(w(r)+" is not iterable")}return v.prototype=b,o(T,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function x(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function E(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,r)||function(e,r){if(e){if("string"==typeof e)return I(e,r);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,r):void 0}}(e,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}var T=(0,i.createContext)({user:null,player:null,loading:!0});function k(e){var r=e.children,n=(0,v.useAuthStore)(),o=n.user,s=n.status,u=(n.error,n.appMode),c=E((0,i.useState)(null),2),l=c[0],h=c[1],d=E((0,i.useState)(!0),2),f=d[0],p=d[1],m=E((0,i.useState)(null),2),g=(m[0],m[1]);return(0,i.useEffect)(function(){var e,r,n=(e=S().mark(function e(){return S().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p(!0),g(null),e.prev=1,!(o&&"online"===u)){e.next=3;break}return e.next=2,(0,b.getPlayerByUserId)(o.uid);case 2:h(e.sent),e.next=4;break;case 3:h(null);case 4:e.next=6;break;case 5:e.prev=5,console.error("Fehler beim Laden des Spielers:",e.catch(1)),g("Spieler konnte nicht geladen werden");case 6:return e.prev=6,p(!1),e.finish(6);case 7:case"end":return e.stop()}},e,null,[[1,5,6,7]])}),r=function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){x(a,i,o,s,u,"next",e)}function u(e){x(a,i,o,s,u,"throw",e)}s(void 0)})},function(){return r.apply(this,arguments)});("authenticated"===s||"unauthenticated"===s)&&n()},[o,s,u]),(0,a.jsx)(T.Provider,{value:{user:o,player:l,loading:"loading"===s||f},children:r})}var _=n(48101),A=n(94566),P=n(11996);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(){C=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new A(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(P([])));x&&x!==n&&i.call(x,s)&&(w=x);var E=b.prototype=y.prototype=Object.create(w);function I(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function T(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==O(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function k(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function _(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(O(r)+" is not iterable")}return v.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},I(T.prototype),l(T.prototype,u,function(){return this}),r.AsyncIterator=T,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new T(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},I(E),l(E,c,"Generator"),l(E,s,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=P,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:P(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function N(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return L(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function L(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function D(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function R(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){D(a,i,o,s,u,"next",e)}function u(e){D(a,i,o,s,u,"throw",e)}s(void 0)})}}function j(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,U(i.key),i)}}function F(e,r,n){return(r=U(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function U(e){var r=function(e,r){if("object"!=O(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=O(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==O(r)?r:r+""}var M=function(){var e,r,n,i,o,a,s,u,c;function l(){if(!(this instanceof l))throw TypeError("Cannot call a class as a function");F(this,"registration",null),F(this,"updateAvailable",!1),F(this,"updateStatus","idle"),F(this,"updatePromise",null),F(this,"backoffConfig",{maxAttempts:3,delays:[5e3,15e3,6e4],currentAttempt:0}),F(this,"updateTimeoutId",null),F(this,"UPDATE_TIMEOUT",3e4),F(this,"FAIL_COUNT_KEY","swActivationFailures"),F(this,"MAX_FAILS_BEFORE_KILL",2)}return u=[{key:"getActivationFailCount",value:function(){try{var e=localStorage.getItem(this.FAIL_COUNT_KEY),r=e?parseInt(e,10):0;return Number.isFinite(r)?r:0}catch(e){return 0}}},{key:"setActivationFailCount",value:function(e){try{localStorage.setItem(this.FAIL_COUNT_KEY,String(Math.max(0,e)))}catch(e){}}},{key:"resetActivationFailCount",value:function(){this.setActivationFailCount(0)}},{key:"handleActivationFailureAndMaybeKill",value:function(){var e=this.getActivationFailCount()+1;if(this.setActivationFailCount(e),!window.location.pathname.endsWith("/kill-sw.html")&&e>=this.MAX_FAILS_BEFORE_KILL){this.resetActivationFailCount();try{window.location.href="/kill-sw.html"}catch(e){try{window.location.reload()}catch(e){}}}}},{key:"isPWAMode",value:function(){var e=window.matchMedia("(display-mode: standalone)").matches,r=window.matchMedia("(display-mode: fullscreen)").matches,n=window.matchMedia("(display-mode: minimal-ui)").matches,i="standalone"in window.navigator&&!0===window.navigator.standalone;return e||r||n||i}},{key:"cleanupLegacyServiceWorkers",value:(e=R(C().mark(function e(){var r,n,i,o,a,s;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,navigator.serviceWorker.getRegistrations();case 1:r=N(e.sent),e.prev=2,r.s();case 3:if((n=r.n()).done){e.next=5;break}if(a=(null==(i=(o=n.value).active)?void 0:i.scriptURL)||"",!(o.scope.includes("/pwa/")||a.includes("/pwa/sw.js"))){e.next=4;break}return e.next=4,o.unregister();case 4:e.next=3;break;case 5:e.next=7;break;case 6:e.prev=6,s=e.catch(2),r.e(s);case 7:return e.prev=7,r.f(),e.finish(7);case 8:e.next=10;break;case 9:e.prev=9,console.warn("[ServiceWorker] Legacy cleanup fehlgeschlagen (nicht kritisch):",e.catch(0));case 10:case"end":return e.stop()}},e,null,[[0,9],[2,6,7,8]])})),function(){return e.apply(this,arguments)})},{key:"unregisterAll",value:(r=R(C().mark(function e(){var r,n,i,o,a,s,u,c;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("serviceWorker"in navigator){e.next=1;break}return e.abrupt("return");case 1:return e.prev=1,e.next=2,navigator.serviceWorker.getRegistrations();case 2:r=N(e.sent),e.prev=3,r.s();case 4:if((n=r.n()).done){e.next=6;break}return i=n.value,e.next=5,i.unregister();case 5:e.next=4;break;case 6:e.next=8;break;case 7:e.prev=7,u=e.catch(3),r.e(u);case 8:return e.prev=8,r.f(),e.finish(8);case 9:if(!("caches"in window)){e.next=17;break}return e.next=10,caches.keys();case 10:o=N(e.sent),e.prev=11,o.s();case 12:if((a=o.n()).done){e.next=14;break}return s=a.value,e.next=13,caches.delete(s);case 13:e.next=12;break;case 14:e.next=16;break;case 15:e.prev=15,c=e.catch(11),o.e(c);case 16:return e.prev=16,o.f(),e.finish(16);case 17:e.next=19;break;case 18:e.prev=18,console.error("[ServiceWorker] Fehler beim Deregistrieren:",e.catch(1));case 19:case"end":return e.stop()}},e,null,[[1,18],[3,7,8,9],[11,15,16,17]])})),function(){return r.apply(this,arguments)})},{key:"register",value:(n=R(C().mark(function e(){var r,n,i,o=this,a=arguments;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=a.length>0&&void 0!==a[0]?a[0]:{},e.next=1;break;case 1:if("serviceWorker"in navigator){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,"1"!==new URL(window.location.href).searchParams.get("no-sw")){e.next=3;break}return e.abrupt("return");case 3:e.next=5;break;case 4:e.prev=4,e.catch(2);case 5:if(e.prev=5,!(window.location.pathname.endsWith("/kill-sw.html")||window.location.pathname.endsWith("/recovery.html"))){e.next=6;break}return e.abrupt("return");case 6:e.next=8;break;case 7:e.prev=7,e.catch(5);case 8:if(e.prev=8,"true"!==sessionStorage.getItem("watchdog-triggered")){e.next=9;break}return setTimeout(function(){sessionStorage.removeItem("watchdog-triggered"),o.register(r)},5e3),e.abrupt("return");case 9:e.next=11;break;case 10:e.prev=10,e.catch(8);case 11:return e.next=12,this.cleanupLegacyServiceWorkers();case 12:return e.prev=12,e.next=13,new Promise(function(e){"complete"===document.readyState?e():window.addEventListener("load",function(){return e()})});case 13:return e.next=14,navigator.serviceWorker.register("/sw.js",{scope:"/"});case 14:n=e.sent,this.registration=n,n.addEventListener("updatefound",function(){var e=n.installing;e&&e.addEventListener("statechange",function(){"installed"===e.state&&navigator.serviceWorker.controller&&(o.updateAvailable=!0,r.onUpdate&&r.onUpdate(n))})}),r.onSuccess&&r.onSuccess(n),setInterval(function(){"visible"===document.visibilityState&&"idle"===o.updateStatus&&o.checkForUpdate()},18e5),e.next=16;break;case 15:e.prev=15,console.error("[PWA] Service Worker Registrierung fehlgeschlagen:",i=e.catch(12)),r.onError&&r.onError(i);case 16:case"end":return e.stop()}},e,this,[[2,4],[5,7],[8,10],[12,15]])})),function(){return n.apply(this,arguments)})},{key:"activateUpdate",value:(i=R(C().mark(function e(){var r,n=this;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("activating"===this.updateStatus||this.updatePromise)){e.next=1;break}return e.abrupt("return",this.updatePromise||Promise.resolve());case 1:if(!l.isGloballyUpdating){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(!(!this.registration||!this.registration.waiting)){e.next=3;break}try{if(!function(){try{return"1"===sessionStorage.getItem("pwaUpdateReloaded")}catch(e){return!1}}()){try{sessionStorage.setItem("pwaUpdateReloaded","1")}catch(e){}window.location.href=window.location.href.split("?")[0]+"?updated="+Date.now()}}catch(e){try{window.location.reload()}catch(e){}}return e.abrupt("return");case 3:return this.updateStatus="activating",l.isGloballyUpdating=!0,this.updatePromise=new Promise(function(e,r){var i=n.registration.waiting,o=!1,a=setTimeout(function(){if(!o){o=!0,n.updateStatus="idle",n.updatePromise=null,l.isGloballyUpdating=!1,navigator.serviceWorker.removeEventListener("controllerchange",s),n.handleActivationFailureAndMaybeKill();try{if(!function(){try{return"1"===sessionStorage.getItem("pwaUpdateReloaded")}catch(e){return!1}}()){try{sessionStorage.setItem("pwaUpdateReloaded","1")}catch(e){}window.location.href=window.location.href.split("?")[0]+"?updated="+Date.now()}}catch(e){}e()}},n.UPDATE_TIMEOUT),s=function(){if(!o){o=!0,clearTimeout(a),navigator.serviceWorker.removeEventListener("controllerchange",s),navigator.serviceWorker.removeEventListener("message",u),n.updateStatus="idle",n.updatePromise=null,n.backoffConfig.currentAttempt=0,l.isGloballyUpdating=!1,n.resetActivationFailCount();try{sessionStorage.setItem("pwaUpdateReloaded","1")}catch(e){}window.location.href=window.location.href.split("?")[0]+"?updated="+Date.now(),e()}},u=function(e){try{var r=e.data;if(!r||"object"!==O(r))return;"SW_ACTIVATED"!==r.type||o||s()}catch(e){}};navigator.serviceWorker.addEventListener("message",u),navigator.serviceWorker.addEventListener("controllerchange",s);try{i&&"function"==typeof i.postMessage&&i.postMessage({type:"SKIP_WAITING"})}catch(e){o||(o=!0,clearTimeout(a),navigator.serviceWorker.removeEventListener("controllerchange",s),n.updateStatus="error",n.updatePromise=null,l.isGloballyUpdating=!1,n.handleActivationFailureAndMaybeKill(),r(e))}}),e.prev=4,e.next=5,this.updatePromise;case 5:e.next=7;break;case 6:throw e.prev=6,console.error("[PWA] ❌ Update-Aktivierung fehlgeschlagen:",r=e.catch(4)),l.isGloballyUpdating=!1,this.updateStatus="idle",this.updatePromise=null,r;case 7:case"end":return e.stop()}},e,this,[[4,6]])})),function(){return i.apply(this,arguments)})},{key:"handleUpdateError",value:(o=R(C().mark(function e(r){var n=this;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.backoffConfig.currentAttempt++,!(this.backoffConfig.currentAttempt>=this.backoffConfig.maxAttempts)){e.next=1;break}return console.error("[PWA] \uD83D\uDEAB Max Update-Versuche erreicht - gebe auf",{attempts:this.backoffConfig.currentAttempt,error:r.message}),this.backoffConfig.currentAttempt=0,e.abrupt("return");case 1:setTimeout(function(){n.activateUpdate().catch(console.error)},this.backoffConfig.delays[this.backoffConfig.currentAttempt-1]||6e4);case 2:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"checkForUpdate",value:(a=R(C().mark(function e(){var r,n=this;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.registration){e.next=1;break}return e.abrupt("return");case 1:if("checking"!==this.updateStatus&&"activating"!==this.updateStatus){e.next=2;break}return e.abrupt("return");case 2:return this.updateStatus="checking",e.prev=3,e.next=4,this.registration.update();case 4:this.updateStatus="idle",e.next=6;break;case 5:e.prev=5,r=e.catch(3),this.updateStatus="error",console.error("[PWA] ❌ Fehler beim Suchen nach Updates:",r),setTimeout(function(){n.updateStatus="idle"},Math.min(3e4*this.backoffConfig.currentAttempt,3e5));case 6:case"end":return e.stop()}},e,this,[[3,5]])})),function(){return a.apply(this,arguments)})},{key:"unregister",value:(s=R(C().mark(function e(){return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.registration){e.next=1;break}return e.abrupt("return");case 1:return e.prev=1,e.next=2,this.registration.unregister();case 2:e.sent&&(this.registration=null),e.next=4;break;case 3:e.prev=3,console.error("[PWA] Deregistrierung fehlgeschlagen:",e.catch(1));case 4:case"end":return e.stop()}},e,this,[[1,3]])})),function(){return s.apply(this,arguments)})},{key:"hasUpdate",value:function(){return this.updateAvailable}},{key:"getRegistration",value:function(){return this.registration}}],c=[{key:"getInstance",value:function(){return l.instance||(l.instance=new l),l.instance}}],u&&j(l.prototype,u),c&&j(l,c),Object.defineProperty(l,"prototype",{writable:!1}),l}();F(M,"isGloballyUpdating",!1);var G=M.getInstance(),V=n(53551);let B=function(){var e=(0,A.useUIStore)(),r=e.setUpdateAvailable,n=e.setTriggerUpdate,o=(0,i.useCallback)(function(e){r(!0),n(function(){return G.activateUpdate()})},[r,n]);return(0,i.useEffect)(function(){G.register({onUpdate:function(e){(0,V.N)(window.location.pathname)||o(e)}});var e=function(){document.hidden||G.checkForUpdate()};return document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}},[o]),null};var z=n(42009),q=n(13848),H=n(28742),$=n(35365),K=n(83872),W=n(10637),Q=n(21297),J=n(99407);function Y(){Y=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new A(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(P([])));x&&x!==n&&i.call(x,s)&&(w=x);var E=b.prototype=y.prototype=Object.create(w);function I(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function T(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==et(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function k(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function _(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(et(r)+" is not iterable")}return v.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},I(T.prototype),l(T.prototype,u,function(){return this}),r.AsyncIterator=T,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new T(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},I(E),l(E,c,"Generator"),l(E,s,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=P,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:P(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function X(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function Z(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function ee(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?Z(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=et(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=et(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==et(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}var en=(0,i.createContext)(null);window.__FIRESTORE_SYNC_API__={markLocalUpdate:null};var ei=function(e){var r,n=e.children,s=(0,z.getFirestore)(q.firebaseApp),u=(0,i.useRef)(!1),c=(0,H.useGameStore)(function(e){return e.resetGame}),l=H.useGameStore.setState,h=(0,K.useJassStore)(function(e){return e.activeGameId}),d=(0,K.useJassStore)(function(e){return e.jassSessionId}),f=(0,$.h)().user,p=(0,o.useRouter)();(0,i.useRef)(!1),(0,i.useRef)(0);var m=(0,i.useRef)(0);(0,i.useRef)(new Set);var g=(0,i.useRef)(null),y=function(e){if(Array.isArray(e))return e}(r=(0,i.useState)({isSyncing:!1,lastSyncTime:null,syncError:null,isPaused:!1,currentlyProcessingRoundIds:[]}))||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(r,2)||function(e,r){if(e){if("string"==typeof e)return er(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?er(e,r):void 0}}(r,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),v=y[0],b=y[1],w=(0,i.useRef)(null),S=(0,i.useRef)(null),x=(0,i.useRef)(null),E=(0,i.useRef)(null),I=function(e){return e&&"object"===et(e)&&(e instanceof z.Timestamp||"_seconds"in e&&"_nanoseconds"in e&&"function"==typeof e.toMillis)},T=function(e){if(I(e))try{return e.toMillis()}catch(e){console.error("Fehler beim Aufrufen von toMillis():",e)}return Date.now()},k=(0,i.useCallback)(function(e){var r=H.useGameStore.getState().activeGameId;if(!r)return void console.warn("[FirestoreSyncProvider] handleRemoteGameEndOrAbort called without activeGameId. Skipping.");if(g.current!==r){var n=A.useUIStore.getState().signingState;if("completed"===e&&"completed"===n){g.current=r;return}if(g.current=r,"aborted"===e){W.useTimerStore.getState().resetAllTimers(),c(1,void 0),A.useUIStore.getState().clearResumableGameId(),A.useUIStore.getState().resetAll();var i=!!f;p.push(i?"/start":"/")}else{W.useTimerStore.getState().resetAllTimers(),c(1,void 0),A.useUIStore.getState().clearResumableGameId(),A.useUIStore.getState().resetAll();var o=!!f;p.push(o?"/start":"/")}}},[p,f,c]),_=(0,i.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=H.useGameStore.getState().activeGameId;if(!n||g.current!==n){if(u.current){console.log("[FirestoreSync applyServerUpdate] Applying INITIAL sync for game ".concat(h,". Overwriting state..."));var i,o,a,s,c,d,f,p,y,v,b,w,S,x=null!=(o=e.initialStartingPlayer)?o:1,E=null!=(a=e.startingPlayer)?a:x,I=null!=(s=e.currentPlayer)?s:E,_=(0,Q.g)(e);console.log("[FirestoreSync applyServerUpdate] Initial sync data sanitized:",_),l({activeGameId:null!=h?h:void 0,scores:null!=(c=_.scores)?c:{top:0,bottom:0},striche:null!=(d=_.striche)?d:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},weisPoints:null!=(f=_.weisPoints)?f:{top:0,bottom:0},jassPoints:null!=(p=_.jassPoints)?p:{top:0,bottom:0},currentRound:null!=(y=_.currentRound)?y:1,currentPlayer:I,startingPlayer:E,initialStartingPlayer:x,isGameStarted:!0,isGameCompleted:"completed"===_.status||"aborted"===_.status,isRoundCompleted:null!=(v=_.isRoundCompleted)&&v,currentRoundWeis:null!=(b=_.currentRoundWeis)?b:[],playerNames:null!=(w=_.playerNames)?w:{1:"",2:"",3:"",4:""},gamePlayers:null!=(S=_.gamePlayers)?S:null,roundHistory:r||[],currentHistoryIndex:r?r.length-1:-1,historyState:{lastNavigationTimestamp:Date.now()}}),u.current=!1,console.log("[FirestoreSync applyServerUpdate] Initial sync applied. isInitialSyncRef set to false.");return}Date.now();H.useGameStore.getState(),m.current,T(e.lastUpdated),A.useUIStore.getState().isNavigatingHistory&&console.log("[FirestoreSync applyServerUpdate] ⚠️ Currently navigating history, but applying server update anyway for cross-client sync.");var P=(0,Q.g)(e),O=!0===P.isRoundCompleted?{top:0,bottom:0}:null!=(i=P.weisPoints)?i:{top:0,bottom:0};l(function(e){var r,n,i,o,a,s,u,c,l,h;return ee(ee({},e),{},{scores:null!=(r=P.scores)?r:{top:0,bottom:0},weisPoints:O,striche:null!=(n=P.striche)?n:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},jassPoints:null!=(i=P.currentJassPoints)?i:{top:0,bottom:0},currentRound:null!=(o=P.currentRound)?o:1,currentPlayer:null!=(a=P.currentPlayer)?a:1,startingPlayer:null!=(s=P.startingPlayer)?s:1,isRoundCompleted:null!=(u=P.isRoundCompleted)&&u,currentRoundWeis:null!=(c=P.currentRoundWeis)?c:[],gamePlayers:null!=(l=P.gamePlayers)?l:null,playerNames:null!=(h=P.playerNames)?h:{1:"Spieler 1",2:"Spieler 2",3:"Spieler 3",4:"Spieler 4"}})}),("aborted"===P.status||"completed"===P.status)&&k(P.status)}},[l,h,k]),P=(0,i.useCallback)(function(e){try{var r=e.data(),n=I(r.timestamp)?T(r.timestamp):Date.now(),i={id:r.id,roundId:r.roundId,timestamp:n,actionType:r.actionType,startingPlayer:r.startingPlayer,startingPlayerName:r.startingPlayerName,currentPlayer:r.currentPlayer,weisPoints:r.weisPoints||{top:0,bottom:0},jassPoints:r.jassPoints||{top:0,bottom:0},scores:r.scores||{top:0,bottom:0},striche:r.striche||{top:{},bottom:{}},weisActions:r.weisActions||[],roundState:r.roundState||{roundNumber:1,nextPlayer:1},visualStriche:r.visualStriche||{top:{stricheCounts:{},restZahl:0},bottom:{stricheCounts:{},restZahl:0}},isActive:r.isActive};if("jass"===r.actionType)return ee(ee({},i),{},{actionType:"jass",farbe:r.farbe,cardStyle:r.cardStyle||"deutsch",strichInfo:r.strichInfo,isRoundFinalized:!0,isCompleted:!0,isActive:r.isActive});return ee(ee({},i),{},{actionType:"weis",isRoundFinalized:!1,isCompleted:!1,isActive:r.isActive})}catch(e){return console.error("Fehler beim Konvertieren des Rundendokuments:",e),null}},[]),O=(0,i.useCallback)(function(){console.log("Pausiere Synchronisation"),b(function(e){return ee(ee({},e),{},{isPaused:!0})})},[]),C=(0,i.useCallback)(function(){console.log("Setze Synchronisation fort"),b(function(e){return ee(ee({},e),{},{isPaused:!1})})},[]),N=(0,i.useCallback)(function(){m.current=Date.now()},[]);(0,i.useEffect)(function(){return window.__FIRESTORE_SYNC_API__={markLocalUpdate:N},function(){window.__FIRESTORE_SYNC_API__={markLocalUpdate:null}}},[N]),(0,i.useEffect)(function(){var e,r,n=function(e){E.current=e,g.current=null,b(function(e){return ee(ee({},e),{},{isSyncing:!0,syncError:null})});try{var r=(0,z.doc)(s,"activeGames",e);w.current=(0,z.onSnapshot)(r,function(r){if(b(function(e){return ee(ee({},e),{},{isSyncing:!1,lastSyncTime:new Date})}),r.exists()){var n=r.data();_(n,null)}else console.warn("[FirestoreSyncProvider] Active game document ".concat(e," does not exist."))},function(r){console.error("[FirestoreSyncProvider] Error listening to game ".concat(e,":"),r),b(function(e){return ee(ee({},e),{},{isSyncing:!1,syncError:r})})})}catch(r){console.error("[FirestoreSyncProvider] Failed to set up listener for game ".concat(e,":"),r),b(function(e){return ee(ee({},e),{},{isSyncing:!1,syncError:r})})}try{var n=(0,z.collection)(s,"activeGames",e,"rounds"),i=(0,z.query)(n,(0,z.orderBy)("timestamp"));S.current=(0,z.onSnapshot)(i,function(e){var r=e.docs.map(function(e){return P(e)}).filter(function(e){return null!==e}),n=H.useGameStore.getState().roundHistory;if(JSON.stringify(r)!==JSON.stringify(n)){var i=r.findLastIndex(function(e){return void 0===e.isActive||!0===e.isActive});l({roundHistory:r,currentHistoryIndex:i>=0?i:-1})}},function(r){console.error("[FirestoreSyncProvider] ❌ CRITICAL ERROR: Rounds listener failed for game ".concat(e,":"),r),console.error("[FirestoreSyncProvider] ❌ Error details:",{name:r.name,message:r.message,code:r.code,stack:r.stack})})}catch(r){console.error("[FirestoreSyncProvider] ❌ FATAL: Failed to set up listener for rounds of game ".concat(e,":"),r),console.error("[FirestoreSyncProvider] ❌ Setup error details:",{name:r.name,message:r.message,stack:r.stack})}},i=function(){w.current&&w.current(),S.current&&S.current(),w.current=null,S.current=null,E.current=null},o=(e=Y().mark(function e(r){var i,o,a,u,c,h,d,f,p,m,g,y,v,w,S,x,E,I,T,k,_,A;return Y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b(function(e){return ee(ee({},e),{},{isSyncing:!0,syncError:null})}),e.prev=1,v=(0,z.doc)(s,"activeGames",r),e.next=2,(0,z.getDoc)(v);case 2:if((w=e.sent).exists()){e.next=3;break}throw console.error("[FirestoreSyncProvider LOAD] ERROR: Active game document ".concat(r," not found!")),Error("Active game document ".concat(r," not found during initial load."));case 3:return S=w.data(),e.next=4,(0,J.loadRoundsFromFirestore)(r);case 4:x=e.sent,E=null!=(i=S.initialStartingPlayer)?i:1,I=null!=(o=S.startingPlayer)?o:E,T=null!=(a=S.currentPlayer)?a:I,k=x.findLastIndex(function(e){return void 0===e.isActive||!0===e.isActive}),_=!0===S.isRoundCompleted?{top:0,bottom:0}:null!=(u=S.weisPoints)?u:{top:0,bottom:0},l({activeGameId:r,scores:null!=(c=S.scores)?c:{top:0,bottom:0},striche:null!=(h=S.striche)?h:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},weisPoints:_,jassPoints:null!=(d=S.currentJassPoints)?d:{top:0,bottom:0},currentRound:null!=(f=S.currentRound)?f:1,currentPlayer:T,startingPlayer:I,initialStartingPlayer:E,isGameStarted:!0,isGameCompleted:"completed"===S.status||"aborted"===S.status,isRoundCompleted:null!=(p=S.isRoundCompleted)&&p,currentRoundWeis:null!=(m=S.currentRoundWeis)?m:[],playerNames:null!=(g=S.playerNames)?g:{1:"",2:"",3:"",4:""},gamePlayers:null!=(y=S.gamePlayers)?y:null,roundHistory:x,currentHistoryIndex:k>=0?k:-1,historyState:{lastNavigationTimestamp:Date.now()}}),H.useGameStore.getState(),n(r),e.next=6;break;case 5:e.prev=5,A=e.catch(1),console.error("[FirestoreSyncProvider LOAD] FATAL ERROR during initial load for game ".concat(r,":"),A),b(function(e){return ee(ee({},e),{},{isSyncing:!1,syncError:A})});case 6:return e.prev=6,b(function(e){return ee(ee({},e),{},{isSyncing:!1})}),e.finish(6);case 7:case"end":return e.stop()}},e,null,[[1,5,6,7]])}),r=function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){X(a,i,o,s,u,"next",e)}function u(e){X(a,i,o,s,u,"throw",e)}s(void 0)})},function(e){return r.apply(this,arguments)});if(!v.isPaused){var a=E.current;return h?h!==a?(i(),o(h)):w.current&&S.current||(i(),n(h)):a&&(i(),g.current=null),function(){}}},[h,v.isPaused]);var L=function(e){try{var r=e.data();if(!r.gameNumber||!r.finalScores||!r.finalStriche)return console.warn("Unvollst\xe4ndiges CompletedGameSummary-Dokument:",e.id),null;var n=I(r.timestampCompleted)?r.timestampCompleted:new z.Timestamp(0,0),i=[];return Array.isArray(r.roundHistory)&&(i=r.roundHistory.map(function(e){return e&&I(e.timestamp)&&(e.timestamp=T(e.timestamp)),e})),{gameNumber:r.gameNumber,timestampCompleted:n,durationMillis:r.durationMillis||0,finalScores:r.finalScores,finalStriche:r.finalStriche,weisPoints:r.weisPoints||{top:0,bottom:0},startingPlayer:r.startingPlayer,initialStartingPlayer:r.initialStartingPlayer,playerNames:r.playerNames||{1:"",2:"",3:"",4:""},trumpColorsPlayed:r.trumpColorsPlayed||[],roundHistory:i,participantUids:r.participantUids||[],groupId:r.groupId,completedAt:r.completedAt||null}}catch(e){return console.error("Fehler beim Konvertieren des CompletedGameSummary-Dokuments:",e),null}};return(0,i.useEffect)(function(){if(d&&!v.isPaused){x.current&&(x.current(),x.current=null);try{var e=K.useJassStore.getState().currentSession,r=(null==e?void 0:e.gruppeId)||(null==e?void 0:e.groupId);if(!r)return void console.error("[FirestoreSyncProvider] No groupId found for session ".concat(d));var n=(0,z.collection)(s,"groups",r,"jassGameSummaries",d,"completedGames"),i=(0,z.query)(n,(0,z.orderBy)("gameNumber"));return x.current=(0,z.onSnapshot)(i,function(e){new Date().toISOString();var r=e.docs.map(function(e){return L(e)}).filter(function(e){return null!==e});K.useJassStore.setState(function(e){var n=JSON.stringify(e.onlineCompletedGames),i=JSON.stringify(r);return n!==i?ee(ee({},e),{},{onlineCompletedGames:r}):e})},function(e){var r=new Date().toISOString();console.error("[FirestoreSync COMPLETED_GAMES ".concat(r,"] Error listening to completed games in session ").concat(d,":"),e),b(function(r){return ee(ee({},r),{},{syncError:e instanceof Error?e:Error("Unknown error")})})}),function(){x.current&&(x.current(),x.current=null)}}catch(e){console.error("Fehler beim Einrichten der completedGames-Listener",e),b(function(r){return ee(ee({},r),{},{syncError:e instanceof Error?e:Error("Unknown error")})})}}},[d,v.isPaused]),(0,a.jsx)(en.Provider,{value:{syncStatus:v,pauseSync:O,resumeSync:C,markLocalUpdate:N},children:n})},eo=n(11923),ea=n(40531),es=n(19250),eu=n(24534),ec=n(93786),el=n(11510),eh=n(39427),ed=n(31931);function ef(e){return(ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ep(){ep=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new A(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(P([])));x&&x!==n&&i.call(x,s)&&(w=x);var E=b.prototype=y.prototype=Object.create(w);function I(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function T(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==ef(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function k(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function _(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(ef(r)+" is not iterable")}return v.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},I(T.prototype),l(T.prototype,u,function(){return this}),r.AsyncIterator=T,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new T(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},I(E),l(E,c,"Generator"),l(E,s,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=P,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:P(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function em(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}var eg=function(){var e=(0,v.useAuthStore)(),r=e.user,n=e.isAuthenticated,o=(0,ed.Q5)(),a=o.userGroups,s=o.currentGroup;(0,i.useEffect)(function(){if(n()&&r){var e,i=setTimeout((e=ep().mark(function e(){var n;return ep().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],r.photoURL&&n.push({url:r.photoURL,type:"profile",metadata:{userId:r.uid}}),null!=s&&s.logoUrl&&n.push({url:s.logoUrl,type:"group",metadata:{groupId:s.id}}),null==a||a.forEach(function(e){e.logoUrl&&e.id!==(null==s?void 0:s.id)&&n.push({url:e.logoUrl,type:"group",metadata:{groupId:e.id}})}),!(n.length>0)){e.next=1;break}return e.next=1,eh.is.queueMultiple(n);case 1:case"end":return e.stop()}},e)}),function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){em(a,i,o,s,u,"next",e)}function u(e){em(a,i,o,s,u,"throw",e)}s(void 0)})}),3e3);return function(){return clearTimeout(i)}}},[r,s,a,n]),(0,i.useEffect)(function(){var e=setInterval(function(){var e=eh.is.getStatus();(e.queueLength>0||e.isProcessing)&&console.log("[BackgroundOptimizer Status]",e)},1e4);return function(){return clearInterval(e)}},[])},ey=n(37537),ev=(0,n(11037).A)("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),eb=n(95014);function ew(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}var eS=function(){var e,r=(0,A.useUIStore)(),n=r.isUpdateAvailable,o=r.triggerUpdate,s=function(e){if(Array.isArray(e))return e}(e=(0,i.useState)(!1))||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,2)||function(e,r){if(e){if("string"==typeof e)return ew(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ew(e,r):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),u=s[0],c=s[1],l=G.isPWAMode(),h=(0,V.N)(window.location.pathname);return n&&l&&!h?(0,a.jsxs)("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 w-[95%] max-w-lg bg-blue-600 text-white p-4 rounded-lg shadow-lg flex items-center justify-between z-50 animate-fade-in-up",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ev,{className:"mr-3 h-6 w-6"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:"Update verf\xfcgbar"}),(0,a.jsx)("p",{className:"text-sm",children:"Eine neue Version der App ist bereit."})]})]}),(0,a.jsx)(ey.$,{onClick:function(){o&&(c(!0),setTimeout(function(){o()},50))},disabled:u,className:"bg-white text-blue-600 hover:bg-gray-200 disabled:opacity-75",children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eb.A,{className:"mr-2 h-5 w-5 animate-spin"}),"Installiere..."]}):"Installieren"})]}):null},ex=n(23513),eE=n(15323),eI=n(48610),eT=function(){if(/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&1){var e=document.documentElement;e.style.fontSize="16px",e.style.setProperty("-webkit-text-size-adjust","100%"),e.style.setProperty("text-size-adjust","100%");var r=document.querySelector('meta[name="viewport"]');r&&r.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover"),e.classList.add("chrome-browser"),console.log("\uD83D\uDD27 Chrome-spezifische Skalierungs-Fixes angewendet")}},ek=function(){var e=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),r=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),n=/Firefox/.test(navigator.userAgent);return{browser:e?"chrome":r?"safari":n?"firefox":"other",zoomLevel:window.devicePixelRatio||1,isChrome:e,isSafari:r,isFirefox:n}};function e_(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",eT):eT();var eA=function(){var e,r=(0,o.useRouter)(),n=function(e){if(Array.isArray(e))return e}(e=(0,i.useState)(""))||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,2)||function(e,r){if(e){if("string"==typeof e)return e_(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e_(e,r):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=n[0],u=n[1];return((0,i.useEffect)(function(){var e=window.location.hostname,n=r.asPath;if(e.includes("jasswiki.ch"))u("https://jasswiki.ch".concat(n));else if(e.includes("jassguru.ch")&&n.startsWith("/wissen")){var i=n.substring(7);u("https://jasswiki.ch".concat(i||"/"))}else e.includes("jassguru.ch")&&n.startsWith("/quellen")?u("https://jasswiki.ch".concat(n)):u("https://jassguru.ch".concat(n))},[r.asPath]),s)?(0,a.jsx)(h(),{children:(0,a.jsx)("link",{rel:"canonical",href:s})}):null};function eP(e){return(eP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eO(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function eC(){eC=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new A(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(P([])));x&&x!==n&&i.call(x,s)&&(w=x);var E=b.prototype=y.prototype=Object.create(w);function I(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function T(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==eP(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function k(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function _(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(eP(r)+" is not iterable")}return v.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},I(T.prototype),l(T.prototype,u,function(){return this}),r.AsyncIterator=T,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new T(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},I(E),l(E,c,"Generator"),l(E,s,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=P,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:P(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function eN(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function eL(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,r)||function(e,r){if(e){if("string"==typeof e)return eD(e,r);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eD(e,r):void 0}}(e,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eD(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}var eR=function(e){var r=e.onForceLoad,n=eL((0,i.useState)(!1),2),o=n[0],s=n[1],u=eL((0,i.useState)(!1),2),c=u[0],l=u[1];return(0,i.useEffect)(function(){var e=setTimeout(function(){s(!0)},2e3),r=setTimeout(function(){l(!0)},4e3);return function(){clearTimeout(e),clearTimeout(r)}},[]),(0,a.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-center min-h-full bg-gray-900 text-white p-6",children:[(0,a.jsx)(eo.A,{color:"#ffffff",size:40}),(0,a.jsx)("p",{className:"mt-4 text-lg",children:"App wird geladen..."}),o&&(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-400 text-center max-w-xs",children:"Falls die App nicht l\xe4dt, pr\xfcfe deine Internetverbindung."}),c&&r&&(0,a.jsxs)("div",{className:"mt-4 text-center",children:[(0,a.jsx)("button",{onClick:r,className:"px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg font-semibold transition-colors",children:"App trotzdem laden"}),(0,a.jsx)("p",{className:"mt-2 text-xs text-gray-500 max-w-xs",children:"Notfall-Modus: L\xe4dt die App ohne vollst\xe4ndige Initialisierung"})]})]})};let ej=function(e){var r=e.Component,n=e.pageProps,s=eL((0,i.useState)(!1),2),u=(s[0],s[1]);!function(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"screen",o=m((0,i.useState)(null),2),a=o[0],s=o[1],u=m((0,i.useState)(!1),2),c=(u[0],u[1]),l=(0,i.useRef)(!1),h=(e=f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(l.current||a)){e.next=1;break}return e.abrupt("return");case 1:if(l.current=!0,e.prev=2,!("wakeLock"in navigator)){e.next=4;break}return e.next=3,navigator.wakeLock.request(n);case 3:s(e.sent),c(!0),e.next=5;break;case 4:case 5:e.next=7;break;case 6:e.prev=6,e.catch(2);case 7:return e.prev=7,l.current=!1,e.finish(7);case 8:case"end":return e.stop()}},e,null,[[2,6,7,8]])}),r=function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){p(a,i,o,s,u,"next",e)}function u(e){p(a,i,o,s,u,"throw",e)}s(void 0)})},function(){return r.apply(this,arguments)}),d=function(){a&&a.release().then(function(){s(null),c(!1)}).catch(function(e){})};(0,i.useEffect)(function(){var e=function(){"visible"===document.visibilityState&&h()};return h(),document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e),d()}},[n])}(),(0,el.A)(),eg(),(0,i.useEffect)(function(){"function"==typeof window.cancelPwaLoadTimeout&&window.cancelPwaLoadTimeout()},[]);var l=(0,v.useAuthStore)(function(e){return e.setAuthUser}),d=(0,v.useAuthStore)(function(e){return e.setUnauthenticated}),g=(0,v.useAuthStore)(function(e){return e.status}),b=(0,v.useAuthStore)(function(e){return e.isGuest}),w=eL((0,i.useState)(!1),2),S=w[0],x=w[1],E=(0,o.useRouter)(),I=(0,_.yu)(function(e){return e.checkUserActiveTournament}),T=(0,_.yu)(function(e){return e.userActiveTournamentId}),O=(0,_.yu)(function(e){return e.userActiveTournamentStatus}),C=(0,A.useUIStore)(function(e){return e.hasBeenRedirectedToActiveTournament}),N=(0,A.useUIStore)(function(e){return e.setHasBeenRedirectedToActiveTournament});return(0,i.useEffect)(function(){u(!0),eT();var e=ek();e&&console.log("\uD83C\uDF10 Browser erkannt:",e);var r=(0,ec.xI)(),n=(0,ec.hg)(r,function(e){e?l(e):d()});return function(){return n()}},[l,d]),(0,i.useEffect)(function(){if(E.isReady){var e,r=!1,n=function(){!r&&(r=!0,x(!0),e&&clearTimeout(e))},i=window.location.pathname;return(0,V.N)(i)||"authenticated"===g||"unauthenticated"===g?n():e=setTimeout(function(){n()},4e3),function(){e&&clearTimeout(e)}}},[E.isReady,g]),(0,i.useEffect)(function(){if(!S){var e=setTimeout(function(){x(!0)},5e3);return function(){return clearTimeout(e)}}},[S]),(0,i.useEffect)(function(){if(E.isReady&&S&&["authenticated","unauthenticated"].includes(g)){var e=setTimeout(function(){var e=window.location.pathname;if(!(0,V.N)(e)){var r="authenticated"===g&&!b,n="unauthenticated"===g&&b;r||n||(0,ea.p)(E,"/",void 0,!0)}},100);return function(){return clearTimeout(e)}}},[E.isReady,S,g,b]),(0,i.useEffect)(function(){if(E.isReady&&S&&"authenticated"===g){var e=v.useAuthStore.getState().user;e&&I(e.uid)}},[g,E.isReady,S,I]),(0,i.useEffect)(function(){if(E.isReady&&S&&"authenticated"===g&&"success"===O&&T&&!C){var e=E.pathname;e.startsWith("/view/tournament/")||e.startsWith("/jass")||e.startsWith("/game")||(0,V.N)(e)||((0,ea.p)(E,"/view/tournament/".concat(T),void 0,!0),N(!0))}},[T,O,E.isReady,S,E.pathname,C,N,g]),(0,i.useEffect)(function(){var e,r,n=null;return(e=eC().mark(function e(){return eC().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,Promise.race([(0,es.eW)(),new Promise(function(e,r){return setTimeout(function(){return r(Error("IndexedDB timeout"))},2e3)})]);case 1:n=(0,eu.go)(),e.next=3;break;case 2:e.prev=2,console.warn("[App] ⚠️ Offline Sync nicht verf\xfcgbar (nicht kritisch):",e.catch(0));case 3:case"end":return e.stop()}},e,null,[[0,2]])}),r=function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){eN(a,i,o,s,u,"next",e)}function u(e){eN(a,i,o,s,u,"throw",e)}s(void 0)})},function(){return r.apply(this,arguments)})(),function(){n&&n.stop()}},[]),(0,i.useEffect)(function(){},[]),(0,a.jsxs)(c,{children:[(0,a.jsxs)(h(),{children:[(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover"}),(0,a.jsx)("meta",{httpEquiv:"Cache-Control",content:"no-cache, no-store, must-revalidate"}),(0,a.jsx)("meta",{httpEquiv:"Pragma",content:"no-cache"}),(0,a.jsx)("meta",{httpEquiv:"Expires",content:"0"})]}),(0,a.jsx)(eA,{}),(0,a.jsx)(eI.g,{}),(0,a.jsx)(y.O,{children:(0,a.jsx)(k,{children:(0,a.jsxs)(ei,{children:[S?(0,a.jsx)(r,function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?eO(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=eP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=eP(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==eP(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eO(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}({},n)):(0,a.jsx)(eR,{onForceLoad:function(){return x(!0)}}),(0,a.jsx)(P.A,{}),(0,a.jsx)(B,{})," ",(0,a.jsx)(eS,{})," ",(0,A.useUIStore)(function(e){return e.isLoading})&&(0,a.jsx)(ex.A,{message:"N\xe4chstes Spiel wird vorbereitet...",color:"white"}),(0,A.useUIStore)(function(e){return e.isFinalizingSession})&&(0,a.jsx)(eE.A,{text:"Daten und Statistiken werden aktualisiert..."})]})})})]})}},10637:(e,r,n)=>{"use strict";n.r(r),n.d(r,{useTimerStore:()=>h});var i=n(8106);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return s(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,r):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function u(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function c(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?u(Object(n),!0).forEach(function(r){var i,a,s;i=e,a=r,s=n[r],(a=function(e){var r=function(e,r){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=o(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==o(r)?r:r+""}(a))in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var l=function(e){return Math.max(0,e)},h=(0,i.v)(function(e,r){return{jassStartTime:null,gameStartTime:null,roundStartTime:null,history:{jass:[],games:[],rounds:[]},isPaused:!1,pauseStartTime:null,totalPausedTime:0,lastJassDuration:0,gameTimers:new Map,activeGameId:null,startJassTimer:function(){e(function(e){return c(c({},e),{},{jassStartTime:Date.now(),history:c(c({},e.history),{},{jass:[].concat(a(e.history.jass),[{startTime:Date.now()}])})})})},startGameTimer:function(){e(function(e){return c(c({},e),{},{gameStartTime:Date.now(),history:c(c({},e.history),{},{games:[].concat(a(e.history.games),[{startTime:Date.now()}])})})})},startRoundTimer:function(){var r=Date.now();e(function(e){return c(c({},e),{},{roundStartTime:r,history:c(c({},e.history),{},{rounds:[].concat(a(e.history.rounds),[{startTime:r}])})})})},completeRound:function(){var r=Date.now();e(function(e){var n=a(e.history.rounds),i=n[n.length-1];return i&&(i.endTime=r,i.duration=r-i.startTime),c(c({},e),{},{roundStartTime:null,history:c(c({},e.history),{},{rounds:n})})})},completeGame:function(){var r=Date.now();e(function(e){var n=a(e.history.games),i=n[n.length-1];return i&&(i.endTime=r,i.duration=r-i.startTime),c(c({},e),{},{gameStartTime:null,roundStartTime:null,history:c(c({},e.history),{},{games:n})})})},completeJass:function(){var n=Date.now(),i=r(),o=i.jassStartTime?n-i.jassStartTime:0;e(function(e){return c(c({},e),{},{lastJassDuration:o,jassStartTime:null,gameStartTime:null,roundStartTime:null,history:c(c({},e.history),{},{jass:e.history.jass.slice(0,-1)})})})},getAnalytics:function(){var e=r(),n=r().getCurrentTime(),i=e.gameStartTime?l(n-e.gameStartTime):0;return{totalJassTime:e.jassStartTime?l(n-e.jassStartTime):e.lastJassDuration,currentGameDuration:i}},resetRoundTimer:function(){e(function(e){return c(c({},e),{},{roundStartTime:null})})},resetGameTimers:function(){e(function(e){return c(c({},e),{},{gameStartTime:null,roundStartTime:null})})},resetAllTimers:function(){e(function(e){return c(c({},e),{},{jassStartTime:null,gameStartTime:null,roundStartTime:null,history:{jass:[],games:[],rounds:[]}})})},pauseTimer:function(){e(function(e){return c(c({},e),{},{isPaused:!0,pauseStartTime:Date.now()})})},resumeTimer:function(){e(function(e){var r=e.pauseStartTime?Date.now()-e.pauseStartTime:0;return c(c({},e),{},{isPaused:!1,pauseStartTime:null,totalPausedTime:e.totalPausedTime+r})})},getCurrentTime:function(){var e=r(),n=Date.now();return e.isPaused&&e.pauseStartTime?e.pauseStartTime-e.totalPausedTime:n-e.totalPausedTime},prepareJassEnd:function(){var e=Date.now(),n=r();return n.jassStartTime?e-n.jassStartTime:0},finalizeJassEnd:function(){e(function(e){return c(c({},e),{},{jassStartTime:null,gameStartTime:null,roundStartTime:null,history:c(c({},e.history),{},{jass:e.history.jass.slice(0,-1)})})})},getElapsedTimes:function(){var e=r(),n=Date.now(),i=e.totalPausedTime+(e.isPaused&&e.pauseStartTime?n-e.pauseStartTime:0);return{jass:e.jassStartTime?n-e.jassStartTime-i:0,game:e.gameStartTime?n-e.gameStartTime-i:0,round:e.roundStartTime?n-e.roundStartTime-i:0}},getTotalPausedTime:function(){var e=r();return e.totalPausedTime+(e.isPaused&&e.pauseStartTime?Date.now()-e.pauseStartTime:0)},restoreTimerSnapshot:function(n){var i=Date.now();r(),e(function(e){var r={jassStartTime:i-n.elapsedJassTime-n.totalPausedTime,gameStartTime:i-n.elapsedGameTime-n.totalPausedTime,roundStartTime:i-n.elapsedRoundTime-n.totalPausedTime,totalPausedTime:n.totalPausedTime,isPaused:!1,pauseStartTime:null},o=new Map(e.gameTimers);if(e.activeGameId){var a=o.get(e.activeGameId);a&&(a.startTime=i,a.isActive=!0,a.pausedTime=n.totalPausedTime)}return c(c(c({},e),r),{},{gameTimers:o})})},activateGameTimer:function(n){r();var i=Date.now();e(function(e){var r=new Map(e.gameTimers),o=null!==e.activeGameId?r.get(e.activeGameId):null;null!=o&&o.isActive&&(o.totalDuration+=i-o.startTime-o.pausedTime,o.isActive=!1);var a=r.get(n);a||(a={startTime:i,totalDuration:0,pausedTime:0,isActive:!1}),a.startTime=i,a.isActive=!0,a.pausedTime=0,r.set(n,a);var s=e.jassStartTime;return c(c({},e),{},{gameTimers:r,activeGameId:n,gameStartTime:i,roundStartTime:i,jassStartTime:s,isPaused:!1,pauseStartTime:null})})},getGameDuration:function(e){var n=r().gameTimers.get(e);if(!n)return 0;if(!n.isActive)return n.totalDuration;var i=Date.now();return n.totalDuration+(i-n.startTime-n.pausedTime)},reactivateGameTimer:function(n){r();var i=Date.now();e(function(e){var r,o=new Map(e.gameTimers),a=null!=(r=o.get(n))?r:{startTime:i,totalDuration:0,pausedTime:0,isActive:!1};a.startTime=i,a.isActive=!0,a.pausedTime=0,o.set(n,a);var s=e.jassStartTime;return c(c({},e),{},{gameTimers:o,activeGameId:n,gameStartTime:i,roundStartTime:i,isPaused:!1,pauseStartTime:null,jassStartTime:s})})},restoreTimers:function(r,n){var i=Date.now();return e({jassStartTime:r,gameStartTime:n,roundStartTime:i}),{jassStartTime:r,gameStartTime:n,roundStartTime:i}}}})},10714:(e,r,n)=>{"use strict";n.d(r,{s:()=>s,t:()=>a});var i=n(14232);function o(e,r){if("function"==typeof e)return e(r);null!=e&&(e.current=r)}function a(...e){return r=>{let n=!1,i=e.map(e=>{let i=o(e,r);return n||"function"!=typeof i||(n=!0),i});if(n)return()=>{for(let r=0;r<i.length;r++){let n=i[r];"function"==typeof n?n():o(e[r],null)}}}}function s(...e){return i.useCallback(a(...e),e)}},11037:(e,r,n)=>{"use strict";n.d(r,{A:()=>b});var i=n(14232),o=function(e){var r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,function(e,r,n){return n?n.toUpperCase():r.toLowerCase()});return r.charAt(0).toUpperCase()+r.slice(1)},a=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.filter(function(e,r,n){return!!e&&""!==e.trim()&&n.indexOf(e)===r}).join(" ").trim()},s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"];function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,r){if(e){if("string"==typeof e)return d(e,r);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,r):void 0}}function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function f(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function p(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?f(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=u(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==u(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var m=(0,i.forwardRef)(function(e,r){var n=e.color,o=e.size,u=void 0===o?24:o,d=e.strokeWidth,f=void 0===d?2:d,m=e.absoluteStrokeWidth,g=e.className,y=e.children,v=e.iconNode,b=function(e,r){if(null==e)return{};var n,i,o=function(e,r){if(null==e)return{};var n={};for(var i in e)if(({}).hasOwnProperty.call(e,i)){if(-1!==r.indexOf(i))continue;n[i]=e[i]}return n}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],-1===r.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,c);return(0,i.createElement)("svg",p(p({ref:r},s),{},{width:u,height:u,stroke:void 0===n?"currentColor":n,strokeWidth:m?24*Number(f)/Number(u):f,className:a("lucide",void 0===g?"":g)},b),[].concat(l(v.map(function(e){var r=function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,2)||h(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],o=r[1];return(0,i.createElement)(n,o)})),l(Array.isArray(y)?y:[y])))});function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var y=["className"];function v(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}var b=function(e,r){var n=(0,i.forwardRef)(function(n,s){var u=n.className,c=function(e,r){if(null==e)return{};var n,i,o=function(e,r){if(null==e)return{};var n={};for(var i in e)if(({}).hasOwnProperty.call(e,i)){if(-1!==r.indexOf(i))continue;n[i]=e[i]}return n}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],-1===r.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(n,y);return(0,i.createElement)(m,function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?v(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=g(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==g(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}({ref:s,iconNode:r,className:a("lucide-".concat(o(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),u)},c))});return n.displayName=o(e),n}},11510:(e,r,n)=>{"use strict";n.d(r,{A:()=>a});var i=n(14232);function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}let a=function(){var e,r=function(e){if(Array.isArray(e))return e}(e=(0,i.useState)(function(){return window.visualViewport?window.visualViewport.height:window.innerHeight}))||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,2)||function(e,r){if(e){if("string"==typeof e)return o(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,r):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],a=r[1];return(0,i.useEffect)(function(){var e=function(){var e=window.visualViewport?window.visualViewport.height:window.innerHeight;a(e),document.documentElement.style.setProperty("--vh","".concat(e/window.innerHeight*100,"vh"))};return window.visualViewport?window.visualViewport.addEventListener("resize",e):window.addEventListener("resize",e),window.addEventListener("orientationchange",e),e(),function(){window.visualViewport?window.visualViewport.removeEventListener("resize",e):window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]),n}},11923:(e,r,n)=>{"use strict";n.d(r,{A:()=>l});var i=n(14232),o={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function a(e){var r=function(e){if("number"==typeof e)return{value:e,unit:"px"};var r,n=(e.match(/^[0-9.]*/)||"").toString();r=n.includes(".")?parseFloat(n):parseInt(n,10);var i=(e.match(/[^0-9]*$/)||"").toString();return o[i]?{value:r,unit:i}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(r,"px.")),{value:r,unit:"px"})}(e);return"".concat(r.value).concat(r.unit)}var s=function(){return(s=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},u=function(e,r){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>r.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)0>r.indexOf(i[o])&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]]);return n},c=function(e,r,n){var i="react-spinners-".concat(e,"-").concat(n);if("undefined"==typeof window||!window.document)return i;var o=document.createElement("style");document.head.appendChild(o);var a=o.sheet,s="\n    @keyframes ".concat(i," {\n      ").concat(r,"\n    }\n  ");return a&&a.insertRule(s,0),i}("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");let l=function(e){var r=e.loading,n=e.color,o=void 0===n?"#000000":n,l=e.speedMultiplier,h=e.cssOverride,d=e.size,f=void 0===d?35:d,p=u(e,["loading","color","speedMultiplier","cssOverride","size"]),m=s({background:"transparent !important",width:a(f),height:a(f),borderRadius:"100%",border:"2px solid",borderTopColor:o,borderBottomColor:"transparent",borderLeftColor:o,borderRightColor:o,display:"inline-block",animation:"".concat(c," ").concat(.75/(void 0===l?1:l),"s 0s infinite linear"),animationFillMode:"both"},void 0===h?{}:h);return void 0===r||r?i.createElement("span",s({style:m},p)):null}},11996:(e,r,n)=>{"use strict";n.d(r,{A:()=>f});var i=n(14232),o=n(98477),a=n(27212),s=n(23355),u=n(94566),c=n(37876),l=function(e){var r=e.checked,n=e.onChange,i=e.label,o=e.className,a=function(){var e=!r;console.log("\uD83C\uDFAF [Custom Checkbox] Clicked:",{current:r,new:e,label:i}),n(e)};return(0,c.jsxs)("label",{className:"flex items-center cursor-pointer text-gray-300 text-sm hover:text-white transition-colors ".concat(void 0===o?"":o),children:[(0,c.jsx)("div",{className:"mr-2 w-5 h-5 border-2 rounded flex items-center justify-center transition-all duration-200 cursor-pointer",style:{backgroundColor:r?"#EAB308":"#374151",borderColor:r?"#EAB308":"#6B7280",color:r?"white":"transparent"},onClick:a,children:(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:"bold"},children:r?"✓":""})}),(0,c.jsx)("span",{className:"select-none",onClick:a,children:i})]})},h=n(50679);function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}let f=function(){var e,r=(0,u.useUIStore)(function(e){return e.notifications}),n=(0,u.useUIStore)(function(e){return e.removeNotification}),f=(0,u.useUIStore)(function(e){return e.iosNotification}),p=(0,u.useUIStore)(function(e){return e.setIOSNotificationDontShowAgain}),m=function(e){if(Array.isArray(e))return e}(e=(0,i.useState)(!1))||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,2)||function(e,r){if(e){if("string"==typeof e)return d(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,r):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),g=m[0],y=m[1];(0,i.useEffect)(function(){y(!0)},[]);var v=function(e){if(e.image)return(0,c.jsx)("img",{src:e.image,alt:"",className:"w-56 h-56 mb-4 rounded-lg object-cover"});switch(e.type){case"warning":return(0,c.jsx)(h.BS8,{className:"w-12 h-12 text-yellow-600 mb-2"});case"success":case"bedanken":return(0,c.jsx)(h.A7C,{className:"w-12 h-12 text-green-600 mb-2"});case"error":return(0,c.jsx)(h.BS8,{className:"w-12 h-12 text-red-600 mb-2"});default:return(0,c.jsx)(h.__w,{className:"w-12 h-12 text-blue-600 mb-2"})}},b=function(e){var r;return null!=(r=e.actions)&&r.length?e.actions.map(function(r,i){return(0,c.jsx)("button",{onClick:function(){r.onClick(),n(e.id)},className:"\n          flex-1 px-6 py-2 rounded-full \n          text-lg font-semibold\n          ".concat(("bedanken"===e.type||"success"===e.type)&&i===e.actions.length-1?"bg-green-600 hover:bg-green-700":i===e.actions.length-1?"bg-yellow-600 hover:bg-yellow-700":"bg-gray-600 hover:bg-gray-700","\n          text-white\n          transition-all duration-100\n          active:scale-95 active:opacity-80\n        "),children:r.label},i)}):(0,c.jsx)("div",{className:"flex justify-center w-full",children:(0,c.jsx)("button",{onClick:function(){return n(e.id)},className:" w-36 bg-yellow-600 text-white px-6 py-2 rounded-full hover:bg-yellow-700 transition-all duration-100 text-lg font-semibold active:scale-95 active:opacity-80 ",children:"Verstanden"})})},w=(0,c.jsx)(a.N,{mode:"wait",children:r.map(function(e){var r,i,o,a,u,h;return(0,c.jsxs)(s.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"\n            fixed inset-0 flex items-center justify-center z-[9999]\n            ".concat(e.isFlipped?"rotate-180":"","\n            ").concat("bedanken"===e.type?"items-end pb-4":"","\n          "),children:[(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:function(){e.preventClose||n(e.id)}}),(0,c.jsxs)(s.P.div,{initial:{scale:.95},animate:{scale:1},exit:{scale:.95},className:"bg-gray-800 p-6 rounded-lg shadow-lg max-w-xs w-full relative text-white z-10",children:[(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center mb-4",children:[v(e),(0,c.jsx)("p",{className:"text-center mb-6 mt-4",children:e.message})]}),e.checkbox&&(0,c.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,c.jsx)(l,{checked:e.checkbox.checked,onChange:e.checkbox.onChange,label:e.checkbox.label})}),(e.simpleCheckbox||e.isIOSNotification)&&(0,c.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,c.jsxs)("div",{className:"flex items-center cursor-pointer select-none px-3 py-2 rounded-lg transition-all duration-200 ".concat((e.isIOSNotification?f.dontShowAgain:null==(r=e.simpleCheckbox)?void 0:r.checked)?"bg-yellow-600/20":"bg-gray-700/30 hover:bg-gray-600/40"),onClick:function(){if(e.isIOSNotification){var r=!f.dontShowAgain;console.log("\uD83C\uDFAF [GlobalContainer iOS] Klick:",{notificationId:e.id,current:f.dontShowAgain,new:r}),p(r)}else if(e.simpleCheckbox){var n=!e.simpleCheckbox.checked;console.log("\uD83C\uDFAF [GlobalContainer SimpleCheckbox] Klick:",{notificationId:e.id,current:e.simpleCheckbox.checked,new:n}),e.simpleCheckbox.onChange(n)}},children:[(0,c.jsx)("div",{className:"w-6 h-6 border-2 rounded mr-3 flex items-center justify-center transition-all duration-200 ".concat((e.isIOSNotification?f.dontShowAgain:null==(i=e.simpleCheckbox)?void 0:i.checked)?"bg-yellow-600 border-yellow-600 text-white":"bg-gray-700 border-gray-500"),children:(e.isIOSNotification?f.dontShowAgain:null==(o=e.simpleCheckbox)?void 0:o.checked)&&(0,c.jsx)("span",{className:"text-white text-lg font-bold leading-none",children:"✓"})}),(0,c.jsx)("span",{className:"text-sm transition-colors duration-200 ".concat((e.isIOSNotification?f.dontShowAgain:null==(a=e.simpleCheckbox)?void 0:a.checked)?"text-yellow-300 font-medium":"text-gray-300"),children:e.isIOSNotification?"Nicht mehr anzeigen":null==(u=e.simpleCheckbox)?void 0:u.label})]})}),(0,c.jsx)("div",{className:"flex justify-".concat((null==(h=e.actions)?void 0:h.length)===1?"center":"between"," gap-4"),children:b(e)})]})]},"notification-".concat(e.id))})});if(!g)return null;var S=(0,c.jsx)("div",{id:"global-notification-container-wrapper",className:"pointer-events-none",children:(0,c.jsx)("div",{className:"pointer-events-auto",children:w})});return o.createPortal(S,document.body)}},13848:(e,r,n)=>{"use strict";let i,o,a,s;n.r(r),n.d(r,{Timestamp:()=>eN.Timestamp,analytics:()=>ez,app:()=>u,auth:()=>c,collection:()=>eN.collection,collections:()=>eW,createUserWithEmailAndPassword:()=>f.eJ,db:()=>l,deleteDoc:()=>eN.deleteDoc,doc:()=>eN.doc,firebaseApp:()=>eQ,getAuth:()=>f.xI,getDoc:()=>eN.getDoc,getDocs:()=>eN.getDocs,isFirebaseReady:()=>eZ,isLocalDevelopment:()=>eJ,isOfflineMode:()=>eY,limit:()=>eN.limit,query:()=>eN.query,registerWithEmailAndPassword:()=>eH,resetFirestoreCache:()=>e0,resetPassword:()=>e$,sendEmailVerification:()=>f.gA,sendPasswordResetEmail:()=>f.J1,serverTimestamp:()=>eN.serverTimestamp,setDoc:()=>eN.setDoc,signInWithEmailAndPassword:()=>f.x9,signInWithGoogle:()=>eK,storage:()=>h,updateDoc:()=>eN.updateDoc,updateProfile:()=>f.r7,useLocalAuth:()=>eX,where:()=>eN.where});var u,c,l,h,d=n(16042),f=n(93786),p=n(96796),m=n(36525),g=n(51139),y=n(88308),v=n(62704);let b="@firebase/installations",w="0.6.18",S=`w:${w}`,x="FIS_v2",E=new g.FA("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function I(e){return e instanceof g.g&&e.code.includes("request-failed")}function T({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function k(e){return{token:e.token,requestStatus:2,expiresIn:Number(e.expiresIn.replace("s","000")),creationTime:Date.now()}}async function _(e,r){let n=(await r.json()).error;return E.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function A({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function P(e){let r=await e();return r.status>=500&&r.status<600?e():r}async function O({appConfig:e,heartbeatServiceProvider:r},{fid:n}){let i=T(e),o=A(e),a=r.getImmediate({optional:!0});if(a){let e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}let s={method:"POST",headers:o,body:JSON.stringify({fid:n,authVersion:x,appId:e.appId,sdkVersion:S})},u=await P(()=>fetch(i,s));if(u.ok){let e=await u.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:k(e.authToken)}}throw await _("Create Installation",u)}function C(e){return new Promise(r=>{setTimeout(r,e)})}let N=/^[cdef][\w-]{21}$/;function L(e){return`${e.appName}!${e.appId}`}let D=new Map;function R(e,r){let n=L(e);j(n,r),function(e,r){let n=(!F&&"BroadcastChannel"in self&&((F=new BroadcastChannel("[Firebase] FID Change")).onmessage=e=>{j(e.data.key,e.data.fid)}),F);n&&n.postMessage({key:e,fid:r}),0===D.size&&F&&(F.close(),F=null)}(n,r)}function j(e,r){let n=D.get(e);if(n)for(let e of n)e(r)}let F=null,U="firebase-installations-store",M=null;function G(){return M||(M=(0,v.P2)("firebase-installations-database",1,{upgrade:(e,r)=>{0===r&&e.createObjectStore(U)}})),M}async function V(e,r){let n=L(e),i=(await G()).transaction(U,"readwrite"),o=i.objectStore(U),a=await o.get(n);return await o.put(r,n),await i.done,a&&a.fid===r.fid||R(e,r.fid),r}async function B(e){let r=L(e),n=(await G()).transaction(U,"readwrite");await n.objectStore(U).delete(r),await n.done}async function z(e,r){let n=L(e),i=(await G()).transaction(U,"readwrite"),o=i.objectStore(U),a=await o.get(n),s=r(a);return void 0===s?await o.delete(n):await o.put(s,n),await i.done,s&&(!a||a.fid!==s.fid)&&R(e,s.fid),s}async function q(e){let r,n=await z(e.appConfig,n=>{let i=function(e,r){if(0===r.registrationStatus){if(!navigator.onLine)return{installationEntry:r,registrationPromise:Promise.reject(E.create("app-offline"))};let n={fid:r.fid,registrationStatus:1,registrationTime:Date.now()},i=H(e,n);return{installationEntry:n,registrationPromise:i}}return 1===r.registrationStatus?{installationEntry:r,registrationPromise:$(e)}:{installationEntry:r}}(e,W(n||{fid:function(){try{var e;let r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;let n=(e=r,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22));return N.test(n)?n:""}catch(e){return""}}(),registrationStatus:0}));return r=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:await r}:{installationEntry:n,registrationPromise:r}}async function H(e,r){try{let n=await O(e,r);return V(e.appConfig,n)}catch(n){throw I(n)&&409===n.customData.serverCode?await B(e.appConfig):await V(e.appConfig,{fid:r.fid,registrationStatus:0}),n}}async function $(e){let r=await K(e.appConfig);for(;1===r.registrationStatus;)await C(100),r=await K(e.appConfig);if(0===r.registrationStatus){let{installationEntry:r,registrationPromise:n}=await q(e);return n||r}return r}function K(e){return z(e,e=>{if(!e)throw E.create("installation-not-found");return W(e)})}function W(e){var r;return 1===(r=e).registrationStatus&&r.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e}async function Q({appConfig:e,heartbeatServiceProvider:r},n){let i=function(e,{fid:r}){return`${T(e)}/${r}/authTokens:generate`}(e,n),o=function(e,{refreshToken:r}){var n;let i=A(e);return i.append("Authorization",(n=r,`${x} ${n}`)),i}(e,n),a=r.getImmediate({optional:!0});if(a){let e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}let s={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:S,appId:e.appId}})},u=await P(()=>fetch(i,s));if(u.ok)return k(await u.json());throw await _("Generate Auth Token",u)}async function J(e,r=!1){let n,i=await z(e.appConfig,i=>{var o;if(!ee(i))throw E.create("not-registered");let a=i.authToken;if(!r&&2===(o=a).requestStatus&&!function(e){let r=Date.now();return r<e.creationTime||e.creationTime+e.expiresIn<r+36e5}(o))return i;if(1===a.requestStatus)return n=Y(e,r),i;{if(!navigator.onLine)throw E.create("app-offline");let r=function(e){let r={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:r})}(i);return n=Z(e,r),r}});return n?await n:i.authToken}async function Y(e,r){let n=await X(e.appConfig);for(;1===n.authToken.requestStatus;)await C(100),n=await X(e.appConfig);let i=n.authToken;return 0===i.requestStatus?J(e,r):i}function X(e){return z(e,e=>{var r;if(!ee(e))throw E.create("not-registered");return 1===(r=e.authToken).requestStatus&&r.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Z(e,r){try{let n=await Q(e,r),i=Object.assign(Object.assign({},r),{authToken:n});return await V(e.appConfig,i),n}catch(n){if(I(n)&&(401===n.customData.serverCode||404===n.customData.serverCode))await B(e.appConfig);else{let n=Object.assign(Object.assign({},r),{authToken:{requestStatus:0}});await V(e.appConfig,n)}throw n}}function ee(e){return void 0!==e&&2===e.registrationStatus}async function et(e){let{installationEntry:r,registrationPromise:n}=await q(e);return n?n.catch(console.error):J(e).catch(console.error),r.fid}async function er(e,r=!1){return await en(e),(await J(e,r)).token}async function en(e){let{registrationPromise:r}=await q(e);r&&await r}function ei(e){return E.create("missing-app-config-values",{valueName:e})}let eo="installations";(0,p.om)(new y.uA(eo,e=>{let r=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw ei("App Configuration");if(!e.name)throw ei("App Name");for(let r of["projectId","apiKey","appId"])if(!e.options[r])throw ei(r);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(r),i=(0,p.j6)(r,"heartbeat");return{app:r,appConfig:n,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},"PUBLIC")),(0,p.om)(new y.uA("installations-internal",e=>{let r=e.getProvider("app").getImmediate(),n=(0,p.j6)(r,eo).getImmediate();return{getId:()=>et(n),getToken:e=>er(n,e)}},"PRIVATE")),(0,p.KO)(b,w),(0,p.KO)(b,w,"esm2017");let ea="analytics",es="https://www.googletagmanager.com/gtag/js",eu=new m.Vy("@firebase/analytics"),ec=new g.FA("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function el(e){if(!e.startsWith(es)){let r=ec.create("invalid-gtag-resource",{gtagURL:e});return eu.warn(r.message),""}return e}function eh(e){return Promise.all(e.map(e=>e.catch(e=>e)))}async function ed(e,r,n,i,o,a){let s=i[o];try{if(s)await r[s];else{let e=(await eh(n)).find(e=>e.measurementId===o);e&&await r[e.appId]}}catch(e){eu.error(e)}e("config",o,a)}async function ef(e,r,n,i,o){try{let a=[];if(o&&o.send_to){let e=o.send_to;Array.isArray(e)||(e=[e]);let i=await eh(n);for(let n of e){let e=i.find(e=>e.measurementId===n),o=e&&r[e.appId];if(o)a.push(o);else{a=[];break}}}0===a.length&&(a=Object.values(r)),await Promise.all(a),e("event",i,o||{})}catch(e){eu.error(e)}}class ep{constructor(e={},r=1e3){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}let em=new ep;async function eg(e){var r;let{appId:n,apiKey:i}=e,o={method:"GET",headers:new Headers({Accept:"application/json","x-goog-api-key":i})},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(a,o);if(200!==s.status&&304!==s.status){let e="";try{let n=await s.json();(null==(r=n.error)?void 0:r.message)&&(e=n.error.message)}catch(e){}throw ec.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}async function ey(e,r=em,n){let{appId:i,apiKey:o,measurementId:a}=e.options;if(!i)throw ec.create("no-app-id");if(!o){if(a)return{measurementId:a,appId:i};throw ec.create("no-api-key")}let s=r.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new eb;return setTimeout(async()=>{u.abort()},void 0!==n?n:6e4),ev({appId:i,apiKey:o,measurementId:a},s,u,r)}async function ev(e,{throttleEndTimeMillis:r,backoffCount:n},i,o=em){var a,s,u;let{appId:c,measurementId:l}=e;try{await (s=i,u=r,new Promise((e,r)=>{let n=setTimeout(e,Math.max(u-Date.now(),0));s.addEventListener(()=>{clearTimeout(n),r(ec.create("fetch-throttle",{throttleEndTimeMillis:u}))})}))}catch(e){if(l)return eu.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:c,measurementId:l};throw e}try{let r=await eg(e);return o.deleteThrottleMetadata(c),r}catch(u){if(!function(e){if(!(e instanceof g.g)||!e.customData)return!1;let r=Number(e.customData.httpStatus);return 429===r||500===r||503===r||504===r}(u)){if(o.deleteThrottleMetadata(c),l)return eu.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null==u?void 0:u.message}]`),{appId:c,measurementId:l};throw u}let r=503===Number(null==(a=null==u?void 0:u.customData)?void 0:a.httpStatus)?(0,g.p9)(n,o.intervalMillis,30):(0,g.p9)(n,o.intervalMillis),s={throttleEndTimeMillis:Date.now()+r,backoffCount:n+1};return o.setThrottleMetadata(c,s),eu.debug(`Calling attemptFetch again in ${r} millis`),ev(e,s,i,o)}}class eb{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function ew(e,r,n,i,o){if(o&&o.global)return void e("event",n,i);{let o=await r;e("event",n,Object.assign(Object.assign({},i),{send_to:o}))}}async function eS(){if(!(0,g.zW)())return eu.warn(ec.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await (0,g.eX)()}catch(e){return eu.warn(ec.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}async function ex(e,r,n,a,s,u,c){var l;let h=ey(e);h.then(r=>{n[r.measurementId]=r.appId,e.options.measurementId&&r.measurementId!==e.options.measurementId&&eu.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${r.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>eu.error(e)),r.push(h);let d=eS().then(e=>e?a.getId():void 0),[f,p]=await Promise.all([h,d]);!function(e){for(let r of Object.values(window.document.getElementsByTagName("script")))if(r.src&&r.src.includes(es)&&r.src.includes(e))return r;return null}(u)&&function(e,r){var n;let i,o=(n={createScriptURL:el},window.trustedTypes&&(i=window.trustedTypes.createPolicy("firebase-js-sdk-policy",n)),i),a=document.createElement("script"),s=`${es}?l=${e}&id=${r}`;a.src=o?null==o?void 0:o.createScriptURL(s):s,a.async=!0,document.head.appendChild(a)}(u,f.measurementId),o&&(s("consent","default",o),o=void 0),s("js",new Date);let m=null!=(l=null==c?void 0:c.config)?l:{};return m.origin="firebase",m.update=!0,null!=p&&(m.firebase_id=p),s("config",f.measurementId,m),i&&(s("set",i),i=void 0),f.measurementId}class eE{constructor(e){this.app=e}_delete(){return delete eI[this.app.options.appId],Promise.resolve()}}let eI={},eT=[],ek={},e_="dataLayer",eA=!1;async function eP(){if((0,g.sr)()||!(0,g.dM)()||!(0,g.zW)())return!1;try{return await (0,g.eX)()}catch(e){return!1}}let eO="@firebase/analytics",eC="0.10.17";(0,p.om)(new y.uA(ea,(e,{options:r})=>(function(e,r,n){let i=[];if((0,g.sr)()&&i.push("This is a browser extension environment."),(0,g.dM)()||i.push("Cookies are not available."),i.length>0){let e=i.map((e,r)=>`(${r+1}) ${e}`).join(" "),r=ec.create("invalid-analytics-context",{errorInfo:e});eu.warn(r.message)}let o=e.options.appId;if(!o)throw ec.create("no-app-id");if(!e.options.apiKey)if(e.options.measurementId)eu.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ec.create("no-api-key");if(null!=eI[o])throw ec.create("already-exists",{id:o});if(!eA){var u,c;let e,r;e=[],Array.isArray(window[e_])?e=window[e_]:window[e_]=e;let{wrappedGtag:n,gtagCore:i}=(u="gtag",r=function(){window[e_].push(arguments)},window[u]&&"function"==typeof window[u]&&(r=window[u]),window[u]=(c=r,async function(e,...r){try{if("event"===e){let[e,n]=r;await ef(c,eI,eT,e,n)}else if("config"===e){let[e,n]=r;await ed(c,eI,eT,ek,e,n)}else if("consent"===e){let[e,n]=r;c("consent",e,n)}else if("get"===e){let[e,n,i]=r;c("get",e,n,i)}else if("set"===e){let[e]=r;c("set",e)}else c(e,...r)}catch(e){eu.error(e)}}),{gtagCore:r,wrappedGtag:window[u]});s=n,a=i,eA=!0}return eI[o]=ex(e,eT,ek,r,a,e_,n),new eE(e)})(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),r),"PUBLIC")),(0,p.om)(new y.uA("analytics-internal",function(e){try{let r=e.getProvider(ea).getImmediate();return{logEvent:(e,n,i)=>{var o;return o=r,void(o=(0,g.Ku)(o),ew(s,eI[o.app.options.appId],e,n,i).catch(e=>eu.error(e)))}}}catch(e){throw ec.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),(0,p.KO)(eO,eC),(0,p.KO)(eO,eC,"esm2017");var eN=n(42009),eL=n(95226);function eD(e){return(eD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eR(){eR=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new A(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(P([])));x&&x!==n&&i.call(x,s)&&(w=x);var E=b.prototype=y.prototype=Object.create(w);function I(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function T(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==eD(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function k(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function _(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(eD(r)+" is not iterable")}return v.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},I(T.prototype),l(T.prototype,u,function(){return this}),r.AsyncIterator=T,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new T(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},I(E),l(E,c,"Generator"),l(E,s,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=P,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:P(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function ej(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function eF(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){ej(a,i,o,s,u,"next",e)}function u(e){ej(a,i,o,s,u,"throw",e)}s(void 0)})}}function eU(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,r)||function(e,r){if(e){if("string"==typeof e)return eM(e,r);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eM(e,r):void 0}}(e,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eM(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}var eG="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,eV={apiKey:"AIzaSyDlzJTOPQhBFm20Cl4IpSkJbM95gtL_xXc",authDomain:"jassguru.firebaseapp.com",projectId:"jassguru",storageBucket:"jassguru.firebasestorage.app",messagingSenderId:"827424297556",appId:"1:827424297556:web:b8a0bec41f98fb35fa53c1"},eB=function(){return Object.entries(eV).filter(function(e){var r=eU(e,2);return r[0],!r[1]}).map(function(e){return eU(e,1)[0]}).length>0};eB();var ez=null,eq=!1;try{if(eB())throw Error("Firebase config incomplete - skipping initialization");u=(0,d.Wp)(eV),c=(0,f.xI)(u),(0,f.oM)(c,f.F0).then(function(){}).catch(function(e){console.error("Fehler beim Setzen der Persistenz:",e)});try{console.log("[Firestore] Verwende Standard-Cache (persistente IDB-Cache deaktiviert)"),l=(0,eN.getFirestore)(u)}catch(e){console.error("Fehler bei der Firestore-Initialisierung:",e),l=(0,eN.getFirestore)(u)}h=(0,eL.c7)(u),eq=!0,eG?ez=null:eP().then(function(e){e&&(ez=function(e=(0,p.Sx)()){e=(0,g.Ku)(e);let r=(0,p.j6)(e,ea);return r.isInitialized()?r.getImmediate():function(e,r={}){let n=(0,p.j6)(e,ea);if(n.isInitialized()){let e=n.getImmediate();if((0,g.bD)(r,n.getOptions()))return e;throw ec.create("already-initialized")}return n.initialize({options:r})}(e)}(u))}).catch(function(e){console.error("Analytics nicht unterst\xfctzt:",e)})}catch(e){console.warn("Firebase-Initialisierung \xfcbersprungen (CI/Build-Mode):",e.message),u={},c={},l={},h={}}var eH=function(){var e=eF(eR().mark(function e(r,n){var i,o;return eR().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,eq){e.next=1;break}throw Error("Firebase Auth ist nicht initialisiert oder im Offline-Modus.");case 1:return e.next=2,(0,f.eJ)(c,r,n);case 2:return i=e.sent,e.next=3,(0,f.gA)(i.user);case 3:return e.abrupt("return",i.user);case 4:throw e.prev=4,console.error("Error during registration:",o=e.catch(0)),o;case 5:case"end":return e.stop()}},e,null,[[0,4]])}));return function(r,n){return e.apply(this,arguments)}}(),e$=function(){var e=eF(eR().mark(function e(r){var n;return eR().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,eq){e.next=1;break}throw Error("Firebase Auth ist nicht initialisiert oder im Offline-Modus.");case 1:return e.next=2,(0,f.J1)(c,r);case 2:e.next=4;break;case 3:throw e.prev=3,console.error("Error resetting password:",n=e.catch(0)),n;case 4:case"end":return e.stop()}},e,null,[[0,3]])}));return function(r){return e.apply(this,arguments)}}(),eK=function(){var e=eF(eR().mark(function e(){var r,n,i;return eR().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,eq){e.next=1;break}throw Error("Firebase Auth ist nicht initialisiert oder im Offline-Modus.");case 1:return r=new f.HF,e.next=2,(0,f.df)(c,r);case 2:return n=e.sent,e.abrupt("return",n.user);case 3:throw e.prev=3,console.error("Error signing in with Google:",i=e.catch(0)),i;case 4:case"end":return e.stop()}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}(),eW={users:null,players:null,groups:null,games:null,teams:null};if(eq)try{eW={users:(0,eN.collection)(l,"users"),players:(0,eN.collection)(l,"players"),groups:(0,eN.collection)(l,"groups"),games:(0,eN.collection)(l,"games"),teams:(0,eN.collection)(l,"teams")}}catch(e){console.error("Fehler beim Initialisieren der Firestore-Collections:",e)}var eQ=u,eJ=function(){return eG},eY=function(){return!1},eX=function(){return eJ()&&!1},eZ=eq,e0=function(){var e=eF(eR().mark(function e(){var r,i,o;return eR().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(eq){e.next=1;break}return console.warn("[Firebase] resetFirestoreCache: Firebase ist nicht initialisiert."),e.abrupt("return");case 1:return e.prev=1,e.next=2,Promise.resolve().then(n.bind(n,42009));case 2:return r=e.sent.enableNetwork,console.log("[Firebase] Starte sanfte Cache-Aktualisierung..."),e.next=3,r(l);case 3:console.log("[Firebase] Netzwerkverbindung aktualisiert.");try{(i=n(94566).useUIStore)&&"function"==typeof i.getState&&i.getState().showNotification({type:"info",message:"Daten wurden synchronisiert.",duration:3e3})}catch(e){}return e.abrupt("return");case 4:e.prev=4,console.error("[Firebase] Fehler bei der Firestore-Cache-Aktualisierung:",e.catch(1));try{(o=n(94566).useUIStore)&&"function"==typeof o.getState&&o.getState().showNotification({type:"error",message:"Fehler bei der Datensynchronisation. Bitte App neu laden.",duration:5e3})}catch(e){}case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(){return e.apply(this,arguments)}}()},15323:(e,r,n)=>{"use strict";n.d(r,{A:()=>a}),n(14232);var i=n(95014),o=n(37876);let a=function(e){var r=e.text;return(0,o.jsxs)("div",{className:"fixed inset-0 z-[100] flex flex-col items-center justify-center bg-gray-900 bg-opacity-90 text-white",children:[(0,o.jsx)(i.A,{className:"h-12 w-12 animate-spin text-white mb-4"}),(0,o.jsx)("p",{className:"text-lg font-medium",children:void 0===r?"Laden...":r})]})}},15424:(e,r,n)=>{"use strict";n.d(r,{Aw:()=>c,GA:()=>u,OB:()=>f,Xr:()=>s,Zv:()=>l,_9:()=>h,s2:()=>p,vm:()=>d,wq:()=>a});var i=n(38791),o=n(42471),a=["schneider","kontermatsch"],s={top:[2,4],bottom:[1,3]},u=function(e){},c=function(e){return"jass"===e.actionType},l=function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.zh,arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.$d,{horizontal:(e.matsch||0)+(e.kontermatsch||0),vertikal:(e.berg||0)+(e.sieg||0)+(e.schneider||0)}},h=function(){return{lastNavigationTimestamp:Date.now(),weisCache:null}},d=function(e){var r=e%4+1;return r>=1&&r<=4?r:1},f=function(e,r){return"top"===r&&(2===e||4===e)||"bottom"===r&&(1===e||3===e)},p={none:0,low:500,medium:1500,high:3e3,super:5e3,extreme:8e3}},15861:e=>{!function(){var r={229:function(e){var r,n,i,o=e.exports={};function a(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}var c=[],l=!1,h=-1;function d(){l&&i&&(l=!1,i.length?c=i.concat(c):h=-1,c.length&&f())}function f(){if(!l){var e=u(d);l=!0;for(var r=c.length;r;){for(i=c,c=[];++h<r;)i&&i[h].run();h=-1,r=c.length}i=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(r){try{return n.call(null,e)}catch(r){return n.call(this,e)}}}(e)}}function p(e,r){this.fun=e,this.array=r}function m(){}o.nextTick=function(e){var r=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)r[n-1]=arguments[n];c.push(new p(e,r)),1!==c.length||l||u(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}},s=!0;try{r[e](a,a.exports,i),s=!1}finally{s&&delete n[e]}return a.exports}i.ab="//",e.exports=i(229)}()},16042:(e,r,n)=>{"use strict";n.d(r,{Wp:()=>i.Wp,g:()=>i.g});var i=n(96796);(0,i.KO)("firebase","11.10.0","app")},16871:(e,r,n)=>{"use strict";n.d(r,{GH:()=>i,Zr:()=>o});var i=function(e,r){return e.reduce(function(e,n){var i,o,a,s,u,c,l,h,d,f;return{berg:e.berg+(null!=(i=null==(o=n.teams[r].striche)?void 0:o.berg)?i:0),sieg:e.sieg+(null!=(a=null==(s=n.teams[r].striche)?void 0:s.sieg)?a:0),matsch:e.matsch+(null!=(u=null==(c=n.teams[r].striche)?void 0:c.matsch)?u:0),schneider:e.schneider+(null!=(l=null==(h=n.teams[r].striche)?void 0:h.schneider)?l:0),kontermatsch:e.kontermatsch+(null!=(d=null==(f=n.teams[r].striche)?void 0:f.kontermatsch)?d:0)}},{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0})},o=function(e){return e.berg+e.sieg+e.schneider}},19250:(e,r,n)=>{"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){o=function(){return r};var e,r={},n=Object.prototype,a=n.hasOwnProperty,s=Object.defineProperty||function(e,r,n){e[r]=n.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function d(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{d({},"")}catch(e){d=function(e,r,n){return e[r]=n}}function f(r,n,i,o){var a,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return s(h,"_invoke",{value:(a=r,u=i,c=new O(o||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var s=p(a,u,c);if("normal"===s.type){if(l=c.done?y:"suspendedYield",s.arg===v)continue;return{value:s.arg,done:c.done}}"throw"===s.type&&(l=y,c.method="throw",c.arg=s.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};d(x,c,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&a.call(I,c)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){d(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;s(this,"_invoke",{value:function(o,s){function u(){return new r(function(n,u){!function n(o,s,u,c){var l=p(e[o],e,s);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==i(d)&&a.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,u,c)},function(e){n("throw",e,u,c)}):r.resolve(d).then(function(e){h.value=e,u(h)},function(e){return n("throw",e,u,c)})}c(l.arg)}(o,s,n,u)})}return n=n?n.then(u,u):u()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[c];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,s=function n(){for(;++o<r.length;)if(a.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw TypeError(i(r)+" is not iterable")}return w.prototype=S,s(T,"constructor",{value:S,configurable:!0}),s(S,"constructor",{value:w,configurable:!0}),w.displayName=d(S,h,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,d(e,h,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),d(_.prototype,l,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(f(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),d(T,h,"Generator"),d(T,c,function(){return this}),d(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function i(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],u=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=a.call(s,"catchLoc"),l=a.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=r,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function a(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function s(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var s=e.apply(r,n);function u(e){a(s,i,o,u,c,"next",e)}function c(e){a(s,i,o,u,c,"throw",e)}u(void 0)})}}n.d(r,{eW:()=>d});function u(e,r,n){return(r=c(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function c(e){var r=function(e,r){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,r||"default");if("object"!=i(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==i(r)?r:r+""}var l=function(){var e,r,n,i,a,l,h,d,f,p,m,g;return m=function e(){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");u(this,"dbName","JasstafelOfflineDB"),u(this,"dbVersion",1),u(this,"db",null)},g=[{key:"init",value:(e=s(o().mark(function e(){var r=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var i=setTimeout(function(){console.warn("[IndexedDB] Init timeout nach 3s - m\xf6glicherweise Safari Private Mode"),n(Error("IndexedDB initialization timeout"))},3e3),o=indexedDB.open(r.dbName,r.dbVersion);o.onerror=function(){clearTimeout(i),n(o.error)},o.onsuccess=function(){clearTimeout(i),r.db=o.result,e()},o.onupgradeneeded=function(e){var r=e.target.result;if(!r.objectStoreNames.contains("syncQueue")){var n=r.createObjectStore("syncQueue",{keyPath:"id"});n.createIndex("timestamp","timestamp"),n.createIndex("type","type"),n.createIndex("attempts","attempts")}if(!r.objectStoreNames.contains("offlineGames")){var i=r.createObjectStore("offlineGames",{keyPath:"id"});i.createIndex("sessionId","sessionId"),i.createIndex("timestamp","timestamp"),i.createIndex("synced","synced")}r.objectStoreNames.contains("gameSettings")||r.createObjectStore("gameSettings",{keyPath:"sessionId"}).createIndex("timestamp","timestamp")}}));case 1:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})},{key:"addToSyncQueue",value:(r=s(o().mark(function e(r){var n=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,i){var o=n.db.transaction(["syncQueue"],"readwrite").objectStore("syncQueue").add(r);o.onerror=function(){return i(o.error)},o.onsuccess=function(){e()}}));case 2:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"getPendingSyncItems",value:(n=s(o().mark(function e(){var r=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,n){var i=r.db.transaction(["syncQueue"],"readonly").objectStore("syncQueue").index("timestamp").getAll();i.onerror=function(){return n(i.error)},i.onsuccess=function(){var r=i.result;r.sort(function(e,r){return e.attempts!==r.attempts?e.attempts-r.attempts:r.timestamp-e.timestamp}),e(r)}}));case 2:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"removeSyncItem",value:(i=s(o().mark(function e(r){var n=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,i){var o=n.db.transaction(["syncQueue"],"readwrite").objectStore("syncQueue").delete(r);o.onerror=function(){return i(o.error)},o.onsuccess=function(){e()}}));case 2:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"updateSyncItem",value:(a=s(o().mark(function e(r){var n=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,i){var o=n.db.transaction(["syncQueue"],"readwrite").objectStore("syncQueue").put(r);o.onerror=function(){return i(o.error)},o.onsuccess=function(){console.log("[OfflineDB] ✅ Sync item updated: ".concat(r.id," (attempts: ").concat(r.attempts,")")),e()}}));case 2:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"saveOfflineGame",value:(l=s(o().mark(function e(r){var n=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,i){var o=n.db.transaction(["offlineGames"],"readwrite").objectStore("offlineGames").put(r);o.onerror=function(){return i(o.error)},o.onsuccess=function(){console.log("[OfflineDB] ✅ Offline game saved: ".concat(r.id)),e()}}));case 2:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"getOfflineGames",value:(h=s(o().mark(function e(r){var n=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,i){var o,a=n.db.transaction(["offlineGames"],"readonly").objectStore("offlineGames");(o=r?a.index("sessionId").getAll(r):a.getAll()).onerror=function(){return i(o.error)},o.onsuccess=function(){return e(o.result)}}));case 2:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"clearSyncedGames",value:(d=s(o().mark(function e(){var r=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,n){var i=r.db.transaction(["offlineGames"],"readwrite").objectStore("offlineGames").index("synced").openCursor();i.onerror=function(){return n(i.error)},i.onsuccess=function(r){var n=r.target.result;n?(n.value.synced&&n.delete(),n.continue()):(console.log("[OfflineDB] ✅ Synced games cleared"),e())}}));case 2:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)})},{key:"saveGameSettings",value:(f=s(o().mark(function e(r,n){var i=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,o){var a=i.db.transaction(["gameSettings"],"readwrite").objectStore("gameSettings"),s={sessionId:r,settings:n,timestamp:Date.now()},u=a.put(s);u.onerror=function(){return o(u.error)},u.onsuccess=function(){console.log("[OfflineDB] ✅ Game settings saved for session: ".concat(r)),e()}}));case 2:case"end":return e.stop()}},e,this)})),function(e,r){return f.apply(this,arguments)})},{key:"getGameSettings",value:(p=s(o().mark(function e(r){var n=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=1;break}throw Error("DB not initialized");case 1:return e.abrupt("return",new Promise(function(e,i){var o=n.db.transaction(["gameSettings"],"readonly").objectStore("gameSettings").get(r);o.onerror=function(){return i(o.error)},o.onsuccess=function(){var r=o.result;e(r?r.settings:null)}}));case 2:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})}],function(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,c(i.key),i)}}(m.prototype,g),Object.defineProperty(m,"prototype",{writable:!1}),m}(),h=null,d=function(){var e=s(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=1;break}return h=new l,e.next=1,h.init();case 1:return e.abrupt("return",h);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},21297:(e,r,n)=>{"use strict";n.d(r,{g:()=>function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=s({removeEmptyArrays:!1,removeEmptyObjects:!1,replaceNaNWith:0,fixDuplicateFields:!0},n);if(null==r)return null;if("number"==typeof r&&isNaN(r))return a.replaceNaNWith;if("object"!==o(r)||r instanceof i.Timestamp||r instanceof i.FieldValue||r&&"object"===o(r)&&("_methodName"in r||"_seconds"in r&&"_nanoseconds"in r)||r instanceof Date)return r;if(Array.isArray(r)){var u=r.map(function(r){return e(r,a)}).filter(function(e){return!(a.removeEmptyArrays&&Array.isArray(e)&&0===e.length)}).filter(function(e){return!(a.removeEmptyObjects&&"object"===o(e)&&null!==e&&!Array.isArray(e)&&0===Object.keys(e).length)});return a.removeEmptyArrays&&0===u.length?null:u}var c={};if(a.fixDuplicateFields&&"weisPoints"in r&&"roundHistory"in r&&Array.isArray(r.roundHistory)){var l=s({},r);l.roundHistory&&Array.isArray(l.roundHistory)&&(l.roundHistory=l.roundHistory.map(function(e){if(e&&"object"===o(e)&&!Array.isArray(e)){var r=s({},e);return"weisPoints"in r&&(r._savedWeisPoints=r.weisPoints),r}return e})),r=l}for(var h in r)if(Object.prototype.hasOwnProperty.call(r,h)){var d=e(r[h],a);if(a.removeEmptyArrays&&Array.isArray(d)&&0===d.length||a.removeEmptyObjects&&"object"===o(d)&&null!==d&&!Array.isArray(d)&&0===Object.keys(d).length)continue;c[h]=d}return a.removeEmptyObjects&&0===Object.keys(c).length?null:c}});var i=n(42009);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function s(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach(function(r){var i,a,s;i=e,a=r,s=n[r],(a=function(e){var r=function(e,r){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=o(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==o(r)?r:r+""}(a))in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}},23355:(e,r,n)=>{"use strict";let i;function o(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function a(e){let r=[{},{}];return e?.values.forEach((e,n)=>{r[0][n]=e.get(),r[1][n]=e.getVelocity()}),r}function s(e,r,n,i){if("function"==typeof r){let[o,s]=a(i);r=r(void 0!==n?n:e.custom,o,s)}if("string"==typeof r&&(r=e.variants&&e.variants[r]),"function"==typeof r){let[o,s]=a(i);r=r(void 0!==n?n:e.custom,o,s)}return r}function u(e,r,n){let i=e.getProps();return s(i,r,void 0!==n?n:i.custom,e)}function c(e,r){return e?.[r]??e?.default??e}n.d(r,{P:()=>om});let l=e=>e,h={},d=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],f={value:null,addProjectionMetrics:null};function p(e,r){let n=!1,i=!0,o={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,s=d.reduce((e,n)=>(e[n]=function(e,r){let n=new Set,i=new Set,o=!1,a=!1,s=new WeakSet,u={delta:0,timestamp:0,isProcessing:!1},c=0;function l(r){s.has(r)&&(h.schedule(r),e()),c++,r(u)}let h={schedule:(e,r=!1,a=!1)=>{let u=a&&o?n:i;return r&&s.add(e),u.has(e)||u.add(e),e},cancel:e=>{i.delete(e),s.delete(e)},process:e=>{if(u=e,o){a=!0;return}o=!0,[n,i]=[i,n],n.forEach(l),r&&f.value&&f.value.frameloop[r].push(c),c=0,n.clear(),o=!1,a&&(a=!1,h.process(e))}};return h}(a,r?n:void 0),e),{}),{setup:u,read:c,resolveKeyframes:l,preUpdate:p,update:m,preRender:g,render:y,postRender:v}=s,b=()=>{let a=h.useManualTiming?o.timestamp:performance.now();n=!1,h.useManualTiming||(o.delta=i?1e3/60:Math.max(Math.min(a-o.timestamp,40),1)),o.timestamp=a,o.isProcessing=!0,u.process(o),c.process(o),l.process(o),p.process(o),m.process(o),g.process(o),y.process(o),v.process(o),o.isProcessing=!1,n&&r&&(i=!1,e(b))};return{schedule:d.reduce((r,a)=>{let u=s[a];return r[a]=(r,a=!1,s=!1)=>(!n&&(n=!0,i=!0,o.isProcessing||e(b)),u.schedule(r,a,s)),r},{}),cancel:e=>{for(let r=0;r<d.length;r++)s[d[r]].cancel(e)},state:o,steps:s}}let{schedule:m,cancel:g,state:y,steps:v}=p("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:l,!0),b=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],w=new Set(b),S=new Set(["width","height","top","left","right","bottom",...b]);function x(e,r){-1===e.indexOf(r)&&e.push(r)}function E(e,r){let n=e.indexOf(r);n>-1&&e.splice(n,1)}class I{constructor(){this.subscriptions=[]}add(e){return x(this.subscriptions,e),()=>E(this.subscriptions,e)}notify(e,r,n){let i=this.subscriptions.length;if(i)if(1===i)this.subscriptions[0](e,r,n);else for(let o=0;o<i;o++){let i=this.subscriptions[o];i&&i(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function T(){i=void 0}let k={now:()=>(void 0===i&&k.set(y.isProcessing||h.useManualTiming?y.timestamp:performance.now()),i),set:e=>{i=e,queueMicrotask(T)}},_={current:void 0};class A{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(e,r=!0)=>{let n=k.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let e of this.dependents)e.dirty();r&&this.events.renderRequest?.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=k.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=!isNaN(parseFloat(this.current)))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new I);let n=this.events[e].add(r);return"change"===e?()=>{n(),m.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){r&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,r)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return _.current&&_.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let r=k.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||r-this.updatedAt>30)return 0;let n=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),n?1e3/n*e:0}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function P(e,r){return new A(e,r)}let O=e=>Array.isArray(e),C=e=>!!(e&&e.getVelocity);function N(e,r){let n=e.getValue("willChange");if(C(n)&&n.add)return n.add(r);if(!n&&h.WillChange){let n=new h.WillChange("auto");e.addValue("willChange",n),n.add(r)}}let L=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),D="data-"+L("framerAppearId"),R=(e,r)=>n=>r(e(n)),j=(...e)=>e.reduce(R),F=(e,r,n)=>n>r?r:n<e?e:n,U=e=>1e3*e,M={layout:0,mainThread:0,waapi:0},G=()=>{},V=()=>{},B=e=>r=>"string"==typeof r&&r.startsWith(e),z=B("--"),q=B("var(--"),H=e=>!!q(e)&&$.test(e.split("/*")[0].trim()),$=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,K={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},W={...K,transform:e=>F(0,1,e)},Q={...K,default:1},J=e=>Math.round(1e5*e)/1e5,Y=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,X=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Z=(e,r)=>n=>!!("string"==typeof n&&X.test(n)&&n.startsWith(e)||r&&null!=n&&Object.prototype.hasOwnProperty.call(n,r)),ee=(e,r,n)=>i=>{if("string"!=typeof i)return i;let[o,a,s,u]=i.match(Y);return{[e]:parseFloat(o),[r]:parseFloat(a),[n]:parseFloat(s),alpha:void 0!==u?parseFloat(u):1}},et={...K,transform:e=>Math.round(F(0,255,e))},er={test:Z("rgb","red"),parse:ee("red","green","blue"),transform:({red:e,green:r,blue:n,alpha:i=1})=>"rgba("+et.transform(e)+", "+et.transform(r)+", "+et.transform(n)+", "+J(W.transform(i))+")"},en={test:Z("#"),parse:function(e){let r="",n="",i="",o="";return e.length>5?(r=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),o=e.substring(7,9)):(r=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),o=e.substring(4,5),r+=r,n+=n,i+=i,o+=o),{red:parseInt(r,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:o?parseInt(o,16)/255:1}},transform:er.transform},ei=e=>({test:r=>"string"==typeof r&&r.endsWith(e)&&1===r.split(" ").length,parse:parseFloat,transform:r=>`${r}${e}`}),eo=ei("deg"),ea=ei("%"),es=ei("px"),eu=ei("vh"),ec=ei("vw"),el={...ea,parse:e=>ea.parse(e)/100,transform:e=>ea.transform(100*e)},eh={test:Z("hsl","hue"),parse:ee("hue","saturation","lightness"),transform:({hue:e,saturation:r,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+ea.transform(J(r))+", "+ea.transform(J(n))+", "+J(W.transform(i))+")"},ed={test:e=>er.test(e)||en.test(e)||eh.test(e),parse:e=>er.test(e)?er.parse(e):eh.test(e)?eh.parse(e):en.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?er.transform(e):eh.transform(e),getAnimatableNone:e=>{let r=ed.parse(e);return r.alpha=0,ed.transform(r)}},ef=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,ep="number",em="color",eg=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ey(e){let r=e.toString(),n=[],i={color:[],number:[],var:[]},o=[],a=0,s=r.replace(eg,e=>(ed.test(e)?(i.color.push(a),o.push(em),n.push(ed.parse(e))):e.startsWith("var(")?(i.var.push(a),o.push("var"),n.push(e)):(i.number.push(a),o.push(ep),n.push(parseFloat(e))),++a,"${}")).split("${}");return{values:n,split:s,indexes:i,types:o}}function ev(e){return ey(e).values}function eb(e){let{split:r,types:n}=ey(e),i=r.length;return e=>{let o="";for(let a=0;a<i;a++)if(o+=r[a],void 0!==e[a]){let r=n[a];r===ep?o+=J(e[a]):r===em?o+=ed.transform(e[a]):o+=e[a]}return o}}let ew=e=>"number"==typeof e?0:ed.test(e)?ed.getAnimatableNone(e):e,eS={test:function(e){return isNaN(e)&&"string"==typeof e&&(e.match(Y)?.length||0)+(e.match(ef)?.length||0)>0},parse:ev,createTransformer:eb,getAnimatableNone:function(e){let r=ev(e);return eb(e)(r.map(ew))}};function ex(e,r,n){return(n<0&&(n+=1),n>1&&(n-=1),n<1/6)?e+(r-e)*6*n:n<.5?r:n<2/3?e+(r-e)*(2/3-n)*6:e}function eE(e,r){return n=>n>0?r:e}let eI=(e,r,n)=>e+(r-e)*n,eT=(e,r,n)=>{let i=e*e,o=n*(r*r-i)+i;return o<0?0:Math.sqrt(o)},ek=[en,er,eh];function e_(e){let r=ek.find(r=>r.test(e));if(G(!!r,`'${e}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!r)return!1;let n=r.parse(e);return r===eh&&(n=function({hue:e,saturation:r,lightness:n,alpha:i}){e/=360,n/=100;let o=0,a=0,s=0;if(r/=100){let i=n<.5?n*(1+r):n+r-n*r,u=2*n-i;o=ex(u,i,e+1/3),a=ex(u,i,e),s=ex(u,i,e-1/3)}else o=a=s=n;return{red:Math.round(255*o),green:Math.round(255*a),blue:Math.round(255*s),alpha:i}}(n)),n}let eA=(e,r)=>{let n=e_(e),i=e_(r);if(!n||!i)return eE(e,r);let o={...n};return e=>(o.red=eT(n.red,i.red,e),o.green=eT(n.green,i.green,e),o.blue=eT(n.blue,i.blue,e),o.alpha=eI(n.alpha,i.alpha,e),er.transform(o))},eP=new Set(["none","hidden"]);function eO(e,r){return n=>eI(e,r,n)}function eC(e){return"number"==typeof e?eO:"string"==typeof e?H(e)?eE:ed.test(e)?eA:eD:Array.isArray(e)?eN:"object"==typeof e?ed.test(e)?eA:eL:eE}function eN(e,r){let n=[...e],i=n.length,o=e.map((e,n)=>eC(e)(e,r[n]));return e=>{for(let r=0;r<i;r++)n[r]=o[r](e);return n}}function eL(e,r){let n={...e,...r},i={};for(let o in n)void 0!==e[o]&&void 0!==r[o]&&(i[o]=eC(e[o])(e[o],r[o]));return e=>{for(let r in i)n[r]=i[r](e);return n}}let eD=(e,r)=>{let n=eS.createTransformer(r),i=ey(e),o=ey(r);return i.indexes.var.length===o.indexes.var.length&&i.indexes.color.length===o.indexes.color.length&&i.indexes.number.length>=o.indexes.number.length?eP.has(e)&&!o.values.length||eP.has(r)&&!i.values.length?function(e,r){return eP.has(e)?n=>n<=0?e:r:n=>n>=1?r:e}(e,r):j(eN(function(e,r){let n=[],i={color:0,var:0,number:0};for(let o=0;o<r.values.length;o++){let a=r.types[o],s=e.indexes[a][i[a]],u=e.values[s]??0;n[o]=u,i[a]++}return n}(i,o),o.values),n):(G(!0,`Complex values '${e}' and '${r}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),eE(e,r))};function eR(e,r,n){return"number"==typeof e&&"number"==typeof r&&"number"==typeof n?eI(e,r,n):eC(e)(e,r)}let ej=e=>{let r=({timestamp:r})=>e(r);return{start:(e=!0)=>m.update(r,e),stop:()=>g(r),now:()=>y.isProcessing?y.timestamp:k.now()}},eF=(e,r,n=10)=>{let i="",o=Math.max(Math.round(r/n),2);for(let r=0;r<o;r++)i+=Math.round(1e4*e(r/(o-1)))/1e4+", ";return`linear(${i.substring(0,i.length-2)})`};function eU(e){let r=0,n=e.next(r);for(;!n.done&&r<2e4;)r+=50,n=e.next(r);return r>=2e4?1/0:r}function eM(e,r,n){var i,o;let a=Math.max(r-5,0);return i=n-e(a),(o=r-a)?1e3/o*i:0}let eG={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1};function eV(e,r){return e*Math.sqrt(1-r*r)}let eB=["duration","bounce"],ez=["stiffness","damping","mass"];function eq(e,r){return r.some(r=>void 0!==e[r])}function eH(e=eG.visualDuration,r=eG.bounce){let n,i="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:r}:e,{restSpeed:o,restDelta:a}=i,s=i.keyframes[0],u=i.keyframes[i.keyframes.length-1],c={done:!1,value:s},{stiffness:l,damping:h,mass:d,duration:f,velocity:p,isResolvedFromDuration:m}=function(e){let r={velocity:eG.velocity,stiffness:eG.stiffness,damping:eG.damping,mass:eG.mass,isResolvedFromDuration:!1,...e};if(!eq(e,ez)&&eq(e,eB))if(e.visualDuration){let n=2*Math.PI/(1.2*e.visualDuration),i=n*n,o=2*F(.05,1,1-(e.bounce||0))*Math.sqrt(i);r={...r,mass:eG.mass,stiffness:i,damping:o}}else{let n=function({duration:e=eG.duration,bounce:r=eG.bounce,velocity:n=eG.velocity,mass:i=eG.mass}){let o,a;G(e<=U(eG.maxDuration),"Spring duration must be 10 seconds or less","spring-duration-limit");let s=1-r;s=F(eG.minDamping,eG.maxDamping,s),e=F(eG.minDuration,eG.maxDuration,e/1e3),s<1?(o=r=>{let i=r*s,o=i*e;return .001-(i-n)/eV(r,s)*Math.exp(-o)},a=r=>{let i=r*s*e,a=Math.pow(s,2)*Math.pow(r,2)*e,u=Math.exp(-i),c=eV(Math.pow(r,2),s);return(i*n+n-a)*u*(-o(r)+.001>0?-1:1)/c}):(o=r=>-.001+Math.exp(-r*e)*((r-n)*e+1),a=r=>e*e*(n-r)*Math.exp(-r*e));let u=function(e,r,n){let i=n;for(let n=1;n<12;n++)i-=e(i)/r(i);return i}(o,a,5/e);if(e=U(e),isNaN(u))return{stiffness:eG.stiffness,damping:eG.damping,duration:e};{let r=Math.pow(u,2)*i;return{stiffness:r,damping:2*s*Math.sqrt(i*r),duration:e}}}(e);(r={...r,...n,mass:eG.mass}).isResolvedFromDuration=!0}return r}({...i,velocity:-((i.velocity||0)/1e3)}),g=p||0,y=h/(2*Math.sqrt(l*d)),v=u-s,b=Math.sqrt(l/d)/1e3,w=5>Math.abs(v);if(o||(o=w?eG.restSpeed.granular:eG.restSpeed.default),a||(a=w?eG.restDelta.granular:eG.restDelta.default),y<1){let e=eV(b,y);n=r=>u-Math.exp(-y*b*r)*((g+y*b*v)/e*Math.sin(e*r)+v*Math.cos(e*r))}else if(1===y)n=e=>u-Math.exp(-b*e)*(v+(g+b*v)*e);else{let e=b*Math.sqrt(y*y-1);n=r=>{let n=Math.exp(-y*b*r),i=Math.min(e*r,300);return u-n*((g+y*b*v)*Math.sinh(i)+e*v*Math.cosh(i))/e}}let S={calculatedDuration:m&&f||null,next:e=>{let r=n(e);if(m)c.done=e>=f;else{let i=0===e?g:0;y<1&&(i=0===e?U(g):eM(n,e,r));let s=Math.abs(u-r)<=a;c.done=Math.abs(i)<=o&&s}return c.value=c.done?u:r,c},toString:()=>{let e=Math.min(eU(S),2e4),r=eF(r=>S.next(e*r).value,e,30);return e+"ms "+r},toTransition:()=>{}};return S}function e$({keyframes:e,velocity:r=0,power:n=.8,timeConstant:i=325,bounceDamping:o=10,bounceStiffness:a=500,modifyTarget:s,min:u,max:c,restDelta:l=.5,restSpeed:h}){let d,f,p=e[0],m={done:!1,value:p},g=n*r,y=p+g,v=void 0===s?y:s(y);v!==y&&(g=v-p);let b=e=>-g*Math.exp(-e/i),w=e=>v+b(e),S=e=>{let r=b(e),n=w(e);m.done=Math.abs(r)<=l,m.value=m.done?v:n},x=e=>{let r;if(r=m.value,void 0!==u&&r<u||void 0!==c&&r>c){var n;d=e,f=eH({keyframes:[m.value,(n=m.value,void 0===u?c:void 0===c||Math.abs(u-n)<Math.abs(c-n)?u:c)],velocity:eM(w,e,m.value),damping:o,stiffness:a,restDelta:l,restSpeed:h})}};return x(0),{calculatedDuration:null,next:e=>{let r=!1;return(f||void 0!==d||(r=!0,S(e),x(e)),void 0!==d&&e>=d)?f.next(e-d):(r||S(e),m)}}}eH.applyToOptions=e=>{let r=function(e,r=100,n){let i=n({...e,keyframes:[0,r]}),o=Math.min(eU(i),2e4);return{type:"keyframes",ease:e=>i.next(o*e).value/r,duration:o/1e3}}(e,100,eH);return e.ease=r.ease,e.duration=U(r.duration),e.type="keyframes",e};let eK=(e,r,n)=>(((1-3*n+3*r)*e+(3*n-6*r))*e+3*r)*e;function eW(e,r,n,i){return e===r&&n===i?l:o=>0===o||1===o?o:eK(function(e,r,n,i,o){let a,s,u=0;do(a=eK(s=r+(n-r)/2,i,o)-e)>0?n=s:r=s;while(Math.abs(a)>1e-7&&++u<12);return s}(o,0,1,e,n),r,i)}let eQ=eW(.42,0,1,1),eJ=eW(0,0,.58,1),eY=eW(.42,0,.58,1),eX=e=>r=>r<=.5?e(2*r)/2:(2-e(2*(1-r)))/2,eZ=e=>r=>1-e(1-r),e0=eW(.33,1.53,.69,.99),e1=eZ(e0),e2=eX(e1),e3=e=>(e*=2)<1?.5*e1(e):.5*(2-Math.pow(2,-10*(e-1))),e4=e=>1-Math.sin(Math.acos(e)),e5=eZ(e4),e6=eX(e4),e8=e=>Array.isArray(e)&&"number"==typeof e[0],e7={linear:l,easeIn:eQ,easeInOut:eY,easeOut:eJ,circIn:e4,circInOut:e6,circOut:e5,backIn:e1,backInOut:e2,backOut:e0,anticipate:e3},e9=e=>{if(e8(e)){V(4===e.length,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[r,n,i,o]=e;return eW(r,n,i,o)}return"string"==typeof e?(V(void 0!==e7[e],`Invalid easing type '${e}'`,"invalid-easing-type"),e7[e]):e},te=(e,r,n)=>{let i=r-e;return 0===i?1:(n-e)/i};function tt({duration:e=300,keyframes:r,times:n,ease:i="easeInOut"}){var o;let a=Array.isArray(i)&&"number"!=typeof i[0]?i.map(e9):e9(i),s={done:!1,value:r[0]},u=function(e,r,{clamp:n=!0,ease:i,mixer:o}={}){let a=e.length;if(V(a===r.length,"Both input and output ranges must be the same length","range-length"),1===a)return()=>r[0];if(2===a&&r[0]===r[1])return()=>r[1];let s=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),r=[...r].reverse());let u=function(e,r,n){let i=[],o=n||h.mix||eR,a=e.length-1;for(let n=0;n<a;n++){let a=o(e[n],e[n+1]);r&&(a=j(Array.isArray(r)?r[n]||l:r,a)),i.push(a)}return i}(r,i,o),c=u.length,d=n=>{if(s&&n<e[0])return r[0];let i=0;if(c>1)for(;i<e.length-2&&!(n<e[i+1]);i++);let o=te(e[i],e[i+1],n);return u[i](o)};return n?r=>d(F(e[0],e[a-1],r)):d}((o=n&&n.length===r.length?n:function(e){let r=[0];return!function(e,r){let n=e[e.length-1];for(let i=1;i<=r;i++){let o=te(0,r,i);e.push(eI(n,1,o))}}(r,e.length-1),r}(r),o.map(r=>r*e)),r,{ease:Array.isArray(a)?a:r.map(()=>a||eY).splice(0,r.length-1)});return{calculatedDuration:e,next:r=>(s.value=u(r),s.done=r>=e,s)}}let tr=e=>null!==e;function tn(e,{repeat:r,repeatType:n="loop"},i,o=1){let a=e.filter(tr),s=o<0||r&&"loop"!==n&&r%2==1?0:a.length-1;return s&&void 0!==i?i:a[s]}let ti={decay:e$,inertia:e$,tween:tt,keyframes:tt,spring:eH};function to(e){"string"==typeof e.type&&(e.type=ti[e.type])}class ta{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}let ts=e=>e/100;class tu extends ta{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:e}=this.options;e&&e.updatedAt!==k.now()&&this.tick(k.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},M.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){let{options:e}=this;to(e);let{type:r=tt,repeat:n=0,repeatDelay:i=0,repeatType:o,velocity:a=0}=e,{keyframes:s}=e,u=r||tt;u!==tt&&"number"!=typeof s[0]&&(this.mixKeyframes=j(ts,eR(s[0],s[1])),s=[0,100]);let c=u({...e,keyframes:s});"mirror"===o&&(this.mirroredGenerator=u({...e,keyframes:[...s].reverse(),velocity:-a})),null===c.calculatedDuration&&(c.calculatedDuration=eU(c));let{calculatedDuration:l}=c;this.calculatedDuration=l,this.resolvedDuration=l+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=c}updateTime(e){let r=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){let{generator:n,totalDuration:i,mixKeyframes:o,mirroredGenerator:a,resolvedDuration:s,calculatedDuration:u}=this;if(null===this.startTime)return n.next(0);let{delay:c=0,keyframes:l,repeat:h,repeatType:d,repeatDelay:f,type:p,onUpdate:m,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);let y=this.currentTime-c*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?y<0:y>i;this.currentTime=Math.max(y,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=i);let b=this.currentTime,w=n;if(h){let e=Math.min(this.currentTime,i)/s,r=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&r--,(r=Math.min(r,h+1))%2&&("reverse"===d?(n=1-n,f&&(n-=f/s)):"mirror"===d&&(w=a)),b=F(0,1,n)*s}let S=v?{done:!1,value:l[0]}:w.next(b);o&&(S.value=o(S.value));let{done:x}=S;v||null===u||(x=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);let E=null===this.holdTime&&("finished"===this.state||"running"===this.state&&x);return E&&p!==e$&&(S.value=tn(l,this.options,g,this.speed)),m&&m(S.value),E&&this.finish(),S}then(e,r){return this.finished.then(e,r)}get duration(){return this.calculatedDuration/1e3}get time(){return this.currentTime/1e3}set time(e){e=U(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(k.now());let r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=this.currentTime/1e3)}play(){if(this.isStopped)return;let{driver:e=ej,startTime:r}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),this.options.onPlay?.();let n=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=n):null!==this.holdTime?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(k.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,M.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}let tc=e=>180*e/Math.PI,tl=e=>td(tc(Math.atan2(e[1],e[0]))),th={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:tl,rotateZ:tl,skewX:e=>tc(Math.atan(e[1])),skewY:e=>tc(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},td=e=>((e%=360)<0&&(e+=360),e),tf=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),tp=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),tm={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:tf,scaleY:tp,scale:e=>(tf(e)+tp(e))/2,rotateX:e=>td(tc(Math.atan2(e[6],e[5]))),rotateY:e=>td(tc(Math.atan2(-e[2],e[0]))),rotateZ:tl,rotate:tl,skewX:e=>tc(Math.atan(e[4])),skewY:e=>tc(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function tg(e){return+!!e.includes("scale")}function ty(e,r){let n,i;if(!e||"none"===e)return tg(r);let o=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);if(o)n=tm,i=o;else{let r=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=th,i=r}if(!i)return tg(r);let a=n[r],s=i[1].split(",").map(tv);return"function"==typeof a?a(s):s[a]}function tv(e){return parseFloat(e.trim())}let tb=e=>e===K||e===es,tw=new Set(["x","y","z"]),tS=b.filter(e=>!tw.has(e)),tx={width:({x:e},{paddingLeft:r="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(r)-parseFloat(n),height:({y:e},{paddingTop:r="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(r)-parseFloat(n),top:(e,{top:r})=>parseFloat(r),left:(e,{left:r})=>parseFloat(r),bottom:({y:e},{top:r})=>parseFloat(r)+(e.max-e.min),right:({x:e},{left:r})=>parseFloat(r)+(e.max-e.min),x:(e,{transform:r})=>ty(r,"x"),y:(e,{transform:r})=>ty(r,"y")};tx.translateX=tx.x,tx.translateY=tx.y;let tE=new Set,tI=!1,tT=!1,tk=!1;function t_(){if(tT){let e=Array.from(tE).filter(e=>e.needsMeasurement),r=new Set(e.map(e=>e.element)),n=new Map;r.forEach(e=>{let r=function(e){let r=[];return tS.forEach(n=>{let i=e.getValue(n);void 0!==i&&(r.push([n,i.get()]),i.set(+!!n.startsWith("scale")))}),r}(e);r.length&&(n.set(e,r),e.render())}),e.forEach(e=>e.measureInitialState()),r.forEach(e=>{e.render();let r=n.get(e);r&&r.forEach(([r,n])=>{e.getValue(r)?.set(n)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}tT=!1,tI=!1,tE.forEach(e=>e.complete(tk)),tE.clear()}function tA(){tE.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(tT=!0)})}class tP{constructor(e,r,n,i,o,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=i,this.element=o,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(tE.add(this),tI||(tI=!0,m.read(tA),m.resolveKeyframes(t_))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:r,element:n,motionValue:i}=this;if(null===e[0]){let o=i?.get(),a=e[e.length-1];if(void 0!==o)e[0]=o;else if(n&&r){let i=n.readValue(r,a);null!=i&&(e[0]=i)}void 0===e[0]&&(e[0]=a),i&&void 0===o&&i.set(e[0])}for(let r=1;r<e.length;r++)e[r]??(e[r]=e[r-1])}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),tE.delete(this)}cancel(){"scheduled"===this.state&&(tE.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}function tO(e){let r;return()=>(void 0===r&&(r=e()),r)}let tC=tO(()=>void 0!==window.ScrollTimeline),tN={},tL=function(e,r){let n=tO(e);return()=>tN[r]??n()}(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),tD=([e,r,n,i])=>`cubic-bezier(${e}, ${r}, ${n}, ${i})`,tR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:tD([0,.65,.55,1]),circOut:tD([.55,0,1,.45]),backIn:tD([.31,.01,.66,-.59]),backOut:tD([.33,1.53,.69,.99])};function tj(e){return"function"==typeof e&&"applyToOptions"in e}class tF extends ta{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;let{element:r,name:n,keyframes:i,pseudoElement:o,allowFlatten:a=!1,finalKeyframe:s,onComplete:u}=e;this.isPseudoElement=!!o,this.allowFlatten=a,this.options=e,V("string"!=typeof e.type,'Mini animate() doesn\'t support "type" as a string.',"mini-spring");let c=function({type:e,...r}){return tj(e)&&tL()?e.applyToOptions(r):(r.duration??(r.duration=300),r.ease??(r.ease="easeOut"),r)}(e);this.animation=function(e,r,n,{delay:i=0,duration:o=300,repeat:a=0,repeatType:s="loop",ease:u="easeOut",times:c}={},l){let h={[r]:n};c&&(h.offset=c);let d=function e(r,n){if(r)return"function"==typeof r?tL()?eF(r,n):"ease-out":e8(r)?tD(r):Array.isArray(r)?r.map(r=>e(r,n)||tR.easeOut):tR[r]}(u,o);Array.isArray(d)&&(h.easing=d),f.value&&M.waapi++;let p={delay:i,duration:o,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:a+1,direction:"reverse"===s?"alternate":"normal"};l&&(p.pseudoElement=l);let m=e.animate(h,p);return f.value&&m.finished.finally(()=>{M.waapi--}),m}(r,n,i,c,o),!1===c.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){let e=tn(i,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,r,n){r.startsWith("--")?e.style.setProperty(r,n):e.style[r]=n}(r,n,e),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){return Number(this.animation.effect?.getComputedTiming?.().duration||0)/1e3}get time(){return(Number(this.animation.currentTime)||0)/1e3}set time(e){this.finishedTime=null,this.animation.currentTime=U(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){return(this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&tC())?(this.animation.timeline=e,l):r(this)}}let tU={anticipate:e3,backInOut:e2,circInOut:e6};class tM extends tF{constructor(e){!function(e){"string"==typeof e.ease&&e.ease in tU&&(e.ease=tU[e.ease])}(e),to(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){let{motionValue:r,onUpdate:n,onComplete:i,element:o,...a}=this.options;if(!r)return;if(void 0!==e)return void r.set(e);let s=new tu({...a,autoplay:!1}),u=U(this.finishedTime??this.time);r.setWithVelocity(s.sample(u-10).value,s.sample(u).value,10),s.stop()}}let tG=(e,r)=>"zIndex"!==r&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(eS.test(e)||"0"===e)&&!e.startsWith("url(")),tV=new Set(["opacity","clipPath","filter","transform"]),tB=tO(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class tz extends ta{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",keyframes:s,name:u,motionValue:c,element:l,...h}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=k.now();let d={autoplay:e,delay:r,type:n,repeat:i,repeatDelay:o,repeatType:a,name:u,motionValue:c,element:l,...h},f=l?.KeyframeResolver||tP;this.keyframeResolver=new f(s,(e,r,n)=>this.onKeyframesResolved(e,r,d,!n),u,c,l),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,r,n,i){this.keyframeResolver=void 0;let{name:o,type:a,velocity:s,delay:u,isHandoff:c,onUpdate:d}=n;this.resolvedAt=k.now(),!function(e,r,n,i){let o=e[0];if(null===o)return!1;if("display"===r||"visibility"===r)return!0;let a=e[e.length-1],s=tG(o,r),u=tG(a,r);return G(s===u,`You are trying to animate ${r} from "${o}" to "${a}". "${s?a:o}" is not an animatable value.`,"value-not-animatable"),!!s&&!!u&&(function(e){let r=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==r)return!0}(e)||("spring"===n||tj(n))&&i)}(e,o,a,s)&&((h.instantAnimations||!u)&&d?.(tn(e,n,r)),e[0]=e[e.length-1],n.duration=0,n.repeat=0);let f={startTime:i?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},p=!c&&function(e){let{motionValue:r,name:n,repeatDelay:i,repeatType:o,damping:a,type:s}=e;if(!(r?.owner?.current instanceof HTMLElement))return!1;let{onUpdate:u,transformTemplate:c}=r.owner.getProps();return tB()&&n&&tV.has(n)&&("transform"!==n||!c)&&!u&&!i&&"mirror"!==o&&0!==a&&"inertia"!==s}(f)?new tM({...f,element:f.motionValue.owner.current}):new tu(f);p.finished.then(()=>this.notifyFinished()).catch(l),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),tk=!0,tA(),t_(),tk=!1),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}let tq=e=>null!==e,tH={type:"spring",stiffness:500,damping:25,restSpeed:10},t$={type:"keyframes",duration:.8},tK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},tW=(e,r,n,i={},o,a)=>s=>{let u=c(i,e)||{},l=u.delay||i.delay||0,{elapsed:d=0}=i;d-=U(l);let f={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:r.getVelocity(),...u,delay:-d,onUpdate:e=>{r.set(e),u.onUpdate&&u.onUpdate(e)},onComplete:()=>{s(),u.onComplete&&u.onComplete()},name:e,motionValue:r,element:a?void 0:o};!function({when:e,delay:r,delayChildren:n,staggerChildren:i,staggerDirection:o,repeat:a,repeatType:s,repeatDelay:u,from:c,elapsed:l,...h}){return!!Object.keys(h).length}(u)&&Object.assign(f,((e,{keyframes:r})=>r.length>2?t$:w.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===r[1]?2*Math.sqrt(550):30,restSpeed:10}:tH:tK)(e,f)),f.duration&&(f.duration=U(f.duration)),f.repeatDelay&&(f.repeatDelay=U(f.repeatDelay)),void 0!==f.from&&(f.keyframes[0]=f.from);let p=!1;if(!1!==f.type&&(0!==f.duration||f.repeatDelay)||(f.duration=0,0===f.delay&&(p=!0)),(h.instantAnimations||h.skipAnimations)&&(p=!0,f.duration=0,f.delay=0),f.allowFlatten=!u.type&&!u.ease,p&&!a&&void 0!==r.get()){let e=function(e,{repeat:r,repeatType:n="loop"},i){let o=e.filter(tq),a=r&&"loop"!==n&&r%2==1?0:o.length-1;return o[a]}(f.keyframes,u);if(void 0!==e)return void m.update(()=>{f.onUpdate(e),f.onComplete()})}return u.isSync?new tu(f):new tz(f)};function tQ(e,r,{delay:n=0,transitionOverride:i,type:o}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:s,...l}=r;i&&(a=i);let h=[],d=o&&e.animationState&&e.animationState.getState()[o];for(let r in l){let i=e.getValue(r,e.latestValues[r]??null),o=l[r];if(void 0===o||d&&function({protectedKeys:e,needsAnimating:r},n){let i=e.hasOwnProperty(n)&&!0!==r[n];return r[n]=!1,i}(d,r))continue;let s={delay:n,...c(a||{},r)},u=i.get();if(void 0!==u&&!i.isAnimating&&!Array.isArray(o)&&o===u&&!s.velocity)continue;let f=!1;if(window.MotionHandoffAnimation){let n=e.props[D];if(n){let e=window.MotionHandoffAnimation(n,r,m);null!==e&&(s.startTime=e,f=!0)}}N(e,r),i.start(tW(r,i,o,e.shouldReduceMotion&&S.has(r)?{type:!1}:s,e,f));let p=i.animation;p&&h.push(p)}return s&&Promise.all(h).then(()=>{m.update(()=>{s&&function(e,r){let{transitionEnd:n={},transition:i={},...o}=u(e,r)||{};for(let r in o={...o,...n}){var a;let n=O(a=o[r])?a[a.length-1]||0:a;e.hasValue(r)?e.getValue(r).set(n):e.addValue(r,P(n))}}(e,s)})}),h}function tJ(e,r,n={}){let i=u(e,r,"exit"===n.type?e.presenceContext?.custom:void 0),{transition:o=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(o=n.transitionOverride);let a=i?()=>Promise.all(tQ(e,i,n)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(i=0)=>{let{delayChildren:a=0,staggerChildren:s,staggerDirection:u}=o;return function(e,r,n=0,i=0,o=0,a=1,s){let u=[],c=e.variantChildren.size,l=(c-1)*o,h="function"==typeof i,d=h?e=>i(e,c):1===a?(e=0)=>e*o:(e=0)=>l-e*o;return Array.from(e.variantChildren).sort(tY).forEach((e,o)=>{e.notify("AnimationStart",r),u.push(tJ(e,r,{...s,delay:n+(h?0:i)+d(o)}).then(()=>e.notify("AnimationComplete",r)))}),Promise.all(u)}(e,r,i,a,s,u,n)}:()=>Promise.resolve(),{when:c}=o;if(!c)return Promise.all([a(),s(n.delay)]);{let[e,r]="beforeChildren"===c?[a,s]:[s,a];return e().then(()=>r())}}function tY(e,r){return e.sortNodePosition(r)}function tX(e,r){if(!Array.isArray(r))return!1;let n=r.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(r[i]!==e[i])return!1;return!0}function tZ(e){return"string"==typeof e||Array.isArray(e)}let t0=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],t1=["initial",...t0],t2=t1.length,t3=[...t0].reverse(),t4=t0.length;function t5(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function t6(){return{animate:t5(!0),whileInView:t5(),whileHover:t5(),whileTap:t5(),whileDrag:t5(),whileFocus:t5(),exit:t5()}}class t8{constructor(e){this.isMounted=!1,this.node=e}update(){}}class t7 extends t8{constructor(e){super(e),e.animationState||(e.animationState=function(e){let r=r=>Promise.all(r.map(({animation:r,options:n})=>(function(e,r,n={}){let i;if(e.notify("AnimationStart",r),Array.isArray(r))i=Promise.all(r.map(r=>tJ(e,r,n)));else if("string"==typeof r)i=tJ(e,r,n);else{let o="function"==typeof r?u(e,r,n.custom):r;i=Promise.all(tQ(e,o,n))}return i.then(()=>{e.notify("AnimationComplete",r)})})(e,r,n))),n=t6(),i=!0,a=r=>(n,i)=>{let o=u(e,i,"exit"===r?e.presenceContext?.custom:void 0);if(o){let{transition:e,transitionEnd:r,...i}=o;n={...n,...i,...r}}return n};function s(s){let{props:c}=e,l=function e(r){if(!r)return;if(!r.isControllingVariants){let n=r.parent&&e(r.parent)||{};return void 0!==r.props.initial&&(n.initial=r.props.initial),n}let n={};for(let e=0;e<t2;e++){let i=t1[e],o=r.props[i];(tZ(o)||!1===o)&&(n[i]=o)}return n}(e.parent)||{},h=[],d=new Set,f={},p=1/0;for(let r=0;r<t4;r++){var m,g;let u=t3[r],y=n[u],v=void 0!==c[u]?c[u]:l[u],b=tZ(v),w=u===s?y.isActive:null;!1===w&&(p=r);let S=v===l[u]&&v!==c[u]&&b;if(S&&i&&e.manuallyAnimateOnMount&&(S=!1),y.protectedKeys={...f},!y.isActive&&null===w||!v&&!y.prevProp||o(v)||"boolean"==typeof v)continue;let x=(m=y.prevProp,"string"==typeof(g=v)?g!==m:!!Array.isArray(g)&&!tX(g,m)),E=x||u===s&&y.isActive&&!S&&b||r>p&&b,I=!1,T=Array.isArray(v)?v:[v],k=T.reduce(a(u),{});!1===w&&(k={});let{prevResolvedValues:_={}}=y,A={..._,...k},P=r=>{E=!0,d.has(r)&&(I=!0,d.delete(r)),y.needsAnimating[r]=!0;let n=e.getValue(r);n&&(n.liveStyle=!1)};for(let e in A){let r=k[e],n=_[e];if(!f.hasOwnProperty(e))(O(r)&&O(n)?tX(r,n):r===n)?void 0!==r&&d.has(e)?P(e):y.protectedKeys[e]=!0:null!=r?P(e):d.add(e)}y.prevProp=v,y.prevResolvedValues=k,y.isActive&&(f={...f,...k}),i&&e.blockInitialAnimation&&(E=!1);let C=!(S&&x)||I;E&&C&&h.push(...T.map(e=>({animation:e,options:{type:u}})))}if(d.size){let r={};if("boolean"!=typeof c.initial){let n=u(e,Array.isArray(c.initial)?c.initial[0]:c.initial);n&&n.transition&&(r.transition=n.transition)}d.forEach(n=>{let i=e.getBaseTarget(n),o=e.getValue(n);o&&(o.liveStyle=!0),r[n]=i??null}),h.push({animation:r})}let y=!!h.length;return i&&(!1===c.initial||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(y=!1),i=!1,y?r(h):Promise.resolve()}return{animateChanges:s,setActive:function(r,i){if(n[r].isActive===i)return Promise.resolve();e.variantChildren?.forEach(e=>e.animationState?.setActive(r,i)),n[r].isActive=i;let o=s(r);for(let e in n)n[e].protectedKeys={};return o},setAnimateFunction:function(n){r=n(e)},getState:()=>n,reset:()=>{n=t6(),i=!0}}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();o(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let t9=0;class re extends t8{constructor(){super(...arguments),this.id=t9++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;let i=this.node.animationState.setActive("exit",!e);r&&!e&&i.then(()=>{r(this.id)})}mount(){let{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}let rt={x:!1,y:!1};function rr(e,r,n,i={passive:!0}){return e.addEventListener(r,n,i),()=>e.removeEventListener(r,n)}let rn=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function ri(e){return{point:{x:e.pageX,y:e.pageY}}}function ro(e,r,n,i){return rr(e,r,e=>rn(e)&&n(e,ri(e)),i)}function ra({top:e,left:r,right:n,bottom:i}){return{x:{min:r,max:n},y:{min:e,max:i}}}function rs(e){return e.max-e.min}function ru(e,r,n,i=.5){e.origin=i,e.originPoint=eI(r.min,r.max,e.origin),e.scale=rs(n)/rs(r),e.translate=eI(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function rc(e,r,n,i){ru(e.x,r.x,n.x,i?i.originX:void 0),ru(e.y,r.y,n.y,i?i.originY:void 0)}function rl(e,r,n){e.min=n.min+r.min,e.max=e.min+rs(r)}function rh(e,r,n){e.min=r.min-n.min,e.max=e.min+rs(r)}function rd(e,r,n){rh(e.x,r.x,n.x),rh(e.y,r.y,n.y)}let rf=()=>({translate:0,scale:1,origin:0,originPoint:0}),rp=()=>({x:rf(),y:rf()}),rm=()=>({min:0,max:0}),rg=()=>({x:rm(),y:rm()});function ry(e){return[e("x"),e("y")]}function rv(e){return void 0===e||1===e}function rb({scale:e,scaleX:r,scaleY:n}){return!rv(e)||!rv(r)||!rv(n)}function rw(e){return rb(e)||rS(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function rS(e){var r,n;return(r=e.x)&&"0%"!==r||(n=e.y)&&"0%"!==n}function rx(e,r,n,i,o){return void 0!==o&&(e=i+o*(e-i)),i+n*(e-i)+r}function rE(e,r=0,n=1,i,o){e.min=rx(e.min,r,n,i,o),e.max=rx(e.max,r,n,i,o)}function rI(e,{x:r,y:n}){rE(e.x,r.translate,r.scale,r.originPoint),rE(e.y,n.translate,n.scale,n.originPoint)}function rT(e,r){e.min=e.min+r,e.max=e.max+r}function rk(e,r,n,i,o=.5){let a=eI(e.min,e.max,o);rE(e,r,n,a,i)}function r_(e,r){rk(e.x,r.x,r.scaleX,r.scale,r.originX),rk(e.y,r.y,r.scaleY,r.scale,r.originY)}function rA(e,r){return ra(function(e,r){if(!r)return e;let n=r({x:e.left,y:e.top}),i=r({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}(e.getBoundingClientRect(),r))}let rP=({current:e})=>e?e.ownerDocument.defaultView:null;function rO(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}let rC=(e,r)=>Math.abs(e-r);class rN{constructor(e,r,{transformPagePoint:n,contextWindow:i=window,dragSnapToOrigin:o=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let e=rR(this.lastMoveEventInfo,this.history),r=null!==this.startEvent,n=function(e,r){return Math.sqrt(rC(e.x,r.x)**2+rC(e.y,r.y)**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!r&&!n)return;let{point:i}=e,{timestamp:o}=y;this.history.push({...i,timestamp:o});let{onStart:a,onMove:s}=this.handlers;r||(a&&a(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),s&&s(this.lastMoveEvent,e)},this.handlePointerMove=(e,r)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=rL(r,this.transformPagePoint),m.update(this.updatePoint,!0)},this.handlePointerUp=(e,r)=>{this.end();let{onEnd:n,onSessionEnd:i,resumeAnimation:o}=this.handlers;if(this.dragSnapToOrigin&&o&&o(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let a=rR("pointercancel"===e.type?this.lastMoveEventInfo:rL(r,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,a),i&&i(e,a)},!rn(e))return;this.dragSnapToOrigin=o,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=a,this.contextWindow=i||window;let s=rL(ri(e),this.transformPagePoint),{point:u}=s,{timestamp:c}=y;this.history=[{...u,timestamp:c}];let{onSessionStart:l}=r;l&&l(e,rR(s,this.history)),this.removeListeners=j(ro(this.contextWindow,"pointermove",this.handlePointerMove),ro(this.contextWindow,"pointerup",this.handlePointerUp),ro(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),g(this.updatePoint)}}function rL(e,r){return r?{point:r(e.point)}:e}function rD(e,r){return{x:e.x-r.x,y:e.y-r.y}}function rR({point:e},r){return{point:e,delta:rD(e,rj(r)),offset:rD(e,r[0]),velocity:function(e,r){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null,o=rj(e);for(;n>=0&&(i=e[n],!(o.timestamp-i.timestamp>U(.1)));)n--;if(!i)return{x:0,y:0};let a=(o.timestamp-i.timestamp)/1e3;if(0===a)return{x:0,y:0};let s={x:(o.x-i.x)/a,y:(o.y-i.y)/a};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}(r,.1)}}function rj(e){return e[e.length-1]}function rF(e,r,n){return{min:void 0!==r?e.min+r:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function rU(e,r){let n=r.min-e.min,i=r.max-e.max;return r.max-r.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function rM(e,r,n){return{min:rG(e,r),max:rG(e,n)}}function rG(e,r){return"number"==typeof e?e:e[r]||0}let rV=new WeakMap;class rB{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=rg(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){let{presenceContext:i}=this.visualElement;if(i&&!1===i.isPresent)return;let o=e=>{let{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(ri(e).point)},a=(e,r)=>{let{drag:n,dragPropagation:i,onDragStart:o}=this.getProps();if(n&&!i&&(this.openDragLock&&this.openDragLock(),this.openDragLock=function(e){if("x"===e||"y"===e)if(rt[e])return null;else return rt[e]=!0,()=>{rt[e]=!1};return rt.x||rt.y?null:(rt.x=rt.y=!0,()=>{rt.x=rt.y=!1})}(n),!this.openDragLock))return;this.latestPointerEvent=e,this.latestPanInfo=r,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ry(e=>{let r=this.getAxisMotionValue(e).get()||0;if(ea.test(r)){let{projection:n}=this.visualElement;if(n&&n.layout){let i=n.layout.layoutBox[e];i&&(r=rs(i)*(parseFloat(r)/100))}}this.originPoint[e]=r}),o&&m.postRender(()=>o(e,r)),N(this.visualElement,"transform");let{animationState:a}=this.visualElement;a&&a.setActive("whileDrag",!0)},s=(e,r)=>{this.latestPointerEvent=e,this.latestPanInfo=r;let{dragPropagation:n,dragDirectionLock:i,onDirectionLock:o,onDrag:a}=this.getProps();if(!n&&!this.openDragLock)return;let{offset:s}=r;if(i&&null===this.currentDirection){this.currentDirection=function(e,r=10){let n=null;return Math.abs(e.y)>r?n="y":Math.abs(e.x)>r&&(n="x"),n}(s),null!==this.currentDirection&&o&&o(this.currentDirection);return}this.updateAxis("x",r.point,s),this.updateAxis("y",r.point,s),this.visualElement.render(),a&&a(e,r)},u=(e,r)=>{this.latestPointerEvent=e,this.latestPanInfo=r,this.stop(e,r),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>ry(e=>"paused"===this.getAnimationState(e)&&this.getAxisMotionValue(e).animation?.play()),{dragSnapToOrigin:l}=this.getProps();this.panSession=new rN(e,{onSessionStart:o,onStart:a,onMove:s,onSessionEnd:u,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:l,distanceThreshold:n,contextWindow:rP(this.visualElement)})}stop(e,r){let n=e||this.latestPointerEvent,i=r||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!i||!n)return;let{velocity:a}=i;this.startAnimation(a);let{onDragEnd:s}=this.getProps();s&&m.postRender(()=>s(n,i))}cancel(){this.isDragging=!1;let{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){let{drag:i}=this.getProps();if(!n||!rz(e,i,this.currentDirection))return;let o=this.getAxisMotionValue(e),a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=function(e,{min:r,max:n},i){return void 0!==r&&e<r?e=i?eI(r,e,i.min):Math.max(e,r):void 0!==n&&e>n&&(e=i?eI(n,e,i.max):Math.min(e,n)),e}(a,this.constraints[e],this.elastic[e])),o.set(a)}resolveConstraints(){let{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&rO(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=function(e,{top:r,left:n,bottom:i,right:o}){return{x:rF(e.x,n,o),y:rF(e.y,r,i)}}(n.layoutBox,e):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:rM(e,"left","right"),y:rM(e,"top","bottom")}}(r),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&ry(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,r){let n={};return void 0!==r.min&&(n.min=r.min-e.min),void 0!==r.max&&(n.max=r.max-e.min),n}(n.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){var e;let{dragConstraints:r,onMeasureDragConstraints:n}=this.getProps();if(!r||!rO(r))return!1;let i=r.current;V(null!==i,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");let{projection:o}=this.visualElement;if(!o||!o.layout)return!1;let a=function(e,r,n){let i=rA(e,n),{scroll:o}=r;return o&&(rT(i.x,o.offset.x),rT(i.y,o.offset.y)),i}(i,o.root,this.visualElement.getTransformPagePoint()),s=(e=o.layout.layoutBox,{x:rU(e.x,a.x),y:rU(e.y,a.y)});if(n){let e=n(function({x:e,y:r}){return{top:r.min,right:e.max,bottom:r.max,left:e.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=ra(e))}return s}startAnimation(e){let{drag:r,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:s}=this.getProps(),u=this.constraints||{};return Promise.all(ry(s=>{if(!rz(s,r,this.currentDirection))return;let c=u&&u[s]||{};a&&(c={min:0,max:0});let l={type:"inertia",velocity:n?e[s]:0,bounceStiffness:i?200:1e6,bounceDamping:i?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...o,...c};return this.startAxisValueAnimation(s,l)})).then(s)}startAxisValueAnimation(e,r){let n=this.getAxisMotionValue(e);return N(this.visualElement,e),n.start(tW(e,n,0,r,this.visualElement,!1))}stopAnimation(){ry(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ry(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){let r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps();return n[r]||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){ry(r=>{let{drag:n}=this.getProps();if(!rz(r,n,this.currentDirection))return;let{projection:i}=this.visualElement,o=this.getAxisMotionValue(r);if(i&&i.layout){let{min:n,max:a}=i.layout.layoutBox[r];o.set(e[r]-eI(n,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!rO(r)||!n||!this.constraints)return;this.stopAnimation();let i={x:0,y:0};ry(e=>{let r=this.getAxisMotionValue(e);if(r&&!1!==this.constraints){let n=r.get();i[e]=function(e,r){let n=.5,i=rs(e),o=rs(r);return o>i?n=te(r.min,r.max-i,e.min):i>o&&(n=te(e.min,e.max-o,r.min)),F(0,1,n)}({min:n,max:n},this.constraints[e])}});let{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ry(r=>{if(!rz(r,e,null))return;let n=this.getAxisMotionValue(r),{min:o,max:a}=this.constraints[r];n.set(eI(o,a,i[r]))})}addListeners(){if(!this.visualElement.current)return;rV.set(this.visualElement,this);let e=ro(this.visualElement.current,"pointerdown",e=>{let{drag:r,dragListener:n=!0}=this.getProps();r&&n&&this.start(e)}),r=()=>{let{dragConstraints:e}=this.getProps();rO(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",r);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),m.read(r);let o=rr(window,"resize",()=>this.scalePositionWithinConstraints()),a=n.addEventListener("didUpdate",({delta:e,hasLayoutChanged:r})=>{this.isDragging&&r&&(ry(r=>{let n=this.getAxisMotionValue(r);n&&(this.originPoint[r]+=e[r].translate,n.set(n.get()+e[r].translate))}),this.visualElement.render())});return()=>{o(),e(),i(),a&&a()}}getProps(){let e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:a=.35,dragMomentum:s=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:a,dragMomentum:s}}}function rz(e,r,n){return(!0===r||r===e)&&(null===n||n===e)}class rq extends t8{constructor(e){super(e),this.removeGroupControls=l,this.removeListeners=l,this.controls=new rB(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||l}unmount(){this.removeGroupControls(),this.removeListeners()}}let rH=e=>(r,n)=>{e&&m.postRender(()=>e(r,n))};class r$ extends t8{constructor(){super(...arguments),this.removePointerDownListener=l}onPointerDown(e){this.session=new rN(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:rP(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:rH(e),onStart:rH(r),onMove:n,onEnd:(e,r)=>{delete this.session,i&&m.postRender(()=>i(e,r))}}}mount(){this.removePointerDownListener=ro(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}var rK,rW,rQ=n(37876);let{schedule:rJ}=p(queueMicrotask,!1);var rY=n(14232),rX=n(83885),rZ=n(5048);let r0=(0,rY.createContext)({}),r1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function r2(e,r){return r.max===r.min?0:e/(r.max-r.min)*100}let r3={correct:(e,r)=>{if(!r.target)return e;if("string"==typeof e)if(!es.test(e))return e;else e=parseFloat(e);let n=r2(e,r.target.x),i=r2(e,r.target.y);return`${n}% ${i}%`}},r4={},r5=!1;class r6 extends rY.Component{componentDidMount(){let{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=e;for(let e in r7)r4[e]=r7[e],z(e)&&(r4[e].isCSSVariable=!0);o&&(r.group&&r.group.add(o),n&&n.register&&i&&n.register(o),r5&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),r1.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:r,visualElement:n,drag:i,isPresent:o}=this.props,{projection:a}=n;return a&&(a.isPresent=o,r5=!0,i||e.layoutDependency!==r||void 0===r||e.isPresent!==o?a.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?a.promote():a.relegate()||m.postRender(()=>{let e=a.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),rJ.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function r8(e){let[r,n]=(0,rX.xQ)(),i=(0,rY.useContext)(rZ.L);return(0,rQ.jsx)(r6,{...e,layoutGroup:i,switchLayoutGroup:(0,rY.useContext)(r0),isPresent:r,safeToRemove:n})}let r7={borderRadius:{...r3,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:r3,borderTopRightRadius:r3,borderBottomLeftRadius:r3,borderBottomRightRadius:r3,boxShadow:{correct:(e,{treeScale:r,projectionDelta:n})=>{let i=eS.parse(e);if(i.length>5)return e;let o=eS.createTransformer(e),a=+("number"!=typeof i[0]),s=n.x.scale*r.x,u=n.y.scale*r.y;i[0+a]/=s,i[1+a]/=u;let c=eI(s,u,.5);return"number"==typeof i[2+a]&&(i[2+a]/=c),"number"==typeof i[3+a]&&(i[3+a]/=c),o(i)}}};var r9=n(97594);function ne(e){return(0,r9.G)(e)&&"ownerSVGElement"in e}let nt=(e,r)=>e.depth-r.depth;class nr{constructor(){this.children=[],this.isDirty=!1}add(e){x(this.children,e),this.isDirty=!0}remove(e){E(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(nt),this.isDirty=!1,this.children.forEach(e)}}function nn(e){return C(e)?e.get():e}let ni=["TopLeft","TopRight","BottomLeft","BottomRight"],no=ni.length,na=e=>"string"==typeof e?parseFloat(e):e,ns=e=>"number"==typeof e||es.test(e);function nu(e,r){return void 0!==e[r]?e[r]:e.borderRadius}let nc=nh(0,.5,e5),nl=nh(.5,.95,l);function nh(e,r,n){return i=>i<e?0:i>r?1:n(te(e,r,i))}function nd(e,r){e.min=r.min,e.max=r.max}function nf(e,r){nd(e.x,r.x),nd(e.y,r.y)}function np(e,r){e.translate=r.translate,e.scale=r.scale,e.originPoint=r.originPoint,e.origin=r.origin}function nm(e,r,n,i,o){return e-=r,e=i+1/n*(e-i),void 0!==o&&(e=i+1/o*(e-i)),e}function ng(e,r,[n,i,o],a,s){!function(e,r=0,n=1,i=.5,o,a=e,s=e){if(ea.test(r)&&(r=parseFloat(r),r=eI(s.min,s.max,r/100)-s.min),"number"!=typeof r)return;let u=eI(a.min,a.max,i);e===a&&(u-=r),e.min=nm(e.min,r,n,u,o),e.max=nm(e.max,r,n,u,o)}(e,r[n],r[i],r[o],r.scale,a,s)}let ny=["x","scaleX","originX"],nv=["y","scaleY","originY"];function nb(e,r,n,i){ng(e.x,r,ny,n?n.x:void 0,i?i.x:void 0),ng(e.y,r,nv,n?n.y:void 0,i?i.y:void 0)}function nw(e){return 0===e.translate&&1===e.scale}function nS(e){return nw(e.x)&&nw(e.y)}function nx(e,r){return e.min===r.min&&e.max===r.max}function nE(e,r){return Math.round(e.min)===Math.round(r.min)&&Math.round(e.max)===Math.round(r.max)}function nI(e,r){return nE(e.x,r.x)&&nE(e.y,r.y)}function nT(e){return rs(e.x)/rs(e.y)}function nk(e,r){return e.translate===r.translate&&e.scale===r.scale&&e.originPoint===r.originPoint}class n_{constructor(){this.members=[]}add(e){x(this.members,e),e.scheduleRender()}remove(e){if(E(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let r,n=this.members.findIndex(r=>e===r);if(0===n)return!1;for(let e=n;e>=0;e--){let n=this.members[e];if(!1!==n.isPresent){r=n;break}}return!!r&&(this.promote(r),!0)}promote(e,r){let n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:i}=e.options;!1===i&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let nA={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},nP=["","X","Y","Z"],nO=0;function nC(e,r,n,i){let{latestValues:o}=r;o[e]&&(n[e]=o[e],r.setStaticValue(e,0),i&&(i[e]=0))}function nN({attachResizeListener:e,defaultParent:r,measureScroll:n,checkIsScrollRoot:i,resetTransform:o}){return class{constructor(e={},n=r?.()){this.id=nO++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,f.value&&(nA.nodes=nA.calculatedTargetDeltas=nA.calculatedProjections=0),this.nodes.forEach(nR),this.nodes.forEach(nB),this.nodes.forEach(nz),this.nodes.forEach(nj),f.addProjectionMetrics&&f.addProjectionMetrics(nA)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=n?n.root||n:this,this.path=n?[...n.path,n]:[],this.parent=n,this.depth=n?n.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new nr)}addEventListener(e,r){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new I),this.eventHandlers.get(e).add(r)}notifyListeners(e,...r){let n=this.eventHandlers.get(e);n&&n.notify(...r)}hasListeners(e){return this.eventHandlers.has(e)}mount(r){if(this.instance)return;this.isSVG=ne(r)&&!(ne(r)&&"svg"===r.tagName),this.instance=r;let{layoutId:n,layout:i,visualElement:o}=this.options;if(o&&!o.current&&o.mount(r),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(i||n)&&(this.isLayoutDirty=!0),e){let n,i=0,o=()=>this.root.updateBlockedByResize=!1;m.read(()=>{i=window.innerWidth}),e(r,()=>{let e=window.innerWidth;e!==i&&(i=e,this.root.updateBlockedByResize=!0,n&&n(),n=function(e,r){let n=k.now(),i=({timestamp:r})=>{let o=r-n;o>=250&&(g(i),e(o-250))};return m.setup(i,!0),()=>g(i)}(o,250),r1.hasAnimatedSinceResize&&(r1.hasAnimatedSinceResize=!1,this.nodes.forEach(nV)))})}n&&this.root.registerSharedNode(n,this),!1!==this.options.animate&&o&&(n||i)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:r,hasRelativeLayoutChanged:n,layout:i})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let a=this.options.transition||o.getDefaultTransition()||nQ,{onLayoutAnimationStart:s,onLayoutAnimationComplete:u}=o.getProps(),l=!this.targetLayout||!nI(this.targetLayout,i),h=!r&&n;if(this.options.layoutRoot||this.resumeFrom||h||r&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let r={...c(a,"layout"),onPlay:s,onComplete:u};(o.shouldReduceMotion||this.options.layoutRoot)&&(r.delay=0,r.type=!1),this.startAnimation(r),this.setAnimationOrigin(e,h)}else r||nV(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),g(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(nq),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;let{visualElement:n}=r.options;if(!n)return;let i=n.props[D];if(window.MotionHasOptimisedAnimation(i,"transform")){let{layout:e,layoutId:n}=r.options;window.MotionCancelOptimisedAnimation(i,"transform",m,!(e||n))}let{parent:o}=r;o&&!o.hasCheckedOptimisedAppear&&e(o)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let r=this.path[e];r.shouldResetTransform=!0,r.updateScroll("snapshot"),r.options.layoutRoot&&r.willUpdate(!1)}let{layoutId:r,layout:n}=this.options;if(void 0===r&&!n)return;let i=this.getTransformTemplate();this.prevTransformTemplateValue=i?i(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(nU);return}if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(nM);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(nG),this.nodes.forEach(nL),this.nodes.forEach(nD)):this.nodes.forEach(nM),this.clearAllSnapshots();let e=k.now();y.delta=F(0,1e3/60,e-y.timestamp),y.timestamp=e,y.isProcessing=!0,v.update.process(y),v.preRender.process(y),v.render.process(y),y.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rJ.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(nF),this.sharedNodes.forEach(nH)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,m.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){m.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||rs(this.snapshot.measuredBox.x)||rs(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutCorrected=rg(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:r}=this.options;r&&r.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let r=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(r=!1),r&&this.instance){let r=i(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:r,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:r}}}resetTransform(){if(!o)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,r=this.projectionDelta&&!nS(this.projectionDelta),n=this.getTransformTemplate(),i=n?n(this.latestValues,""):void 0,a=i!==this.prevTransformTemplateValue;e&&this.instance&&(r||rw(this.latestValues)||a)&&(o(this.instance,i),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var r;let n=this.measurePageBox(),i=this.removeElementScroll(n);return e&&(i=this.removeTransform(i)),nX((r=i).x),nX(r.y),{animationId:this.root.animationId,measuredBox:n,layoutBox:i,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:e}=this.options;if(!e)return rg();let r=e.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(n0))){let{scroll:e}=this.root;e&&(rT(r.x,e.offset.x),rT(r.y,e.offset.y))}return r}removeElementScroll(e){let r=rg();if(nf(r,e),this.scroll?.wasRoot)return r;for(let n=0;n<this.path.length;n++){let i=this.path[n],{scroll:o,options:a}=i;i!==this.root&&o&&a.layoutScroll&&(o.wasRoot&&nf(r,e),rT(r.x,o.offset.x),rT(r.y,o.offset.y))}return r}applyTransform(e,r=!1){let n=rg();nf(n,e);for(let e=0;e<this.path.length;e++){let i=this.path[e];!r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&r_(n,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),rw(i.latestValues)&&r_(n,i.latestValues)}return rw(this.latestValues)&&r_(n,this.latestValues),n}removeTransform(e){let r=rg();nf(r,e);for(let e=0;e<this.path.length;e++){let n=this.path[e];if(!n.instance||!rw(n.latestValues))continue;rb(n.latestValues)&&n.updateSnapshot();let i=rg();nf(i,n.measurePageBox()),nb(r,n.latestValues,n.snapshot?n.snapshot.layoutBox:void 0,i)}return rw(this.latestValues)&&nb(r,this.latestValues),r}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==y.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){let r=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=r.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=r.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=r.isSharedProjectionDirty);let n=!!this.resumingFrom||this!==r;if(!(e||n&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:i,layoutId:o}=this.options;if(this.layout&&(i||o)){if(this.resolvedRelativeTargetAt=y.timestamp,!this.targetDelta&&!this.relativeTarget){let e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rg(),this.relativeTargetOrigin=rg(),rd(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),nf(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if(this.target||(this.target=rg(),this.targetWithTransforms=rg()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target){var a,s,u;this.forceRelativeParentToResolveTarget(),a=this.target,s=this.relativeTarget,u=this.relativeParent.target,rl(a.x,s.x,u.x),rl(a.y,s.y,u.y)}else this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):nf(this.target,this.layout.layoutBox),rI(this.target,this.targetDelta)):nf(this.target,this.layout.layoutBox);if(this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let e=this.getClosestProjectingParent();e&&!!e.resumingFrom==!!this.resumingFrom&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rg(),this.relativeTargetOrigin=rg(),rd(this.relativeTargetOrigin,this.target,e.target),nf(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}f.value&&nA.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||rb(this.parent.latestValues)||rS(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){let e=this.getLead(),r=!!this.resumingFrom||this!==e,n=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(n=!1),r&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(n=!1),this.resolvedRelativeTargetAt===y.timestamp&&(n=!1),n)return;let{layout:i,layoutId:o}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(i||o))return;nf(this.layoutCorrected,this.layout.layoutBox);let a=this.treeScale.x,s=this.treeScale.y;!function(e,r,n,i=!1){let o,a,s=n.length;if(s){r.x=r.y=1;for(let u=0;u<s;u++){a=(o=n[u]).projectionDelta;let{visualElement:s}=o.options;(!s||!s.props.style||"contents"!==s.props.style.display)&&(i&&o.options.layoutScroll&&o.scroll&&o!==o.root&&r_(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(r.x*=a.x.scale,r.y*=a.y.scale,rI(e,a)),i&&rw(o.latestValues)&&r_(e,o.latestValues))}r.x<1.0000000000001&&r.x>.999999999999&&(r.x=1),r.y<1.0000000000001&&r.y>.999999999999&&(r.y=1)}}(this.layoutCorrected,this.treeScale,this.path,r),e.layout&&!e.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(e.target=e.layout.layoutBox,e.targetWithTransforms=rg());let{target:u}=e;if(!u){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(np(this.prevProjectionDelta.x,this.projectionDelta.x),np(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),rc(this.projectionDelta,this.layoutCorrected,u,this.latestValues),this.treeScale.x===a&&this.treeScale.y===s&&nk(this.projectionDelta.x,this.prevProjectionDelta.x)&&nk(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",u)),f.value&&nA.calculatedProjections++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.visualElement?.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=rp(),this.projectionDelta=rp(),this.projectionDeltaWithTransform=rp()}setAnimationOrigin(e,r=!1){let n,i=this.snapshot,o=i?i.latestValues:{},a={...this.latestValues},s=rp();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!r;let u=rg(),c=(i?i.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),h=!l||l.members.length<=1,d=!!(c&&!h&&!0===this.options.crossfade&&!this.path.some(nW));this.animationProgress=0,this.mixTargetDelta=r=>{let i=r/1e3;if(n$(s.x,e.x,i),n$(s.y,e.y,i),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var l,f,p,m,g,y;rd(u,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,m=this.relativeTargetOrigin,g=u,y=i,nK(p.x,m.x,g.x,y),nK(p.y,m.y,g.y,y),n&&(l=this.relativeTarget,f=n,nx(l.x,f.x)&&nx(l.y,f.y))&&(this.isProjectionDirty=!1),n||(n=rg()),nf(n,this.relativeTarget)}c&&(this.animationValues=a,function(e,r,n,i,o,a){o?(e.opacity=eI(0,n.opacity??1,nc(i)),e.opacityExit=eI(r.opacity??1,0,nl(i))):a&&(e.opacity=eI(r.opacity??1,n.opacity??1,i));for(let o=0;o<no;o++){let a=`border${ni[o]}Radius`,s=nu(r,a),u=nu(n,a);(void 0!==s||void 0!==u)&&(s||(s=0),u||(u=0),0===s||0===u||ns(s)===ns(u)?(e[a]=Math.max(eI(na(s),na(u),i),0),(ea.test(u)||ea.test(s))&&(e[a]+="%")):e[a]=u)}(r.rotate||n.rotate)&&(e.rotate=eI(r.rotate||0,n.rotate||0,i))}(a,o,this.latestValues,i,d,h)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=i},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(g(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=m.update(()=>{r1.hasAnimatedSinceResize=!0,M.layout++,this.motionValue||(this.motionValue=P(0)),this.currentAnimation=function(e,r,n){let i=C(e)?e:P(e);return i.start(tW("",i,r,n)),i.animation}(this.motionValue,[0,1e3],{...e,velocity:0,isSync:!0,onUpdate:r=>{this.mixTargetDelta(r),e.onUpdate&&e.onUpdate(r)},onStop:()=>{M.layout--},onComplete:()=>{M.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:r,target:n,layout:i,latestValues:o}=e;if(r&&n&&i){if(this!==e&&this.layout&&i&&nZ(this.options.animationType,this.layout.layoutBox,i.layoutBox)){n=this.target||rg();let r=rs(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+r;let i=rs(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+i}nf(r,n),r_(r,o),rc(this.projectionDeltaWithTransform,this.layoutCorrected,r,o)}}registerSharedNode(e,r){this.sharedNodes.has(e)||this.sharedNodes.set(e,new n_),this.sharedNodes.get(e).add(r);let n=r.options.initialPromotionConfig;r.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(r):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){let{layoutId:e}=this.options;return e&&this.getStack()?.lead||this}getPrevLead(){let{layoutId:e}=this.options;return e?this.getStack()?.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:r,preserveFollowOpacity:n}={}){let i=this.getStack();i&&i.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),r&&this.setOptions({transition:r})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let r=!1,{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(r=!0),!r)return;let i={};n.z&&nC("z",e,i,this.animationValues);for(let r=0;r<nP.length;r++)nC(`rotate${nP[r]}`,e,i,this.animationValues),nC(`skew${nP[r]}`,e,i,this.animationValues);for(let r in e.render(),i)e.setStaticValue(r,i[r]),this.animationValues&&(this.animationValues[r]=i[r]);e.scheduleRender()}applyProjectionStyles(e,r){if(!this.instance||this.isSVG)return;if(!this.isVisible){e.visibility="hidden";return}let n=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=nn(r?.pointerEvents)||"",e.transform=n?n(this.latestValues,""):"none";return}let i=this.getLead();if(!this.projectionDelta||!this.layout||!i.target){this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=nn(r?.pointerEvents)||""),this.hasProjected&&!rw(this.latestValues)&&(e.transform=n?n({},""):"none",this.hasProjected=!1);return}e.visibility="";let o=i.animationValues||i.latestValues;this.applyTransformsToTarget();let a=function(e,r,n){let i="",o=e.x.translate/r.x,a=e.y.translate/r.y,s=n?.z||0;if((o||a||s)&&(i=`translate3d(${o}px, ${a}px, ${s}px) `),(1!==r.x||1!==r.y)&&(i+=`scale(${1/r.x}, ${1/r.y}) `),n){let{transformPerspective:e,rotate:r,rotateX:o,rotateY:a,skewX:s,skewY:u}=n;e&&(i=`perspective(${e}px) ${i}`),r&&(i+=`rotate(${r}deg) `),o&&(i+=`rotateX(${o}deg) `),a&&(i+=`rotateY(${a}deg) `),s&&(i+=`skewX(${s}deg) `),u&&(i+=`skewY(${u}deg) `)}let u=e.x.scale*r.x,c=e.y.scale*r.y;return(1!==u||1!==c)&&(i+=`scale(${u}, ${c})`),i||"none"}(this.projectionDeltaWithTransform,this.treeScale,o);n&&(a=n(o,a)),e.transform=a;let{x:s,y:u}=this.projectionDelta;for(let r in e.transformOrigin=`${100*s.origin}% ${100*u.origin}% 0`,i.animationValues?e.opacity=i===this?o.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:e.opacity=i===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0,r4){if(void 0===o[r])continue;let{correct:n,applyTo:s,isCSSVariable:u}=r4[r],c="none"===a?o[r]:n(o[r],i);if(s){let r=s.length;for(let n=0;n<r;n++)e[s[n]]=c}else u?this.options.visualElement.renderState.vars[r]=c:e[r]=c}this.options.layoutId&&(e.pointerEvents=i===this?nn(r?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>e.currentAnimation?.stop()),this.root.nodes.forEach(nU),this.root.sharedNodes.clear()}}}function nL(e){e.updateLayout()}function nD(e){let r=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){let{layoutBox:n,measuredBox:i}=e.layout,{animationType:o}=e.options,a=r.source!==e.layout.source;"size"===o?ry(e=>{let i=a?r.measuredBox[e]:r.layoutBox[e],o=rs(i);i.min=n[e].min,i.max=i.min+o}):nZ(o,r.layoutBox,n)&&ry(i=>{let o=a?r.measuredBox[i]:r.layoutBox[i],s=rs(n[i]);o.max=o.min+s,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[i].max=e.relativeTarget[i].min+s)});let s=rp();rc(s,n,r.layoutBox);let u=rp();a?rc(u,e.applyTransform(i,!0),r.measuredBox):rc(u,n,r.layoutBox);let c=!nS(s),l=!1;if(!e.resumeFrom){let i=e.getClosestProjectingParent();if(i&&!i.resumeFrom){let{snapshot:o,layout:a}=i;if(o&&a){let s=rg();rd(s,r.layoutBox,o.layoutBox);let u=rg();rd(u,n,a.layoutBox),nI(s,u)||(l=!0),i.options.layoutRoot&&(e.relativeTarget=u,e.relativeTargetOrigin=s,e.relativeParent=i)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:u,layoutDelta:s,hasLayoutChanged:c,hasRelativeLayoutChanged:l})}else if(e.isLead()){let{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function nR(e){f.value&&nA.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function nj(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function nF(e){e.clearSnapshot()}function nU(e){e.clearMeasurements()}function nM(e){e.isLayoutDirty=!1}function nG(e){let{visualElement:r}=e.options;r&&r.getProps().onBeforeLayoutMeasure&&r.notify("BeforeLayoutMeasure"),e.resetTransform()}function nV(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function nB(e){e.resolveTargetDelta()}function nz(e){e.calcProjection()}function nq(e){e.resetSkewAndRotation()}function nH(e){e.removeLeadSnapshot()}function n$(e,r,n){e.translate=eI(r.translate,0,n),e.scale=eI(r.scale,1,n),e.origin=r.origin,e.originPoint=r.originPoint}function nK(e,r,n,i){e.min=eI(r.min,n.min,i),e.max=eI(r.max,n.max,i)}function nW(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let nQ={duration:.45,ease:[.4,0,.1,1]},nJ=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),nY=nJ("applewebkit/")&&!nJ("chrome/")?Math.round:l;function nX(e){e.min=nY(e.min),e.max=nY(e.max)}function nZ(e,r,n){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(nT(r)-nT(n)))}function n0(e){return e!==e.root&&e.scroll?.wasRoot}let n1=nN({attachResizeListener:(e,r)=>rr(e,"resize",r),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),n2={current:void 0},n3=nN({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!n2.current){let e=new n1({});e.mount(window),e.setOptions({layoutScroll:!0}),n2.current=e}return n2.current},resetTransform:(e,r)=>{e.style.transform=void 0!==r?r:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function n4(e,r){let n=function(e,r,n){if(e instanceof EventTarget)return[e];if("string"==typeof e){let r=document,n=(void 0)??r.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}(e),i=new AbortController;return[n,{passive:!0,...r,signal:i.signal},()=>i.abort()]}function n5(e){return!("touch"===e.pointerType||rt.x||rt.y)}function n6(e,r,n){let{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover","Start"===n);let o=i["onHover"+n];o&&m.postRender(()=>o(r,ri(r)))}class n8 extends t8{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,r,n={}){let[i,o,a]=n4(e,n),s=e=>{if(!n5(e))return;let{target:n}=e,i=r(n,e);if("function"!=typeof i||!n)return;let a=e=>{n5(e)&&(i(e),n.removeEventListener("pointerleave",a))};n.addEventListener("pointerleave",a,o)};return i.forEach(e=>{e.addEventListener("pointerenter",s,o)}),a}(e,(e,r)=>(n6(this.node,r,"Start"),e=>n6(this.node,e,"End"))))}unmount(){}}class n7 extends t8{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(r){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=j(rr(this.node.current,"focus",()=>this.onFocus()),rr(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}var n9=n(7990);let ie=(e,r)=>!!r&&(e===r||ie(e,r.parentElement)),it=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),ir=new WeakSet;function ii(e){return r=>{"Enter"===r.key&&e(r)}}function io(e,r){e.dispatchEvent(new PointerEvent("pointer"+r,{isPrimary:!0,bubbles:!0}))}function ia(e){return rn(e)&&!(rt.x||rt.y)}function is(e,r,n){let{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap","Start"===n);let o=i["onTap"+("End"===n?"":n)];o&&m.postRender(()=>o(r,ri(r)))}class iu extends t8{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,r,n={}){let[i,o,a]=n4(e,n),s=e=>{let i=e.currentTarget;if(!ia(e))return;ir.add(i);let a=r(i,e),s=(e,r)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",c),ir.has(i)&&ir.delete(i),ia(e)&&"function"==typeof a&&a(e,{success:r})},u=e=>{s(e,i===window||i===document||n.useGlobalTarget||ie(i,e.target))},c=e=>{s(e,!1)};window.addEventListener("pointerup",u,o),window.addEventListener("pointercancel",c,o)};return i.forEach(e=>{((n.useGlobalTarget?window:e).addEventListener("pointerdown",s,o),(0,n9.s)(e))&&(e.addEventListener("focus",e=>((e,r)=>{let n=e.currentTarget;if(!n)return;let i=ii(()=>{if(ir.has(n))return;io(n,"down");let e=ii(()=>{io(n,"up")});n.addEventListener("keyup",e,r),n.addEventListener("blur",()=>io(n,"cancel"),r)});n.addEventListener("keydown",i,r),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),r)})(e,o)),it.has(e.tagName)||-1!==e.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),a}(e,(e,r)=>(is(this.node,r,"Start"),(e,{success:r})=>is(this.node,e,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}let ic=new WeakMap,il=new WeakMap,ih=e=>{let r=ic.get(e.target);r&&r(e)},id=e=>{e.forEach(ih)},ip={some:0,all:1};class im extends t8{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:o}=e,a={root:r?r.current:void 0,rootMargin:n,threshold:"number"==typeof i?i:ip[i]},s=e=>{let{isIntersecting:r}=e;if(this.isInView===r||(this.isInView=r,o&&!r&&this.hasEnteredView))return;r&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",r);let{onViewportEnter:n,onViewportLeave:i}=this.node.getProps(),a=r?n:i;a&&a(e)};var u=this.node.current;let c=function({root:e,...r}){let n=e||document;il.has(n)||il.set(n,{});let i=il.get(n),o=JSON.stringify(r);return i[o]||(i[o]=new IntersectionObserver(id,{root:e,...r})),i[o]}(a);return ic.set(u,s),c.observe(u),()=>{ic.delete(u),c.unobserve(u)}}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:r}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:r={}}={}){return n=>e[n]!==r[n]}(e,r))&&this.startObserver()}unmount(){}}let ig=(0,rY.createContext)({strict:!1});var iy=n(39751);let iv=(0,rY.createContext)({});function ib(e){return o(e.animate)||t1.some(r=>tZ(e[r]))}function iw(e){return!!(ib(e)||e.variants)}function iS(e){return Array.isArray(e)?e.join(" "):e}var ix=n(2205);let iE={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},iI={};for(let e in iE)iI[e]={isEnabled:r=>iE[e].some(e=>!!r[e])};let iT=Symbol.for("motionComponentSymbol");var ik=n(3866),i_=n(50181);function iA(e,{layout:r,layoutId:n}){return w.has(e)||e.startsWith("origin")||(r||void 0!==n)&&(!!r4[e]||"opacity"===e)}let iP=(e,r)=>r&&"number"==typeof e?r.transform(e):e,iO={...K,transform:Math.round},iC={borderWidth:es,borderTopWidth:es,borderRightWidth:es,borderBottomWidth:es,borderLeftWidth:es,borderRadius:es,radius:es,borderTopLeftRadius:es,borderTopRightRadius:es,borderBottomRightRadius:es,borderBottomLeftRadius:es,width:es,maxWidth:es,height:es,maxHeight:es,top:es,right:es,bottom:es,left:es,padding:es,paddingTop:es,paddingRight:es,paddingBottom:es,paddingLeft:es,margin:es,marginTop:es,marginRight:es,marginBottom:es,marginLeft:es,backgroundPositionX:es,backgroundPositionY:es,rotate:eo,rotateX:eo,rotateY:eo,rotateZ:eo,scale:Q,scaleX:Q,scaleY:Q,scaleZ:Q,skew:eo,skewX:eo,skewY:eo,distance:es,translateX:es,translateY:es,translateZ:es,x:es,y:es,z:es,perspective:es,transformPerspective:es,opacity:W,originX:el,originY:el,originZ:es,zIndex:iO,fillOpacity:W,strokeOpacity:W,numOctaves:iO},iN={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},iL=b.length;function iD(e,r,n){let{style:i,vars:o,transformOrigin:a}=e,s=!1,u=!1;for(let e in r){let n=r[e];if(w.has(e)){s=!0;continue}if(z(e)){o[e]=n;continue}{let r=iP(n,iC[e]);e.startsWith("origin")?(u=!0,a[e]=r):i[e]=r}}if(!r.transform&&(s||n?i.transform=function(e,r,n){let i="",o=!0;for(let a=0;a<iL;a++){let s=b[a],u=e[s];if(void 0===u)continue;let c=!0;if(!(c="number"==typeof u?u===+!!s.startsWith("scale"):0===parseFloat(u))||n){let e=iP(u,iC[s]);if(!c){o=!1;let r=iN[s]||s;i+=`${r}(${e}) `}n&&(r[s]=e)}}return i=i.trim(),n?i=n(r,o?"":i):o&&(i="none"),i}(r,e.transform,n):i.transform&&(i.transform="none")),u){let{originX:e="50%",originY:r="50%",originZ:n=0}=a;i.transformOrigin=`${e} ${r} ${n}`}}let iR=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ij(e,r,n){for(let i in r)C(r[i])||iA(i,n)||(e[i]=r[i])}let iF={offset:"stroke-dashoffset",array:"stroke-dasharray"},iU={offset:"strokeDashoffset",array:"strokeDasharray"};function iM(e,{attrX:r,attrY:n,attrScale:i,pathLength:o,pathSpacing:a=1,pathOffset:s=0,...u},c,l,h){if(iD(e,u,l),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:d,style:f}=e;d.transform&&(f.transform=d.transform,delete d.transform),(f.transform||d.transformOrigin)&&(f.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),f.transform&&(f.transformBox=h?.transformBox??"fill-box",delete d.transformBox),void 0!==r&&(d.x=r),void 0!==n&&(d.y=n),void 0!==i&&(d.scale=i),void 0!==o&&function(e,r,n=1,i=0,o=!0){e.pathLength=1;let a=o?iF:iU;e[a.offset]=es.transform(-i);let s=es.transform(r),u=es.transform(n);e[a.array]=`${s} ${u}`}(d,o,a,s,!1)}let iG=()=>({...iR(),attrs:{}}),iV=e=>"string"==typeof e&&"svg"===e.toLowerCase(),iB=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function iz(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||iB.has(e)}let iq=e=>!iz(e);try{!function(e){"function"==typeof e&&(iq=r=>r.startsWith("on")?!iz(r):e(r))}(require("@emotion/is-prop-valid").default)}catch{}let iH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function i$(e){if("string"!=typeof e||e.includes("-"));else if(iH.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}var iK=n(91200);let iW=e=>(r,n)=>{let i=(0,rY.useContext)(iv),a=(0,rY.useContext)(ik.t),u=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:r},n,i,a){return{latestValues:function(e,r,n,i){let a={},u=i(e,{});for(let e in u)a[e]=nn(u[e]);let{initial:c,animate:l}=e,h=ib(e),d=iw(e);r&&d&&!h&&!1!==e.inherit&&(void 0===c&&(c=r.initial),void 0===l&&(l=r.animate));let f=!!n&&!1===n.initial,p=(f=f||!1===c)?l:c;if(p&&"boolean"!=typeof p&&!o(p)){let r=Array.isArray(p)?p:[p];for(let n=0;n<r.length;n++){let i=s(e,r[n]);if(i){let{transitionEnd:e,transition:r,...n}=i;for(let e in n){let r=n[e];if(Array.isArray(r)){let e=f?r.length-1:0;r=r[e]}null!==r&&(a[e]=r)}for(let r in e)a[r]=e[r]}}}return a}(n,i,a,e),renderState:r()}})(e,r,i,a);return n?u():(0,iK.M)(u)};function iQ(e,r,n){let{style:i}=e,o={};for(let a in i)(C(i[a])||r.style&&C(r.style[a])||iA(a,e)||n?.getValue(a)?.liveStyle!==void 0)&&(o[a]=i[a]);return o}let iJ={useVisualState:iW({scrapeMotionValuesFromProps:iQ,createRenderState:iR})};function iY(e,r,n){let i=iQ(e,r,n);for(let n in e)(C(e[n])||C(r[n]))&&(i[-1!==b.indexOf(n)?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n]=e[n]);return i}let iX={useVisualState:iW({scrapeMotionValuesFromProps:iY,createRenderState:iG})},iZ=e=>r=>r.test(e),i0=[K,es,ea,eo,ec,eu,{test:e=>"auto"===e,parse:e=>e}],i1=e=>i0.find(iZ(e)),i2=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),i3=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,i4=e=>/^0[^.\s]+$/u.test(e),i5=new Set(["brightness","contrast","saturate","opacity"]);function i6(e){let[r,n]=e.slice(0,-1).split("(");if("drop-shadow"===r)return e;let[i]=n.match(Y)||[];if(!i)return e;let o=n.replace(i,""),a=+!!i5.has(r);return i!==n&&(a*=100),r+"("+a+o+")"}let i8=/\b([a-z-]*)\(.*?\)/gu,i7={...eS,getAnimatableNone:e=>{let r=e.match(i8);return r?r.map(i6).join(" "):e}},i9={...iC,color:ed,backgroundColor:ed,outlineColor:ed,fill:ed,stroke:ed,borderColor:ed,borderTopColor:ed,borderRightColor:ed,borderBottomColor:ed,borderLeftColor:ed,filter:i7,WebkitFilter:i7},oe=e=>i9[e];function ot(e,r){let n=oe(e);return n!==i7&&(n=eS),n.getAnimatableNone?n.getAnimatableNone(r):void 0}let or=new Set(["auto","none","0"]);class on extends tP{constructor(e,r,n,i,o){super(e,r,n,i,o,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let n=0;n<e.length;n++){let i=e[n];if("string"==typeof i&&H(i=i.trim())){let o=function e(r,n,i=1){V(i<=4,`Max CSS variable fallback depth detected in property "${r}". This may indicate a circular fallback dependency.`,"max-css-var-depth");let[o,a]=function(e){let r=i3.exec(e);if(!r)return[,];let[,n,i,o]=r;return[`--${n??i}`,o]}(r);if(!o)return;let s=window.getComputedStyle(n).getPropertyValue(o);if(s){let e=s.trim();return i2(e)?parseFloat(e):e}return H(a)?e(a,n,i+1):a}(i,r.current);void 0!==o&&(e[n]=o),n===e.length-1&&(this.finalKeyframe=i)}}if(this.resolveNoneKeyframes(),!S.has(n)||2!==e.length)return;let[i,o]=e,a=i1(i),s=i1(o);if(a!==s)if(tb(a)&&tb(s))for(let r=0;r<e.length;r++){let n=e[r];"string"==typeof n&&(e[r]=parseFloat(n))}else tx[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:r}=this,n=[];for(let r=0;r<e.length;r++){var i;(null===e[r]||("number"==typeof(i=e[r])?0===i:null===i||"none"===i||"0"===i||i4(i)))&&n.push(r)}n.length&&function(e,r,n){let i,o=0;for(;o<e.length&&!i;){let r=e[o];"string"==typeof r&&!or.has(r)&&ey(r).values.length&&(i=e[o]),o++}if(i&&n)for(let o of r)e[o]=ot(n,i)}(e,n,r)}measureInitialState(){let{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tx[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;let i=r[r.length-1];void 0!==i&&e.getValue(n,i).jump(i,!1)}measureEndState(){let{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;let i=e.getValue(r);i&&i.jump(this.measuredOrigin,!1);let o=n.length-1,a=n[o];n[o]=tx[r](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==a&&void 0===this.finalKeyframe&&(this.finalKeyframe=a),this.removedTransforms?.length&&this.removedTransforms.forEach(([r,n])=>{e.getValue(r).set(n)}),this.resolveNoneKeyframes()}}let oi=[...i0,ed,eS],oo={current:null},oa={current:!1},os=new WeakMap,ou=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class oc{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:o,visualState:a},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=tP,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=k.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,m.render(this.render,!1,!0))};let{latestValues:u,renderState:c}=a;this.latestValues=u,this.baseTarget={...u},this.initialValues=r.initial?{...u}:{},this.renderState=c,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=s,this.blockInitialAnimation=!!o,this.isControllingVariants=ib(r),this.isVariantNode=iw(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:l,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(let e in h){let r=h[e];void 0!==u[e]&&C(r)&&r.set(u[e],!1)}}mount(e){this.current=e,os.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,r)=>this.bindToMotionValue(r,e)),oa.current||function(){if(oa.current=!0,ix.B)if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),r=()=>oo.current=e.matches;e.addEventListener("change",r),r()}else oo.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||oo.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in this.projection&&this.projection.unmount(),g(this.notifyUpdate),g(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[e].clear();for(let e in this.features){let r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){let n;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let i=w.has(e);i&&this.onBindTransform&&this.onBindTransform();let o=r.on("change",r=>{this.latestValues[e]=r,this.props.onUpdate&&m.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),a=r.on("renderRequest",this.scheduleRender);window.MotionCheckAppearSync&&(n=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{o(),a(),n&&n(),r.owner&&r.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in iI){let r=iI[e];if(!r)continue;let{isEnabled:n,Feature:i}=r;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){let r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):rg()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let r=0;r<ou.length;r++){let n=ou[r];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);let i=e["on"+n];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=function(e,r,n){for(let i in r){let o=r[i],a=n[i];if(C(o))e.addValue(i,o);else if(C(a))e.addValue(i,P(o,{owner:e}));else if(a!==o)if(e.hasValue(i)){let r=e.getValue(i);!0===r.liveStyle?r.jump(o):r.hasAnimated||r.set(o)}else{let r=e.getStaticValue(i);e.addValue(i,P(void 0!==r?r:o,{owner:e}))}}for(let i in n)void 0===r[i]&&e.removeValue(i);return r}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){let n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);let r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==r&&(n=P(null===r?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];if(null!=n){if("string"==typeof n&&(i2(n)||i4(n)))n=parseFloat(n);else{let i;i=n,!oi.find(iZ(i))&&eS.test(r)&&(n=ot(e,r))}this.setBaseTarget(e,C(n)?n.get():n)}return C(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){let r,{initial:n}=this.props;if("string"==typeof n||"object"==typeof n){let i=s(this.props,n,this.presenceContext?.custom);i&&(r=i[e])}if(n&&void 0!==r)return r;let i=this.getBaseTargetFromProps(this.props,e);return void 0===i||C(i)?void 0!==this.initialValues[e]&&void 0===r?void 0:this.baseTarget[e]:i}on(e,r){return this.events[e]||(this.events[e]=new I),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class ol extends oc{constructor(){super(...arguments),this.KeyframeResolver=on}sortInstanceNodePosition(e,r){return 2&e.compareDocumentPosition(r)?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;C(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function oh(e,{style:r,vars:n},i,o){let a,s=e.style;for(a in r)s[a]=r[a];for(a in o?.applyProjectionStyles(s,i),n)s.setProperty(a,n[a])}class od extends ol{constructor(){super(...arguments),this.type="html",this.renderInstance=oh}readValueFromInstance(e,r){if(w.has(r))return this.projection?.isProjecting?tg(r):((e,r)=>{let{transform:n="none"}=getComputedStyle(e);return ty(n,r)})(e,r);{let n=window.getComputedStyle(e),i=(z(r)?n.getPropertyValue(r):n[r])||0;return"string"==typeof i?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:r}){return rA(e,r)}build(e,r,n){iD(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return iQ(e,r,n)}}let of=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);class op extends ol{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=rg}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(w.has(r)){let e=oe(r);return e&&e.default||0}return r=of.has(r)?r:L(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return iY(e,r,n)}build(e,r,n){iM(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,i){for(let n in oh(e,r,void 0,i),r.attrs)e.setAttribute(of.has(n)?n:L(n),r.attrs[n])}mount(e){this.isSVGTag=iV(e.tagName),super.mount(e)}}let om=function(e){if("undefined"==typeof Proxy)return e;let r=new Map;return new Proxy((...r)=>e(...r),{get:(n,i)=>"create"===i?e:(r.has(i)||r.set(i,e(i)),r.get(i))})}((rK={animation:{Feature:t7},exit:{Feature:re},inView:{Feature:im},tap:{Feature:iu},focus:{Feature:n7},hover:{Feature:n8},pan:{Feature:r$},drag:{Feature:rq,ProjectionNode:n3,MeasureLayout:r8},layout:{ProjectionNode:n3,MeasureLayout:r8}},rW=(e,r)=>i$(e)?new op(r):new od(r,{allowProjection:e!==rY.Fragment}),function(e,{forwardMotionProps:r}={forwardMotionProps:!1}){return function({preloadedFeatures:e,createVisualElement:r,useRender:n,useVisualState:i,Component:o}){function a(e,a){var s;let u,c={...(0,rY.useContext)(iy.Q),...e,layoutId:function({layoutId:e}){let r=(0,rY.useContext)(rZ.L).id;return r&&void 0!==e?r+"-"+e:e}(e)},{isStatic:l}=c,h=function(e){let{initial:r,animate:n}=function(e,r){if(ib(e)){let{initial:r,animate:n}=e;return{initial:!1===r||tZ(r)?r:void 0,animate:tZ(n)?n:void 0}}return!1!==e.inherit?r:{}}(e,(0,rY.useContext)(iv));return(0,rY.useMemo)(()=>({initial:r,animate:n}),[iS(r),iS(n)])}(e),d=i(e,l);if(!l&&ix.B){(0,rY.useContext)(ig).strict;let e=function(e){let{drag:r,layout:n}=iI;if(!r&&!n)return{};let i={...r,...n};return{MeasureLayout:r?.isEnabled(e)||n?.isEnabled(e)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}(c);u=e.MeasureLayout,h.visualElement=function(e,r,n,i,o){let{visualElement:a}=(0,rY.useContext)(iv),s=(0,rY.useContext)(ig),u=(0,rY.useContext)(ik.t),c=(0,rY.useContext)(iy.Q).reducedMotion,l=(0,rY.useRef)(null);i=i||s.renderer,!l.current&&i&&(l.current=i(e,{visualState:r,parent:a,props:n,presenceContext:u,blockInitialAnimation:!!u&&!1===u.initial,reducedMotionConfig:c}));let h=l.current,d=(0,rY.useContext)(r0);h&&!h.projection&&o&&("html"===h.type||"svg"===h.type)&&function(e,r,n,i){let{layoutId:o,layout:a,drag:s,dragConstraints:u,layoutScroll:c,layoutRoot:l,layoutCrossfade:h}=r;e.projection=new n(e.latestValues,r["data-framer-portal-id"]?void 0:function e(r){if(r)return!1!==r.options.allowProjection?r.projection:e(r.parent)}(e.parent)),e.projection.setOptions({layoutId:o,layout:a,alwaysMeasureLayout:!!s||u&&rO(u),visualElement:e,animationType:"string"==typeof a?a:"both",initialPromotionConfig:i,crossfade:h,layoutScroll:c,layoutRoot:l})}(l.current,n,o,d);let f=(0,rY.useRef)(!1);(0,rY.useInsertionEffect)(()=>{h&&f.current&&h.update(n,u)});let p=n[D],m=(0,rY.useRef)(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return(0,i_.E)(()=>{h&&(f.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),rJ.render(h.render),m.current&&h.animationState&&h.animationState.animateChanges())}),(0,rY.useEffect)(()=>{h&&(!m.current&&h.animationState&&h.animationState.animateChanges(),m.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),m.current=!1))}),h}(o,d,c,r,e.ProjectionNode)}return(0,rQ.jsxs)(iv.Provider,{value:h,children:[u&&h.visualElement?(0,rQ.jsx)(u,{visualElement:h.visualElement,...c}):null,n(o,e,(s=h.visualElement,(0,rY.useCallback)(e=>{e&&d.onMount&&d.onMount(e),s&&(e?s.mount(e):s.unmount()),a&&("function"==typeof a?a(e):rO(a)&&(a.current=e))},[s])),d,l,h.visualElement)]})}e&&function(e){for(let r in e)iI[r]={...iI[r],...e[r]}}(e),a.displayName=`motion.${"string"==typeof o?o:`create(${o.displayName??o.name??""})`}`;let s=(0,rY.forwardRef)(a);return s[iT]=o,s}({...i$(e)?iX:iJ,preloadedFeatures:rK,useRender:function(e=!1){return(r,n,i,{latestValues:o},a)=>{let s=(i$(r)?function(e,r,n,i){let o=(0,rY.useMemo)(()=>{let n=iG();return iM(n,r,iV(i),e.transformTemplate,e.style),{...n.attrs,style:{...n.style}}},[r]);if(e.style){let r={};ij(r,e.style,e),o.style={...r,...o.style}}return o}:function(e,r){let n={},i=function(e,r){let n=e.style||{},i={};return ij(i,n,e),Object.assign(i,function({transformTemplate:e},r){return(0,rY.useMemo)(()=>{let n=iR();return iD(n,r,e),Object.assign({},n.vars,n.style)},[r])}(e,r)),i}(e,r);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n})(n,o,a,r),u=function(e,r,n){let i={};for(let o in e)("values"!==o||"object"!=typeof e.values)&&(iq(o)||!0===n&&iz(o)||!r&&!iz(o)||e.draggable&&o.startsWith("onDrag"))&&(i[o]=e[o]);return i}(n,"string"==typeof r,e),c=r!==rY.Fragment?{...u,...s,ref:i}:{},{children:l}=n,h=(0,rY.useMemo)(()=>C(l)?l.get():l,[l]);return(0,rY.createElement)(r,{...c,children:h})}}(r),createVisualElement:rW,Component:e})}))},23513:(e,r,n)=>{"use strict";n.d(r,{A:()=>a}),n(14232);var i=n(95014),o=n(37876);let a=function(e){var r=e.message,n=e.color,a=void 0===n?"white":n;return(0,o.jsxs)("div",{className:"fixed inset-0 flex flex-col items-center justify-center bg-gray-900 bg-opacity-80 z-[9999]",children:[(0,o.jsx)(i.A,{className:"h-16 w-16 ".concat("white"===a?"text-white":"purple"===a?"text-purple-400":"text-".concat(a)," animate-spin")}),(0,o.jsx)("p",{className:"mt-4 text-white text-lg",children:r||"Wird geladen..."})]})}},24534:(e,r,n)=>{"use strict";let i;n.d(r,{U8:()=>x,go:()=>E});var o=n(19250),a=n(99407);let s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},u=new Uint8Array(16),c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));let l=function(e,r,n){if(s.randomUUID&&!r&&!e)return s.randomUUID();let o=(e=e||{}).random||(e.rng||function(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(u)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,r){n=n||0;for(let e=0;e<16;++e)r[n+e]=o[e];return r}return function(e,r=0){return c[e[r+0]]+c[e[r+1]]+c[e[r+2]]+c[e[r+3]]+"-"+c[e[r+4]]+c[e[r+5]]+"-"+c[e[r+6]]+c[e[r+7]]+"-"+c[e[r+8]]+c[e[r+9]]+"-"+c[e[r+10]]+c[e[r+11]]+c[e[r+12]]+c[e[r+13]]+c[e[r+14]]+c[e[r+15]]}(o)};function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){d=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function f(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=p(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=p(e[o],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==h(d)&&i.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(d).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(h(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=l(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(f(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function f(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function p(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){f(a,i,o,s,u,"next",e)}function u(e){f(a,i,o,s,u,"throw",e)}s(void 0)})}}function m(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function g(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?m(Object(n),!0).forEach(function(r){y(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function y(e,r,n){return(r=v(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function v(e){var r=function(e,r){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=h(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==h(r)?r:r+""}var b={maxRetries:10,baseRetryDelay:1e3,maxRetryDelay:3e4,batchSize:3,networkCheckInterval:5e3},w=function(){var e,r,n,i,s,u,c,h,f,m;return f=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(this instanceof e))throw TypeError("Cannot call a class as a function");y(this,"isRunning",!1),y(this,"syncInterval",null),y(this,"networkCheckInterval",null),y(this,"isOnline",navigator.onLine),this.config=g(g({},b),r),this.setupNetworkListeners()},m=[{key:"setupNetworkListeners",value:function(){var e=this;window.addEventListener("online",function(){console.log("[SyncEngine] \uD83C\uDF10 Network: ONLINE - Resuming sync"),e.isOnline=!0,e.start()}),window.addEventListener("offline",function(){console.log("[SyncEngine] \uD83D\uDCF4 Network: OFFLINE - Pausing sync"),e.isOnline=!1,e.pause()}),this.networkCheckInterval=setInterval(function(){var r=e.isOnline;e.isOnline=navigator.onLine,!r&&e.isOnline?(console.log("[SyncEngine] \uD83D\uDD04 Network check: Back online - Resuming sync"),e.start()):r&&!e.isOnline&&(console.log("[SyncEngine] \uD83D\uDD04 Network check: Gone offline - Pausing sync"),e.pause())},this.config.networkCheckInterval)}},{key:"start",value:(e=p(d().mark(function e(){var r=this;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.isRunning||!this.isOnline)){e.next=1;break}return e.abrupt("return");case 1:return console.log("[SyncEngine] \uD83D\uDE80 Starting background synchronization"),this.isRunning=!0,e.next=2,this.processSyncQueue();case 2:this.syncInterval=setInterval(p(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.isOnline&&r.isRunning)){e.next=1;break}return e.next=1,r.processSyncQueue();case 1:case"end":return e.stop()}},e)})),1e4);case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"pause",value:function(){this.isRunning&&(console.log("[SyncEngine] ⏸️ Pausing synchronization"),this.isRunning=!1,this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null))}},{key:"stop",value:function(){console.log("[SyncEngine] \uD83D\uDED1 Stopping sync engine"),this.pause(),this.networkCheckInterval&&(clearInterval(this.networkCheckInterval),this.networkCheckInterval=null),window.removeEventListener("online",this.start),window.removeEventListener("offline",this.pause)}},{key:"queueGameFinalization",value:(r=p(d().mark(function e(r,n){var i,a,s,u=arguments;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>2&&void 0!==u[2]&&u[2],e.next=1,(0,o.eW)();case 1:return i=e.sent,a={id:l(),type:"GAME_COMPLETED",sessionId:r,gameData:n,timestamp:Date.now(),attempts:0},e.prev=2,e.next=3,i.addToSyncQueue(a);case 3:if(!this.isOnline){e.next=4;break}return e.next=4,this.processSyncQueue();case 4:e.next=6;break;case 5:throw e.prev=5,console.error("[SyncEngine] ❌ Failed to queue game finalization:",s=e.catch(2)),s;case 6:case"end":return e.stop()}},e,this,[[2,5]])})),function(e,n){return r.apply(this,arguments)})},{key:"saveOfflineGame",value:(n=p(d().mark(function e(r,n){var i,a,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,(0,o.eW)();case 1:return i=e.sent,a={id:l(),sessionId:r,gameData:n,timestamp:Date.now(),synced:!1},e.prev=2,e.next=3,i.saveOfflineGame(a);case 3:console.log("[SyncEngine] \uD83D\uDCBE Game saved offline: ".concat(a.id)),e.next=5;break;case 4:throw e.prev=4,console.error("[SyncEngine] ❌ Failed to save offline game:",s=e.catch(2)),s;case 5:case"end":return e.stop()}},e,null,[[2,4]])})),function(e,r){return n.apply(this,arguments)})},{key:"processSyncQueue",value:(i=p(d().mark(function e(){var r,n,i,a,s,u=this;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isOnline){e.next=1;break}return e.abrupt("return");case 1:return e.prev=1,e.next=2,(0,o.eW)();case 2:return r=e.sent,e.next=3,r.getPendingSyncItems();case 3:if(0!==(n=e.sent).length){e.next=4;break}return e.abrupt("return");case 4:i=this.config.batchSize,a=0;case 5:if(!(a<n.length)){e.next=7;break}return s=n.slice(a,a+i),e.next=6,Promise.all(s.map(function(e){return u.processSyncItem(e)}));case 6:a+=i,e.next=5;break;case 7:e.next=9;break;case 8:e.prev=8,console.error("[SyncEngine] ❌ Error processing sync queue:",e.catch(1));case 9:case"end":return e.stop()}},e,this,[[1,8]])})),function(){return i.apply(this,arguments)})},{key:"processSyncItem",value:(s=p(d().mark(function e(r){var n,i,a,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,(0,o.eW)();case 1:if(n=e.sent,e.prev=2,!(r.attempts>=this.config.maxRetries)){e.next=4;break}return console.error("[SyncEngine] ❌ Max retries exceeded for item ".concat(r.id,". Removing from queue.")),e.next=3,n.removeSyncItem(r.id);case 3:return e.abrupt("return");case 4:if(i=Math.min(this.config.baseRetryDelay*Math.pow(2,r.attempts),this.config.maxRetryDelay),!(r.lastAttempt&&Date.now()-r.lastAttempt<i)){e.next=5;break}return e.abrupt("return");case 5:return e.next=6,this.syncGameFinalization(r);case 6:return e.next=7,n.removeSyncItem(r.id);case 7:e.next=9;break;case 8:return e.prev=8,s=e.catch(2),console.warn("[SyncEngine] ⚠️ Sync attempt failed for item ".concat(r.id,":"),s),a=g(g({},r),{},{attempts:r.attempts+1,lastAttempt:Date.now(),error:s instanceof Error?s.message:String(s)}),e.next=9,n.updateSyncItem(a);case 9:case"end":return e.stop()}},e,this,[[2,8]])})),function(e){return s.apply(this,arguments)})},{key:"syncGameFinalization",value:(u=p(d().mark(function e(r){var n,i,o,s;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.sessionId,o=(i=r.gameData).gameNumber||1,e.prev=1,e.next=2,(0,a.saveCompletedGameToFirestore)(n,o,i,!1);case 2:if(!1===i.clearActiveGameId){e.next=6;break}return e.prev=3,e.next=4,(0,a.updateSessionActiveGameId)(n,null);case 4:e.next=6;break;case 5:e.prev=5,console.warn("[SyncEngine] ⚠️ Failed to clear session activeGameId (non-critical):",e.catch(3));case 6:e.next=8;break;case 7:throw e.prev=7,console.error("[SyncEngine] ❌ Failed to sync game finalization:",s=e.catch(1)),s;case 8:case"end":return e.stop()}},e,null,[[1,7],[3,5]])})),function(e){return u.apply(this,arguments)})},{key:"getPendingCount",value:(c=p(d().mark(function e(){var r,n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,(0,o.eW)();case 1:return r=e.sent,e.next=2,r.getPendingSyncItems();case 2:return n=e.sent,e.abrupt("return",n.length);case 3:return e.prev=3,console.error("[SyncEngine] ❌ Failed to get pending count:",e.catch(0)),e.abrupt("return",0);case 4:case"end":return e.stop()}},e,null,[[0,3]])})),function(){return c.apply(this,arguments)})},{key:"clearCompletedSyncs",value:(h=p(d().mark(function e(){var r;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,(0,o.eW)();case 1:return r=e.sent,e.next=2,r.clearSyncedGames();case 2:console.log("[SyncEngine] ✅ Cleared completed syncs from local storage"),e.next=4;break;case 3:e.prev=3,console.error("[SyncEngine] ❌ Failed to clear completed syncs:",e.catch(0));case 4:case"end":return e.stop()}},e,null,[[0,3]])})),function(){return h.apply(this,arguments)})}],function(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,v(i.key),i)}}(f.prototype,m),Object.defineProperty(f,"prototype",{writable:!1}),f}(),S=null,x=function(){return S||(S=new w),S},E=function(e){return S&&S.stop(),S=new w(e)}},27212:(e,r,n)=>{"use strict";n.d(r,{N:()=>b});var i=n(37876),o=n(14232),a=n(5048),s=n(91200),u=n(50181),c=n(3866),l=n(7990),h=n(39751);class d extends o.Component{getSnapshotBeforeUpdate(e){let r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){let e=r.offsetParent,n=(0,l.s)(e)&&e.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=n-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function f({children:e,isPresent:r,anchorX:n,root:a}){let s=(0,o.useId)(),u=(0,o.useRef)(null),c=(0,o.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=(0,o.useContext)(h.Q);return(0,o.useInsertionEffect)(()=>{let{width:e,height:i,top:o,left:h,right:d}=c.current;if(r||!u.current||!e||!i)return;let f="left"===n?`left: ${h}`:`right: ${d}`;u.current.dataset.motionPopId=s;let p=document.createElement("style");l&&(p.nonce=l);let m=a??document.head;return m.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${i}px !important;
            ${f}px !important;
            top: ${o}px !important;
          }
        `),()=>{m.removeChild(p),m.contains(p)&&m.removeChild(p)}},[r]),(0,i.jsx)(d,{isPresent:r,childRef:u,sizeRef:c,children:o.cloneElement(e,{ref:u})})}let p=({children:e,initial:r,isPresent:n,onExitComplete:a,custom:u,presenceAffectsLayout:l,mode:h,anchorX:d,root:p})=>{let g=(0,s.M)(m),y=(0,o.useId)(),v=!0,b=(0,o.useMemo)(()=>(v=!1,{id:y,initial:r,isPresent:n,custom:u,onExitComplete:e=>{for(let r of(g.set(e,!0),g.values()))if(!r)return;a&&a()},register:e=>(g.set(e,!1),()=>g.delete(e))}),[n,g,a]);return l&&v&&(b={...b}),(0,o.useMemo)(()=>{g.forEach((e,r)=>g.set(r,!1))},[n]),o.useEffect(()=>{n||g.size||!a||a()},[n]),"popLayout"===h&&(e=(0,i.jsx)(f,{isPresent:n,anchorX:d,root:p,children:e})),(0,i.jsx)(c.t.Provider,{value:b,children:e})};function m(){return new Map}var g=n(83885);let y=e=>e.key||"";function v(e){let r=[];return o.Children.forEach(e,e=>{(0,o.isValidElement)(e)&&r.push(e)}),r}let b=({children:e,custom:r,initial:n=!0,onExitComplete:c,presenceAffectsLayout:l=!0,mode:h="sync",propagate:d=!1,anchorX:f="left",root:m})=>{let[b,w]=(0,g.xQ)(d),S=(0,o.useMemo)(()=>v(e),[e]),x=d&&!b?[]:S.map(y),E=(0,o.useRef)(!0),I=(0,o.useRef)(S),T=(0,s.M)(()=>new Map),[k,_]=(0,o.useState)(S),[A,P]=(0,o.useState)(S);(0,u.E)(()=>{E.current=!1,I.current=S;for(let e=0;e<A.length;e++){let r=y(A[e]);x.includes(r)?T.delete(r):!0!==T.get(r)&&T.set(r,!1)}},[A,x.length,x.join("-")]);let O=[];if(S!==k){let e=[...S];for(let r=0;r<A.length;r++){let n=A[r],i=y(n);x.includes(i)||(e.splice(r,0,n),O.push(n))}return"wait"===h&&O.length&&(e=O),P(v(e)),_(S),null}let{forceRender:C}=(0,o.useContext)(a.L);return(0,i.jsx)(i.Fragment,{children:A.map(e=>{let o=y(e),a=(!d||!!b)&&(S===A||x.includes(o));return(0,i.jsx)(p,{isPresent:a,initial:(!E.current||!!n)&&void 0,custom:r,presenceAffectsLayout:l,mode:h,root:m,onExitComplete:a?void 0:()=>{if(!T.has(o))return;T.set(o,!0);let e=!0;T.forEach(r=>{r||(e=!1)}),e&&(C?.(),P(I.current),d&&w?.(),c&&c())},anchorX:f,children:e},o)})})}},27788:(e,r,n)=>{"use strict";n.r(r),n.d(r,{useAuthStore:()=>F});var i=n(8106),o=n(4319),a=n(13848),s=n(93786),u=n(16042),c=n(75695),l=n(94566),h=n(31931),d=n(42009),f=n(37746),p="pendingInviteToken";function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){g=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==m(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(m(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=l(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function y(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}var v=function(){var e,r=(e=g().mark(function e(){var r,n,i,o,a,s,u,c,d,m,y,v,b=arguments;return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=b.length>0&&void 0!==b[0]&&b[0],n=l.useUIStore.getState().showNotification,i=h.Q5.getState().addUserGroup,o=h.Q5.getState().setCurrentGroup,a=null,e.prev=1,a=localStorage.getItem(p),e.next=3;break;case 2:return e.prev=2,console.error("Failed to read from localStorage:",e.catch(1)),e.abrupt("return",null);case 3:if(!a){e.next=10;break}try{localStorage.removeItem(p)}catch(e){console.error("Failed to remove item from localStorage:",e)}return e.prev=4,s=(0,f.Uz)(void 0,"europe-west1"),u=(0,f.Qg)(s,"joinGroupByToken"),e.next=5,u({token:a});case 5:if(!(null!=(c=e.sent.data)&&c.success&&c.group&&c.group.id)){e.next=6;break}return d=c.group,i(d),o(d),r||n({message:"Du bist jetzt Mitglied der Gruppe '".concat(d.name,"'."),type:"success",duration:5e3}),e.abrupt("return",d.id);case 6:return console.error("Error joining group via pending token (success=false or group/id object missing):",c),m=(null==c?void 0:c.message)||"Beitritt fehlgeschlagen. Ung\xfcltige Antwort von Funktion.",n({message:m,type:"error",duration:7e3}),e.abrupt("return",null);case 7:e.next=9;break;case 8:return e.prev=8,console.error("Error joining group via pending token:",v=e.catch(4)),y="Beitritt fehlgeschlagen. Der Code war ung\xfcltig oder ist abgelaufen.",v instanceof Error&&(y=v.message||y),n({message:y,type:"error",duration:7e3}),e.abrupt("return",null);case 9:e.next=11;break;case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[1,2],[4,8]])}),function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){y(a,i,o,s,u,"next",e)}function u(e){y(a,i,o,s,u,"throw",e)}s(void 0)})});return function(){return r.apply(this,arguments)}}(),b=n(38556),w=n(66534),S=n(89099),x=n.n(S),E=n(31225);function I(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function _(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?k(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=T(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=T(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==T(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function A(){A=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(C([])));x&&x!==n&&i.call(x,s)&&(w=x);var E=b.prototype=y.prototype=Object.create(w);function I(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function k(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==T(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function _(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(T(r)+" is not iterable")}return v.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},I(k.prototype),l(k.prototype,u,function(){return this}),r.AsyncIterator=k,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new k(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},I(E),l(E,c,"Generator"),l(E,s,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function P(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function O(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){P(a,i,o,s,u,"next",e)}function u(e){P(a,i,o,s,u,"throw",e)}s(void 0)})}}var C=null,N=null,L=null,D=null,R=!1,j=new Map,F=(0,i.v)()((0,o.Zr)(function(e,r){var i,o,f,p,m,g,y,S,k;return{status:"idle",user:null,firebaseUser:null,appMode:"offline",error:null,isGuest:!1,isLoggingOut:!1,uploadStatus:"idle",setAuthUser:(i=O(A().mark(function r(n){var i,o,u,l,f;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return C&&C(),N&&N(),C=null,N=null,i=(0,c._N)(n,null),e({status:"authenticated",firebaseUser:n,user:i,isGuest:!1,error:null}),r.prev=1,o=(0,d.doc)(a.db,b.sb,n.uid),u=!1,C=(l=function(){return(0,d.onSnapshot)(o,function(r){if(r.exists()){var i=r.data();e({user:(0,c._N)(n,i)})}else console.warn("AUTH_STORE: Firestore user document not found for ".concat(n.uid,"."))},function(){var r=O(A().mark(function r(i){var o;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.error("AUTH_STORE: Fehler im User Doc Listener f\xfcr ".concat(n.uid,":"),i),r.prev=1,!(!u&&"permission-denied"===i.code)){r.next=4;break}return u=!0,r.next=2,null==(o=(0,s.xI)().currentUser)?void 0:o.getIdToken(!0);case 2:return r.next=3,new Promise(function(e){return setTimeout(e,200)});case 3:return C&&C(),C=l(),r.abrupt("return");case 4:r.next=6;break;case 5:r.prev=5,r.catch(1);case 6:e({status:"error",error:"Fehler beim Laden der Benutzerdaten."});case 7:case"end":return r.stop()}},r,null,[[1,5]])}));return function(e){return r.apply(this,arguments)}}())})(),r.next=2,(0,w.getPlayerIdForUser)(n.uid,n.displayName||"");case 2:if(!(f=r.sent)){r.next=3;break}return r.next=3,h.Q5.getState().loadUserGroupsByPlayerId(f);case 3:r.next=5;break;case 4:r.prev=4,console.error("AUTH_STORE: Fehler bei der Anreicherung des Benutzers in setAuthUser:",r.catch(1)),e({status:"error",error:"Fehler beim Laden der Profildaten."});case 5:case"end":return r.stop()}},r,null,[[1,4]])})),function(e){return i.apply(this,arguments)}),setUnauthenticated:function(){C&&C(),N&&N(),C=null,N=null,e({user:null,firebaseUser:null,status:"unauthenticated",isGuest:r().isGuest}),h.Q5.getState().resetGroupStore()},login:(o=O(A().mark(function r(n,i){var o;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e({status:"loading",error:null}),r.next=1,(0,c._h)(n,i);case 1:e({user:r.sent,status:"authenticated",appMode:"online",isGuest:!1}),r.next=3;break;case 2:throw r.prev=2,e({status:"error",error:(o=r.catch(0))instanceof Error?o.message:"Ein unbekannter Fehler ist aufgetreten"}),o;case 3:case"end":return r.stop()}},r,null,[[0,2]])})),function(e,r){return o.apply(this,arguments)}),loginWithGoogle:(f=O(A().mark(function r(){var n;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e({status:"loading",error:null}),r.next=1,(0,c.FE)();case 1:e({user:r.sent,status:"authenticated",appMode:"online",isGuest:!1}),r.next=3;break;case 2:throw r.prev=2,e({status:"error",error:(n=r.catch(0))instanceof Error?n.message:"Ein unbekannter Fehler ist aufgetreten"}),n;case 3:case"end":return r.stop()}},r,null,[[0,2]])})),function(){return f.apply(this,arguments)}),register:(p=O(A().mark(function r(n,i,o){var a,s,u;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e({status:"loading",error:null}),r.prev=1,r.next=2,(0,c.Wq)(n,i,o);case 2:r.sent,e({status:"unauthenticated"}),r.next=4;break;case 3:throw r.prev=3,console.error("AUTH_STORE: Fehler bei Registrierung:",u=r.catch(1)),s="Registrierung fehlgeschlagen. Bitte versuchen Sie es erneut.","auth/email-already-in-use"===(a=u).code?s="Diese E-Mail-Adresse ist bereits registriert. Bitte melde dich an oder verwende eine andere E-Mail.":"auth/weak-password"===a.code&&(s="Das Passwort ist zu schwach. Es muss mindestens 6 Zeichen lang sein."),e({status:"error",error:s}),Error(s);case 4:case"end":return r.stop()}},r,null,[[1,3]])})),function(e,r,n){return p.apply(this,arguments)}),logout:(m=O(A().mark(function r(){var n,i,o,a;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log("AUTH_STORE: Starting logout process..."),!window.__OFFLINE_SYNC_SERVICE__||!((n=window.__OFFLINE_SYNC_SERVICE__).isSyncInProgress()||n.hasPendingSync())){r.next=4;break}console.log("AUTH_STORE: Offline-Sync l\xe4uft noch, warte auf Abschluss..."),l.useUIStore.getState().showNotification({type:"info",message:"Daten werden synchronisiert... Bitte warten Sie einen Moment."}),i=0,o=1e4,a=500;case 1:if(!((n.isSyncInProgress()||n.hasPendingSync())&&i<o)){r.next=3;break}return r.next=2,new Promise(function(e){return setTimeout(e,a)});case 2:i+=a,r.next=1;break;case 3:i>=o?console.warn("AUTH_STORE: Sync-Timeout erreicht, fahre mit Logout fort"):console.log("AUTH_STORE: Sync abgeschlossen, fahre mit Logout fort");case 4:return e({isLoggingOut:!0}),C&&(C(),C=null),N&&(N(),N=null),h.Q5.getState().resetGroupStore(),r.prev=5,e({status:"loading",error:null}),r.next=6,(0,c.ri)();case 6:e({user:null,firebaseUser:null,status:"unauthenticated",appMode:"offline",isGuest:!1,isLoggingOut:!1}),console.log("AUTH_STORE: Logout successful, navigating to /"),x().push("/"),r.next=8;break;case 7:r.prev=7,console.error("AUTH_STORE: Fehler beim Logout:",r.catch(5)),e({status:"error",error:"Abmeldung fehlgeschlagen",isLoggingOut:!1});case 8:case"end":return r.stop()}},r,null,[[5,7]])})),function(){return m.apply(this,arguments)}),resetPassword:(g=O(A().mark(function n(i){var o;return A().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e({status:"loading",error:null}),n.next=1,(0,c.hE)(i);case 1:e({status:r().user?"authenticated":"unauthenticated"}),n.next=3;break;case 2:throw n.prev=2,e({status:"error",error:(o=n.catch(0))instanceof Error?o.message:"Ein unbekannter Fehler ist aufgetreten"}),o;case 3:case"end":return n.stop()}},n,null,[[0,2]])})),function(e){return g.apply(this,arguments)}),setAppMode:function(r){e({appMode:r})},continueAsGuest:function(){console.log("[AuthStore] continueAsGuest called");var i=r().status;if(r().user&&"authenticated"===i)return void console.warn("[AuthStore] User is already authenticated, ignoring continueAsGuest.");console.log("[AuthStore] Resetting game state for clean guest mode");try{Promise.resolve().then(n.bind(n,83872)).then(function(e){e.useJassStore.getState().resetJass()}),Promise.resolve().then(n.bind(n,28742)).then(function(e){e.useGameStore.getState().resetGameState({newActiveGameId:null})}),Promise.resolve().then(n.bind(n,10637)).then(function(e){e.useTimerStore.getState().resetAllTimers()})}catch(e){console.warn("[AuthStore] Error resetting game state during guest mode transition:",e)}e({user:null,firebaseUser:null,status:"unauthenticated",appMode:"offline",isGuest:!0,error:null}),console.log("[AuthStore] Set to Guest Mode:",r())},clearGuestStatus:function(){e(function(e){return e.isGuest?{isGuest:!1,appMode:"online"===e.appMode?"online":"offline"}:{}})},isAuthenticated:function(){return"authenticated"===r().status&&!!r().user},resendVerificationEmail:(y=O(A().mark(function r(){var n;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e({status:"loading",error:null}),r.next=1,(0,c.nA)();case 1:e(function(e){return{status:"loading"===e.status?e.user?"authenticated":"unauthenticated":e.status}}),r.next=3;break;case 2:throw r.prev=2,console.error("Error in store resendVerificationEmail:",n=r.catch(0)),e({status:"error",error:n instanceof Error?n.message:"Fehler beim erneuten Senden der E-Mail."}),n;case 3:case"end":return r.stop()}},r,null,[[0,2]])})),function(){return y.apply(this,arguments)}),uploadProfilePicture:(S=O(A().mark(function n(i){var o,a;return A().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r().firebaseUser){n.next=1;break}throw e({uploadStatus:"error",error:"Benutzer nicht angemeldet."}),Error("Benutzer nicht angemeldet.");case 1:return e({uploadStatus:"loading",error:null}),n.prev=2,n.next=3,(0,c.x)(i,o.uid);case 3:e({user:n.sent,uploadStatus:"success",error:null}),n.next=5;break;case 4:throw n.prev=4,console.error("AUTH_STORE: Fehler beim Hochladen des Profilbilds:",a=n.catch(2)),e({uploadStatus:"error",error:a instanceof Error?a.message:"Profilbild konnte nicht hochgeladen werden."}),a;case 5:case"end":return n.stop()}},n,null,[[2,4]])})),function(e){return S.apply(this,arguments)}),updateProfile:(k=O(A().mark(function n(i){var o,a;return A().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r().user){n.next=1;break}throw Error("Benutzer nicht angemeldet.");case 1:return e({status:"loading",error:null}),n.prev=2,n.next=3,(0,c.eg)(i);case 3:o={},void 0!==i.displayName&&(o.displayName=i.displayName),void 0!==i.statusMessage&&(o.statusMessage=i.statusMessage),void 0!==i.profileTheme&&(o.profileTheme=i.profileTheme),e(function(e){return{user:e.user?_(_({},e.user),o):null,status:"authenticated",error:null}}),n.next=5;break;case 4:throw n.prev=4,console.error("AUTH_STORE: Fehler beim Aktualisieren des Profils:",a=n.catch(2)),e({status:"error",error:a instanceof Error?a.message:"Profil konnte nicht aktualisiert werden."}),a;case 5:case"end":return n.stop()}},n,null,[[2,4]])})),function(e){return k.apply(this,arguments)}),initAuth:function(){var i;R||(D&&(D(),D=null),R=!0,L&&clearTimeout(L),e({status:"loading"}),L=setTimeout(function(){if("loading"===r().status){console.error("AUTH_STORE: Watchdog-Alarm! onAuthStateChanged hat nicht innerhalb von 8s geantwortet.");var n=!1;try{var i=localStorage.getItem("auth-storage");if(i){var o,a=JSON.parse(i);if((null==a||null==(o=a.state)?void 0:o.status)==="authenticated"){console.error("AUTH_STORE: Erkenne persistierten authenticated Status - m\xf6gliche localStorage Corruption!");var s=parseInt(localStorage.getItem("auth-failed-attempts")||"0")+1;localStorage.setItem("auth-failed-attempts",s.toString()),s>=2&&(console.error("AUTH_STORE: 2+ failed attempts detected - Emergency localStorage cleanup!"),localStorage.removeItem("auth-storage"),localStorage.removeItem("auth-failed-attempts"),n=!0)}}}catch(e){console.error("AUTH_STORE: localStorage read error - Emergency cleanup!",e),localStorage.removeItem("auth-storage"),n=!0}e({status:"unauthenticated",user:null,firebaseUser:null,isGuest:!1,error:n?"Authentifizierung wurde zur\xfcckgesetzt. Bitte melde dich erneut an.":"Die Authentifizierung hat zu lange gedauert. Pr\xfcfe deine Internetverbindung und versuche es erneut."}),R=!1}},8e3),D=(0,s.hg)(a.auth,(i=O(A().mark(function i(o){var s,l,f,p,m,g,y,S,x,k,P,D,F,U,M,G,V,B,z;return A().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:L&&clearTimeout(L),R=!1;try{localStorage.removeItem("auth-failed-attempts")}catch(e){console.warn("AUTH_STORE: Could not reset failed attempts counter:",e)}if(C&&C(),N&&N(),C=null,N=null,!o){i.next=21;break}s=r().status,l=r().isGuest,f=(0,c._N)(o,null),e({status:"authenticated",firebaseUser:o,user:f,isGuest:!1});try{(m=(p=n(94566).useUIStore.getState()).notifications.filter(function(e){return e.message.includes("Registrierung erfolgreich")||e.message.includes("Pr\xfcfe deine Email")||e.message.includes("Gruppen-Einladung")})).forEach(function(e){p.removeNotification(e.id)}),m.length>0&&console.log("[AuthStore] Removed ".concat(m.length," hanging registration notifications"))}catch(e){console.warn("[AuthStore] Could not clear registration notifications:",e)}if(l&&("unauthenticated"===s||"loading"===s)){console.log("[AuthStore] Detected guest-to-authenticated transition, resetting game state");try{Promise.resolve().then(n.bind(n,83872)).then(function(e){e.useJassStore.getState().resetJass()}),Promise.resolve().then(n.bind(n,28742)).then(function(e){e.useGameStore.getState().resetGameState({newActiveGameId:null})}),Promise.resolve().then(n.bind(n,10637)).then(function(e){e.useTimerStore.getState().resetAllTimers()})}catch(e){console.warn("[AuthStore] Error resetting game state during guest-to-auth transition:",e)}}return g=null,i.prev=1,i.next=2,new Promise(function(e){return setTimeout(e,100)});case 2:return y=(0,d.doc)(a.db,b.sb,o.uid),i.next=3,(0,d.getDoc)(y);case 3:if(S=i.sent,x=null,S.exists()&&null!=(k=x=S.data())&&k.playerId&&"string"==typeof x.playerId&&(g=x.playerId),g){i.next=8;break}return i.prev=4,D=(null==(P=x)?void 0:P.displayName)||o.displayName||"Spieler_".concat(o.uid.substring(0,6)),i.next=5,(0,w.getPlayerIdForUser)(o.uid,D);case 5:g=i.sent,i.next=7;break;case 6:i.prev=6,G=i.catch(4),console.error("AUTH_STORE: getPlayerIdForUser failed for ".concat(o.uid,":"),G),g=null;case 7:i.next=9;break;case 8:case 9:if(!g){i.next=13;break}return i.prev=10,i.next=11,h.Q5.getState().loadUserGroupsByPlayerId(g);case 11:i.next=13;break;case 12:i.prev=12,V=i.catch(10),console.error("AUTH_STORE: loadUserGroupsByPlayerId failed for ".concat(g,":"),V);case 13:if("loading"!==s&&"unauthenticated"!==s){i.next=18;break}return F=n(94566).useUIStore.getState().notifications.some(function(e){return e.message.includes("Registrierung erfolgreich")||e.message.includes("Pr\xfcfe deine Email")||e.message.includes("Gruppen-Einladung")}),i.next=14,v(F);case 14:if(!(U=i.sent)){i.next=18;break}return i.prev=15,i.next=16,(0,c.kQ)(o.uid,{lastActiveGroupId:U});case 16:i.next=18;break;case 17:i.prev=17,B=i.catch(15),console.error("AUTH_STORE: Fehler beim Aktualisieren der lastActiveGroupId auf ".concat(U,":"),B);case 18:C=(0,d.onSnapshot)(y,function(){var r=O(A().mark(function r(n){var i,s,u,l,h,f,p,m,g;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.exists()){r.next=11;break}if(i=_({},n.data()),s=!1,u="".concat(o.uid,"_migration"),!j.get(u)){r.next=1;break}return e({user:(0,c._N)(o,i),status:"authenticated"}),r.abrupt("return");case 1:if(i.preferences&&"object"===T(i.preferences)&&(i.preferences.theme&&(i.profileTheme=i.preferences.theme,"light"===i.profileTheme&&delete i.profileTheme),delete i.preferences,s=!0),!i.email&&o.email&&(i.email=o.email,s=!0),i.profileTheme||(h=(l=Object.keys(E.lt))[Math.floor(Math.random()*l.length)],i.profileTheme=h,s=!0),!s){r.next=6;break}return j.set(u,!0),r.prev=2,r.next=3,(0,d.updateDoc)(y,i);case 3:r.next=5;break;case 4:r.prev=4,m=r.catch(2),console.error("AUTH_STORE: Fehler bei der automatischen Datenmigration f\xfcr User ".concat(o.uid,":"),m);case 5:return r.prev=5,setTimeout(function(){j.delete(u)},2e3),r.finish(5);case 6:if(!((f=(0,c._N)(o,i)).playerId&&f.displayName)){r.next=10;break}return r.prev=7,p=(0,d.doc)(a.db,b.eZ,f.playerId),r.next=8,(0,d.updateDoc)(p,{displayName:f.displayName});case 8:r.next=10;break;case 9:r.prev=9,g=r.catch(7),console.error("AUTH_STORE: Error syncing player nickname for ".concat(f.playerId,":"),g);case 10:e({user:f,status:"authenticated"}),r.next=12;break;case 11:console.warn("AUTH_STORE: Firestore user document not found for ".concat(o.uid,". Using Auth data only.")),e({user:(0,c._N)(o,null),status:"authenticated"});case 12:case"end":return r.stop()}},r,null,[[2,4,5,6],[7,9]])}));return function(e){return r.apply(this,arguments)}}(),function(r){console.error("AUTH_STORE: Fehler beim User Doc Listener f\xfcr ".concat(o.uid,":"),r),e({status:"error",error:"Fehler beim Laden der Benutzerdaten."})}),g&&(M=(0,d.doc)(a.db,b.eZ,g),N=(0,d.onSnapshot)(M,function(e){if(e.exists()){var r,n=e.data().groupIds||[],i=new Set(h.Q5.getState().userGroups.map(function(e){return e.id})),o=new Set(n),a=!1,s=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return I(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,r):void 0}}(e))){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(i);try{for(s.s();!(r=s.n()).done;){var u=r.value;o.has(u)||(a=!0)}}catch(e){s.e(e)}finally{s.f()}a||i.size===o.size||(a=!0)}},function(e){console.error("AUTH_STORE: Fehler beim Player Doc Listener f\xfcr Player ".concat(g,":"),e)})),i.next=20;break;case 19:i.prev=19,console.error("AUTH_STORE: Fehler bei der Initialisierung (playerId/Gruppenladen):",z=i.catch(1)),z instanceof u.g&&("permission-denied"===z.code||z.message.includes("Missing or insufficient permissions"))?(console.warn("AUTH_STORE: Permission error detected during initialization - this is normal during page reload. User stays authenticated."),e({status:"authenticated",error:null})):e({status:"error",error:"Initialisierung fehlgeschlagen."});case 20:i.next=22;break;case 21:e({user:null,firebaseUser:null,status:"unauthenticated",isGuest:r().isGuest}),h.Q5.getState().resetGroupStore();case 22:case"end":return i.stop()}},i,null,[[1,19],[4,6],[10,12],[15,17]])})),function(e){return i.apply(this,arguments)}),function(r){L&&clearTimeout(L),R=!1,console.error("AUTH_STORE: Kritischer Fehler im onAuthStateChanged-Listener:",r),e({status:"error",error:"Ein kritischer Fehler bei der Authentifizierung ist aufgetreten."})}))},clearError:function(){e({error:null})}}},{name:"auth-storage",partialize:function(e){return{appMode:e.appMode,isGuest:e.isGuest,user:e.user?{uid:e.user.uid,displayName:e.user.displayName,photoURL:e.user.photoURL,email:e.user.email}:null}}}))},28742:(e,r,n)=>{"use strict";n.r(r),n.d(r,{useGameStore:()=>M});var i=n(8106),o=n(83872),a=n(57724),s=n(15424),u=n(94566),c=n(50498),l=n(10637),h=n(42471);n(88880);var d=n(85253),f=n(38791),p=n(31931),m=n(48101),g=n(13848),y=n(42009),v=n(99407),b=n(21297),w=n(4319);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(){x=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(w=I);var T=b.prototype=y.prototype=Object.create(w);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==S(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(S(r)+" is not iterable")}return v.prototype=b,o(T,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function E(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function I(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return T(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,r):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function k(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function _(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?k(Object(n),!0).forEach(function(r){A(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function A(e,r,n){var i;return(i=function(e,r){if("object"!=S(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=S(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(r,"string"),(r="symbol"==S(i)?i:i+"")in e)?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}(0,y.getFirestore)(g.firebaseApp);var P={berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},O={1:"",2:"",3:"",4:""},C=function(e,r){var n,i,o;return{activeGameId:void 0,currentPlayer:e,startingPlayer:e,initialStartingPlayer:e,isGameStarted:!1,currentRound:1,weisPoints:{top:0,bottom:0},jassPoints:{top:0,bottom:0},scores:{top:0,bottom:0},striche:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},roundHistory:[],currentRoundWeis:[],isGameCompleted:!1,isRoundCompleted:!1,scoreSettings:null!=(n=null==r?void 0:r.scoreSettings)?n:f.$d,farbeSettings:null!=(i=null==r?void 0:r.farbeSettings)?i:d.FT,strokeSettings:null!=(o=null==r?void 0:r.strokeSettings)?o:h.zh,playerNames:O,gamePlayers:null,currentHistoryIndex:-1,historyState:(0,s._9)(),farbe:void 0,isTransitioning:!1}},N=function(e,r,n,i,o){var a,s,c,l=u.useUIStore.getState().settings,h=(null==o?void 0:o.cardStyle)||l.cardStyle,d=Date.now(),f=(null==(a=e.gamePlayers)||null==(a=a[i])?void 0:a.name)||e.playerNames[i]||"Spieler ".concat(i),p=void 0;e.roundHistory.length>0&&e.currentHistoryIndex>=0&&(p=null==(c=e.roundHistory[e.currentHistoryIndex])?void 0:c.roundId);var m=e.roundHistory[e.currentHistoryIndex],g=m?m.timestamp:void 0,y=[];e.currentPlayer&&y.push({player:e.currentPlayer,startTime:g||d-5e3,endTime:d});var v={id:"".concat(d,"-").concat(Math.random().toString(36).substr(2,9)),timestamp:d,roundId:d,startingPlayer:i,startingPlayerName:f,weisPoints:_({},e.weisPoints),jassPoints:_({},e.jassPoints),scores:_({},e.scores),weisActions:I(null!=(s=e.currentRoundWeis)?s:[]),currentPlayer:e.currentPlayer,isActive:!0,visualStriche:{top:r().getVisualStriche("top"),bottom:r().getVisualStriche("bottom")},previousRoundId:p,nextRoundId:void 0,roundState:{roundNumber:e.currentRound,nextPlayer:e.currentPlayer},striche:{top:_({},e.striche.top),bottom:_({},e.striche.bottom)},startTime:g||d-5e3,endTime:d,playerTurns:y};if("weis"===n)return _(_({},v),{},{actionType:"weis",isRoundFinalized:!1,isCompleted:!1});var b=_(_({},v),{},{actionType:"jass",isRoundFinalized:!0,isCompleted:!0,farbe:null==o?void 0:o.farbe,cardStyle:h});return null!=o&&o.strichInfo?b.strichInfo=o.strichInfo:null!=o&&o.strichType&&(b.strichType=o.strichType),b},L=function(e){return Math.max(0,e)},D=function(e,r){var i=e.currentHistoryIndex,o=[].concat(I(e.roundHistory.slice(0,i+1)),[r]),a=e.roundHistory.slice(i+1);if(a.length>0&&e.activeGameId){var s=a.map(function(e){return e.roundId}).filter(function(e){return void 0!==e});s.length>0?setTimeout(function(){Promise.resolve().then(n.bind(n,99407)).then(function(r){(0,r.markRoundsAsInactive)(e.activeGameId,s).catch(function(e){return console.error("[GameStore] Fehler beim Deaktivieren der \xfcberschriebenen Runden:",e)})})},0):console.log("[truncateFutureAndAddEntry] Keine g\xfcltigen roundIds zum Deaktivieren gefunden.")}return o.length>U&&o.splice(0,o.length-U),{roundHistory:o,currentHistoryIndex:o.length-1}},R=function(e,r){var n,i,o;return e?{currentRound:e.roundState.roundNumber,currentPlayer:e.roundState.nextPlayer,startingPlayer:e.startingPlayer,weisPoints:null!=(n=e.weisPoints)?n:{top:0,bottom:0},jassPoints:null!=(i=e.jassPoints)?i:{top:0,bottom:0},scores:e.scores,striche:e.striche,currentRoundWeis:null!=(o=e.weisActions)?o:[],isRoundCompleted:e.isCompleted}:{currentRound:1,currentPlayer:r().initialStartingPlayer,weisPoints:{top:0,bottom:0},jassPoints:{top:0,bottom:0},scores:{top:0,bottom:0},striche:{top:_({},P),bottom:_({},P)},currentRoundWeis:[],isRoundCompleted:!1}},j=function(e,r){return e.striche.top[r]>0?"top":e.striche.bottom[r]>0?"bottom":void 0},F=function(e){var r=o.useJassStore.getState(),n=r.getCurrentGame();if(n){var i=e.weisPoints;r.updateCurrentGame({teams:{top:_(_({},n.teams.top),{},{striche:e.striche.top,jassPoints:e.scores.top,weisPoints:(n.teams.top.weisPoints||0)+((null==i?void 0:i.top)||0),total:e.scores.top}),bottom:_(_({},n.teams.bottom),{},{striche:e.striche.bottom,jassPoints:e.scores.bottom,weisPoints:(n.teams.bottom.weisPoints||0)+((null==i?void 0:i.bottom)||0),total:e.scores.bottom})},roundHistory:e.roundHistory,currentRound:e.currentRound+1,currentPlayer:e.currentPlayer})}},U=50,M=(0,i.v)()((0,w.lt)((0,w.Zr)(function(e,r){return _(_({},C(1)),{},{gamePlayers:null,playerNames:{1:"Spieler 1",2:"Spieler 2",3:"Spieler 3",4:"Spieler 4"},scoreSettings:f.$d,farbeSettings:d.FT,strokeSettings:h.zh,activeGameId:void 0,isTransitioning:!1,startGame:function(n,i){console.log("\uD83D\uDE80 [GameStore] startGame called (wird ggf. durch resetGame abgel\xf6st)",{initialStartingPlayer:i,gamePlayers:n,activeGameId:r().activeGameId}),e(function(e){var r=_(_({},C(i,{scoreSettings:e.scoreSettings,farbeSettings:e.farbeSettings,strokeSettings:e.strokeSettings})),{},{playerNames:e.playerNames,gamePlayers:n,activeGameId:e.activeGameId,isGameStarted:!0}),o=window.__FIRESTORE_SYNC_API__;return null!=o&&o.markLocalUpdate&&o.markLocalUpdate(),r}),l.useTimerStore.getState().startGameTimer()},startRound:function(){var n=r(),i=l.useTimerStore.getState();1===n.currentRound&&i.startGameTimer(),i.startRoundTimer(),e(function(){return{isRoundCompleted:!1,farbe:void 0,currentRoundWeis:[],weisPoints:{top:0,bottom:0}}})},finalizeRound:function(i,o){var a=l.useTimerStore.getState(),c=r().activeGameId,d=u.useUIStore.getState().settings;r().validateHistoryAction(),a.resetRoundTimer(),a.startRoundTimer();var m=null,g=null,w=null;e(function(e){p.Q5.getState().currentGroup,u.useUIStore.getState(),null!=e.strokeSettings||h.zh,null!=e.scoreSettings||f.$d;var n,a,l=e.currentPlayer,y=e.currentHistoryIndex>=0?e.roundHistory[e.currentHistoryIndex]:null,v=y?y.scores:{top:0,bottom:0},b=e.currentRound+1,S=(null!=(n=e.currentRoundWeis)?n:[]).reduce(function(e,r){return e[r.position]=(e[r.position]||0)+r.points,e},{top:0,bottom:0}),x=_({},e.striche),E=void 0;if(o){var I=o.team,T=o.type;if(E={team:I,type:T},"matsch"===T)x[I]=_(_({},x[I]),{},{matsch:x[I].matsch+1});else if("kontermatsch"===T){var k=p.Q5.getState().currentGroup,A=u.useUIStore.getState(),P=k&&null!==k.strokeSettings&&void 0!==k.strokeSettings?k.strokeSettings:A.strokeSettings;x[I]=_(_({},x[I]),{},{kontermatsch:x[I].kontermatsch+P.kontermatsch})}else if("schneider"===T){var O=p.Q5.getState().currentGroup,C=u.useUIStore.getState(),L=O&&null!==O.strokeSettings&&void 0!==O.strokeSettings?O.strokeSettings:C.strokeSettings;console.log("[GameStore.finalizeRound] Schneider mit Stroke-Settings:",{team:I,schneiderValue:L.schneider,currentValue:x[I].schneider,newTotal:x[I].schneider+L.schneider,source:O?"group":"uiStore"}),x[I]=_(_({},x[I]),{},{schneider:x[I].schneider+L.schneider})}}var R={top:v.top+i.top+S.top,bottom:v.bottom+i.bottom+S.bottom},j=(0,s.vm)(l),F=_(_({},e),{},{scores:R,striche:x,weisPoints:S,currentRoundWeis:e.currentRoundWeis,currentRound:b,currentPlayer:j,jassPoints:i,roundHistory:e.roundHistory||[],currentHistoryIndex:null!=(a=e.currentHistoryIndex)?a:-1,historyState:e.historyState||(0,s._9)(),playerNames:e.playerNames,gamePlayers:e.gamePlayers,activeGameId:e.activeGameId,initialStartingPlayer:e.initialStartingPlayer,isGameStarted:e.isGameStarted,isGameCompleted:e.isGameCompleted,scoreSettings:e.scoreSettings,farbeSettings:e.farbeSettings,strokeSettings:e.strokeSettings}),U=N(F,r,"jass",l,{farbe:e.farbe,strichInfo:E,cardStyle:d.cardStyle}),M=D(e,U);return w=_(_({},e),{},{scores:R,striche:x,weisPoints:S,currentRoundWeis:e.currentRoundWeis,isRoundCompleted:!0,currentRound:b,currentPlayer:j,startingPlayer:l,jassPoints:i,roundHistory:M.roundHistory,currentHistoryIndex:M.currentHistoryIndex,historyState:e.historyState||(0,s._9)(),playerNames:F.playerNames,gamePlayers:F.gamePlayers,activeGameId:c,initialStartingPlayer:F.initialStartingPlayer,isGameStarted:F.isGameStarted,isGameCompleted:F.isGameCompleted,scoreSettings:F.scoreSettings,farbeSettings:F.farbeSettings,strokeSettings:F.strokeSettings}),m=_(_({},e),{},{scores:R,striche:x,weisPoints:{top:0,bottom:0},currentRoundWeis:[],isRoundCompleted:!0,currentRound:b+1,currentPlayer:j,startingPlayer:j},M),g=U,m});var S=r();w?F(w):(console.warn("[GameStore.finalizeRound] stateForJassStoreSyncInternal war nicht gesetzt. Sync mit potenziell falschem State."),F(S)),window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync(),c&&setTimeout(function(){null!=(e=window.__FIRESTORE_SYNC_API__)&&e.markLocalUpdate&&window.__FIRESTORE_SYNC_API__.markLocalUpdate();var e,i=r(),o={scores:i.scores,weisPoints:i.weisPoints,currentRound:i.currentRound,currentPlayer:i.currentPlayer,startingPlayer:i.startingPlayer,striche:i.striche,isRoundCompleted:i.isRoundCompleted,currentJassPoints:i.jassPoints,currentRoundWeis:i.currentRoundWeis,lastUpdated:(0,y.serverTimestamp)()},a=(0,b.g)(o);(0,v.updateActiveGame)(c,a).catch(function(e){return console.error("[GameStore.finalizeRound] Firestore update failed:",e)}),g&&Promise.resolve().then(n.bind(n,99407)).then(function(e){var r=e.saveRoundToFirestore;g&&r(c,g).catch(function(e){return console.error("[GameStore.finalizeRound] Round save failed:",e)})})},0),a.resetRoundTimer(),a.startRoundTimer()},updateScore:function(r,n,i){e(function(e){var o=_({},e.scores);return o[r]=L(n),o["top"===r?"bottom":"top"]=L(i),{scores:o}})},addStrich:function(r,n){e(function(e){var i=_(_({},e.striche[r]),{},A({},n,e.striche[r][n]+1));return o.useJassStore.getState().updateCurrentGame({teams:A({},r,{striche:i})}),console.log("\uD83C\uDFB2 Strich hinzugef\xfcgt:",{team:r,type:n,newValue:i[n],allStriche:i}),window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync(),_(_({},e),{},{striche:_(_({},e.striche),{},A({},r,i))})})},addWeisPoints:function(n,i){var o=r();if(o.currentHistoryIndex<o.roundHistory.length-1)return void(0,u.useUIStore.getState().showHistoryWarning)({message:"Weis wirklich korrigieren? Sp\xe4tere Eintr\xe4ge werden \xfcberschrieben.",onConfirm:function(){e(function(e){var o=_({},e.weisPoints);o[n]=(o[n]||0)+i;var a=[].concat(I(e.currentRoundWeis||[]),[{position:n,points:i}]),s=N(_(_({},e),{},{weisPoints:o,currentRoundWeis:a}),r,"weis",e.startingPlayer),u=D(e,s);return _(_({},e),{},{weisPoints:o,currentRoundWeis:a},u)})},onCancel:function(){return r().jumpToLatest()},type:"error"});var a=null;e(function(e){var o=_({},e.weisPoints);o[n]=(o[n]||0)+i;var s=[].concat(I(e.currentRoundWeis||[]),[{position:n,points:i}]),u=N(_(_({},e),{},{weisPoints:o,currentRoundWeis:s}),r,"weis",e.startingPlayer),c=D(e,u);return a=_(_({},e),{},{weisPoints:o,currentRoundWeis:s},c)}),window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync()},undoLastWeis:function(){e(function(e){var r=e.currentRoundWeis.slice(0,-1),n={top:0,bottom:0};return r.forEach(function(e){n[e.position]+=e.points}),_(_({},e),{},{currentRoundWeis:r,weisPoints:n})})},finalizeGame:function(){e(function(){return{isGameCompleted:!0,isTransitioning:!0}})},resetGame:function(r,n,i){var a,s;(a=x().mark(function e(){var r,n,i,a,s,c,l,v,b,w,S,E,I;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.yu.getState().currentTournamentInstance,i=p.Q5.getState().currentGroup,a=u.useUIStore.getState(),!(null!=n&&n.settings)){e.next=1;break}return e.abrupt("return",{scoreSettings:_(_({},f.$d),n.settings.scoreSettings||{}),strokeSettings:n.settings.strokeSettings||h.zh,farbeSettings:n.settings.farbeSettings||d.FT,source:"tournament"});case 1:if(!i){e.next=2;break}return e.abrupt("return",{scoreSettings:_(_({},f.$d),i.scoreSettings||{}),strokeSettings:i.strokeSettings||h.zh,farbeSettings:i.farbeSettings||d.FT,source:"group"});case 2:if(!(s=null==(r=o.useJassStore.getState().currentSession)?void 0:r.id)){e.next=8;break}return e.prev=3,c=(0,y.getFirestore)(g.firebaseApp),l=(0,y.doc)(c,"sessions",s),e.next=4,(0,y.getDoc)(l);case 4:if(!(v=e.sent).exists()||!(w=(b=v.data()).groupId||b.gruppeId)){e.next=6;break}return console.log("[gameStore] resetGame: currentGroup ist leer, lade Gruppen-Settings aus Firestore f\xfcr Gruppe ".concat(w)),S=(0,y.doc)(c,"groups",w),e.next=5,(0,y.getDoc)(S);case 5:if(!(E=e.sent).exists()){e.next=6;break}return I=E.data(),e.abrupt("return",{scoreSettings:_(_({},f.$d),I.scoreSettings||{}),strokeSettings:I.strokeSettings||h.zh,farbeSettings:I.farbeSettings||d.FT,source:"group-firestore"});case 6:e.next=8;break;case 7:e.prev=7,console.warn("[gameStore] resetGame: Fehler beim Laden der Gruppen-Settings aus Firestore:",e.catch(3));case 8:return e.abrupt("return",{scoreSettings:a.scoreSettings,strokeSettings:a.strokeSettings,farbeSettings:a.farbeSettings,source:"uiStore"});case 9:case"end":return e.stop()}},e,null,[[3,7]])}),s=function(){var e=this,r=arguments;return new Promise(function(n,i){var o=a.apply(e,r);function s(e){E(o,n,i,s,u,"next",e)}function u(e){E(o,n,i,s,u,"throw",e)}s(void 0)})},function(){return s.apply(this,arguments)})().then(function(i){e(function(e){var o=e.playerNames,a=e.gamePlayers;return _(_({},C(r)),{},{scoreSettings:i.scoreSettings,strokeSettings:i.strokeSettings,farbeSettings:i.farbeSettings,playerNames:o,gamePlayers:a,activeGameId:n,roundHistory:[],currentHistoryIndex:-1,isGameStarted:!!n,isTransitioning:!1})})}).catch(function(i){console.error("[gameStore] resetGame: Fehler bei Settings-Ermittlung:",i),e(function(e){var i=e.playerNames,o=e.gamePlayers,a=u.useUIStore.getState();return _(_({},C(r)),{},{scoreSettings:a.scoreSettings,strokeSettings:a.strokeSettings,farbeSettings:a.farbeSettings,playerNames:i,gamePlayers:o,activeGameId:n,roundHistory:[],currentHistoryIndex:-1,isGameStarted:!!n,isTransitioning:!1})})})},resetGamePoints:function(){e(function(){return{scores:{top:0,bottom:0}}})},setScore:function(r,n){e(function(e){var i=_({},e.scores);return i[r]=L(n),{scores:i}})},setPlayerNames:function(r){e(function(){return{playerNames:r}})},updateScoreByStrich:function(i,o){var a=r();if(a.currentHistoryIndex<a.roundHistory.length-1){var s=u.useUIStore.getState().showHistoryWarning;console.log("[GameStore.updateScoreByStrich] History warning triggered."),s({message:c.W,onConfirm:function(){console.log("[GameStore.updateScoreByStrich] Executing action after history warning confirmation (overwrite)");var a=null;e(function(e){var n=_({},e.scores);n[i]+=o;var s=N(_(_({},e),{},{scores:n}),r,"jass",e.startingPlayer),u=D(e,s);return console.log("[GameStore.updateScoreByStrich] History overwritten. New state:",{currentIndex:(a=_(_({},e),{},{scores:n},u)).currentHistoryIndex,historyLength:a.roundHistory.length,scores:a.scores[i]}),a}),setTimeout(function(){null!=(e=window.__FIRESTORE_SYNC_API__)&&e.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.updateScoreByStrich.onConfirm] markLocalUpdate API not available!");var e,i=r(),o=i.activeGameId;if(o){var a={scores:i.scores},s=(0,b.g)(a);if((0,v.updateActiveGame)(o,s).catch(console.error),i.roundHistory.length>0){var u=i.roundHistory[i.roundHistory.length-1];Promise.resolve().then(n.bind(n,99407)).then(function(e){(0,e.saveRoundToFirestore)(o,u).catch(console.error)})}}},0)},onCancel:function(){return r().jumpToLatest()},type:"error"});return}console.log("[GameStore.updateScoreByStrich] No history warning needed, proceeding with normal state update.");var l=null;e(function(e){var n=_({},e.scores);n[i]+=o;var a=N(_(_({},e),{},{scores:n}),r,"jass",e.startingPlayer),s=D(e,a);return console.log("[GameStore.updateScoreByStrich] Normal score updated by strich:",{currentIndex:(l=_(_({},e),{},{scores:n},s)).currentHistoryIndex,historyLength:l.roundHistory.length,scores:l.scores[i]}),l}),window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync(),setTimeout(function(){null!=(e=window.__FIRESTORE_SYNC_API__)&&e.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.updateScoreByStrich] markLocalUpdate API not available!");var e,i=r(),o=i.activeGameId;if(o){var a={scores:i.scores},s=(0,b.g)(a);if((0,v.updateActiveGame)(o,s).catch(console.error),i.roundHistory.length>0){var u=i.roundHistory[i.roundHistory.length-1];Promise.resolve().then(n.bind(n,99407)).then(function(e){(0,e.saveRoundToFirestore)(o,u).catch(console.error)})}}},0)},getVisualStriche:function(e){var n=r().scores[e],i=(0,a.J)(n),o=i.striche,s=i.restZahl;return{stricheCounts:{20:o["20"],50:o["50"],100:o["100"]},restZahl:s}},navigateHistory:function(n){var i=r();Date.now();var o=i.currentHistoryIndex,a=-1,s=null,c=0,l=i.roundHistory.length+1;do{if(c++,(o="forward"===n?o+1:o-1)<-1||o>=i.roundHistory.length){console.warn("[navigateHistory] Index out of bounds: ".concat(o,", L\xe4nge: ").concat(i.roundHistory.length,". Stopping navigation.")),u.useUIStore.setState({isNavigatingHistory:!1});return}if(s=o>=0?i.roundHistory[o]:null,-1===o||s&&(void 0===s.isActive||!0===s.isActive)){a=o;break}console.log("[navigateHistory] Skipping inactive entry at index: ".concat(o))}while(c<l);if(-1===a&&c>=l){console.error("[navigateHistory] Max attempts reached, could not find active entry. Stopping."),u.useUIStore.setState({isNavigatingHistory:!1});return}e(_(_({},R(s,function(){return i})),{},{currentHistoryIndex:a,weisPoints:{top:0,bottom:0},currentRoundWeis:[]})),u.useUIStore.setState({isNavigatingHistory:!1})},canNavigateForward:function(){var e=r();return e.currentHistoryIndex<e.roundHistory.length-1},canNavigateBackward:function(){return r().currentHistoryIndex>-1},jumpToLatest:function(){e(function(e){var r=e.roundHistory.length-1;if(r===e.currentHistoryIndex)return e;var n=e.roundHistory[r];if(!n)return e;var i=_(_({},e),{},{currentRound:n.roundState.roundNumber,currentPlayer:n.roundState.nextPlayer,weisPoints:n.weisPoints,jassPoints:n.jassPoints,scores:n.scores,striche:n.striche,currentRoundWeis:n.weisActions,currentHistoryIndex:r,historyState:{lastNavigationTimestamp:Date.now(),weisCache:null},isRoundCompleted:n.isCompleted});"jass"===n.actionType&&(i=_(_({},i),{},{weisPoints:{top:0,bottom:0},currentRoundWeis:[]}),console.log("[jumpToLatest] Resetting weisPoints/currentRoundWeis for restored Jass entry."));var a=l.useTimerStore.getState(),s=o.useJassStore.getState();return a.reactivateGameTimer(s.currentGameId),F(i),i})},syncHistoryState:function(r){e(function(e){return _(_({},e),{},{roundHistory:[].concat(I(e.roundHistory),[r]),currentHistoryIndex:e.roundHistory.length,historyState:{isNavigating:!1,lastNavigationTimestamp:Date.now()}})})},logGameHistory:function(){return r().roundHistory.filter(function(e){return e.isRoundFinalized}).map(function(e){return{roundId:e.roundId,farbe:"jass"===e.actionType?e.farbe:void 0,strichInfo:"jass"===e.actionType?e.strichInfo:void 0,timestamp:new Date(e.timestamp).toLocaleString("de-CH"),points:{top:e.jassPoints.top,bottom:e.jassPoints.bottom},weisPoints:{top:e.weisPoints.top,bottom:e.weisPoints.bottom},totalPoints:{top:e.scores.top,bottom:e.scores.bottom}}})},restoreRoundState:function(r){e(function(e){return _(_({},e),{},{currentRound:r.roundState.roundNumber,currentPlayer:r.roundState.nextPlayer})})},isBergActive:function(e){return r().striche[e].berg>0},isSiegActive:function(e){return r().striche[e].sieg>0},addBerg:function(n){var i=null;e(function(e){var r,o=u.useUIStore.getState().scoreSettings;if(!(null!=o&&null!=(r=o.enabled)&&r.berg))return e;var a=j(e,"berg"),s=_({},e.striche);a===n?s[n].berg=0:a||(s[n].berg=1,s["top"===n?"bottom":"top"].berg=0);var c=_(_({},e),{},{striche:s});return F(c),i=c,c}),window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync();var o=r();if(o.activeGameId){null!=(a=window.__FIRESTORE_SYNC_API__)&&a.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.addBerg] markLocalUpdate API not available!");var a,s=o.activeGameId,c={striche:o.striche,lastUpdated:(0,y.serverTimestamp)()},l=(0,b.g)(c);(0,v.updateActiveGame)(s,l).catch(function(e){return console.error("[GameStore.addBerg] Firestore update failed.",e)})}else i&&console.warn("[GameStore.addBerg] activeGameId fehlte im State nach get(), verwende alten finalState f\xfcr Log, falls vorhanden. Firestore-Update \xfcbersprungen.",{oldFinalState:i})},addSieg:function(n){var i=!1;if(e(function(e){var r=p.Q5.getState().currentGroup,o=u.useUIStore.getState(),a=r&&null!==r.scoreSettings&&void 0!==r.scoreSettings?r.scoreSettings:o.scoreSettings,s=r&&null!==r.strokeSettings&&void 0!==r.strokeSettings?r.strokeSettings:o.strokeSettings,c=j(e,"sieg"),l=!a.enabled.berg||e.striche.top.berg>0||e.striche.bottom.berg>0,h=_({},e.striche);if(c===n){h[n]=_(_({},h[n]),{},{sieg:0,schneider:0});var d={striche:h};return F(_(_({},e),d)),i=!0,d}if(!c&&l){var f="top"===n?"bottom":"top";h[n]=_(_({},h[n]),{},{sieg:2}),h[f]=_(_({},h[f]),{},{sieg:0,schneider:0}),a.enabled.schneider&&e.scores[f]<a.values.schneider?h[n].schneider=s.schneider:h[n].schneider=0;var m={striche:h};return F(_(_({},e),m)),i=!0,m}if(JSON.stringify(e.striche)===JSON.stringify(h))return{};i=!0;var g=_(_({},e),{},{striche:h});return F(g),g}),i&&window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync(),i){var o=r();if(o.activeGameId){null!=(a=window.__FIRESTORE_SYNC_API__)&&a.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.addSieg] markLocalUpdate API not available!");var a,s=o.activeGameId,c={striche:o.striche,lastUpdated:(0,y.serverTimestamp)()},l=(0,b.g)(c);(0,v.updateActiveGame)(s,l).catch(function(e){return console.error("[GameStore.addSieg] Firestore update failed.",e)})}else console.warn("[GameStore.addSieg] Striche changed but activeGameId missing, skipping Firestore update.")}},addSchneider:function(r){e(function(e){var n,i,o=p.Q5.getState().currentGroup,a=u.useUIStore.getState(),s=null!=(n=null==o?void 0:o.scoreSettings)?n:a.scoreSettings,c=null!=(i=null==o?void 0:o.strokeSettings)?i:a.strokeSettings;if(console.log("\uD83C\uDFB2 Settings beim Schneider:",{activeScoreSettings:s,activeStrokeSettings:c,team:r,currentStriche:e.striche[r]}),1!==e.striche[r].sieg)return console.log("Kein Sieg vorhanden, Schneider nicht hinzugef\xfcgt."),e;var l="top"===r?"bottom":"top",h=e.scores[l],d=s.enabled.schneider&&h<s.values.schneider;console.log("Schneider Pr\xfcfung:",{isSchneider:d,otherTeamPoints:h,limit:s.values.schneider,enabled:s.enabled.schneider});var f=d?c.schneider:0;if(e.striche[r].schneider===f)return console.log("Schneider-Status unver\xe4ndert."),e;var m=_(_({},e),{},{striche:_(_({},e.striche),{},A(A({},r,_(_({},e.striche[r]),{},{schneider:f})),l,_(_({},e.striche[l]),{},{schneider:0})))});return F(m),m})},addMatsch:function(i){var o=r();if(o.currentHistoryIndex<o.roundHistory.length-1){var a=u.useUIStore.getState().showHistoryWarning;console.log("[GameStore.addMatsch] History warning triggered."),a({message:"M\xf6chten Sie wirklich einen Matsch in der Vergangenheit hinzuf\xfcgen?",onConfirm:function(){console.log("[GameStore.addMatsch] Executing action after history warning confirmation (overwrite)");var o=null;e(function(e){var n=_(_({},e.striche),{},A({},i,_(_({},e.striche[i]),{},{matsch:e.striche[i].matsch+1}))),a=N(_(_({},e),{},{striche:n}),r,"jass",e.startingPlayer,{strichInfo:{team:i,type:"matsch"}}),s=D(e,a);return console.log("[GameStore.addMatsch] History overwritten. New state:",{currentIndex:(o=_(_({},e),{},{striche:n},s)).currentHistoryIndex,historyLength:o.roundHistory.length,striche:o.striche[i].matsch}),o}),setTimeout(function(){null!=(e=window.__FIRESTORE_SYNC_API__)&&e.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.addMatsch.onConfirm] markLocalUpdate API not available!");var e,i=r(),o=i.activeGameId;if(o){var a={striche:i.striche},s=(0,b.g)(a);if((0,v.updateActiveGame)(o,s).catch(console.error),i.roundHistory.length>0){var u=i.roundHistory[i.roundHistory.length-1];Promise.resolve().then(n.bind(n,99407)).then(function(e){(0,e.saveRoundToFirestore)(o,u).catch(console.error)})}}},0)},onCancel:function(){return r().jumpToLatest()}});return}console.log("[GameStore.addMatsch] No history warning needed, proceeding.");var s=null;e(function(e){var n=_(_({},e.striche),{},A({},i,_(_({},e.striche[i]),{},{matsch:e.striche[i].matsch+1}))),o=N(_(_({},e),{},{striche:n}),r,"jass",e.startingPlayer,{strichInfo:{team:i,type:"matsch"}}),a=D(e,o);return console.log("[GameStore.addMatsch] Normal Matsch added:",{currentIndex:(s=_(_({},e),{},{striche:n},a)).currentHistoryIndex,historyLength:s.roundHistory.length,striche:s.striche[i].matsch}),s}),window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync(),setTimeout(function(){null!=(e=window.__FIRESTORE_SYNC_API__)&&e.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.addMatsch] markLocalUpdate API not available!");var e,i=r(),o=i.activeGameId;if(o){var a={striche:i.striche},s=(0,b.g)(a);if((0,v.updateActiveGame)(o,s).catch(console.error),i.roundHistory.length>0){var u=i.roundHistory[i.roundHistory.length-1];Promise.resolve().then(n.bind(n,99407)).then(function(e){(0,e.saveRoundToFirestore)(o,u).catch(console.error)})}}},0)},getTotalStriche:function(e){var n,i,o=r(),a=u.useUIStore.getState().scoreSettings,s=o.striche[e],c=0;return null!=a&&null!=(n=a.enabled)&&n.berg&&(c+=s.berg),c+=s.sieg,null!=a&&null!=(i=a.enabled)&&i.schneider&&(c+=s.schneider),c+=s.matsch,c+=s.kontermatsch},completeRound:function(){var r=l.useTimerStore.getState();e(function(e){return _(_({},e),{},{isRoundCompleted:!0,currentRound:e.currentRound+1})}),r.resetRoundTimer()},addKontermatsch:function(i){var o=r();if(o.currentHistoryIndex<o.roundHistory.length-1)return void(0,u.useUIStore.getState().showHistoryWarning)({message:"M\xf6chten Sie wirklich einen Kontermatsch in der Vergangenheit hinzuf\xfcgen?",onConfirm:function(){e(function(e){var n=p.Q5.getState().currentGroup,o=u.useUIStore.getState(),a=n&&null!==n.strokeSettings&&void 0!==n.strokeSettings?n.strokeSettings:o.strokeSettings,s=_(_({},e.striche),{},A({},i,_(_({},e.striche[i]),{},{kontermatsch:a.kontermatsch}))),c=N(_(_({},e),{},{striche:s}),r,"jass",e.startingPlayer,{strichInfo:{team:i,type:"kontermatsch"}}),l=D(e,c);return _(_({},e),{},{striche:s},l)}),setTimeout(function(){null!=(e=window.__FIRESTORE_SYNC_API__)&&e.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.addKontermatsch.onConfirm] markLocalUpdate API not available!");var e,i=r(),o=i.activeGameId;if(o){var a={striche:i.striche,lastUpdated:(0,y.serverTimestamp)()},s=(0,b.g)(a);if((0,v.updateActiveGame)(o,s).catch(console.error),i.roundHistory.length>0){var u=i.roundHistory[i.roundHistory.length-1];Promise.resolve().then(n.bind(n,99407)).then(function(e){(0,e.saveRoundToFirestore)(o,u).catch(console.error)})}}},0)},onCancel:function(){return r().jumpToLatest()}});e(function(e){var n=p.Q5.getState().currentGroup,o=u.useUIStore.getState(),a=n&&null!==n.strokeSettings&&void 0!==n.strokeSettings?n.strokeSettings:o.strokeSettings,s=_(_({},e.striche),{},A({},i,_(_({},e.striche[i]),{},{kontermatsch:a.kontermatsch}))),c=N(_(_({},e),{},{striche:s}),r,"jass",e.startingPlayer,{strichInfo:{team:i,type:"kontermatsch"}}),l=D(e,c);return _(_({},e),{},{striche:s},l)}),window.__OFFLINE_SYNC_SERVICE__&&window.__OFFLINE_SYNC_SERVICE__.markPendingSync(),setTimeout(function(){null!=(e=window.__FIRESTORE_SYNC_API__)&&e.markLocalUpdate?window.__FIRESTORE_SYNC_API__.markLocalUpdate():console.warn("[GameStore.addKontermatsch] markLocalUpdate API not available!");var e,i=r(),o=i.activeGameId;if(o){var a={striche:i.striche,lastUpdated:(0,y.serverTimestamp)()},s=(0,b.g)(a);if((0,v.updateActiveGame)(o,s).catch(console.error),i.roundHistory.length>0){var u=i.roundHistory[i.roundHistory.length-1];Promise.resolve().then(n.bind(n,99407)).then(function(e){(0,e.saveRoundToFirestore)(o,u).catch(console.error)})}}},0)},getPlayerName:function(e){var n,i=r();return(null==(n=i.gamePlayers)||null==(n=n[e])?void 0:n.name)||i.playerNames[e]||"Spieler ".concat(e)},resetGameState:function(r){e(function(e){var n,i,o,a,s,u,c,l,p,m,g=(null==r?void 0:r.nextStarter)||e.initialStartingPlayer||1,y=null!=(n=null!=(i=null==r||null==(o=r.settings)?void 0:o.farbeSettings)?i:e.farbeSettings)?n:d.FT,v=null!=(a=null!=(s=null==r||null==(u=r.settings)?void 0:u.scoreSettings)?s:e.scoreSettings)?a:f.$d,b=null!=(c=null!=(l=null==r||null==(p=r.settings)?void 0:p.strokeSettings)?l:e.strokeSettings)?c:h.zh,w=C(g,{farbeSettings:y,scoreSettings:v,strokeSettings:b}),S=e.playerNames&&Object.values(e.playerNames).some(function(e){return""!==e})?e.playerNames:O,x=e.gamePlayers||null,E=!1;return r&&r.hasOwnProperty("newActiveGameId")?null===r.newActiveGameId?(m=null,E=!1):"string"==typeof r.newActiveGameId?(m=r.newActiveGameId,E=!0):(m=void 0,E=!1):(m=e.activeGameId,E=!!e.activeGameId),_(_({},w),{},{gamePlayers:x,activeGameId:m,isGameStarted:E,farbeSettings:y,scoreSettings:v,strokeSettings:b,roundHistory:[],currentHistoryIndex:-1,scores:w.scores||{top:0,bottom:0},striche:w.striche||{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},playerNames:S||w.playerNames||{1:"Spieler 1",2:"Spieler 2",3:"Spieler 3",4:"Spieler 4"},currentPlayer:w.currentPlayer||1})})},rebuildStateFromHistory:function(r){e(function(e){if(r<-1||r>=e.roundHistory.length)return console.error("[rebuildStateFromHistory] Ung\xfcltiger Index: ".concat(r)),e;var n=R(-1===r?null:e.roundHistory[r],function(){return e});return _(_(_({},e),n),{},{currentHistoryIndex:r,historyState:{lastNavigationTimestamp:e.historyState.lastNavigationTimestamp,weisCache:null}})})},setPlayers:function(r){return e({playerNames:r})},setGameSettings:function(r){e(function(e){var n=e.farbeSettings,i=e.scoreSettings,o=e.strokeSettings,a=function(e,r){return JSON.stringify(e)!==JSON.stringify(r)},s=r.farbeSettings||n,u=r.scoreSettings||i,c=r.strokeSettings||o;return a(n,s)||a(i,u)||a(o,c)?_(_({},e),{},{farbeSettings:s,scoreSettings:u,strokeSettings:c}):e})},showHistoryWarning:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return r().jumpToLatest()},o=r();o.currentHistoryIndex<o.roundHistory.length-1?u.useUIStore.getState().showHistoryWarning({message:e,onConfirm:n,onCancel:i,type:"error"}):(console.warn("[GameStore.showHistoryWarning] Called unexpectedly when already at the latest state."),n())},validateHistoryAction:function(){var e=r();return e.currentHistoryIndex>=e.roundHistory.length-1},setFarbe:function(r){e(function(e){return _(_({},e),{},{farbe:r})})},setTransitioning:function(r){e({isTransitioning:r})}})},{name:"game-storage",version:1,migrate:function(e,r){return 0===r&&e.scoreSettings&&void 0===e.scoreSettings.matschBonus&&(console.log("\uD83D\uDD04 Migrating gameStore state v0 to v1: Adding matschBonus"),e.scoreSettings.matschBonus=!0),e}}),{name:"gameStore"}))},31225:(e,r,n)=>{"use strict";n.d(r,{SR:()=>o,lt:()=>i,sn:()=>s,yX:()=>a});var i={green:{primary:"bg-green-600",primaryHover:"bg-green-700/80",accent:"bg-green-500",profileImage:"bg-green-600/20",accentHex:"#22c55e"},blue:{primary:"bg-blue-600",primaryHover:"bg-blue-700/80",accent:"bg-blue-500",profileImage:"bg-blue-600/20",accentHex:"#3b82f6"},purple:{primary:"bg-purple-600",primaryHover:"bg-purple-700/80",accent:"bg-purple-500",profileImage:"bg-purple-600/20",accentHex:"#a855f7"},pink:{primary:"bg-pink-600",primaryHover:"bg-pink-700/80",accent:"bg-pink-500",profileImage:"bg-pink-600/20",accentHex:"#ec4899"},yellow:{primary:"bg-yellow-600",primaryHover:"bg-yellow-700/80",accent:"bg-yellow-500",profileImage:"bg-yellow-600/20",accentHex:"#eab308"},teal:{primary:"bg-teal-600",primaryHover:"bg-teal-700/80",accent:"bg-teal-500",profileImage:"bg-teal-600/20",accentHex:"#14b8a6"},orange:{primary:"bg-orange-600",primaryHover:"bg-orange-700/80",accent:"bg-orange-500",profileImage:"bg-orange-600/20",accentHex:"#f97316"},cyan:{primary:"bg-cyan-600",primaryHover:"bg-cyan-700/80",accent:"bg-cyan-500",profileImage:"bg-cyan-600/20",accentHex:"#06b6d4"}},o="blue",a=function(e){if(e&&i[e])return e;var r=localStorage.getItem("jasstafel-profile-theme");return r&&i[r]?r:o},s=function(e){return e&&i[e]?e:o}},31931:(e,r,n)=>{"use strict";n.d(r,{Q5:()=>T});var i=n(8106),o=n(4319),a=n(27788),s=n(75695),u=n(80360),c=n(42009),l=n(13848),h=n(85253),d=n(64609),f=n(94566),p=n(38556),m=n(66534);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return v(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,r):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function b(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function w(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?b(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=g(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==g(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S(){S=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof v?n:v).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),y;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,y;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,y)}(i,c);if(o){if(o===y)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===y)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",y={};function v(){}function b(){}function w(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=w.prototype=v.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==g(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(g(r)+" is not iterable")}return b.prototype=w,o(T,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=l(w,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===b||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),y},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},r}function x(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function E(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){x(a,i,o,s,u,"next",e)}function u(e){x(a,i,o,s,u,"throw",e)}s(void 0)})}}var I={currentGroupId:null,currentGroup:null,userGroups:[],status:"idle",error:null,_currentGroupListenerUnsubscribe:null,lastSettingsUpdateTimestamp:null,updateCurrentGroupScoreSettings:function(){var e=E(S().mark(function e(r,n){return S().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),updateCurrentGroupStrokeSettings:function(){var e=E(S().mark(function e(r,n){return S().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),updateCurrentGroupFarbeSettings:function(){var e=E(S().mark(function e(r,n){return S().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),updateCurrentGroupCardStyle:function(){var e=E(S().mark(function e(r,n){return S().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}()},T=(0,i.v)()((0,o.lt)((0,o.Zr)(function(e,r){var n,i,o,g,v,b,x,T,k,_,A,P;return w(w({},I),{},{_cleanupCurrentGroupListener:function(){var n=r()._currentGroupListenerUnsubscribe;n&&(n(),e({_currentGroupListenerUnsubscribe:null},!1,"cleanupListener"))},setCurrentGroup:function(n){var i,o=a.useAuthStore.getState();if(o.isLoggingOut)return void console.log("GROUP_STORE: Skipping setCurrentGroup during logout process");r()._cleanupCurrentGroupListener(),e({currentGroup:n},!1,"setCurrentGroup");var u=null==(i=o.user)?void 0:i.uid;u&&"authenticated"===o.status&&!o.isLoggingOut?(0,s.kQ)(u,{lastActiveGroupId:(null==n?void 0:n.id)||null}).catch(function(e){console.warn("GROUP_STORE: Failed to update lastActiveGroupId to ".concat((null==n?void 0:n.id)||"null"," for user ").concat(u," (maybe during logout?):"),e)}):console.log("GROUP_STORE: Skipping update of lastActiveGroupId for group ".concat((null==n?void 0:n.id)||"null"," because user is not authenticated or is logging out."))},setUserGroups:function(r){return e({userGroups:r.map(function(e){var r;return w(w({},e),{},{farbeSettings:null!=(r=e.farbeSettings)?r:h.FT})})},!1,"setUserGroups")},loadUserGroups:(n=E(S().mark(function r(n){return S().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e({status:"idle",userGroups:[],error:"Deprecated function called"},!1,"loadUserGroups");case 1:case"end":return r.stop()}},r)})),function(e){return n.apply(this,arguments)}),loadUserGroupsByPlayerId:(i=E(S().mark(function n(i){var o,c,l,d,f;return S().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i){n.next=1;break}return e({userGroups:[],status:"error",error:"Player-ID fehlt."},!1,"loadGroupsByPlayerIdError"),n.abrupt("return");case 1:return e({status:"loading",error:null},!1,"loadGroupsByPlayerIdStart"),n.prev=2,n.next=3,(0,u.Z0)(i);case 3:o=n.sent.map(function(e){var r;return w(w({},e),{},{farbeSettings:null!=(r=e.farbeSettings)?r:h.FT})}),l=(c=r().currentGroup)&&o.some(function(e){return e.id===c.id}),e({userGroups:o,currentGroup:l?c:null,status:"success",error:null},!1,"loadGroupsByPlayerIdSuccess"),c&&!l&&(f=null==(d=a.useAuthStore.getState().user)?void 0:d.uid)&&(0,s.kQ)(f,{lastActiveGroupId:null}).catch(function(e){console.error("GROUP_STORE: Failed to clear lastActiveGroupId after current group became invalid:",e)}),l||c||r()._trySetLastActiveGroup(),n.next=5;break;case 4:n.prev=4,n.catch(2),e({status:"error",error:"Fehler beim Laden der Gruppen.",userGroups:[]},!1,"loadGroupsByPlayerIdFail");case 5:case"end":return n.stop()}},n,null,[[2,4]])})),function(e){return i.apply(this,arguments)}),fetchCurrentGroup:(o=E(S().mark(function n(i){var o,a,s,c;return S().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if((null==(o=(a=r()).currentGroup)?void 0:o.id)!==i||"success"!==a.status){n.next=1;break}return console.log("[groupStore] fetchCurrentGroup: Gruppe ".concat(i," bereits geladen, \xfcberspringe")),n.abrupt("return");case 1:if("loading"!==a.status){n.next=2;break}return console.log("[groupStore] fetchCurrentGroup: Bereits am Laden, \xfcberspringe"),n.abrupt("return");case 2:return e({status:"loading",error:null},!1,"fetchCurrentGroupStart"),n.prev=3,n.next=4,(0,u.Qo)(i);case 4:(s=n.sent)?(r().setCurrentGroup(s),e({status:"success"},!1,"fetchCurrentGroupSuccess")):e({status:"error",error:"Gruppe nicht gefunden"},!1,"fetchCurrentGroupNotFound"),n.next=6;break;case 5:n.prev=5,e({status:"error",error:(c=n.catch(3))instanceof Error?c.message:"Fehler beim Laden der Gruppe",currentGroup:null},!1,"fetchCurrentGroupFail");case 6:case"end":return n.stop()}},n,null,[[3,5]])})),function(e){return o.apply(this,arguments)}),updateGroup:(g=E(S().mark(function n(i,o){var a,s,u,h,m,g,y=arguments;return S().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=!(y.length>2)||void 0===y[2]||y[2],s=f.useUIStore.getState(),i){n.next=1;break}return console.error("GROUP_STORE: updateGroup called without groupId."),s.showNotification({message:"Fehler: Gruppen-ID fehlt.",type:"error"}),n.abrupt("return");case 1:return u=(0,c.doc)(l.db,p.ce,i),n.prev=2,n.next=3,(0,c.updateDoc)(u,w(w({},o),{},{updatedAt:(0,c.serverTimestamp)()}));case 3:h=r(),e((0,d.jM)(h,function(e){e.currentGroup&&e.currentGroup.id===i&&(e.currentGroup=w(w(w({},e.currentGroup),o),{},{updatedAt:c.Timestamp.now()}));var r=e.userGroups.findIndex(function(e){return e.id===i});-1!==r&&(e.userGroups[r]=w(w(w({},e.userGroups[r]),o),{},{updatedAt:c.Timestamp.now()})),e.lastSettingsUpdateTimestamp=Date.now()})),a&&s.showNotification({message:"Gruppeneinstellungen gespeichert.",type:"success"}),n.next=6;break;case 4:if(n.prev=4,g=n.catch(2),console.error("GROUP_STORE: Error updating group ".concat(i,":"),g),!(g instanceof Error&&g.message.includes("No document to update"))){n.next=5;break}return console.warn("GROUP_STORE: Group ".concat(i," does not exist, silently ignoring update.")),n.abrupt("return");case 5:m="Fehler beim Speichern der Gruppeneinstellungen.",g instanceof Error&&(m+=": ".concat(g.message)),s.showNotification({message:m,type:"error"}),e({error:m},!1,"updateGroupError");case 6:case"end":return n.stop()}},n,null,[[2,4]])})),function(e,r){return g.apply(this,arguments)}),updateCurrentGroupFarbeSettings:(v=E(S().mark(function r(n,i){var o,a;return S().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e({status:"loading"},!1,"updateCurrentGroupFarbeSettingsStart"),r.prev=1,o=(0,c.doc)(l.db,"groups",n),r.next=2,(0,c.updateDoc)(o,{farbeSettings:i,updatedAt:(0,c.serverTimestamp)()});case 2:e(function(e){return(0,d.jM)(e,function(e){e.currentGroup&&e.currentGroup.id===n&&(e.currentGroup.farbeSettings=i,e.currentGroup.updatedAt=c.Timestamp.now());var r=e.userGroups.findIndex(function(e){return e.id===n});-1!==r&&(e.userGroups[r].farbeSettings=i,e.userGroups[r].updatedAt=c.Timestamp.now()),e.status="idle"})},!1,"updateCurrentGroupFarbeSettingsSuccess"),r.next=5;break;case 3:if(r.prev=3,!((a=r.catch(1))instanceof Error&&a.message.includes("No document to update"))){r.next=4;break}return console.warn("GROUP_STORE: Group ".concat(n," does not exist, silently ignoring farbeSettings update.")),e({status:"idle"},!1,"updateCurrentGroupFarbeSettingsIgnored"),r.abrupt("return");case 4:throw e({status:"error",error:"Fehler beim Speichern der Farbeinstellungen."},!1,"updateCurrentGroupFarbeSettingsError"),a;case 5:case"end":return r.stop()}},r,null,[[1,3]])})),function(e,r){return v.apply(this,arguments)}),updateCurrentGroupScoreSettings:(b=E(S().mark(function r(n,i){var o,a;return S().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e({status:"loading"},!1,"updateCurrentGroupScoreSettingsStart"),r.prev=1,o=(0,c.doc)(l.db,"groups",n),r.next=2,(0,c.updateDoc)(o,{scoreSettings:i,updatedAt:(0,c.serverTimestamp)()});case 2:e(function(e){return(0,d.jM)(e,function(e){e.currentGroup&&e.currentGroup.id===n&&(e.currentGroup.scoreSettings=i,e.currentGroup.updatedAt=c.Timestamp.now());var r=e.userGroups.findIndex(function(e){return e.id===n});-1!==r&&(e.userGroups[r].scoreSettings=i,e.userGroups[r].updatedAt=c.Timestamp.now()),e.status="idle"})},!1,"updateCurrentGroupScoreSettingsSuccess"),r.next=5;break;case 3:if(r.prev=3,!((a=r.catch(1))instanceof Error&&a.message.includes("No document to update"))){r.next=4;break}return console.warn("GROUP_STORE: Group ".concat(n," does not exist, silently ignoring scoreSettings update.")),e({status:"idle"},!1,"updateCurrentGroupScoreSettingsIgnored"),r.abrupt("return");case 4:throw e({status:"error",error:"Fehler beim Speichern der Punkteeinstellungen."},!1,"updateCurrentGroupScoreSettingsError"),a;case 5:case"end":return r.stop()}},r,null,[[1,3]])})),function(e,r){return b.apply(this,arguments)}),updateCurrentGroupStrokeSettings:(x=E(S().mark(function r(n,i){var o,a;return S().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e({status:"loading"},!1,"updateCurrentGroupStrokeSettingsStart"),r.prev=1,o=(0,c.doc)(l.db,"groups",n),r.next=2,(0,c.updateDoc)(o,{strokeSettings:i,updatedAt:(0,c.serverTimestamp)()});case 2:e(function(e){return(0,d.jM)(e,function(e){e.currentGroup&&e.currentGroup.id===n&&(e.currentGroup.strokeSettings=i,e.currentGroup.updatedAt=c.Timestamp.now());var r=e.userGroups.findIndex(function(e){return e.id===n});-1!==r&&(e.userGroups[r].strokeSettings=i,e.userGroups[r].updatedAt=c.Timestamp.now()),e.status="idle"})},!1,"updateCurrentGroupStrokeSettingsSuccess"),r.next=5;break;case 3:if(r.prev=3,!((a=r.catch(1))instanceof Error&&a.message.includes("No document to update"))){r.next=4;break}return console.warn("GROUP_STORE: Group ".concat(n," does not exist, silently ignoring strokeSettings update.")),e({status:"idle"},!1,"updateCurrentGroupStrokeSettingsIgnored"),r.abrupt("return");case 4:throw e({status:"error",error:"Fehler beim Speichern der Stricheinstellungen."},!1,"updateCurrentGroupStrokeSettingsError"),a;case 5:case"end":return r.stop()}},r,null,[[1,3]])})),function(e,r){return x.apply(this,arguments)}),updateCurrentGroupCardStyle:(T=E(S().mark(function n(i,o){var a,s;return S().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r().isCurrentUserAdmin(i)){n.next=1;break}throw Error("Nur Admins k\xf6nnen den Kartensatz \xe4ndern.");case 1:return a=(0,c.doc)(l.db,"groups",i),n.prev=2,n.next=3,(0,c.updateDoc)(a,{cardStyle:o});case 3:e(function(e){return{currentGroup:e.currentGroup?w(w({},e.currentGroup),{},{cardStyle:o}):null}}),n.next=6;break;case 4:if(n.prev=4,!((s=n.catch(2))instanceof Error&&s.message.includes("No document to update"))){n.next=5;break}return console.warn("GROUP_STORE: Group ".concat(i," does not exist, silently ignoring cardStyle update.")),n.abrupt("return");case 5:throw s;case 6:case"end":return n.stop()}},n,null,[[2,4]])})),function(e,r){return T.apply(this,arguments)}),updateGroupInList:function(r,n){e(function(e){var i=e.userGroups.findIndex(function(e){return e.id===r});if(-1===i)return{};var o,a,s,u=y(e.userGroups),c=w(w(w({},u[i]),n),{},{players:null!=(o=n.players)?o:u[i].players,farbeSettings:null!=(a=null!=(s=n.farbeSettings)?s:u[i].farbeSettings)?a:h.FT});return u[i]=c,{userGroups:u}},!1,"updateGroupInList")},addUserGroup:function(n){var i=r().userGroups;if(!i.some(function(e){return e.id===n.id})){var o,a=w(w({},n),{},{farbeSettings:null!=(o=n.farbeSettings)?o:h.FT,players:n.players});e({userGroups:[].concat(y(i),[a])},!1,"addUserGroup")}},updateMemberRole:(k=E(S().mark(function n(i,o){var a,s,u,h,g,y,v,b;return S().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=r().currentGroup,f.useUIStore.getState().showNotification,console.log("[updateMemberRole] Attempting to change role for playerId: ".concat(i," to ").concat(o)),!(!a||!i)){n.next=1;break}throw console.error("[updateMemberRole] Failed: Current group missing (".concat(!a,") or playerId missing (").concat(!i,").")),Error("Ung\xfcltige IDs f\xfcr Gruppen- oder Spieleroperation.");case 1:return s=a.id,console.log("[updateMemberRole] Target Group ID: ".concat(s)),e({status:"loading"},!1,"updateMemberRoleStart"),n.prev=2,console.log("[updateMemberRole] Calling getPlayerDocument for playerId: ".concat(i)),n.next=3,(0,m.getPlayerDocument)(i);case 3:if(u=n.sent,console.log("[updateMemberRole] Result from getPlayerDocument for ".concat(i,":"),u),!(!u||!u.userId)){n.next=4;break}throw console.error("[updateMemberRole] Failed: Player document not found (".concat(!u,") or userId missing (").concat(!(null!=u&&u.userId),") for playerId ").concat(i,".")),Error("Benutzerinformationen f\xfcr das Mitglied konnten nicht gefunden werden.");case 4:return h=u.userId,console.log("[updateMemberRole] Found targetUserId: ".concat(h," for playerId: ").concat(i)),g=(0,c.doc)(l.db,p.ce,s),y="admin"===o?{adminIds:(0,c.arrayUnion)(h)}:{adminIds:(0,c.arrayRemove)(h)},console.log("[updateMemberRole] Updating Firestore group ".concat(s," with:"),y),n.next=5,(0,c.updateDoc)(g,y);case 5:console.log("[updateMemberRole] Firestore update successful for group ".concat(s,".")),e(function(e){return(0,d.jM)(e,function(e){e.currentGroup&&("admin"===o?e.currentGroup.adminIds.includes(h)||e.currentGroup.adminIds.push(h):(e.currentGroup.adminIds.length,e.currentGroup.adminIds=e.currentGroup.adminIds.filter(function(e){return e!==h}),e.currentGroup.adminIds.length)),e.status="success",e.error=null})},!1,"updateMemberRoleSuccess"),n.next=8;break;case 6:if(n.prev=6,b=n.catch(2),console.error("GROUP_STORE: Failed to update role for playerId ".concat(i," to ").concat(o," in group ").concat(s,":"),b),!(b instanceof Error&&b.message.includes("No document to update"))){n.next=7;break}return console.warn("GROUP_STORE: Group ".concat(s," does not exist, silently ignoring role update for playerId ").concat(i,".")),e({status:"idle",error:null},!1,"updateMemberRoleIgnored"),n.abrupt("return");case 7:throw e({status:"error",error:v=b instanceof Error?b.message:"Rollen\xe4nderung fehlgeschlagen."},!1,"updateMemberRoleError"),Error(v);case 8:case"end":return n.stop()}},n,null,[[2,6]])})),function(e,r){return k.apply(this,arguments)}),setError:function(r){return e({status:"error",error:r},!1,"setError")},clearError:function(){return e({error:null},!1,"clearError")},resetGroupStore:function(){r()._cleanupCurrentGroupListener(),e(I)},loadGroup:(_=E(S().mark(function e(r){return S().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(e){return _.apply(this,arguments)}),leaveGroup:(A=E(S().mark(function e(r,n){return S().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(e,r){return A.apply(this,arguments)}),subscribeToGroup:function(e){},unsubscribeFromGroup:function(){},setCurrentGroupId:function(r){return e({currentGroupId:r})},clearGroupState:function(){return e(w({},I))},isCurrentUserAdmin:function(e){var n=r().currentGroup,i=a.useAuthStore.getState().user,o=null!=e?e:null==n?void 0:n.id;return!!i&&!!n&&n.id===o&&Array.isArray(n.adminIds)&&n.adminIds.includes(i.uid)},_trySetLastActiveGroup:function(){var e=a.useAuthStore.getState().user,n=r().userGroups,i=r().currentGroup;if(null!=e&&e.lastActiveGroupId&&!i&&0!==n.length){var o=n.find(function(r){return r.id===e.lastActiveGroupId});o?r().setCurrentGroup(o):(console.warn("[GroupStore] ⚠️ lastActiveGroupId ".concat(e.lastActiveGroupId," nicht in userGroups gefunden")),e.uid&&(0,s.kQ)(e.uid,{lastActiveGroupId:null}).catch(function(e){console.error("Failed to clear invalid lastActiveGroupId:",e)}))}},updateCurrentGroupJassSettings:(P=E(S().mark(function n(i,o){var a,s,u,m,g,y;return S().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=f.useUIStore.getState(),i){n.next=1;break}return console.error("GROUP_STORE: updateCurrentGroupJassSettings called without groupId."),a.showNotification({message:"Fehler: Gruppen-ID f\xfcr Jass-Einstellungen fehlt.",type:"error"}),n.abrupt("return");case 1:return s=(0,c.doc)(l.db,p.ce,i),n.prev=2,u={scoreSettings:o.scoreSettings,strokeSettings:o.strokeSettings,"farbeSettings.values":o.farbeSettingsValues,"farbeSettings.cardStyle":o.cardStyle,updatedAt:(0,c.serverTimestamp)()},n.next=3,(0,c.updateDoc)(s,u);case 3:m=r(),e((0,d.jM)(m,function(e){e.currentGroup&&e.currentGroup.id===i&&(e.currentGroup=w(w({},e.currentGroup),{},{scoreSettings:o.scoreSettings,strokeSettings:o.strokeSettings,farbeSettings:w(w({},e.currentGroup.farbeSettings||h.FT),{},{values:o.farbeSettingsValues,cardStyle:o.cardStyle}),updatedAt:c.Timestamp.now()}));var r=e.userGroups.findIndex(function(e){return e.id===i});-1!==r&&(e.userGroups[r]=w(w({},e.userGroups[r]),{},{scoreSettings:o.scoreSettings,strokeSettings:o.strokeSettings,farbeSettings:w(w({},e.userGroups[r].farbeSettings||h.FT),{},{values:o.farbeSettingsValues,cardStyle:o.cardStyle}),updatedAt:c.Timestamp.now()})),e.lastSettingsUpdateTimestamp=Date.now()})),a.showNotification({message:"Jass-Einstellungen erfolgreich aktualisiert.",type:"success"}),n.next=6;break;case 4:if(n.prev=4,console.error("GROUP_STORE: Fehler beim Aktualisieren der Jass-Einstellungen f\xfcr Gruppe",i,y=n.catch(2)),!(y instanceof Error&&y.message.includes("No document to update"))){n.next=5;break}return console.warn("GROUP_STORE: Group ".concat(i," does not exist, silently ignoring Jass-Einstellungen update.")),n.abrupt("return");case 5:g="Fehler beim Aktualisieren der Jass-Einstellungen.",y instanceof Error&&(g+=": ".concat(y.message)),a.showNotification({message:g,type:"error"}),e({error:g},!1,"updateJassSettingsError");case 6:case"end":return n.stop()}},n,null,[[2,4]])})),function(e,r){return P.apply(this,arguments)})})},{name:"jass-group-storage",storage:(0,o.KU)(function(){return localStorage}),partialize:function(e){return{currentGroupId:e.currentGroupId,userGroups:e.userGroups.map(function(e){return{id:e.id,name:e.name,description:e.description,createdAt:e.createdAt,createdBy:e.createdBy,updatedAt:e.updatedAt,playerIds:e.playerIds,adminIds:e.adminIds,isPublic:e.isPublic,logoUrl:e.logoUrl,farbeSettings:e.farbeSettings,scoreSettings:e.scoreSettings,strokeSettings:e.strokeSettings,cardStyle:e.cardStyle}})}},onRehydrateStorage:function(){return function(e,r){if(r){null==e||e.resetGroupStore();return}null==e||e.currentGroupId}},version:1,migrate:function(e,r){return 0===r?(console.log("Migrating GroupStore from version 0 to 1..."),{currentGroupId:e.currentGroupId,userGroups:(e.userGroups||[]).map(function(e){return{id:e.id,name:e.name,description:e.description,createdBy:e.createdBy,createdAt:e.createdAt,updatedAt:e.updatedAt,playerIds:e.playerIds,adminIds:e.adminIds,isPublic:e.isPublic,logoUrl:e.logoUrl,farbeSettings:e.farbeSettings,scoreSettings:e.scoreSettings,strokeSettings:e.strokeSettings,memberUserIds:[]}})}):(console.log("GroupStore: No migration needed for version ".concat(r,".")),e)}}),{name:"GroupStore"}))},35365:(e,r,n)=>{"use strict";n.d(r,{h:()=>u});var i=n(14232),o=n(93786),a=n(13848);function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function u(){var e,r=function(e){if(Array.isArray(e))return e}(e=(0,i.useState)({user:null,isLoading:!0,error:null}))||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,2)||function(e,r){if(e){if("string"==typeof e)return s(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,r):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],u=r[1];return(0,i.useEffect)(function(){var e=(0,o.xI)(a.firebaseApp),r=(0,o.hg)(e,function(e){u({user:e,isLoading:!1,error:null})},function(e){console.error("Auth error:",e),u({user:null,isLoading:!1,error:e})});return function(){return r()}},[]),n}},36525:(e,r,n)=>{"use strict";var i;n.d(r,{$b:()=>i,Vy:()=>l});let o=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));let a={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},s=i.INFO,u={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=(e,r,...n)=>{if(r<e.logLevel)return;let i=new Date().toISOString(),o=u[r];if(o)console[o](`[${i}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${r})`)};class l{constructor(e){this.name=e,this._logLevel=s,this._logHandler=c,this._userLogHandler=null,o.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?a[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}},37537:(e,r,n)=>{"use strict";n.d(r,{$:()=>f,r:()=>d});var i=n(14232),o=n(82987),a=n(47137),s=n(53551),u=n(37876);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=["className","variant","size","asChild"];function h(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}var d=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),f=i.forwardRef(function(e,r){var n=e.className,i=e.variant,a=e.size,f=e.asChild,p=function(e,r){if(null==e)return{};var n,i,o=function(e,r){if(null==e)return{};var n={};for(var i in e)if(({}).hasOwnProperty.call(e,i)){if(-1!==r.indexOf(i))continue;n[i]=e[i]}return n}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],-1===r.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,l),m=void 0!==f&&f?o.DX:"button";return(0,u.jsx)(m,function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?h(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=c(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==c(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}({className:(0,s.cn)(d({variant:i,size:a,className:n})),ref:r},p))});f.displayName="Button"},37746:(e,r,n)=>{"use strict";n.d(r,{Uz:()=>I,Qg:()=>T});var i=n(96796),o=n(51139),a=n(88308);function s(e,r){let n={};for(let i in e)e.hasOwnProperty(i)&&(n[i]=r(e[i]));return n}function u(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>u(e));if("function"==typeof e||"object"==typeof e)return s(e,e=>u(e));throw Error("Data cannot be encoded in JSON: "+e)}function c(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{let r=Number(e.value);if(isNaN(r))throw Error("Data cannot be decoded from JSON: "+e);return r}default:throw Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>c(e)):"function"==typeof e||"object"==typeof e?s(e,e=>c(e)):e}let l="functions",h={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class d extends o.g{constructor(e,r,n){super(`${l}/${e}`,r||""),this.details=n,Object.setPrototypeOf(this,d.prototype)}}function f(e,r){let n,i=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),o=i;try{let e=r&&r.error;if(e){let r=e.status;if("string"==typeof r){if(!h[r])return new d("internal","internal");i=h[r],o=r}let a=e.message;"string"==typeof a&&(o=a),n=e.details,void 0!==n&&(n=c(n))}}catch(e){}return"ok"===i?null:new d(i,o,n)}class p{constructor(e,r,n,o){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,i.xZ)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=r.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||r.get().then(e=>this.auth=e,()=>{}),this.messaging||n.get().then(e=>this.messaging=e,()=>{}),this.appCheck||null==o||o.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{let e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){let r=await this.getAuthToken();return{authToken:r,messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}let m="us-central1",g=/^data: (.*?)(?:\n|$)/;class y{constructor(e,r,n,i,o=m,a=(...e)=>fetch(...e)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new p(e,r,n,i),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{let e=new URL(o);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=m}catch(e){this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){let r=this.app.options.projectId;if(null!==this.emulatorOrigin){let n=this.emulatorOrigin;return`${n}/${r}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}async function v(e,r,n,i){let o;n["Content-Type"]="application/json";try{o=await i(e,{method:"POST",body:JSON.stringify(r),headers:n})}catch(e){return{status:0,json:null}}let a=null;try{a=await o.json()}catch(e){}return{status:o.status,json:a}}async function b(e,r){let n={},i=await e.contextProvider.getContext(r.limitedUseAppCheckTokens);return i.authToken&&(n.Authorization="Bearer "+i.authToken),i.messagingToken&&(n["Firebase-Instance-ID-Token"]=i.messagingToken),null!==i.appCheckToken&&(n["X-Firebase-AppCheck"]=i.appCheckToken),n}async function w(e,r,n,i){var o;let a,s={data:n=u(n)},l=await b(e,i),h=(o=i.timeout||7e4,a=null,{promise:new Promise((e,r)=>{a=setTimeout(()=>{r(new d("deadline-exceeded","deadline-exceeded"))},o)}),cancel:()=>{a&&clearTimeout(a)}}),p=await Promise.race([v(r,s,l,e.fetchImpl),h.promise,e.cancelAllRequests]);if(h.cancel(),!p)throw new d("cancelled","Firebase Functions instance was deleted.");let m=f(p.status,p.json);if(m)throw m;if(!p.json)throw new d("internal","Response is not valid JSON object.");let g=p.json.data;if(void 0===g&&(g=p.json.result),void 0===g)throw new d("internal","Response is missing data field.");return{data:c(g)}}async function S(e,r,n,i){var o;let a,s,l,h={data:n=u(n)},p=await b(e,i);p["Content-Type"]="application/json",p.Accept="text/event-stream";try{a=await e.fetchImpl(r,{method:"POST",body:JSON.stringify(h),headers:p,signal:null==i?void 0:i.signal})}catch(r){if(r instanceof Error&&"AbortError"===r.name){let e=new d("cancelled","Request was cancelled.");return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let e=f(0,null);return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let m=new Promise((e,r)=>{s=e,l=r});null==(o=null==i?void 0:i.signal)||o.addEventListener("abort",()=>{let e=new d("cancelled","Request was cancelled.");l(e)});let y=function(e,r,n,i){let o=(e,i)=>{let o=e.match(g);if(!o)return;let a=o[1];try{let e=JSON.parse(a);if("result"in e)return void r(c(e.result));if("message"in e)return void i.enqueue(c(e.message));if("error"in e){let r=f(0,e);i.error(r),n(r);return}}catch(e){if(e instanceof d){i.error(e),n(e);return}}},a=new TextDecoder;return new ReadableStream({start(r){let s="";return u();async function u(){if(null==i?void 0:i.aborted){let e=new d("cancelled","Request was cancelled");return r.error(e),n(e),Promise.resolve()}try{let{value:c,done:l}=await e.read();if(l){s.trim()&&o(s.trim(),r),r.close();return}if(null==i?void 0:i.aborted){let i=new d("cancelled","Request was cancelled");r.error(i),n(i),await e.cancel();return}let h=(s+=a.decode(c,{stream:!0})).split("\n");for(let e of(s=h.pop()||"",h))e.trim()&&o(e.trim(),r);return u()}catch(i){let e=i instanceof d?i:f(0,null);r.error(e),n(e)}}},cancel:()=>e.cancel()})}(a.body.getReader(),s,l,null==i?void 0:i.signal);return{stream:{[Symbol.asyncIterator](){let e=y.getReader();return{async next(){let{value:r,done:n}=await e.read();return{value:r,done:n}},return:async()=>(await e.cancel(),{done:!0,value:void 0})}}},data:m}}let x="@firebase/functions",E="0.12.9";function I(e=(0,i.Sx)(),r=m){let n=(0,i.j6)((0,o.Ku)(e),l).getImmediate({identifier:r}),a=(0,o.yU)("functions");return a&&function(e,r,n){var i=(0,o.Ku)(e);let a=(0,o.zJ)(r);i.emulatorOrigin=`http${a?"s":""}://${r}:${n}`,a&&((0,o.gE)(i.emulatorOrigin),(0,o.P1)("Functions",!0))}(n,...a),n}function T(e,r,n){var i=(0,o.Ku)(e);let a=e=>(function(e,r,n,i){let o=e._url(r);return w(e,o,n,i)})(i,r,e,n||{});return a.stream=(e,n)=>(function(e,r,n,i){let o=e._url(r);return S(e,o,n,i||{})})(i,r,e,n),a}(0,i.om)(new a.uA(l,(e,{instanceIdentifier:r})=>{let n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal");return new y(n,i,e.getProvider("messaging-internal"),e.getProvider("app-check-internal"),r)},"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(x,E,void 0),(0,i.KO)(x,E,"esm2017")},38556:(e,r,n)=>{"use strict";n.d(r,{ce:()=>o,eZ:()=>a,sb:()=>i});var i="users",o="groups",a="players"},38652:(e,r,n)=>{"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var n in r)Object.defineProperty(e,n,{enumerable:!0,get:r[n]})}(r,{default:function(){return y},defaultHead:function(){return f}});var o=n(64252),a=n(88365),s=n(37876),u=a._(n(14232)),c=o._(n(60481)),l=n(82824),h=n(36498),d=n(54176);function f(e){void 0===e&&(e=!1);var r=[(0,s.jsx)("meta",{charSet:"utf-8"},"charset")];return e||r.push((0,s.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),r}function p(e,r){return"string"==typeof r||"number"==typeof r?e:r.type===u.default.Fragment?e.concat(u.default.Children.toArray(r.props.children).reduce(function(e,r){return"string"==typeof r||"number"==typeof r?e:e.concat(r)},[])):e.concat(r)}n(73298);var m=["name","httpEquiv","charSet","itemProp"];function g(e,r){var n,i,o,a,s=r.inAmpMode;return e.reduce(p,[]).reverse().concat(f(s).reverse()).filter((n=new Set,i=new Set,o=new Set,a={},function(e){var r=!0,s=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){s=!0;var u=e.key.slice(e.key.indexOf("$")+1);n.has(u)?r=!1:n.add(u)}switch(e.type){case"title":case"base":i.has(e.type)?r=!1:i.add(e.type);break;case"meta":for(var c=0,l=m.length;c<l;c++){var h=m[c];if(e.props.hasOwnProperty(h))if("charSet"===h)o.has(h)?r=!1:o.add(h);else{var d=e.props[h],f=a[h]||new Set;("name"!==h||!s)&&f.has(d)?r=!1:(f.add(d),a[h]=f)}}}return r})).reverse().map(function(e,r){var n=e.key||r;return u.default.cloneElement(e,{key:n})})}var y=function(e){var r=e.children,n=(0,u.useContext)(l.AmpStateContext),i=(0,u.useContext)(h.HeadManagerContext);return(0,s.jsx)(c.default,{reduceComponentsToState:g,headManager:i,inAmpMode:(0,d.isInAmpMode)(n),children:r})};("function"==typeof r.default||"object"===i(r.default)&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},38791:(e,r,n)=>{"use strict";n.d(r,{$d:()=>a,C3:()=>o,IZ:()=>u,sz:()=>i});var i=157,o=[{id:"sieg",name:"Sieg",defaultValue:2e3,maxValue:1e4,order:1},{id:"berg",name:"Berg",defaultValue:1e3,maxValue:5e3,order:2},{id:"schneider",name:"Schneider",defaultValue:1e3,maxValue:5e3,order:3}],a={values:o.reduce(function(e,r){var n;return e[r.id]=null!=(n=r.defaultValue)?n:"sieg"===r.id?2e3:1e3,e},{}),enabled:{sieg:!0,berg:!0,schneider:!0},matschBonus:!0},s=function(e){var r=o.find(function(r){return r.id===e});if(!r)throw Error("Ung\xfcltiger ScoreMode: ".concat(e));return r},u=function(e,r){var n=s(e);if(r<0)return!1;if("sieg"===e)return r<=n.maxValue;var i=Math.floor(s("sieg").defaultValue/2);return r<=Math.min(n.maxValue,i)}},39427:(e,r,n)=>{"use strict";n.d(r,{is:()=>y});var i=n(40673),o=n(75695),a=n(80360),s=n(93504);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function l(){l=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",h=a.toStringTag||"@@toStringTag";function d(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{d({},"")}catch(e){d=function(e,r,n){return e[r]=n}}function f(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=p(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};d(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){d(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,c){var l=p(e[o],e,a);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==u(d)&&i.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,s,c)},function(e){n("throw",e,s,c)}):r.resolve(d).then(function(e){h.value=e,s(h)},function(e){return n("throw",e,s,c)})}c(l.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(u(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=d(S,h,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,d(e,h,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),d(_.prototype,c,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(f(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),d(T,h,"Generator"),d(T,s,function(){return this}),d(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function h(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function d(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?h(Object(n),!0).forEach(function(r){m(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function f(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function p(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){f(a,i,o,s,u,"next",e)}function u(e){f(a,i,o,s,u,"throw",e)}s(void 0)})}}function m(e,r,n){return(r=g(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function g(e){var r=function(e,r){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=u(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==u(r)?r:r+""}var y=new(function(){var e,r,n,u,h,f,y;return f=function e(){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");m(this,"queue",[]),m(this,"isProcessing",!1),m(this,"optimizedUrls",new Set),m(this,"maxFileSize",307200)},y=[{key:"checkAndQueue",value:(e=p(l().mark(function e(r,n,i){var o,a,s,u,c=arguments;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=c.length>3&&void 0!==c[3]?c[3]:3,!(!r||this.optimizedUrls.has(r)||!r.includes("firebasestorage.googleapis.com"))){e.next=1;break}return e.abrupt("return");case 1:return e.prev=1,e.next=2,fetch(r,{method:"HEAD",signal:AbortSignal.timeout(3e3)});case 2:(a=e.sent.headers.get("content-length"))&&parseInt(a)>this.maxFileSize?(s=parseInt(a)/1024,console.log("[BackgroundOptimizer] Queuing ".concat(n," image for optimization: ").concat(s.toFixed(1),"KB")),this.queue.push(d(d({url:r,type:n},i),{},{priority:o})),this.queue.sort(function(e,r){return e.priority-r.priority}),this.isProcessing||this.processQueue()):this.optimizedUrls.add(r),e.next=4;break;case 3:e.prev=3,u=e.catch(1),console.debug("[BackgroundOptimizer] Skipping ".concat(r,":"),u);case 4:case"end":return e.stop()}},e,this,[[1,3]])})),function(r,n,i){return e.apply(this,arguments)})},{key:"processQueue",value:(r=p(l().mark(function e(){var r,n;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.isProcessing||0===this.queue.length)){e.next=1;break}return e.abrupt("return");case 1:this.isProcessing=!0,console.log("[BackgroundOptimizer] Processing ".concat(this.queue.length," images..."));case 2:if(!(this.queue.length>0)){e.next=8;break}return r=this.queue.shift(),e.prev=3,e.next=4,this.optimizeImage(r);case 4:return this.optimizedUrls.add(r.url),e.next=5,new Promise(function(e){return setTimeout(e,2e3)});case 5:e.next=7;break;case 6:e.prev=6,n=e.catch(3),console.warn("[BackgroundOptimizer] Failed to optimize ".concat(r.url,":"),n),this.optimizedUrls.add(r.url);case 7:e.next=2;break;case 8:this.isProcessing=!1,console.log("[BackgroundOptimizer] Queue processed.");case 9:case"end":return e.stop()}},e,this,[[3,6]])})),function(){return r.apply(this,arguments)})},{key:"optimizeImage",value:(n=p(l().mark(function e(r){var n,u,c,h,d,f,p,m,g;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[BackgroundOptimizer] Optimizing ".concat(r.type,": ").concat(r.url)),e.next=1,fetch(r.url);case 1:return n=e.sent,e.next=2,n.blob();case 2:return c=(u=e.sent).size,h=new File([u],"optimized.jpg",{type:"image/jpeg"}),e.next=3,(0,i.w)(h,400,.7);case 3:if(d=e.sent){e.next=4;break}throw Error("Compression failed");case 4:p=(f=new File([d],"optimized.jpg",{type:"image/jpeg"})).size,m=(c-p)/c*100,console.log("[BackgroundOptimizer] Compressed: ".concat(c," → ").concat(p," bytes (").concat(m.toFixed(1),"% saved)")),e.next="profile"===(g=r.type)?5:"group"===g?8:"tournament"===g?11:14;break;case 5:if(r.userId){e.next=6;break}throw Error("userId required for profile");case 6:return e.next=7,(0,o.x)(f,r.userId);case 7:return e.abrupt("continue",15);case 8:if(r.groupId){e.next=9;break}throw Error("groupId required for group");case 9:return e.next=10,(0,a.ie)(r.groupId,f);case 10:case 13:return e.sent,e.abrupt("continue",15);case 11:if(!(!r.tournamentId||!r.userId)){e.next=12;break}throw Error("tournamentId and userId required");case 12:return e.next=13,(0,s.uploadTournamentLogoFirebase)(r.tournamentId,f,r.userId);case 14:throw Error("Unknown type: ".concat(r.type));case 15:console.log("[BackgroundOptimizer] ✅ ".concat(r.type," optimized successfully"));case 16:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})},{key:"queueMultiple",value:(u=p(l().mark(function e(r){var n,i,o,a;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return c(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,r):void 0}}(e))){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(r),e.prev=1,n.s();case 2:if((i=n.n()).done){e.next=4;break}return o=i.value,e.next=3,this.checkAndQueue(o.url,o.type,o.metadata,4);case 3:e.next=2;break;case 4:e.next=6;break;case 5:e.prev=5,a=e.catch(1),n.e(a);case 6:return e.prev=6,n.f(),e.finish(6);case 7:case"end":return e.stop()}},e,this,[[1,5,6,7]])})),function(e){return u.apply(this,arguments)})},{key:"getStatus",value:function(){return{queueLength:this.queue.length,isProcessing:this.isProcessing,optimizedCount:this.optimizedUrls.size}}},{key:"forceOptimize",value:(h=p(l().mark(function e(r,n,i){var o,a,s=arguments;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=s.length>3&&void 0!==s[3]?s[3]:1,!(!r||this.optimizedUrls.has(r))){e.next=1;break}return e.abrupt("return");case 1:console.log("[BackgroundOptimizer] Force optimizing ".concat(n," image: ").concat(r)),a={url:r,type:n,userId:i.userId,groupId:i.groupId,tournamentId:i.tournamentId,priority:o},this.queue.unshift(a),this.queue.sort(function(e,r){return e.priority-r.priority}),this.isProcessing||this.processQueue();case 2:case"end":return e.stop()}},e,this)})),function(e,r,n){return h.apply(this,arguments)})},{key:"pause",value:function(){this.queue.length=0,console.log("[BackgroundOptimizer] Paused")}}],function(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,g(i.key),i)}}(f.prototype,y),Object.defineProperty(f,"prototype",{writable:!1}),f}())},39751:(e,r,n)=>{"use strict";n.d(r,{Q:()=>i});let i=(0,n(14232).createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"})},40531:(e,r,n)=>{"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){o=function(){return r};var e,r={},n=Object.prototype,a=n.hasOwnProperty,s=Object.defineProperty||function(e,r,n){e[r]=n.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function d(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{d({},"")}catch(e){d=function(e,r,n){return e[r]=n}}function f(r,n,i,o){var a,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return s(h,"_invoke",{value:(a=r,u=i,c=new O(o||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var s=p(a,u,c);if("normal"===s.type){if(l=c.done?y:"suspendedYield",s.arg===v)continue;return{value:s.arg,done:c.done}}"throw"===s.type&&(l=y,c.method="throw",c.arg=s.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};d(x,c,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&a.call(I,c)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){d(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;s(this,"_invoke",{value:function(o,s){function u(){return new r(function(n,u){!function n(o,s,u,c){var l=p(e[o],e,s);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==i(d)&&a.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,u,c)},function(e){n("throw",e,u,c)}):r.resolve(d).then(function(e){h.value=e,u(h)},function(e){return n("throw",e,u,c)})}c(l.arg)}(o,s,n,u)})}return n=n?n.then(u,u):u()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[c];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,s=function n(){for(;++o<r.length;)if(a.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw TypeError(i(r)+" is not iterable")}return w.prototype=S,s(T,"constructor",{value:S,configurable:!0}),s(S,"constructor",{value:w,configurable:!0}),w.displayName=d(S,h,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,d(e,h,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),d(_.prototype,l,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(f(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),d(T,h,"Generator"),d(T,c,function(){return this}),d(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function i(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],u=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=a.call(s,"catchLoc"),l=a.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=r,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function a(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}n.d(r,{p:()=>u});var s=0,u=function(){var e,r=(e=o().mark(function e(r,n,i){var a,u,c,l=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.length>3&&void 0!==l[3]&&l[3],u=Date.now(),!(!a&&s&&u-s<300)){e.next=1;break}return e.abrupt("return",!1);case 1:return s=u,e.prev=2,e.next=3,r.push(n,void 0,i);case 3:return e.abrupt("return",!0);case 4:return e.prev=4,c=e.catch(2),console.error("[RouterUtils] Fehler bei Navigation zu ".concat(n,":"),c),e.abrupt("return",!1);case 5:case"end":return e.stop()}},e,null,[[2,4]])}),function(){var r=this,n=arguments;return new Promise(function(i,o){var s=e.apply(r,n);function u(e){a(s,i,o,u,c,"next",e)}function c(e){a(s,i,o,u,c,"throw",e)}u(void 0)})});return function(e,n,i){return r.apply(this,arguments)}}()},40673:(e,r,n)=>{"use strict";n.d(r,{w:()=>l});var i=n(83587);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(){a=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,s=Object.defineProperty||function(e,r,n){e[r]=n.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function d(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{d({},"")}catch(e){d=function(e,r,n){return e[r]=n}}function f(r,n,i,o){var a,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return s(h,"_invoke",{value:(a=r,u=i,c=new O(o||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var s=p(a,u,c);if("normal"===s.type){if(l=c.done?y:"suspendedYield",s.arg===v)continue;return{value:s.arg,done:c.done}}"throw"===s.type&&(l=y,c.method="throw",c.arg=s.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};d(x,c,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,c)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){d(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;s(this,"_invoke",{value:function(a,s){function u(){return new r(function(n,u){!function n(a,s,u,c){var l=p(e[a],e,s);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==o(d)&&i.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,u,c)},function(e){n("throw",e,u,c)}):r.resolve(d).then(function(e){h.value=e,u(h)},function(e){return n("throw",e,u,c)})}c(l.arg)}(a,s,n,u)})}return n=n?n.then(u,u):u()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[c];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,s=function n(){for(;++a<r.length;)if(i.call(r,a))return n.value=r[a],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw TypeError(o(r)+" is not iterable")}return w.prototype=S,s(T,"constructor",{value:S,configurable:!0}),s(S,"constructor",{value:w,configurable:!0}),w.displayName=d(S,h,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,d(e,h,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),d(_.prototype,l,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(f(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),d(T,h,"Generator"),d(T,c,function(){return this}),d(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function s(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function u(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach(function(r){var i,a,s;i=e,a=r,s=n[r],(a=function(e){var r=function(e,r){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=o(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==o(r)?r:r+""}(a))in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function c(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function l(e){return h.apply(this,arguments)}function h(){var e;return e=a().mark(function e(r){var n,o,s,c,l,h=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>1&&void 0!==h[1]?h[1]:800,o=h.length>2&&void 0!==h[2]?h[2]:.8,e.prev=1,s={maxSizeMB:.5,maxWidthOrHeight:Math.min(n,600),useWebWorker:!0,initialQuality:o,fileType:"image/jpeg"},e.next=2,(0,i.A)(r,s);case 2:if(!((c=e.sent).size>5e5)){e.next=4;break}return l=u(u({},s),{},{maxSizeMB:.3,initialQuality:.6}),e.next=3,(0,i.A)(c,l);case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",c);case 5:return e.prev=5,console.error("Fehler bei der Bildkompression:",e.catch(1)),e.abrupt("return",null);case 6:case"end":return e.stop()}},e,null,[[1,5]])}),(h=function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){c(a,i,o,s,u,"next",e)}function u(e){c(a,i,o,s,u,"throw",e)}s(void 0)})}).apply(this,arguments)}},42009:(e,r,n)=>{"use strict";n.r(r),n.d(r,{AbstractUserDataWriter:()=>lc,AggregateField:()=>ch,AggregateQuerySnapshot:()=>cd,Bytes:()=>cf,CACHE_SIZE_UNLIMITED:()=>u5,CollectionReference:()=>uW,DocumentReference:()=>uK,DocumentSnapshot:()=>lb,FieldPath:()=>cp,FieldValue:()=>cg,Firestore:()=>u6,FirestoreError:()=>q,GeoPoint:()=>cy,LoadBundleTask:()=>u4,PersistentCacheIndexManager:()=>ha,Query:()=>u$,QueryCompositeFilterConstraint:()=>c0,QueryConstraint:()=>cJ,QueryDocumentSnapshot:()=>lS,QueryEndAtConstraint:()=>lt,QueryFieldFilterConstraint:()=>cX,QueryLimitConstraint:()=>c5,QueryOrderByConstraint:()=>c3,QuerySnapshot:()=>lx,QueryStartAtConstraint:()=>c7,SnapshotMetadata:()=>lv,Timestamp:()=>eE,Transaction:()=>l5,VectorValue:()=>cv,WriteBatch:()=>l2,_AutoId:()=>er,_ByteString:()=>re,_DatabaseId:()=>rp,_DocumentKey:()=>ed,_EmptyAppCheckTokenProvider:()=>ee,_EmptyAuthCredentialsProvider:()=>K,_FieldPath:()=>eh,_TestingHooks:()=>hm,_cast:()=>eb,_debugAssert:()=>B,_internalAggregationQueryToProtoRunAggregationQueryRequest:()=>hp,_internalQueryToProtoQueryTarget:()=>hf,_isBase64Available:()=>t9,_logWarn:()=>F,_validateIsNotUsedTogether:()=>ep,addDoc:()=>lR,aggregateFieldEqual:()=>lm,aggregateQuerySnapshotEqual:()=>lg,and:()=>c2,arrayRemove:()=>he,arrayUnion:()=>l9,average:()=>lf,clearIndexedDbPersistence:()=>ci,collection:()=>uQ,collectionGroup:()=>uJ,connectFirestoreEmulator:()=>uH,count:()=>lp,deleteAllPersistentCacheIndexes:()=>hl,deleteDoc:()=>lD,deleteField:()=>l8,disableNetwork:()=>cs,disablePersistentCacheIndexAutoCreation:()=>hc,doc:()=>uY,documentId:()=>cm,documentSnapshotFromJSON:()=>lw,enableIndexedDbPersistence:()=>ct,enableMultiTabIndexedDbPersistence:()=>cr,enableNetwork:()=>ca,enablePersistentCacheIndexAutoCreation:()=>hu,endAt:()=>ln,endBefore:()=>lr,ensureFirestoreConfigured:()=>u9,executeWrite:()=>lM,getAggregateFromServer:()=>lB,getCountFromServer:()=>lV,getDoc:()=>lT,getDocFromCache:()=>l_,getDocFromServer:()=>lA,getDocs:()=>lP,getDocsFromCache:()=>lO,getDocsFromServer:()=>lC,getFirestore:()=>u7,getPersistentCacheIndexManager:()=>hs,increment:()=>ht,initializeFirestore:()=>u8,limit:()=>c6,limitToLast:()=>c8,loadBundle:()=>cc,memoryEagerGarbageCollector:()=>lK,memoryLocalCache:()=>lQ,memoryLruGarbageCollector:()=>lW,namedQuery:()=>cl,onSnapshot:()=>lj,onSnapshotResume:()=>lF,onSnapshotsInSync:()=>lU,or:()=>c1,orderBy:()=>c4,persistentLocalCache:()=>lJ,persistentMultipleTabManager:()=>l0,persistentSingleTabManager:()=>lZ,query:()=>cY,queryEqual:()=>uZ,querySnapshotFromJSON:()=>lE,refEqual:()=>uX,runTransaction:()=>l6,serverTimestamp:()=>l7,setDoc:()=>lN,setIndexConfiguration:()=>hi,setLogLevel:()=>D,snapshotEqual:()=>lI,startAfter:()=>le,startAt:()=>c9,sum:()=>ld,terminate:()=>cu,updateDoc:()=>lL,vector:()=>hr,waitForPendingWrites:()=>co,where:()=>cZ,writeBatch:()=>hn});var i,o,a,s,u,c,l,h,d,f,p,m,g,y,v=n(96796),b=n(88308),w=n(36525),S=n(51139),x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},E={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}var r=function(){this.blockSize=-1};function n(){}function a(e,r,n){n||(n=0);var i=Array(16);if("string"==typeof r)for(var o=0;16>o;++o)i[o]=r.charCodeAt(n++)|r.charCodeAt(n++)<<8|r.charCodeAt(n++)<<16|r.charCodeAt(n++)<<24;else for(o=0;16>o;++o)i[o]=r[n++]|r[n++]<<8|r[n++]<<16|r[n++]<<24;r=e.g[0],n=e.g[1],o=e.g[2];var a=e.g[3],s=r+(a^n&(o^a))+i[0]+0xd76aa478|0;s=a+(o^(r=n+(s<<7|s>>>25))&(n^o))+i[1]+0xe8c7b756|0,s=o+(n^(a=r+(s<<12|s>>>20))&(r^n))+i[2]+0x242070db|0,s=n+(r^(o=a+(s<<17|s>>>15))&(a^r))+i[3]+0xc1bdceee|0,s=r+(a^(n=o+(s<<22|s>>>10))&(o^a))+i[4]+0xf57c0faf|0,s=a+(o^(r=n+(s<<7|s>>>25))&(n^o))+i[5]+0x4787c62a|0,s=o+(n^(a=r+(s<<12|s>>>20))&(r^n))+i[6]+0xa8304613|0,s=n+(r^(o=a+(s<<17|s>>>15))&(a^r))+i[7]+0xfd469501|0,s=r+(a^(n=o+(s<<22|s>>>10))&(o^a))+i[8]+0x698098d8|0,s=a+(o^(r=n+(s<<7|s>>>25))&(n^o))+i[9]+0x8b44f7af|0,s=o+(n^(a=r+(s<<12|s>>>20))&(r^n))+i[10]+0xffff5bb1|0,s=n+(r^(o=a+(s<<17|s>>>15))&(a^r))+i[11]+0x895cd7be|0,s=r+(a^(n=o+(s<<22|s>>>10))&(o^a))+i[12]+0x6b901122|0,s=a+(o^(r=n+(s<<7|s>>>25))&(n^o))+i[13]+0xfd987193|0,s=o+(n^(a=r+(s<<12|s>>>20))&(r^n))+i[14]+0xa679438e|0,s=n+(r^(o=a+(s<<17|s>>>15))&(a^r))+i[15]+0x49b40821|0,n=o+(s<<22|s>>>10),s=r+(o^a&(n^o))+i[1]+0xf61e2562|0,r=n+(s<<5|s>>>27),s=a+(n^o&(r^n))+i[6]+0xc040b340|0,a=r+(s<<9|s>>>23),s=o+(r^n&(a^r))+i[11]+0x265e5a51|0,o=a+(s<<14|s>>>18),s=n+(a^r&(o^a))+i[0]+0xe9b6c7aa|0,n=o+(s<<20|s>>>12),s=r+(o^a&(n^o))+i[5]+0xd62f105d|0,r=n+(s<<5|s>>>27),s=a+(n^o&(r^n))+i[10]+0x2441453|0,a=r+(s<<9|s>>>23),s=o+(r^n&(a^r))+i[15]+0xd8a1e681|0,o=a+(s<<14|s>>>18),s=n+(a^r&(o^a))+i[4]+0xe7d3fbc8|0,n=o+(s<<20|s>>>12),s=r+(o^a&(n^o))+i[9]+0x21e1cde6|0,r=n+(s<<5|s>>>27),s=a+(n^o&(r^n))+i[14]+0xc33707d6|0,a=r+(s<<9|s>>>23),s=o+(r^n&(a^r))+i[3]+0xf4d50d87|0,o=a+(s<<14|s>>>18),s=n+(a^r&(o^a))+i[8]+0x455a14ed|0,n=o+(s<<20|s>>>12),s=r+(o^a&(n^o))+i[13]+0xa9e3e905|0,r=n+(s<<5|s>>>27),s=a+(n^o&(r^n))+i[2]+0xfcefa3f8|0,a=r+(s<<9|s>>>23),s=o+(r^n&(a^r))+i[7]+0x676f02d9|0,o=a+(s<<14|s>>>18),s=n+(a^r&(o^a))+i[12]+0x8d2a4c8a|0,s=r+((n=o+(s<<20|s>>>12))^o^a)+i[5]+0xfffa3942|0,s=a+((r=n+(s<<4|s>>>28))^n^o)+i[8]+0x8771f681|0,s=o+((a=r+(s<<11|s>>>21))^r^n)+i[11]+0x6d9d6122|0,s=n+((o=a+(s<<16|s>>>16))^a^r)+i[14]+0xfde5380c|0,s=r+((n=o+(s<<23|s>>>9))^o^a)+i[1]+0xa4beea44|0,s=a+((r=n+(s<<4|s>>>28))^n^o)+i[4]+0x4bdecfa9|0,s=o+((a=r+(s<<11|s>>>21))^r^n)+i[7]+0xf6bb4b60|0,s=n+((o=a+(s<<16|s>>>16))^a^r)+i[10]+0xbebfbc70|0,s=r+((n=o+(s<<23|s>>>9))^o^a)+i[13]+0x289b7ec6|0,s=a+((r=n+(s<<4|s>>>28))^n^o)+i[0]+0xeaa127fa|0,s=o+((a=r+(s<<11|s>>>21))^r^n)+i[3]+0xd4ef3085|0,s=n+((o=a+(s<<16|s>>>16))^a^r)+i[6]+0x4881d05|0,s=r+((n=o+(s<<23|s>>>9))^o^a)+i[9]+0xd9d4d039|0,s=a+((r=n+(s<<4|s>>>28))^n^o)+i[12]+0xe6db99e5|0,s=o+((a=r+(s<<11|s>>>21))^r^n)+i[15]+0x1fa27cf8|0,s=n+((o=a+(s<<16|s>>>16))^a^r)+i[2]+0xc4ac5665|0,n=o+(s<<23|s>>>9),s=r+(o^(n|~a))+i[0]+0xf4292244|0,r=n+(s<<6|s>>>26),s=a+(n^(r|~o))+i[7]+0x432aff97|0,a=r+(s<<10|s>>>22),s=o+(r^(a|~n))+i[14]+0xab9423a7|0,o=a+(s<<15|s>>>17),s=n+(a^(o|~r))+i[5]+0xfc93a039|0,n=o+(s<<21|s>>>11),s=r+(o^(n|~a))+i[12]+0x655b59c3|0,r=n+(s<<6|s>>>26),s=a+(n^(r|~o))+i[3]+0x8f0ccc92|0,a=r+(s<<10|s>>>22),s=o+(r^(a|~n))+i[10]+0xffeff47d|0,o=a+(s<<15|s>>>17),s=n+(a^(o|~r))+i[1]+0x85845dd1|0,n=o+(s<<21|s>>>11),s=r+(o^(n|~a))+i[8]+0x6fa87e4f|0,r=n+(s<<6|s>>>26),s=a+(n^(r|~o))+i[15]+0xfe2ce6e0|0,a=r+(s<<10|s>>>22),s=o+(r^(a|~n))+i[6]+0xa3014314|0,o=a+(s<<15|s>>>17),s=n+(a^(o|~r))+i[13]+0x4e0811a1|0,n=o+(s<<21|s>>>11),s=r+(o^(n|~a))+i[4]+0xf7537e82|0,r=n+(s<<6|s>>>26),s=a+(n^(r|~o))+i[11]+0xbd3af235|0,a=r+(s<<10|s>>>22),s=o+(r^(a|~n))+i[2]+0x2ad7d2bb|0,o=a+(s<<15|s>>>17),s=n+(a^(o|~r))+i[9]+0xeb86d391|0,e.g[0]=e.g[0]+r|0,e.g[1]=e.g[1]+(o+(s<<21|s>>>11))|0,e.g[2]=e.g[2]+o|0,e.g[3]=e.g[3]+a|0}function s(e,r){this.h=r;for(var n=[],i=!0,o=e.length-1;0<=o;o--){var a=0|e[o];i&&a==r||(n[o]=a,i=!1)}this.g=n}n.prototype=r.prototype,e.D=r.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return r.prototype[n].apply(e,o)},e.prototype.s=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.u=function(e,r){void 0===r&&(r=e.length);for(var n=r-this.blockSize,i=this.B,o=this.h,s=0;s<r;){if(0==o)for(;s<=n;)a(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<r;)if(i[o++]=e.charCodeAt(s++),o==this.blockSize){a(this,i),o=0;break}}else for(;s<r;)if(i[o++]=e[s++],o==this.blockSize){a(this,i),o=0;break}}this.h=o,this.o+=r},e.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var r=1;r<e.length-8;++r)e[r]=0;var n=8*this.o;for(r=e.length-8;r<e.length;++r)e[r]=255&n,n/=256;for(this.u(e),e=Array(16),r=n=0;4>r;++r)for(var i=0;32>i;i+=8)e[n++]=this.g[r]>>>i&255;return e};var u,c={};function l(e){var r;return -128<=e&&128>e?(r=function(e){return new s([0|e],0>e?-1:0)},Object.prototype.hasOwnProperty.call(c,e)?c[e]:c[e]=r(e)):new s([0|e],0>e?-1:0)}function h(e){if(isNaN(e)||!isFinite(e))return d;if(0>e)return y(h(-e));for(var r=[],n=1,i=0;e>=n;i++)r[i]=e/n|0,n*=0x100000000;return new s(r,0)}var d=l(0),f=l(1),p=l(0x1000000);function m(e){if(0!=e.h)return!1;for(var r=0;r<e.g.length;r++)if(0!=e.g[r])return!1;return!0}function g(e){return -1==e.h}function y(e){for(var r=e.g.length,n=[],i=0;i<r;i++)n[i]=~e.g[i];return new s(n,~e.h).add(f)}function v(e,r){return e.add(y(r))}function b(e,r){for(;(65535&e[r])!=e[r];)e[r+1]+=e[r]>>>16,e[r]&=65535,r++}function w(e,r){this.g=e,this.h=r}function S(e,r){if(m(r))throw Error("division by zero");if(m(e))return new w(d,d);if(g(e))return r=S(y(e),r),new w(y(r.g),y(r.h));if(g(r))return r=S(e,y(r)),new w(y(r.g),r.h);if(30<e.g.length){if(g(e)||g(r))throw Error("slowDivide_ only works with positive integers.");for(var n=f,i=r;0>=i.l(e);)n=x(n),i=x(i);var o=I(n,1),a=I(i,1);for(i=I(i,2),n=I(n,2);!m(i);){var s=a.add(i);0>=s.l(e)&&(o=o.add(n),a=s),i=I(i,1),n=I(n,1)}return r=v(e,o.j(r)),new w(o,r)}for(o=d;0<=e.l(r);){for(i=48>=(i=Math.ceil(Math.log(n=Math.max(1,Math.floor(e.m()/r.m())))/Math.LN2))?1:Math.pow(2,i-48),s=(a=h(n)).j(r);g(s)||0<s.l(e);)n-=i,s=(a=h(n)).j(r);m(a)&&(a=f),o=o.add(a),e=v(e,s)}return new w(o,e)}function x(e){for(var r=e.g.length+1,n=[],i=0;i<r;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new s(n,e.h)}function I(e,r){var n=r>>5;r%=32;for(var i=e.g.length-n,o=[],a=0;a<i;a++)o[a]=0<r?e.i(a+n)>>>r|e.i(a+n+1)<<32-r:e.i(a+n);return new s(o,e.h)}(u=s.prototype).m=function(){if(g(this))return-y(this).m();for(var e=0,r=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:0x100000000+i)*r,r*=0x100000000}return e},u.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(m(this))return"0";if(g(this))return"-"+y(this).toString(e);for(var r=h(Math.pow(e,6)),n=this,i="";;){var o=S(n,r).g,a=((0<(n=v(n,o.j(r))).g.length?n.g[0]:n.h)>>>0).toString(e);if(m(n=o))return a+i;for(;6>a.length;)a="0"+a;i=a+i}},u.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},u.l=function(e){return g(e=v(this,e))?-1:+!m(e)},u.abs=function(){return g(this)?y(this):this},u.add=function(e){for(var r=Math.max(this.g.length,e.g.length),n=[],i=0,o=0;o<=r;o++){var a=i+(65535&this.i(o))+(65535&e.i(o)),u=(a>>>16)+(this.i(o)>>>16)+(e.i(o)>>>16);i=u>>>16,a&=65535,u&=65535,n[o]=u<<16|a}return new s(n,-0x80000000&n[n.length-1]?-1:0)},u.j=function(e){if(m(this)||m(e))return d;if(g(this))return g(e)?y(this).j(y(e)):y(y(this).j(e));if(g(e))return y(this.j(y(e)));if(0>this.l(p)&&0>e.l(p))return h(this.m()*e.m());for(var r=this.g.length+e.g.length,n=[],i=0;i<2*r;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var o=0;o<e.g.length;o++){var a=this.i(i)>>>16,u=65535&this.i(i),c=e.i(o)>>>16,l=65535&e.i(o);n[2*i+2*o]+=u*l,b(n,2*i+2*o),n[2*i+2*o+1]+=a*l,b(n,2*i+2*o+1),n[2*i+2*o+1]+=u*c,b(n,2*i+2*o+1),n[2*i+2*o+2]+=a*c,b(n,2*i+2*o+2)}for(i=0;i<r;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=r;i<2*r;i++)n[i]=0;return new s(n,0)},u.A=function(e){return S(this,e).h},u.and=function(e){for(var r=Math.max(this.g.length,e.g.length),n=[],i=0;i<r;i++)n[i]=this.i(i)&e.i(i);return new s(n,this.h&e.h)},u.or=function(e){for(var r=Math.max(this.g.length,e.g.length),n=[],i=0;i<r;i++)n[i]=this.i(i)|e.i(i);return new s(n,this.h|e.h)},u.xor=function(e){for(var r=Math.max(this.g.length,e.g.length),n=[],i=0;i<r;i++)n[i]=this.i(i)^e.i(i);return new s(n,this.h^e.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,o=E.Md5=e,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=h,s.fromString=function e(r,n){if(0==r.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==r.charAt(0))return y(e(r.substring(1),n));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=h(Math.pow(n,8)),o=d,a=0;a<r.length;a+=8){var s=Math.min(8,r.length-a),u=parseInt(r.substring(a,a+s),n);8>s?(s=h(Math.pow(n,s)),o=o.j(s).add(h(u))):o=(o=o.j(i)).add(h(u))}return o},i=E.Integer=s}).apply(void 0!==x?x:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T={};(function(){var e,r,n,i="function"==typeof Object.defineProperties?Object.defineProperty:function(e,r,n){return e==Array.prototype||e==Object.prototype||(e[r]=n.value),e},o=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof I&&I];for(var r=0;r<e.length;++r){var n=e[r];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var n=o;e=e.split(".");for(var a=0;a<e.length-1;a++){var s=e[a];if(!(s in n))break e;n=n[s]}(r=r(a=n[e=e[e.length-1]]))!=a&&null!=r&&i(n,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){var e,r,n,i,o;return e=this,r=function(e,r){return r},e instanceof String&&(e+=""),n=0,i=!1,(o={next:function(){if(!i&&n<e.length){var o=n++;return{value:r(o,e[o]),done:!1}}return i=!0,{done:!0,value:void 0}}})[Symbol.iterator]=function(){return o},o}});var p=p||{},m=this||self;function g(e){var r=typeof e;return"array"==(r="object"!=r?r:e?Array.isArray(e)?"array":r:"null")||"object"==r&&"number"==typeof e.length}function y(e){var r=typeof e;return"object"==r&&null!=e||"function"==r}function v(e,r,n){return e.call.apply(e.bind,arguments)}function b(e,r,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(r,n)}}return function(){return e.apply(r,arguments)}}function w(e,r,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:b).apply(null,arguments)}function S(e,r){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function x(e,r){function n(){}n.prototype=r.prototype,e.aa=r.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return r.prototype[n].apply(e,o)}}function E(e){let r=e.length;if(0<r){let n=Array(r);for(let i=0;i<r;i++)n[i]=e[i];return n}return[]}function k(e,r){for(let r=1;r<arguments.length;r++){let n=arguments[r];if(g(n)){let r=e.length||0,i=n.length||0;e.length=r+i;for(let o=0;o<i;o++)e[r+o]=n[o]}else e.push(n)}}class _{constructor(e,r){this.i=e,this.j=r,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function A(e){return/^[\s\xa0]*$/.test(e)}function P(){var e=m.navigator;return e&&(e=e.userAgent)?e:""}function O(e){return O[" "](e),e}O[" "]=function(){};var C=-1!=P().indexOf("Gecko")&&(-1==P().toLowerCase().indexOf("webkit")||-1!=P().indexOf("Edge"))&&-1==P().indexOf("Trident")&&-1==P().indexOf("MSIE")&&-1==P().indexOf("Edge");function N(e,r,n){for(let i in e)r.call(n,e[i],i,e)}function L(e){let r={};for(let n in e)r[n]=e[n];return r}let D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(e,r){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r])e[n]=i[n];for(let r=0;r<D.length;r++)n=D[r],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}class j{constructor(){this.h=this.g=null}add(e,r){let n=F.get();n.set(e,r),this.h?this.h.next=n:this.g=n,this.h=n}}var F=new _(()=>new U,e=>e.reset());class U{constructor(){this.next=this.g=this.h=null}set(e,r){this.h=e,this.g=r,this.next=null}reset(){this.next=this.g=this.h=null}}let M,G=!1,V=new j,B=()=>{let e=m.Promise.resolve(void 0);M=()=>{e.then(z)}};var z=()=>{let e;for(var r;e=null,V.g&&(e=V.g,V.g=V.g.next,V.g||(V.h=null),e.next=null),r=e;){try{r.h.call(r.g)}catch(e){!function(e){m.setTimeout(()=>{throw e},0)}(e)}F.j(r),100>F.h&&(F.h++,r.next=F.g,F.g=r)}G=!1};function q(){this.s=this.s,this.C=this.C}function H(e,r){this.type=e,this.g=this.target=r,this.defaultPrevented=!1}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},H.prototype.h=function(){this.defaultPrevented=!0};var $=function(){if(!m.addEventListener||!Object.defineProperty)return!1;var e=!1,r=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let e=()=>{};m.addEventListener("test",e,r),m.removeEventListener("test",e,r)}catch(e){}return e}();function K(e,r){if(H.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=r,r=e.relatedTarget){if(C){e:{try{O(r.nodeName);var o=!0;break e}catch(e){}o=!1}o||(r=null)}}else"mouseover"==n?r=e.fromElement:"mouseout"==n&&(r=e.toElement);this.relatedTarget=r,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:W[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&K.aa.h.call(this)}}x(K,H);var W={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Q="closure_listenable_"+(1e6*Math.random()|0),J=0;function Y(e,r,n,i,o){this.listener=e,this.proxy=null,this.src=r,this.type=n,this.capture=!!i,this.ha=o,this.key=++J,this.da=this.fa=!1}function X(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function Z(e){this.src=e,this.g={},this.h=0}function ee(e,r){var n=r.type;if(n in e.g){var i,o=e.g[n],a=Array.prototype.indexOf.call(o,r,void 0);(i=0<=a)&&Array.prototype.splice.call(o,a,1),i&&(X(r),0==e.g[n].length&&(delete e.g[n],e.h--))}}function et(e,r,n,i){for(var o=0;o<e.length;++o){var a=e[o];if(!a.da&&a.listener==r&&!!n==a.capture&&a.ha==i)return o}return -1}Z.prototype.add=function(e,r,n,i,o){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var s=et(e,r,i,o);return -1<s?(r=e[s],n||(r.fa=!1)):((r=new Y(r,this.src,a,!!i,o)).fa=n,e.push(r)),r};var er="closure_lm_"+(1e6*Math.random()|0),en={};function ei(e,r,n,i,o,a){if(!r)throw Error("Invalid event type");var s=y(o)?!!o.capture:!!o,u=eu(e);if(u||(e[er]=u=new Z(e)),(n=u.add(r,n,i,s,a)).proxy)return n;if(i=function e(r){return es.call(e.src,e.listener,r)},n.proxy=i,i.src=e,i.listener=n,e.addEventListener)$||(o=s),void 0===o&&(o=!1),e.addEventListener(r.toString(),i,o);else if(e.attachEvent)e.attachEvent(ea(r.toString()),i);else if(e.addListener&&e.removeListener)e.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return n}function eo(e){if("number"!=typeof e&&e&&!e.da){var r=e.src;if(r&&r[Q])ee(r.i,e);else{var n=e.type,i=e.proxy;r.removeEventListener?r.removeEventListener(n,i,e.capture):r.detachEvent?r.detachEvent(ea(n),i):r.addListener&&r.removeListener&&r.removeListener(i),(n=eu(r))?(ee(n,e),0==n.h&&(n.src=null,r[er]=null)):X(e)}}}function ea(e){return e in en?en[e]:en[e]="on"+e}function es(e,r){if(e.da)e=!0;else{r=new K(r,this);var n=e.listener,i=e.ha||e.src;e.fa&&eo(e),e=n.call(i,r)}return e}function eu(e){return(e=e[er])instanceof Z?e:null}var ec="__closure_events_fn_"+(1e9*Math.random()>>>0);function el(e){return"function"==typeof e?e:(e[ec]||(e[ec]=function(r){return e.handleEvent(r)}),e[ec])}function eh(){q.call(this),this.i=new Z(this),this.M=this,this.F=null}function ed(e,r){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=r.type||r,"string"==typeof r)r=new H(r,e);else if(r instanceof H)r.target=r.target||e;else{var o=r;R(r=new H(i,e),o)}if(o=!0,n)for(var a=n.length-1;0<=a;a--){var s=r.g=n[a];o=ef(s,i,!0,r)&&o}if(o=ef(s=r.g=e,i,!0,r)&&o,o=ef(s,i,!1,r)&&o,n)for(a=0;a<n.length;a++)o=ef(s=r.g=n[a],i,!1,r)&&o}function ef(e,r,n,i){if(!(r=e.i.g[String(r)]))return!0;r=r.concat();for(var o=!0,a=0;a<r.length;++a){var s=r[a];if(s&&!s.da&&s.capture==n){var u=s.listener,c=s.ha||s.src;s.fa&&ee(e.i,s),o=!1!==u.call(c,i)&&o}}return o&&!i.defaultPrevented}function ep(e,r,n){if("function"==typeof e)n&&(e=w(e,n));else if(e&&"function"==typeof e.handleEvent)e=w(e.handleEvent,e);else throw Error("Invalid listener argument");return 0x7fffffff<Number(r)?-1:m.setTimeout(e,r||0)}x(eh,q),eh.prototype[Q]=!0,eh.prototype.removeEventListener=function(e,r,n,i){!function e(r,n,i,o,a){if(Array.isArray(n))for(var s=0;s<n.length;s++)e(r,n[s],i,o,a);else(o=y(o)?!!o.capture:!!o,i=el(i),r&&r[Q])?(r=r.i,(n=String(n).toString())in r.g&&-1<(i=et(s=r.g[n],i,o,a))&&(X(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete r.g[n],r.h--))):r&&(r=eu(r))&&(n=r.g[n.toString()],r=-1,n&&(r=et(n,i,o,a)),(i=-1<r?n[r]:null)&&eo(i))}(this,e,r,n,i)},eh.prototype.N=function(){if(eh.aa.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var n=r.g[e],i=0;i<n.length;i++)X(n[i]);delete r.g[e],r.h--}}this.F=null},eh.prototype.K=function(e,r,n,i){return this.i.add(String(e),r,!1,n,i)},eh.prototype.L=function(e,r,n,i){return this.i.add(String(e),r,!0,n,i)};class em extends q{constructor(e,r){super(),this.m=e,this.l=r,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(r){r.g=ep(()=>{r.g=null,r.i&&(r.i=!1,e(r))},r.l);let n=r.h;r.h=null,r.m.apply(null,n)}(this)}N(){super.N(),this.g&&(m.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eg(e){q.call(this),this.h=e,this.g={}}x(eg,q);var ey=[];function ev(e){N(e.g,function(e,r){this.g.hasOwnProperty(r)&&eo(e)},e),e.g={}}eg.prototype.N=function(){eg.aa.N.call(this),ev(this)},eg.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var eb=m.JSON.stringify,ew=m.JSON.parse,eS=class{stringify(e){return m.JSON.stringify(e,void 0)}parse(e){return m.JSON.parse(e,void 0)}};function ex(){}function eE(e){return e.h||(e.h=e.i())}function eI(){}ex.prototype.h=null;var eT={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ek(){H.call(this,"d")}function e_(){H.call(this,"c")}x(ek,H),x(e_,H);var eA={},eP=null;function eO(){return eP=eP||new eh}function eC(e){H.call(this,eA.La,e)}function eN(e){let r=eO();ed(r,new eC(r))}function eL(e,r){H.call(this,eA.STAT_EVENT,e),this.stat=r}function eD(e){let r=eO();ed(r,new eL(r,e))}function eR(e,r){H.call(this,eA.Ma,e),this.size=r}function ej(e,r){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return m.setTimeout(function(){e()},r)}function eF(){this.g=!0}function eU(e,r,n,i){e.info(function(){return"XMLHTTP TEXT ("+r+"): "+function(e,r){if(!e.g)return r;if(!r)return null;try{var n=JSON.parse(r);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var o=i[1];if(Array.isArray(o)&&!(1>o.length)){var a=o[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<o.length;s++)o[s]=""}}}}return eb(n)}catch(e){return r}}(e,n)+(i?" "+i:"")})}eA.La="serverreachability",x(eC,H),eA.STAT_EVENT="statevent",x(eL,H),eA.Ma="timingevent",x(eR,H),eF.prototype.xa=function(){this.g=!1},eF.prototype.info=function(){};var eM={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},eG={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function eV(){}function eB(e,r,n,i){this.j=e,this.i=r,this.l=n,this.R=i||1,this.U=new eg(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ez}function ez(){this.i=null,this.g="",this.h=!1}x(eV,ex),eV.prototype.g=function(){return new XMLHttpRequest},eV.prototype.i=function(){return{}},r=new eV;var eq={},eH={};function e$(e,r,n){e.L=1,e.v=ts(tr(r)),e.m=n,e.P=!0,eK(e,null)}function eK(e,r){e.F=Date.now(),eQ(e),e.A=tr(e.v);var n,i,o,a,s,u,c=e.A,l=e.R;Array.isArray(l)||(l=[String(l)]),tw(c.i,"t",l),e.C=0,c=e.j.J,e.h=new ez,e.g=t6(e.j,c?r:null,!e.m),0<e.O&&(e.M=new em(w(e.Y,e,e.g),e.O)),r=e.U,c=e.g,l=e.ca;var h="readystatechange";Array.isArray(h)||(h&&(ey[0]=h.toString()),h=ey);for(var d=0;d<h.length;d++){var f=function e(r,n,i,o,a){if(o&&o.once)return function e(r,n,i,o,a){if(Array.isArray(n)){for(var s=0;s<n.length;s++)e(r,n[s],i,o,a);return null}return i=el(i),r&&r[Q]?r.L(n,i,y(o)?!!o.capture:!!o,a):ei(r,n,i,!0,o,a)}(r,n,i,o,a);if(Array.isArray(n)){for(var s=0;s<n.length;s++)e(r,n[s],i,o,a);return null}return i=el(i),r&&r[Q]?r.K(n,i,y(o)?!!o.capture:!!o,a):ei(r,n,i,!1,o,a)}(c,h[d],l||r.handleEvent,!1,r.h||r);if(!f)break;r.g[f.key]=f}r=e.H?L(e.H):{},e.m?(e.u||(e.u="POST"),r["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,r)):(e.u="GET",e.g.ea(e.A,e.u,null,r)),eN(),n=e.i,i=e.u,o=e.A,a=e.l,s=e.R,u=e.m,n.info(function(){if(n.g)if(u)for(var e="",r=u.split("&"),c=0;c<r.length;c++){var l=r[c].split("=");if(1<l.length){var h=l[0];l=l[1];var d=h.split("_");e=2<=d.length&&"type"==d[1]?e+(h+"=")+l+"&":e+(h+"=redacted&")}}else e=null;else e=u;return"XMLHTTP REQ ("+a+") [attempt "+s+"]: "+i+"\n"+o+"\n"+e})}function eW(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function eQ(e){e.S=Date.now()+e.I,eJ(e,e.I)}function eJ(e,r){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ej(w(e.ba,e),r)}function eY(e){e.B&&(m.clearTimeout(e.B),e.B=null)}function eX(e){0==e.j.G||e.J||t1(e.j,e)}function eZ(e){eY(e);var r=e.M;r&&"function"==typeof r.ma&&r.ma(),e.M=null,ev(e.U),e.g&&(r=e.g,e.g=null,r.abort(),r.ma())}function e0(e,r){try{var n=e.j;if(0!=n.G&&(n.g==e||e5(n.h,e))){if(!e.K&&e5(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(r)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var o=i;if(0==o[0]){e:if(!n.u){if(n.g)if(n.g.F+3e3<e.F)t0(n),tq(n);else break e;tY(n),eD(18)}}else n.za=o[1],0<n.za-n.T&&37500>o[2]&&n.F&&0==n.v&&!n.C&&(n.C=ej(w(n.Za,n),6e3));if(1>=e4(n.h)&&n.ca){try{n.ca()}catch(e){}n.ca=void 0}}else t3(n,11)}else if((e.K||n.g==e)&&t0(n),!A(r))for(o=n.Da.g.parse(r),r=0;r<o.length;r++){let u=o[r];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.K=u[1],n.ia=u[2];let r=u[3];null!=r&&(n.la=r,n.j.info("VER="+n.la));let o=u[4];null!=o&&(n.Aa=o,n.j.info("SVER="+n.Aa));let c=u[5];null!=c&&"number"==typeof c&&0<c&&(n.L=i=1.5*c,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;let l=e.g;if(l){let e=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=i.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(e6(a,a.h),a.h=null))}if(i.D){let e=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,ta(i.I,i.D,e))}}if(n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms")),(i=n).qa=t5(i,i.J?i.ia:null,i.W),e.K){e8(i.h,e);var s=i.L;s&&(e.I=s),e.B&&(eY(e),eQ(e)),i.g=e}else tJ(i);0<n.i.length&&t$(n)}else"stop"!=u[0]&&"close"!=u[0]||t3(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?t3(n,7):tz(n):"noop"!=u[0]&&n.l&&n.l.ta(u),n.v=0)}}eN(4)}catch(e){}}eB.prototype.ca=function(e){e=e.target;let r=this.M;r&&3==tM(e)?r.j():this.Y(e)},eB.prototype.Y=function(e){try{if(e==this.g)e:{let b=tM(this.g);var r=this.g.Ba();let w=this.g.Z();if(!(3>b)&&(3!=b||this.g&&(this.h.h||this.g.oa()||tG(this.g)))){this.J||4!=b||7==r||(8==r||0>=w?eN(3):eN(2)),eY(this);var n=this.g.Z();this.X=n;t:if(eW(this)){var i=tG(this.g);e="";var o=i.length,a=4==tM(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){eZ(this),eX(this);var s="";break t}this.h.i=new m.TextDecoder}for(r=0;r<o;r++)this.h.h=!0,e+=this.h.i.decode(i[r],{stream:!(a&&r==o-1)});i.length=0,this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.oa();if(this.o=200==n,u=this.i,c=this.u,l=this.A,h=this.l,d=this.R,f=n,u.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+d+"]: "+c+"\n"+l+"\n"+b+" "+f}),this.o){if(this.T&&!this.K){t:{if(this.g){var u,c,l,h,d,f,p,g=this.g;if((p=g.g?g.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(p)){var y=p;break t}}y=null}if(n=y)eU(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,e0(this,n);else{this.o=!1,this.s=3,eD(12),eZ(this),eX(this);break e}}if(this.P){let e;for(n=!0;!this.J&&this.C<s.length;)if((e=function(e,r){var n=e.C,i=r.indexOf("\n",n);return -1==i?eH:isNaN(n=Number(r.substring(n,i)))?eq:(i+=1)+n>r.length?eH:(r=r.slice(i,i+n),e.C=i+n,r)}(this,s))==eH){4==b&&(this.s=4,eD(14),n=!1),eU(this.i,this.l,null,"[Incomplete Response]");break}else if(e==eq){this.s=4,eD(15),eU(this.i,this.l,s,"[Invalid Chunk]"),n=!1;break}else eU(this.i,this.l,e,null),e0(this,e);if(eW(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=b||0!=s.length||this.h.h||(this.s=1,eD(16),n=!1),this.o=this.o&&n,n){if(0<s.length&&!this.W){this.W=!0;var v=this.j;v.g==this&&v.ba&&!v.M&&(v.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),tX(v),v.M=!0,eD(11))}}else eU(this.i,this.l,s,"[Invalid Chunked Response]"),eZ(this),eX(this)}else eU(this.i,this.l,s,null),e0(this,s);4==b&&eZ(this),this.o&&!this.J&&(4==b?t1(this.j,this):(this.o=!1,eQ(this)))}else(function(e){let r={};e=(e.g&&2<=tM(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(A(e[i]))continue;var n=function(e){var r=1;e=e.split(":");let n=[];for(;0<r&&e.length;)n.push(e.shift()),r--;return e.length&&n.push(e.join(":")),n}(e[i]);let o=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();let a=r[o]||[];r[o]=a,a.push(n)}var i=function(e){return e.join(", ")};for(let e in r)i.call(void 0,r[e],e,r)})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.s=3,eD(12)):(this.s=0,eD(13)),eZ(this),eX(this)}}}catch(e){}finally{}},eB.prototype.cancel=function(){this.J=!0,eZ(this)},eB.prototype.ba=function(){var e,r;this.B=null;let n=Date.now();0<=n-this.S?(e=this.i,r=this.A,e.info(function(){return"TIMEOUT: "+r}),2!=this.L&&(eN(),eD(17)),eZ(this),this.s=2,eX(this)):eJ(this,this.S-n)};var e1=class{constructor(e,r){this.g=e,this.map=r}};function e2(e){this.l=e||10,e=m.PerformanceNavigationTiming?0<(e=m.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(m.chrome&&m.chrome.loadTimes&&m.chrome.loadTimes()&&m.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function e3(e){return!!e.h||!!e.g&&e.g.size>=e.j}function e4(e){return e.h?1:e.g?e.g.size:0}function e5(e,r){return e.h?e.h==r:!!e.g&&e.g.has(r)}function e6(e,r){e.g?e.g.add(r):e.h=r}function e8(e,r){e.h&&e.h==r?e.h=null:e.g&&e.g.has(r)&&e.g.delete(r)}function e7(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let r=e.i;for(let n of e.g.values())r=r.concat(n.D);return r}return E(e.i)}function e9(e,r){if(e.forEach&&"function"==typeof e.forEach)e.forEach(r,void 0);else if(g(e)||"string"==typeof e)Array.prototype.forEach.call(e,r,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(g(e)||"string"==typeof e){var r=[];e=e.length;for(var n=0;n<e;n++)r.push(n);return r}for(let i in r=[],n=0,e)r[n++]=i;return r}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(g(e)){for(var r=[],n=e.length,i=0;i<n;i++)r.push(e[i]);return r}for(i in r=[],n=0,e)r[n++]=e[i];return r}(e),o=i.length,a=0;a<o;a++)r.call(void 0,i[a],n&&n[a],e)}e2.prototype.cancel=function(){if(this.i=e7(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var te=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof tt){this.h=e.h,tn(this,e.j),this.o=e.o,this.g=e.g,ti(this,e.s),this.l=e.l;var r=e.i,n=new tg;n.i=r.i,r.g&&(n.g=new Map(r.g),n.h=r.h),to(this,n),this.m=e.m}else e&&(r=String(e).match(te))?(this.h=!1,tn(this,r[1]||"",!0),this.o=tu(r[2]||""),this.g=tu(r[3]||"",!0),ti(this,r[4]),this.l=tu(r[5]||"",!0),to(this,r[6]||"",!0),this.m=tu(r[7]||"")):(this.h=!1,this.i=new tg(null,this.h))}function tr(e){return new tt(e)}function tn(e,r,n){e.j=n?tu(r,!0):r,e.j&&(e.j=e.j.replace(/:$/,""))}function ti(e,r){if(r){if(isNaN(r=Number(r))||0>r)throw Error("Bad port number "+r);e.s=r}else e.s=null}function to(e,r,n){var i,o;r instanceof tg?(e.i=r,i=e.i,(o=e.h)&&!i.j&&(ty(i),i.i=null,i.g.forEach(function(e,r){var n=r.toLowerCase();r!=n&&(tv(this,r),tw(this,n,e))},i)),i.j=o):(n||(r=tc(r,tp)),e.i=new tg(r,e.h))}function ta(e,r,n){e.i.set(r,n)}function ts(e){return ta(e,"zx",Math.floor(0x80000000*Math.random()).toString(36)+Math.abs(Math.floor(0x80000000*Math.random())^Date.now()).toString(36)),e}function tu(e,r){return e?r?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function tc(e,r,n){return"string"==typeof e?(e=encodeURI(e).replace(r,tl),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function tl(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}tt.prototype.toString=function(){var e=[],r=this.j;r&&e.push(tc(r,th,!0),":");var n=this.g;return(n||"file"==r)&&(e.push("//"),(r=this.o)&&e.push(tc(r,th,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(tc(n,"/"==n.charAt(0)?tf:td,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",tc(n,tm)),e.join("")};var th=/[#\/\?@]/g,td=/[#\?:]/g,tf=/[#\?]/g,tp=/[#\?@]/g,tm=/#/g;function tg(e,r){this.h=this.g=null,this.i=e||null,this.j=!!r}function ty(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,r){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),o=null;if(0<=i){var a=e[n].substring(0,i);o=e[n].substring(i+1)}else a=e[n];r(a,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(e.i,function(r,n){e.add(decodeURIComponent(r.replace(/\+/g," ")),n)}))}function tv(e,r){ty(e),r=tS(e,r),e.g.has(r)&&(e.i=null,e.h-=e.g.get(r).length,e.g.delete(r))}function tb(e,r){return ty(e),r=tS(e,r),e.g.has(r)}function tw(e,r,n){tv(e,r),0<n.length&&(e.i=null,e.g.set(tS(e,r),E(n)),e.h+=n.length)}function tS(e,r){return r=String(r),e.j&&(r=r.toLowerCase()),r}function tx(e,r,n,i,o){try{o&&(o.onload=null,o.onerror=null,o.onabort=null,o.ontimeout=null),i(n)}catch(e){}}function tE(){this.g=new eS}function tI(e){this.l=e.Ub||null,this.j=e.eb||!1}function tT(e,r){eh.call(this),this.D=e,this.o=r,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function tk(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function t_(e){e.readyState=4,e.l=null,e.j=null,e.v=null,tA(e)}function tA(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function tP(e){let r="";return N(e,function(e,n){r+=n,r+=":",r+=e,r+="\r\n"}),r}function tO(e,r,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=tP(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ta(e,r,n))}function tC(e){eh.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(n=tg.prototype).add=function(e,r){ty(this),this.i=null,e=tS(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(r),this.h+=1,this},n.forEach=function(e,r){ty(this),this.g.forEach(function(n,i){n.forEach(function(n){e.call(r,n,i,this)},this)},this)},n.na=function(){ty(this);let e=Array.from(this.g.values()),r=Array.from(this.g.keys()),n=[];for(let i=0;i<r.length;i++){let o=e[i];for(let e=0;e<o.length;e++)n.push(r[i])}return n},n.V=function(e){ty(this);let r=[];if("string"==typeof e)tb(this,e)&&(r=r.concat(this.g.get(tS(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)r=r.concat(e[n])}return r},n.set=function(e,r){return ty(this),this.i=null,tb(this,e=tS(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[r]),this.h+=1,this},n.get=function(e,r){return e&&0<(e=this.V(e)).length?String(e[0]):r},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],r=Array.from(this.g.keys());for(var n=0;n<r.length;n++){var i=r[n];let a=encodeURIComponent(String(i)),s=this.V(i);for(i=0;i<s.length;i++){var o=a;""!==s[i]&&(o+="="+encodeURIComponent(String(s[i]))),e.push(o)}}return this.i=e.join("&")},x(tI,ex),tI.prototype.g=function(){return new tT(this.l,this.j)},tI.prototype.i=(e={},function(){return e}),x(tT,eh),(n=tT.prototype).open=function(e,r){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=r,this.readyState=1,tA(this)},n.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;let r={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(r.body=e),(this.D||m).fetch(new Request(this.A,r)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,t_(this)),this.readyState=0},n.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tA(this)),this.g&&(this.readyState=3,tA(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==m.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;tk(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},n.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var r=e.value?e.value:new Uint8Array(0);(r=this.v.decode(r,{stream:!e.done}))&&(this.response=this.responseText+=r)}e.done?t_(this):tA(this),3==this.readyState&&tk(this)}},n.Ra=function(e){this.g&&(this.response=this.responseText=e,t_(this))},n.Qa=function(e){this.g&&(this.response=e,t_(this))},n.ga=function(){this.g&&t_(this)},n.setRequestHeader=function(e,r){this.u.append(e,r)},n.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],r=this.h.entries();for(var n=r.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=r.next();return e.join("\r\n")},Object.defineProperty(tT.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),x(tC,eh);var tN=/^https?$/i,tL=["POST","PUT"];function tD(e,r){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=r,e.m=5,tR(e),tF(e)}function tR(e){e.A||(e.A=!0,ed(e,"complete"),ed(e,"error"))}function tj(e){if(e.h&&void 0!==p&&(!e.v[1]||4!=tM(e)||2!=e.Z())){if(e.u&&4==tM(e))ep(e.Ea,0,e);else if(ed(e,"readystatechange"),4==tM(e)){e.h=!1;try{let s=e.Z();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r,n,i=!0;break;default:i=!1}if(!(r=i)){if(n=0===s){var o=String(e.D).match(te)[1]||null;!o&&m.self&&m.self.location&&(o=m.self.location.protocol.slice(0,-1)),n=!tN.test(o?o.toLowerCase():"")}r=n}if(r)ed(e,"complete"),ed(e,"success");else{e.m=6;try{var a=2<tM(e)?e.g.statusText:""}catch(e){a=""}e.l=a+" ["+e.Z()+"]",tR(e)}}finally{tF(e)}}}}function tF(e,r){if(e.g){tU(e);let n=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,r||ed(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function tU(e){e.I&&(m.clearTimeout(e.I),e.I=null)}function tM(e){return e.g?e.g.readyState:0}function tG(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tV(e,r,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||r}function tB(e){this.Aa=0,this.i=[],this.j=new eF,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=tV("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=tV("baseRetryDelayMs",5e3,e),this.cb=tV("retryDelaySeedMs",1e4,e),this.Wa=tV("forwardChannelMaxRetries",2,e),this.wa=tV("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new e2(e&&e.concurrentRequestLimit),this.Da=new tE,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function tz(e){if(tH(e),3==e.G){var r=e.U++,n=tr(e.I);if(ta(n,"SID",e.K),ta(n,"RID",r),ta(n,"TYPE","terminate"),tW(e,n),(r=new eB(e,e.j,r)).L=2,r.v=ts(tr(n)),n=!1,m.navigator&&m.navigator.sendBeacon)try{n=m.navigator.sendBeacon(r.v.toString(),"")}catch(e){}!n&&m.Image&&((new Image).src=r.v,n=!0),n||(r.g=t6(r.j,null),r.g.ea(r.v)),r.F=Date.now(),eQ(r)}t4(e)}function tq(e){e.g&&(tX(e),e.g.cancel(),e.g=null)}function tH(e){tq(e),e.u&&(m.clearTimeout(e.u),e.u=null),t0(e),e.h.cancel(),e.s&&("number"==typeof e.s&&m.clearTimeout(e.s),e.s=null)}function t$(e){if(!e3(e.h)&&!e.s){e.s=!0;var r=e.Ga;M||B(),G||(M(),G=!0),V.add(r,e),e.B=0}}function tK(e,r){var n;n=r?r.l:e.U++;let i=tr(e.I);ta(i,"SID",e.K),ta(i,"RID",n),ta(i,"AID",e.T),tW(e,i),e.m&&e.o&&tO(i,e.m,e.o),n=new eB(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),r&&(e.i=r.D.concat(e.i)),r=tQ(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),e6(e.h,n),e$(n,i,r)}function tW(e,r){e.H&&N(e.H,function(e,n){ta(r,n,e)}),e.l&&e9({},function(e,n){ta(r,n,e)})}function tQ(e,r,n){n=Math.min(e.i.length,n);var i=e.l?w(e.l.Na,e.l,e):null;e:{var o=e.i;let r=-1;for(;;){let e=["count="+n];-1==r?0<n?(r=o[0].g,e.push("ofs="+r)):r=0:e.push("ofs="+r);let a=!0;for(let s=0;s<n;s++){let n=o[s].g,u=o[s].map;if(0>(n-=r))r=Math.max(0,o[s].g-100),a=!1;else try{!function(e,r,n){let i=n||"";try{e9(e,function(e,n){let o=e;y(e)&&(o=eb(e)),r.push(i+n+"="+encodeURIComponent(o))})}catch(e){throw r.push(i+"type="+encodeURIComponent("_badmap")),e}}(u,e,"req"+n+"_")}catch(e){i&&i(u)}}if(a){i=e.join("&");break e}}}return r.D=e=e.i.splice(0,n),i}function tJ(e){if(!e.g&&!e.u){e.Y=1;var r=e.Fa;M||B(),G||(M(),G=!0),V.add(r,e),e.v=0}}function tY(e){return!e.g&&!e.u&&!(3<=e.v)&&(e.Y++,e.u=ej(w(e.Fa,e),t2(e,e.v)),e.v++,!0)}function tX(e){null!=e.A&&(m.clearTimeout(e.A),e.A=null)}function tZ(e){e.g=new eB(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var r=tr(e.qa);ta(r,"RID","rpc"),ta(r,"SID",e.K),ta(r,"AID",e.T),ta(r,"CI",e.F?"0":"1"),!e.F&&e.ja&&ta(r,"TO",e.ja),ta(r,"TYPE","xmlhttp"),tW(e,r),e.m&&e.o&&tO(r,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ts(tr(r)),n.m=null,n.P=!0,eK(n,e)}function t0(e){null!=e.C&&(m.clearTimeout(e.C),e.C=null)}function t1(e,r){var n,i=null;if(e.g==r){t0(e),tX(e),e.g=null;var o=2}else{if(!e5(e.h,r))return;i=r.D,e8(e.h,r),o=1}if(0!=e.G){if(r.o)if(1==o){i=r.m?r.m.length:0,r=Date.now()-r.F;var a=e.B;ed(o=eO(),new eR(o,i)),t$(e)}else tJ(e);else if(3==(a=r.s)||0==a&&0<r.X||!(1==o&&(n=r,!(e4(e.h)>=e.h.j-!!e.s)&&(e.s?(e.i=n.D.concat(e.i),!0):1!=e.G&&2!=e.G&&!(e.B>=(e.Va?0:e.Wa))&&(e.s=ej(w(e.Ga,e,n),t2(e,e.B)),e.B++,!0)))||2==o&&tY(e)))switch(i&&0<i.length&&((r=e.h).i=r.i.concat(i)),a){case 1:t3(e,5);break;case 4:t3(e,10);break;case 3:t3(e,6);break;default:t3(e,2)}}}function t2(e,r){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*r}function t3(e,r){if(e.j.info("Error code "+r),2==r){var n=w(e.fb,e),i=e.Xa;let r=!i;i=new tt(i||"//www.google.com/images/cleardot.gif"),m.location&&"http"==m.location.protocol||tn(i,"https"),ts(i),r?function(e,r){let n=new eF;if(m.Image){let i=new Image;i.onload=S(tx,n,"TestLoadImage: loaded",!0,r,i),i.onerror=S(tx,n,"TestLoadImage: error",!1,r,i),i.onabort=S(tx,n,"TestLoadImage: abort",!1,r,i),i.ontimeout=S(tx,n,"TestLoadImage: timeout",!1,r,i),m.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else r(!1)}(i.toString(),n):function(e,r){let n=new eF,i=new AbortController,o=setTimeout(()=>{i.abort(),tx(n,"TestPingServer: timeout",!1,r)},1e4);fetch(e,{signal:i.signal}).then(e=>{clearTimeout(o),e.ok?tx(n,"TestPingServer: ok",!0,r):tx(n,"TestPingServer: server error",!1,r)}).catch(()=>{clearTimeout(o),tx(n,"TestPingServer: error",!1,r)})}(i.toString(),n)}else eD(2);e.G=0,e.l&&e.l.sa(r),t4(e),tH(e)}function t4(e){if(e.G=0,e.ka=[],e.l){let r=e7(e.h);(0!=r.length||0!=e.i.length)&&(k(e.ka,r),k(e.ka,e.i),e.h.i.length=0,E(e.i),e.i.length=0),e.l.ra()}}function t5(e,r,n){var i=n instanceof tt?tr(n):new tt(n);if(""!=i.g)r&&(i.g=r+"."+i.g),ti(i,i.s);else{var o=m.location;i=o.protocol,r=r?r+"."+o.hostname:o.hostname,o=+o.port;var a=new tt(null);i&&tn(a,i),r&&(a.g=r),o&&ti(a,o),n&&(a.l=n),i=a}return n=e.D,r=e.ya,n&&r&&ta(i,n,r),ta(i,"VER",e.la),tW(e,i),i}function t6(e,r,n){if(r&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(r=new tC(e.Ca&&!e.pa?new tI({eb:n}):e.pa)).Ha(e.J),r}function t8(){}function t7(){}function t9(e,r){eh.call(this),this.g=new tB(r),this.l=e,this.h=r&&r.messageUrlParams||null,e=r&&r.messageHeaders||null,r&&r.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=r&&r.initMessageHeaders||null,r&&r.messageContentType&&(e?e["X-WebChannel-Content-Type"]=r.messageContentType:e={"X-WebChannel-Content-Type":r.messageContentType}),r&&r.va&&(e?e["X-WebChannel-Client-Profile"]=r.va:e={"X-WebChannel-Client-Profile":r.va}),this.g.S=e,(e=r&&r.Sb)&&!A(e)&&(this.g.m=e),this.v=r&&r.supportsCrossDomainXhr||!1,this.u=r&&r.sendRawJson||!1,(r=r&&r.httpSessionIdParam)&&!A(r)&&(this.g.D=r,null!==(e=this.h)&&r in e&&r in(e=this.h)&&delete e[r]),this.j=new rr(this)}function re(e){ek.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var r=e.__sm__;if(r){e:{for(let n in r){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,r=null!==r&&e in r?r[e]:void 0),this.data=r}else this.data=e}function rt(){e_.call(this),this.status=1}function rr(e){this.g=e}(n=tC.prototype).Ha=function(e){this.J=e},n.ea=function(e,n,i,o){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);n=n?n.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():r.g(),this.v=this.o?eE(this.o):eE(r),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(n,String(e),!0),this.B=!1}catch(e){tD(this,e);return}if(e=i||"",i=new Map(this.headers),o)if(Object.getPrototypeOf(o)===Object.prototype)for(var a in o)i.set(a,o[a]);else if("function"==typeof o.keys&&"function"==typeof o.get)for(let e of o.keys())i.set(e,o.get(e));else throw Error("Unknown input type for opt_headers: "+String(o));for(let[r,s]of(o=Array.from(i.keys()).find(e=>"content-type"==e.toLowerCase()),a=m.FormData&&e instanceof m.FormData,!(0<=Array.prototype.indexOf.call(tL,n,void 0))||o||a||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i))this.g.setRequestHeader(r,s);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tU(this),this.u=!0,this.g.send(e),this.u=!1}catch(e){tD(this,e)}},n.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ed(this,"complete"),ed(this,"abort"),tF(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tF(this,!0)),tC.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?tj(this):this.bb())},n.bb=function(){tj(this)},n.isActive=function(){return!!this.g},n.Z=function(){try{return 2<tM(this)?this.g.status:-1}catch(e){return -1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},n.Oa=function(e){if(this.g){var r=this.g.responseText;return e&&0==r.indexOf(e)&&(r=r.substring(e.length)),ew(r)}},n.Ba=function(){return this.m},n.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(n=tB.prototype).la=8,n.G=1,n.connect=function(e,r,n,i){eD(0),this.W=e,this.H=r||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=t5(this,null,this.W),t$(this)},n.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;let o=new eB(this,this.j,e),a=this.o;if(this.S&&(a?R(a=L(a),this.S):a=this.S),null!==this.m||this.O||(o.H=a,a=null),this.P)e:{for(var r=0,n=0;n<this.i.length;n++){t:{var i=this.i[n];if("__data__"in i.map&&"string"==typeof(i=i.map.__data__)){i=i.length;break t}i=void 0}if(void 0===i)break;if(4096<(r+=i)){r=n;break e}if(4096===r||n===this.i.length-1){r=n+1;break e}}r=1e3}else r=1e3;r=tQ(this,o,r),ta(n=tr(this.I),"RID",e),ta(n,"CVER",22),this.D&&ta(n,"X-HTTP-Session-Id",this.D),tW(this,n),a&&(this.O?r="headers="+encodeURIComponent(String(tP(a)))+"&"+r:this.m&&tO(n,this.m,a)),e6(this.h,o),this.Ua&&ta(n,"TYPE","init"),this.P?(ta(n,"$req",r),ta(n,"SID","null"),o.T=!0,e$(o,n,null)):e$(o,n,r),this.G=2}}else 3==this.G&&(e?tK(this,e):0==this.i.length||e3(this.h)||tK(this))},n.Fa=function(){if(this.u=null,tZ(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=ej(w(this.ab,this),e)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,eD(10),tq(this),tZ(this))},n.Za=function(){null!=this.C&&(this.C=null,tq(this),tY(this),eD(19))},n.fb=function(e){e?(this.j.info("Successfully pinged google.com"),eD(2)):(this.j.info("Failed to ping google.com"),eD(1))},n.isActive=function(){return!!this.l&&this.l.isActive(this)},(n=t8.prototype).ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){},t7.prototype.g=function(e,r){return new t9(e,r)},x(t9,eh),t9.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},t9.prototype.close=function(){tz(this.g)},t9.prototype.o=function(e){var r=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=eb(e),e=n);r.i.push(new e1(r.Ya++,e)),3==r.G&&t$(r)},t9.prototype.N=function(){this.g.l=null,delete this.j,tz(this.g),delete this.g,t9.aa.N.call(this)},x(re,ek),x(rt,e_),x(rr,t8),rr.prototype.ua=function(){ed(this.g,"a")},rr.prototype.ta=function(e){ed(this.g,new re(e))},rr.prototype.sa=function(e){ed(this.g,new rt)},rr.prototype.ra=function(){ed(this.g,"b")},t7.prototype.createWebChannel=t7.prototype.g,t9.prototype.send=t9.prototype.o,t9.prototype.open=t9.prototype.m,t9.prototype.close=t9.prototype.close,f=T.createWebChannelTransport=function(){return new t7},d=T.getStatEventTarget=function(){return eO()},h=T.Event=eA,l=T.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},eM.NO_ERROR=0,eM.TIMEOUT=8,eM.HTTP_ERROR=6,c=T.ErrorCode=eM,eG.COMPLETE="complete",u=T.EventType=eG,eI.EventType=eT,eT.OPEN="a",eT.CLOSE="b",eT.ERROR="c",eT.MESSAGE="d",eh.prototype.listen=eh.prototype.K,s=T.WebChannel=eI,T.FetchXmlHttpFactory=tI,tC.prototype.listenOnce=tC.prototype.L,tC.prototype.getLastError=tC.prototype.Ka,tC.prototype.getLastErrorCode=tC.prototype.Ba,tC.prototype.getStatus=tC.prototype.Z,tC.prototype.getResponseJson=tC.prototype.Oa,tC.prototype.getResponseText=tC.prototype.oa,tC.prototype.send=tC.prototype.ea,tC.prototype.setWithCredentials=tC.prototype.Ha,a=T.XhrIo=tC}).apply(void 0!==I?I:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var k=n(65364),_=n(82909).hp;let A="@firebase/firestore",P="4.8.0";class O{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}O.UNAUTHENTICATED=new O(null),O.GOOGLE_CREDENTIALS=new O("google-credentials-uid"),O.FIRST_PARTY=new O("first-party-uid"),O.MOCK_USER=new O("mock-user");let C="11.10.0",N=new w.Vy("@firebase/firestore");function L(){return N.logLevel}function D(e){N.setLogLevel(e)}function R(e,...r){if(N.logLevel<=w.$b.DEBUG){let n=r.map(U);N.debug(`Firestore (${C}): ${e}`,...n)}}function j(e,...r){if(N.logLevel<=w.$b.ERROR){let n=r.map(U);N.error(`Firestore (${C}): ${e}`,...n)}}function F(e,...r){if(N.logLevel<=w.$b.WARN){let n=r.map(U);N.warn(`Firestore (${C}): ${e}`,...n)}}function U(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(r){return e}}function M(e,r,n){let i="Unexpected state";"string"==typeof r?i=r:n=r,G(e,i,n)}function G(e,r,n){let i=`FIRESTORE (${C}) INTERNAL ASSERTION FAILED: ${r} (ID: ${e.toString(16)})`;if(void 0!==n)try{i+=" CONTEXT: "+JSON.stringify(n)}catch(e){i+=" CONTEXT: "+n}throw j(i),Error(i)}function V(e,r,n,i){let o="Unexpected state";"string"==typeof n?o=n:i=n,e||G(r,o,i)}function B(e,r){e||M(57014,r)}let z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends S.g{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class H{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}class ${constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(O.UNAUTHENTICATED))}shutdown(){}}class W{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Q{constructor(e){this.t=e,this.currentUser=O.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){V(void 0===this.o,42304);let n=this.i,i=e=>this.i!==n?(n=this.i,r(e)):Promise.resolve(),o=new H;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new H,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let r=o;e.enqueueRetryable(async()=>{await r.promise,await i(this.currentUser)})},s=e=>{R("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(e=>s(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?s(e):(R("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new H)}},0),a()}getToken(){let e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(r=>this.i!==e?(R("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(V("string"==typeof r.accessToken,31837,{l:r}),new $(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return V(null===e||"string"==typeof e,2055,{h:e}),new O(e)}}class J{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=O.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Y{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new J(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(O.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class X{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Z{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,v.xZ)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){V(void 0===this.o,3512);let n=e=>{null!=e.error&&R("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.m;return this.m=e.token,R("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?r(e.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>n(r))};let i=e=>{R("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>i(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?i(e):R("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new X(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(V("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new X(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class ee{getToken(){return Promise.resolve(new X(""))}invalidateToken(){}start(e,r){}shutdown(){}}function et(){return new TextEncoder}class er{static newId(){let e=62*Math.floor(256/62),r="";for(;r.length<20;){let n=function(e){let r="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(40);if(r&&"function"==typeof r.getRandomValues)r.getRandomValues(n);else for(let e=0;e<40;e++)n[e]=Math.floor(256*Math.random());return n}(40);for(let i=0;i<n.length;++i)r.length<20&&n[i]<e&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return r}}function en(e,r){return e<r?-1:+(e>r)}function ei(e,r){let n=0;for(;n<e.length&&n<r.length;){let i=e.codePointAt(n),o=r.codePointAt(n);if(i!==o){if(i<128&&o<128)return en(i,o);{let a=et(),s=function(e,r){for(let n=0;n<e.length&&n<r.length;++n)if(e[n]!==r[n])return en(e[n],r[n]);return en(e.length,r.length)}(a.encode(eo(e,n)),a.encode(eo(r,n)));return 0!==s?s:en(i,o)}}n+=i>65535?2:1}return en(e.length,r.length)}function eo(e,r){return e.codePointAt(r)>65535?e.substring(r,r+2):e.substring(r,r+1)}function ea(e,r,n){return e.length===r.length&&e.every((e,i)=>n(e,r[i]))}let es="__name__";class eu{constructor(e,r,n){void 0===r?r=0:r>e.length&&M(637,{offset:r,range:e.length}),void 0===n?n=e.length-r:n>e.length-r&&M(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return 0===eu.comparator(this,e)}child(e){let r=this.segments.slice(this.offset,this.limit());return e instanceof eu?e.forEach(e=>{r.push(e)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){let n=Math.min(e.length,r.length);for(let i=0;i<n;i++){let n=eu.compareSegments(e.get(i),r.get(i));if(0!==n)return n}return en(e.length,r.length)}static compareSegments(e,r){let n=eu.isNumericId(e),i=eu.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?eu.extractNumericId(e).compare(eu.extractNumericId(r)):ei(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return i.fromString(e.substring(4,e.length-2))}}class ec extends eu{construct(e,r,n){return new ec(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let r=[];for(let n of e){if(n.indexOf("//")>=0)throw new q(z.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(e=>e.length>0))}return new ec(r)}static emptyPath(){return new ec([])}}let el=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class eh extends eu{construct(e,r,n){return new eh(e,r,n)}static isValidIdentifier(e){return el.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),eh.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===es}static keyField(){return new eh([es])}static fromServerFormat(e){let r=[],n="",i=0,o=()=>{if(0===n.length)throw new q(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""},a=!1;for(;i<e.length;){let r=e[i];if("\\"===r){if(i+1===e.length)throw new q(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let r=e[i+1];if("\\"!==r&&"."!==r&&"`"!==r)throw new q(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=r,i+=2}else"`"===r?a=!a:"."!==r||a?n+=r:o(),i++}if(o(),a)throw new q(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new eh(r)}static emptyPath(){return new eh([])}}class ed{constructor(e){this.path=e}static fromPath(e){return new ed(ec.fromString(e))}static fromName(e){return new ed(ec.fromString(e).popFirst(5))}static empty(){return new ed(ec.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ec.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,r){return ec.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ed(new ec(e.slice()))}}function ef(e,r,n){if(!n)throw new q(z.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${r}.`)}function ep(e,r,n,i){if(!0===r&&!0===i)throw new q(z.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function em(e){if(!ed.isDocumentKey(e))throw new q(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function eg(e){if(ed.isDocumentKey(e))throw new q(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function ey(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function ev(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var r;let n=(r=e).constructor?r.constructor.name:null;return n?`a custom ${n} object`:"an object"}}return"function"==typeof e?"a function":M(12329,{type:typeof e})}function eb(e,r){if("_delegate"in e&&(e=e._delegate),!(e instanceof r)){if(r.name===e.constructor.name)throw new q(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=ev(e);throw new q(z.INVALID_ARGUMENT,`Expected type '${r.name}', but it was: ${n}`)}}return e}function ew(e,r){if(r<=0)throw new q(z.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${r}.`)}function eS(e,r){let n={typeString:e};return r&&(n.value=r),n}function ex(e,r){let n;if(!ey(e))throw new q(z.INVALID_ARGUMENT,"JSON must be an object");for(let i in r)if(r[i]){let o=r[i].typeString,a="value"in r[i]?{value:r[i].value}:void 0;if(!(i in e)){n=`JSON missing required field: '${i}'`;break}let s=e[i];if(o&&typeof s!==o){n=`JSON field '${i}' must be a ${o}.`;break}if(void 0!==a&&s!==a.value){n=`Expected '${i}' field to equal '${a.value}'`;break}}if(n)throw new q(z.INVALID_ARGUMENT,n);return!0}class eE{static now(){return eE.fromMillis(Date.now())}static fromDate(e){return eE.fromMillis(e.getTime())}static fromMillis(e){let r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*1e6);return new eE(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0||r>=1e9)throw new q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-0xe7791f700||e>=0x3afff44180)throw new q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?en(this.nanoseconds,e.nanoseconds):en(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:eE._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ex(e,eE._jsonSchema))return new eE(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}eE._jsonSchemaVersion="firestore/timestamp/1.0",eE._jsonSchema={type:eS("string",eE._jsonSchemaVersion),seconds:eS("number"),nanoseconds:eS("number")};class eI{static fromTimestamp(e){return new eI(e)}static min(){return new eI(new eE(0,0))}static max(){return new eI(new eE(0x3afff4417f,0x3b9ac9ff))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class eT{constructor(e,r,n,i){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=i}}function ek(e){return e.fields.find(e=>2===e.kind)}function e_(e){return e.fields.filter(e=>2!==e.kind)}function eA(e,r){let n=en(e.collectionGroup,r.collectionGroup);if(0!==n)return n;for(let i=0;i<Math.min(e.fields.length,r.fields.length);++i)if(0!==(n=function(e,r){let n=eh.comparator(e.fieldPath,r.fieldPath);return 0!==n?n:en(e.kind,r.kind)}(e.fields[i],r.fields[i])))return n;return en(e.fields.length,r.fields.length)}eT.UNKNOWN_ID=-1;class eP{constructor(e,r){this.fieldPath=e,this.kind=r}}class eO{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new eO(0,eL.min())}}function eC(e,r){let n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1;return new eL(eI.fromTimestamp(1e9===i?new eE(n+1,0):new eE(n,i)),ed.empty(),r)}function eN(e){return new eL(e.readTime,e.key,-1)}class eL{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new eL(eI.min(),ed.empty(),-1)}static max(){return new eL(eI.max(),ed.empty(),-1)}}function eD(e,r){let n=e.readTime.compareTo(r.readTime);return 0!==n||0!==(n=ed.comparator(e.documentKey,r.documentKey))?n:en(e.largestBatchId,r.largestBatchId)}let eR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ej{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function eF(e){if(e.code!==z.FAILED_PRECONDITION||e.message!==eR)throw e;R("LocalStore","Unexpectedly lost primary lease")}class eU{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&M(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new eU((n,i)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(n,i)},this.catchCallback=e=>{this.wrapFailure(r,e).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{let r=e();return r instanceof eU?r:eU.resolve(r)}catch(e){return eU.reject(e)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):eU.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):eU.reject(r)}static resolve(e){return new eU((r,n)=>{r(e)})}static reject(e){return new eU((r,n)=>{n(e)})}static waitFor(e){return new eU((r,n)=>{let i=0,o=0,a=!1;e.forEach(e=>{++i,e.next(()=>{++o,a&&o===i&&r()},e=>n(e))}),a=!0,o===i&&r()})}static or(e){let r=eU.resolve(!1);for(let n of e)r=r.next(e=>e?eU.resolve(e):n());return r}static forEach(e,r){let n=[];return e.forEach((e,i)=>{n.push(r.call(this,e,i))}),this.waitFor(n)}static mapArray(e,r){return new eU((n,i)=>{let o=e.length,a=Array(o),s=0;for(let u=0;u<o;u++){let c=u;r(e[c]).next(e=>{a[c]=e,++s===o&&n(a)},e=>i(e))}})}static doWhile(e,r){return new eU((n,i)=>{let o=()=>{!0===e()?r().next(()=>{o()},i):n()};o()})}}let eM="SimpleDb";class eG{static open(e,r,n,i){try{return new eG(r,e.transaction(i,n))}catch(e){throw new eq(r,e)}}constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.S=new H,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{r.error?this.S.reject(new eq(e,r.error)):this.S.resolve()},this.transaction.onerror=r=>{let n=eQ(r.target.error);this.S.reject(new eq(e,n))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(R(eM,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return new e$(this.transaction.objectStore(e))}}class eV{static delete(e){return R(eM,"Removing database:",e),eK((0,S.mS)().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,S.zW)())return!1;if(eV.F())return!0;let e=(0,S.ZQ)(),r=eV.M(e),n=eB(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<r&&r<10||0<n&&n<4.5)}static F(){var e;return void 0!==k&&"YES"===(null==(e=k.__PRIVATE_env)?void 0:e.O)}static N(e,r){return e.store(r)}static M(e){let r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(r?r[1].split("_").slice(0,2).join("."):"-1")}constructor(e,r,n){this.name=e,this.version=r,this.B=n,this.L=null,12.2===eV.M((0,S.ZQ)())&&j("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(R(eM,"Opening database:",this.name),this.db=await new Promise((r,n)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=e=>{r(e.target.result)},i.onblocked=()=>{n(new eq(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=r=>{let i=r.target.error;"VersionError"===i.name?n(new q(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new q(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new eq(e,i))},i.onupgradeneeded=e=>{R(eM,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let r=e.target.result;if(null!==this.L&&this.L!==e.oldVersion)throw Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${e.oldVersion}, event.newVersion=${e.newVersion}, db.version=${r.version}`);this.B.q(r,i.transaction,e.oldVersion,this.version).next(()=>{R(eM,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",e=>{let r=e.target;this.L=r.version},{passive:!0})),this.db.addEventListener("versionchange",e=>{var r;null===e.newVersion&&(F('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),null==(r=this.databaseDeletedListener)||r.call(this))},{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,r,n,i){let o="readonly"===r,a=0;for(;;){++a;try{this.db=await this.k(e);let r=eG.open(this.db,e,o?"readonly":"readwrite",n),a=i(r).next(e=>(r.v(),e)).catch(e=>(r.abort(e),eU.reject(e))).toPromise();return a.catch(()=>{}),await r.D,a}catch(r){let e="FirebaseError"!==r.name&&a<3;if(R(eM,"Transaction failed with error:",r.message,"Retrying:",e),this.close(),!e)return Promise.reject(r)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eB(e){let r=e.match(/Android ([\d.]+)/i);return Number(r?r[1].split(".").slice(0,2).join("."):"-1")}class ez{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return eK(this.$.delete())}}class eq extends q{constructor(e,r){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function eH(e){return"IndexedDbTransactionError"===e.name}class e${constructor(e){this.store=e}put(e,r){let n;return void 0!==r?(R(eM,"PUT",this.store.name,e,r),n=this.store.put(r,e)):(R(eM,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),eK(n)}add(e){return R(eM,"ADD",this.store.name,e,e),eK(this.store.add(e))}get(e){return eK(this.store.get(e)).next(r=>(void 0===r&&(r=null),R(eM,"GET",this.store.name,e,r),r))}delete(e){return R(eM,"DELETE",this.store.name,e),eK(this.store.delete(e))}count(){return R(eM,"COUNT",this.store.name),eK(this.store.count())}j(e,r){let n=this.options(e,r),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){let e=i.getAll(n.range);return new eU((r,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{r(e.target.result)}})}{let e=this.cursor(n),r=[];return this.J(e,(e,n)=>{r.push(n)}).next(()=>r)}}H(e,r){let n=this.store.getAll(e,null===r?void 0:r);return new eU((e,r)=>{n.onerror=e=>{r(e.target.error)},n.onsuccess=r=>{e(r.target.result)}})}Y(e,r){R(eM,"DELETE ALL",this.store.name);let n=this.options(e,r);n.Z=!1;let i=this.cursor(n);return this.J(i,(e,r,n)=>n.delete())}X(e,r){let n;r?n=e:(n={},r=e);let i=this.cursor(n);return this.J(i,r)}ee(e){let r=this.cursor({});return new eU((n,i)=>{r.onerror=e=>{i(eQ(e.target.error))},r.onsuccess=r=>{let i=r.target.result;i?e(i.primaryKey,i.value).next(e=>{e?i.continue():n()}):n()}})}J(e,r){let n=[];return new eU((i,o)=>{e.onerror=e=>{o(e.target.error)},e.onsuccess=e=>{let o=e.target.result;if(!o)return void i();let a=new ez(o),s=r(o.primaryKey,o.value,a);if(s instanceof eU){let e=s.catch(e=>(a.done(),eU.reject(e)));n.push(e)}a.isDone?i():null===a.W?o.continue():o.continue(a.W)}}).next(()=>eU.waitFor(n))}options(e,r){let n;return void 0!==e&&("string"==typeof e?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){let n=this.store.index(e.index);return e.Z?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function eK(e){return new eU((r,n)=>{e.onsuccess=e=>{r(e.target.result)},e.onerror=e=>{n(eQ(e.target.error))}})}let eW=!1;function eQ(e){let r=eV.M((0,S.ZQ)());if(r>=12.2&&r<13){let r="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(r)>=0){let e=new q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return eW||(eW=!0,setTimeout(()=>{throw e},0)),e}}return e}let eJ="IndexBackfiller";class eY{constructor(e,r){this.asyncQueue=e,this.te=r,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ne(e){R(eJ,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let e=await this.te.re();R(eJ,`Documents written: ${e}`)}catch(e){eH(e)?R(eJ,"Ignoring IndexedDB error during index backfill: ",e):await eF(e)}await this.ne(6e4)})}}class eX{constructor(e,r){this.localStore=e,this.persistence=r}async re(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.ie(r,e))}ie(e,r){let n=new Set,i=r,o=!0;return eU.doWhile(()=>!0===o&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(r=>{if(null!==r&&!n.has(r))return R(eJ,`Processing collection: ${r}`),this.se(e,r,i).next(e=>{i-=e,n.add(r)});o=!1})).next(()=>r-i)}se(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(i=>this.localStore.localDocuments.getNextDocuments(e,r,i,n).next(n=>{let o=n.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.oe(i,n)).next(n=>(R(eJ,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,r,n))).next(()=>o.size)}))}oe(e,r){let n=e;return r.changes.forEach((e,r)=>{let i=eN(r);eD(i,n)>0&&(n=i)}),new eL(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}class eZ{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=e=>this._e(e),this.ae=e=>r.writeSequenceNumber(e))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ae&&this.ae(e),e}}function e0(e){return null==e}function e1(e){return 0===e&&1/e==-1/0}function e2(e){return"number"==typeof e&&Number.isInteger(e)&&!e1(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function e3(e){let r="";for(let n=0;n<e.length;n++)r.length>0&&(r+="\x01\x01"),r=function(e,r){let n=r,i=e.length;for(let r=0;r<i;r++){let i=e.charAt(r);switch(i){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=i}}return n}(e.get(n),r);return r+"\x01\x01"}eZ.ue=-1;function e4(e){let r=e.length;if(V(r>=2,64408,{path:e}),2===r)return V("\x01"===e.charAt(0)&&"\x01"===e.charAt(1),56145,{path:e}),ec.emptyPath();let n=r-2,i=[],o="";for(let a=0;a<r;){let r=e.indexOf("\x01",a);switch((r<0||r>n)&&M(50515,{path:e}),e.charAt(r+1)){case"\x01":let s,u=e.substring(a,r);0===o.length?s=u:(o+=u,s=o,o=""),i.push(s);break;case"\x10":o+=e.substring(a,r),o+="\0";break;case"\x11":o+=e.substring(a,r+1);break;default:M(61167,{path:e})}a=r+2}return new ec(i)}let e5="remoteDocuments",e6="owner",e8="owner",e7="mutationQueues",e9="mutations",te="batchId",tt="userMutationsIndex",tr=["userId","batchId"],tn={},ti="documentMutations",to="remoteDocumentsV14",ta=["prefixPath","collectionGroup","readTime","documentId"],ts="documentKeyIndex",tu=["prefixPath","collectionGroup","documentId"],tc="collectionGroupIndex",tl=["collectionGroup","readTime","prefixPath","documentId"],th="remoteDocumentGlobal",td="remoteDocumentGlobalKey",tf="targets",tp="queryTargetsIndex",tm=["canonicalId","targetId"],tg="targetDocuments",ty=["targetId","path"],tv="documentTargetsIndex",tb=["path","targetId"],tw="targetGlobalKey",tS="targetGlobal",tx="collectionParents",tE=["collectionId","parent"],tI="clientMetadata",tT="bundles",tk="namedQueries",t_="indexConfiguration",tA="collectionGroupIndex",tP="indexState",tO=["indexId","uid"],tC="sequenceNumberIndex",tN=["uid","sequenceNumber"],tL="indexEntries",tD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tR="documentKeyIndex",tj=["indexId","uid","orderedDocumentKey"],tF="documentOverlays",tU=["userId","collectionPath","documentId"],tM="collectionPathOverlayIndex",tG=["userId","collectionPath","largestBatchId"],tV="collectionGroupOverlayIndex",tB=["userId","collectionGroup","largestBatchId"],tz="globals",tq=[e7,e9,ti,e5,tf,e6,tS,tg,tI,th,tx,tT,tk],tH=[...tq,tF],t$=[e7,e9,ti,to,tf,e6,tS,tg,tI,th,tx,tT,tk,tF],tK=[...t$,t_,tP,tL],tW=[...tK,tz];class tQ extends ej{constructor(e,r){super(),this.ce=e,this.currentSequenceNumber=r}}function tJ(e,r){return eV.N(e.ce,r)}function tY(e){let r=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r++;return r}function tX(e,r){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r(n,e[n])}function tZ(e,r){let n=[];for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.push(r(e[i],i,e));return n}function t0(e){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}class t1{constructor(e,r){this.comparator=e,this.root=r||t3.EMPTY}insert(e,r){return new t1(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,t3.BLACK,null,null))}remove(e){return new t1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,t3.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(0===n)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(0===i)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){let e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new t2(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new t2(this.root,e,this.comparator,!1)}getReverseIterator(){return new t2(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new t2(this.root,e,this.comparator,!0)}}class t2{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class t3{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=null!=n?n:t3.RED,this.left=null!=i?i:t3.EMPTY,this.right=null!=o?o:t3.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new t3(null!=e?e:this.key,null!=r?r:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=o?o:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this,o=n(e,i.key);return(i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):0===o?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n))).fixUp()}removeMin(){if(this.left.isEmpty())return t3.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,r){let n,i=this;if(0>r(e,i.key))i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===r(e,i.key)){if(i.right.isEmpty())return t3.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t3.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t3.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw M(43730,{key:this.key,value:this.value});if(this.right.isRed())throw M(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw M(27949);return e+ +!this.isRed()}}t3.EMPTY=null,t3.RED=!0,t3.BLACK=!1,t3.EMPTY=new class{constructor(){this.size=0}get key(){throw M(57766)}get value(){throw M(16141)}get color(){throw M(16727)}get left(){throw M(29726)}get right(){throw M(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new t3(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class t4{constructor(e){this.comparator=e,this.data=new t1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=void 0!==r?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new t5(this.data.getIterator())}getIteratorFrom(e){return new t5(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(e=>{r=r.add(e)}),r}isEqual(e){if(!(e instanceof t4)||this.size!==e.size)return!1;let r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){let e=r.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){let e=[];return this.forEach(r=>{e.push(r)}),e}toString(){let e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){let r=new t4(this.comparator);return r.data=e,r}}class t5{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function t6(e){return e.hasNext()?e.getNext():void 0}class t8{constructor(e){this.fields=e,e.sort(eh.comparator)}static empty(){return new t8([])}unionWith(e){let r=new t4(eh.comparator);for(let e of this.fields)r=r.add(e);for(let n of e)r=r.add(n);return new t8(r.toArray())}covers(e){for(let r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ea(this.fields,e.fields,(e,r)=>e.isEqual(r))}}class t7 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function t9(){return"undefined"!=typeof atob}class re{constructor(e){this.binaryString=e}static fromBase64String(e){return new re(function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new t7("Invalid base64 string: "+e):e}}(e))}static fromUint8Array(e){return new re(function(e){let r="";for(let n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return r}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){var e=this.binaryString;let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return en(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}re.EMPTY_BYTE_STRING=new re("");let rt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rr(e){if(V(!!e,39018),"string"==typeof e){let r=0,n=rt.exec(e);if(V(!!n,46558,{timestamp:e}),n[1]){let e=n[1];r=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:r}}return{seconds:rn(e.seconds),nanos:rn(e.nanos)}}function rn(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ri(e){return"string"==typeof e?re.fromBase64String(e):re.fromUint8Array(e)}let ro="server_timestamp",ra="__type__",rs="__previous_value__",ru="__local_write_time__";function rc(e){var r,n;return(null==(n=((null==(r=null==e?void 0:e.mapValue)?void 0:r.fields)||{})[ra])?void 0:n.stringValue)===ro}function rl(e){let r=e.mapValue.fields[rs];return rc(r)?rl(r):r}function rh(e){let r=rr(e.mapValue.fields[ru].timestampValue);return new eE(r.seconds,r.nanos)}class rd{constructor(e,r,n,i,o,a,s,u,c,l){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=l}}let rf="(default)";class rp{constructor(e,r){this.projectId=e,this.database=r||rf}static empty(){return new rp("","")}get isDefaultDatabase(){return this.database===rf}isEqual(e){return e instanceof rp&&e.projectId===this.projectId&&e.database===this.database}}let rm="__type__",rg="__max__",ry={mapValue:{fields:{__type__:{stringValue:rg}}}},rv="__vector__",rb="value",rw={nullValue:"NULL_VALUE"};function rS(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?rc(e)?4:rj(e)?0x1fffffffffffff:rD(e)?10:11:M(28295,{value:e})}function rx(e,r){if(e===r)return!0;let n=rS(e);if(n!==rS(r))return!1;switch(n){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===r.booleanValue;case 4:return rh(e).isEqual(rh(r));case 3:if("string"==typeof e.timestampValue&&"string"==typeof r.timestampValue&&e.timestampValue.length===r.timestampValue.length)return e.timestampValue===r.timestampValue;let i=rr(e.timestampValue),o=rr(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos;case 5:return e.stringValue===r.stringValue;case 6:return ri(e.bytesValue).isEqual(ri(r.bytesValue));case 7:return e.referenceValue===r.referenceValue;case 8:return rn(e.geoPointValue.latitude)===rn(r.geoPointValue.latitude)&&rn(e.geoPointValue.longitude)===rn(r.geoPointValue.longitude);case 2:if("integerValue"in e&&"integerValue"in r)return rn(e.integerValue)===rn(r.integerValue);if("doubleValue"in e&&"doubleValue"in r){let n=rn(e.doubleValue),i=rn(r.doubleValue);return n===i?e1(n)===e1(i):isNaN(n)&&isNaN(i)}return!1;case 9:return ea(e.arrayValue.values||[],r.arrayValue.values||[],rx);case 10:case 11:let a=e.mapValue.fields||{},s=r.mapValue.fields||{};if(tY(a)!==tY(s))return!1;for(let e in a)if(a.hasOwnProperty(e)&&(void 0===s[e]||!rx(a[e],s[e])))return!1;return!0;default:return M(52216,{left:e})}}function rE(e,r){return void 0!==(e.values||[]).find(e=>rx(e,r))}function rI(e,r){if(e===r)return 0;let n=rS(e),i=rS(r);if(n!==i)return en(n,i);switch(n){case 0:case 0x1fffffffffffff:return 0;case 1:return en(e.booleanValue,r.booleanValue);case 2:let o=rn(e.integerValue||e.doubleValue),a=rn(r.integerValue||r.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1;case 3:return rT(e.timestampValue,r.timestampValue);case 4:return rT(rh(e),rh(r));case 5:return ei(e.stringValue,r.stringValue);case 6:return function(e,r){let n=ri(e),i=ri(r);return n.compareTo(i)}(e.bytesValue,r.bytesValue);case 7:return function(e,r){let n=e.split("/"),i=r.split("/");for(let e=0;e<n.length&&e<i.length;e++){let r=en(n[e],i[e]);if(0!==r)return r}return en(n.length,i.length)}(e.referenceValue,r.referenceValue);case 8:return function(e,r){let n=en(rn(e.latitude),rn(r.latitude));return 0!==n?n:en(rn(e.longitude),rn(r.longitude))}(e.geoPointValue,r.geoPointValue);case 9:return rk(e.arrayValue,r.arrayValue);case 10:return function(e,r){var n,i,o,a;let s=e.fields||{},u=r.fields||{},c=null==(n=s[rb])?void 0:n.arrayValue,l=null==(i=u[rb])?void 0:i.arrayValue,h=en((null==(o=null==c?void 0:c.values)?void 0:o.length)||0,(null==(a=null==l?void 0:l.values)?void 0:a.length)||0);return 0!==h?h:rk(c,l)}(e.mapValue,r.mapValue);case 11:return function(e,r){if(e===ry.mapValue&&r===ry.mapValue)return 0;if(e===ry.mapValue)return 1;if(r===ry.mapValue)return -1;let n=e.fields||{},i=Object.keys(n),o=r.fields||{},a=Object.keys(o);i.sort(),a.sort();for(let e=0;e<i.length&&e<a.length;++e){let r=ei(i[e],a[e]);if(0!==r)return r;let s=rI(n[i[e]],o[a[e]]);if(0!==s)return s}return en(i.length,a.length)}(e.mapValue,r.mapValue);default:throw M(23264,{le:n})}}function rT(e,r){if("string"==typeof e&&"string"==typeof r&&e.length===r.length)return en(e,r);let n=rr(e),i=rr(r),o=en(n.seconds,i.seconds);return 0!==o?o:en(n.nanos,i.nanos)}function rk(e,r){let n=e.values||[],i=r.values||[];for(let e=0;e<n.length&&e<i.length;++e){let r=rI(n[e],i[e]);if(r)return r}return en(n.length,i.length)}function r_(e){var r,n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){let r=rr(e);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?ri(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,ed.fromName(r).toString()):"geoPointValue"in e?(n=e.geoPointValue,`geo(${n.latitude},${n.longitude})`):"arrayValue"in e?function(e){let r="[",n=!0;for(let i of e.values||[])n?n=!1:r+=",",r+=r_(i);return r+"]"}(e.arrayValue):"mapValue"in e?function(e){let r=Object.keys(e.fields||{}).sort(),n="{",i=!0;for(let o of r)i?i=!1:n+=",",n+=`${o}:${r_(e.fields[o])}`;return n+"}"}(e.mapValue):M(61005,{value:e})}function rA(e,r){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${r.path.canonicalString()}`}}function rP(e){return!!e&&"integerValue"in e}function rO(e){return!!e&&"arrayValue"in e}function rC(e){return!!e&&"nullValue"in e}function rN(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function rL(e){return!!e&&"mapValue"in e}function rD(e){var r,n;return(null==(n=((null==(r=null==e?void 0:e.mapValue)?void 0:r.fields)||{})[rm])?void 0:n.stringValue)===rv}function rR(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){let r={mapValue:{fields:{}}};return tX(e.mapValue.fields,(e,n)=>r.mapValue.fields[e]=rR(n)),r}if(e.arrayValue){let r={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)r.arrayValue.values[n]=rR(e.arrayValue.values[n]);return r}return Object.assign({},e)}function rj(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===rg}let rF={mapValue:{fields:{[rm]:{stringValue:rv},[rb]:{arrayValue:{}}}}};function rU(e,r){let n=rI(e.value,r.value);return 0!==n?n:e.inclusive&&!r.inclusive?-1:!e.inclusive&&r.inclusive?1:0}function rM(e,r){let n=rI(e.value,r.value);return 0!==n?n:e.inclusive&&!r.inclusive?1:!e.inclusive&&r.inclusive?-1:0}class rG{constructor(e){this.value=e}static empty(){return new rG({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(!rL(r=(r.mapValue.fields||{})[e.get(n)]))return null;return(r=(r.mapValue.fields||{})[e.lastSegment()])||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=rR(r)}setAll(e){let r=eh.emptyPath(),n={},i=[];e.forEach((e,o)=>{if(!r.isImmediateParentOf(o)){let e=this.getFieldsMap(r);this.applyChanges(e,n,i),n={},i=[],r=o.popLast()}e?n[o.lastSegment()]=rR(e):i.push(o.lastSegment())});let o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){let r=this.field(e.popLast());rL(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return rx(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];rL(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){for(let i of(tX(r,(r,n)=>e[r]=n),n))delete e[i]}clone(){return new rG(rR(this.value))}}class rV{constructor(e,r,n,i,o,a,s){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=s}static newInvalidDocument(e){return new rV(e,0,eI.min(),eI.min(),eI.min(),rG.empty(),0)}static newFoundDocument(e,r,n,i){return new rV(e,1,r,eI.min(),n,i,0)}static newNoDocument(e,r){return new rV(e,2,r,eI.min(),eI.min(),rG.empty(),0)}static newUnknownDocument(e,r){return new rV(e,3,r,eI.min(),eI.min(),rG.empty(),2)}convertToFoundDocument(e,r){return this.createTime.isEqual(eI.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rG.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rG.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=eI.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof rV&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rV(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class rB{constructor(e,r){this.position=e,this.inclusive=r}}function rz(e,r,n){let i=0;for(let o=0;o<e.position.length;o++){let a=r[o],s=e.position[o];if(i=a.field.isKeyField()?ed.comparator(ed.fromName(s.referenceValue),n.key):rI(s,n.data.field(a.field)),"desc"===a.dir&&(i*=-1),0!==i)break}return i}function rq(e,r){if(null===e)return null===r;if(null===r||e.inclusive!==r.inclusive||e.position.length!==r.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!rx(e.position[n],r.position[n]))return!1;return!0}class rH{constructor(e,r="asc"){this.field=e,this.dir=r}}class r${}class rK extends r${constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?"in"===r||"not-in"===r?this.createKeyFieldInFilter(e,r,n):new r0(e,r,n):"array-contains"===r?new r4(e,n):"in"===r?new r5(e,n):"not-in"===r?new r6(e,n):"array-contains-any"===r?new r8(e,n):new rK(e,r,n)}static createKeyFieldInFilter(e,r,n){return"in"===r?new r1(e,n):new r2(e,n)}matches(e){let r=e.data.field(this.field);return"!="===this.op?null!==r&&void 0===r.nullValue&&this.matchesComparison(rI(r,this.value)):null!==r&&rS(this.value)===rS(r)&&this.matchesComparison(rI(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return M(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rW extends r${constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new rW(e,r)}matches(e){return rQ(this)?void 0===this.filters.find(r=>!r.matches(e)):void 0!==this.filters.find(r=>r.matches(e))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function rQ(e){return"and"===e.op}function rJ(e){return"or"===e.op}function rY(e){return rX(e)&&rQ(e)}function rX(e){for(let r of e.filters)if(r instanceof rW)return!1;return!0}function rZ(e,r){let n=e.filters.concat(r);return rW.create(n,e.op)}class r0 extends rK{constructor(e,r,n){super(e,r,n),this.key=ed.fromName(n.referenceValue)}matches(e){let r=ed.comparator(e.key,this.key);return this.matchesComparison(r)}}class r1 extends rK{constructor(e,r){super(e,"in",r),this.keys=r3("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class r2 extends rK{constructor(e,r){super(e,"not-in",r),this.keys=r3("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function r3(e,r){var n;return((null==(n=r.arrayValue)?void 0:n.values)||[]).map(e=>ed.fromName(e.referenceValue))}class r4 extends rK{constructor(e,r){super(e,"array-contains",r)}matches(e){let r=e.data.field(this.field);return rO(r)&&rE(r.arrayValue,this.value)}}class r5 extends rK{constructor(e,r){super(e,"in",r)}matches(e){let r=e.data.field(this.field);return null!==r&&rE(this.value.arrayValue,r)}}class r6 extends rK{constructor(e,r){super(e,"not-in",r)}matches(e){if(rE(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let r=e.data.field(this.field);return null!==r&&void 0===r.nullValue&&!rE(this.value.arrayValue,r)}}class r8 extends rK{constructor(e,r){super(e,"array-contains-any",r)}matches(e){let r=e.data.field(this.field);return!(!rO(r)||!r.arrayValue.values)&&r.arrayValue.values.some(e=>rE(this.value.arrayValue,e))}}class r7{constructor(e,r=null,n=[],i=[],o=null,a=null,s=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=s,this.Pe=null}}function r9(e,r=null,n=[],i=[],o=null,a=null,s=null){return new r7(e,r,n,i,o,a,s)}function ne(e){if(null===e.Pe){let r=e.path.canonicalString();null!==e.collectionGroup&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(e=>(function e(r){if(r instanceof rK)return r.field.canonicalString()+r.op.toString()+r_(r.value);if(rY(r))return r.filters.map(r=>e(r)).join(",");{let n=r.filters.map(r=>e(r)).join(",");return`${r.op}(${n})`}})(e)).join(","),r+="|ob:",r+=e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),e0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(e=>r_(e)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(e=>r_(e)).join(",")),e.Pe=r}return e.Pe}function nt(e,r){if(e.limit!==r.limit||e.orderBy.length!==r.orderBy.length)return!1;for(let o=0;o<e.orderBy.length;o++){var n,i;if(n=e.orderBy[o],i=r.orderBy[o],!(n.dir===i.dir&&n.field.isEqual(i.field)))return!1}if(e.filters.length!==r.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!function e(r,n){return r instanceof rK?n instanceof rK&&r.op===n.op&&r.field.isEqual(n.field)&&rx(r.value,n.value):r instanceof rW?n instanceof rW&&r.op===n.op&&r.filters.length===n.filters.length&&r.filters.reduce((r,i,o)=>r&&e(i,n.filters[o]),!0):void M(19439)}(e.filters[n],r.filters[n]))return!1;return e.collectionGroup===r.collectionGroup&&!!e.path.isEqual(r.path)&&!!rq(e.startAt,r.startAt)&&rq(e.endAt,r.endAt)}function nr(e){return ed.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function nn(e,r){return e.filters.filter(e=>e instanceof rK&&e.field.isEqual(r))}function ni(e,r,n){let i=rw,o=!0;for(let n of nn(e,r)){let e=rw,r=!0;switch(n.op){case"<":case"<=":var a;e="nullValue"in(a=n.value)?rw:"booleanValue"in a?{booleanValue:!1}:"integerValue"in a||"doubleValue"in a?{doubleValue:NaN}:"timestampValue"in a?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in a?{stringValue:""}:"bytesValue"in a?{bytesValue:""}:"referenceValue"in a?rA(rp.empty(),ed.empty()):"geoPointValue"in a?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in a?{arrayValue:{}}:"mapValue"in a?rD(a)?rF:{mapValue:{}}:M(35942,{value:a});break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,r=!1;break;case"!=":case"not-in":e=rw}0>rU({value:i,inclusive:o},{value:e,inclusive:r})&&(i=e,o=r)}if(null!==n){for(let a=0;a<e.orderBy.length;++a)if(e.orderBy[a].field.isEqual(r)){let e=n.position[a];0>rU({value:i,inclusive:o},{value:e,inclusive:n.inclusive})&&(i=e,o=n.inclusive);break}}return{value:i,inclusive:o}}function no(e,r,n){let i=ry,o=!0;for(let n of nn(e,r)){let e=ry,r=!0;switch(n.op){case">=":case">":var a;e="nullValue"in(a=n.value)?{booleanValue:!1}:"booleanValue"in a?{doubleValue:NaN}:"integerValue"in a||"doubleValue"in a?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in a?{stringValue:""}:"stringValue"in a?{bytesValue:""}:"bytesValue"in a?rA(rp.empty(),ed.empty()):"referenceValue"in a?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in a?{arrayValue:{}}:"arrayValue"in a?rF:"mapValue"in a?rD(a)?{mapValue:{}}:ry:M(61959,{value:a}),r=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,r=!1;break;case"!=":case"not-in":e=ry}rM({value:i,inclusive:o},{value:e,inclusive:r})>0&&(i=e,o=r)}if(null!==n){for(let a=0;a<e.orderBy.length;++a)if(e.orderBy[a].field.isEqual(r)){let e=n.position[a];rM({value:i,inclusive:o},{value:e,inclusive:n.inclusive})>0&&(i=e,o=n.inclusive);break}}return{value:i,inclusive:o}}class na{constructor(e,r=null,n=[],i=[],o=null,a="F",s=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=s,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function ns(e){return new na(e)}function nu(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function nc(e){return null!==e.collectionGroup}function nl(e){if(null===e.Te){let r;e.Te=[];let n=new Set;for(let r of e.explicitOrderBy)e.Te.push(r),n.add(r.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(r=new t4(eh.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(r=r.add(e.field))})}),r).forEach(r=>{n.has(r.canonicalString())||r.isKeyField()||e.Te.push(new rH(r,i))}),n.has(eh.keyField().canonicalString())||e.Te.push(new rH(eh.keyField(),i))}return e.Te}function nh(e){return e.Ie||(e.Ie=nf(e,nl(e))),e.Ie}function nd(e){return e.de||(e.de=nf(e,e.explicitOrderBy)),e.de}function nf(e,r){if("F"===e.limitType)return r9(e.path,e.collectionGroup,r,e.filters,e.limit,e.startAt,e.endAt);{r=r.map(e=>{let r="desc"===e.dir?"asc":"desc";return new rH(e.field,r)});let n=e.endAt?new rB(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new rB(e.startAt.position,e.startAt.inclusive):null;return r9(e.path,e.collectionGroup,r,e.filters,e.limit,n,i)}}function np(e,r){let n=e.filters.concat([r]);return new na(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function nm(e,r,n){return new na(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),r,n,e.startAt,e.endAt)}function ng(e,r){return nt(nh(e),nh(r))&&e.limitType===r.limitType}function ny(e){return`${ne(nh(e))}|lt:${e.limitType}`}function nv(e){var r;let n;return`Query(target=${n=(r=nh(e)).path.canonicalString(),null!==r.collectionGroup&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(e=>(function e(r){return r instanceof rK?`${r.field.canonicalString()} ${r.op} ${r_(r.value)}`:r instanceof rW?r.op.toString()+" {"+r.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),e0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(e=>r_(e)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(e=>r_(e)).join(",")),`Target(${n})`}; limitType=${e.limitType})`}function nb(e,r){return r.isFoundDocument()&&function(e,r){let n=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ed.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,r)&&function(e,r){for(let n of nl(e))if(!n.field.isKeyField()&&null===r.data.field(n.field))return!1;return!0}(e,r)&&function(e,r){for(let n of e.filters)if(!n.matches(r))return!1;return!0}(e,r)&&(!e.startAt||!!function(e,r,n){let i=rz(e,r,n);return e.inclusive?i<=0:i<0}(e.startAt,nl(e),r))&&(!e.endAt||!!function(e,r,n){let i=rz(e,r,n);return e.inclusive?i>=0:i>0}(e.endAt,nl(e),r))}function nw(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function nS(e){return(r,n)=>{let i=!1;for(let o of nl(e)){let e=function(e,r,n){let i=e.field.isKeyField()?ed.comparator(r.key,n.key):function(e,r,n){let i=r.data.field(e),o=n.data.field(e);return null!==i&&null!==o?rI(i,o):M(42886)}(e.field,r,n);switch(e.dir){case"asc":return i;case"desc":return -1*i;default:return M(19790,{direction:e.dir})}}(o,r,n);if(0!==e)return e;i=i||o.field.isKeyField()}return 0}}class nx{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0!==n){for(let[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return void 0!==this.get(e)}set(e,r){let n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,r]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){tX(this.inner,(r,n)=>{for(let[r,i]of n)e(r,i)})}isEmpty(){return t0(this.inner)}size(){return this.innerSize}}let nE=new t1(ed.comparator),nI=new t1(ed.comparator);function nT(...e){let r=nI;for(let n of e)r=r.insert(n.key,n);return r}function nk(e){let r=nI;return e.forEach((e,n)=>r=r.insert(e,n.overlayedDocument)),r}function n_(){return new nx(e=>e.toString(),(e,r)=>e.isEqual(r))}let nA=new t1(ed.comparator),nP=new t4(ed.comparator);function nO(...e){let r=nP;for(let n of e)r=r.add(n);return r}let nC=new t4(en);function nN(e,r){if(e.useProto3Json){if(isNaN(r))return{doubleValue:"NaN"};if(r===1/0)return{doubleValue:"Infinity"};if(r===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e1(r)?"-0":r}}function nL(e){return{integerValue:""+e}}function nD(e,r){return e2(r)?nL(r):nN(e,r)}class nR{constructor(){this._=void 0}}function nj(e,r){return e instanceof nB?rP(r)||r&&"doubleValue"in r?r:{integerValue:0}:null}class nF extends nR{}class nU extends nR{constructor(e){super(),this.elements=e}}function nM(e,r){let n=nq(r);for(let r of e.elements)n.some(e=>rx(e,r))||n.push(r);return{arrayValue:{values:n}}}class nG extends nR{constructor(e){super(),this.elements=e}}function nV(e,r){let n=nq(r);for(let r of e.elements)n=n.filter(e=>!rx(e,r));return{arrayValue:{values:n}}}class nB extends nR{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function nz(e){return rn(e.integerValue||e.doubleValue)}function nq(e){return rO(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class nH{constructor(e,r){this.field=e,this.transform=r}}class n${constructor(e,r){this.version=e,this.transformResults=r}}class nK{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new nK}static exists(e){return new nK(void 0,e)}static updateTime(e){return new nK(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nW(e,r){return void 0!==e.updateTime?r.isFoundDocument()&&r.version.isEqual(e.updateTime):void 0===e.exists||e.exists===r.isFoundDocument()}class nQ{}function nJ(e,r){if(!e.hasLocalMutations||r&&0===r.fields.length)return null;if(null===r)return e.isNoDocument()?new n4(e.key,nK.none()):new nZ(e.key,e.data,nK.none());{let n=e.data,i=rG.empty(),o=new t4(eh.comparator);for(let e of r.fields)if(!o.has(e)){let r=n.field(e);null===r&&e.length>1&&(e=e.popLast(),r=n.field(e)),null===r?i.delete(e):i.set(e,r),o=o.add(e)}return new n0(e.key,i,new t8(o.toArray()),nK.none())}}function nY(e,r,n,i){return e instanceof nZ?function(e,r,n,i){if(!nW(e.precondition,r))return n;let o=e.value.clone(),a=n3(e.fieldTransforms,i,r);return o.setAll(a),r.convertToFoundDocument(r.version,o).setHasLocalMutations(),null}(e,r,n,i):e instanceof n0?function(e,r,n,i){if(!nW(e.precondition,r))return n;let o=n3(e.fieldTransforms,i,r),a=r.data;return(a.setAll(n1(e)),a.setAll(o),r.convertToFoundDocument(r.version,a).setHasLocalMutations(),null===n)?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,r,n,i):nW(e.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):n}function nX(e,r){var n,i;return e.type===r.type&&!!e.key.isEqual(r.key)&&!!e.precondition.isEqual(r.precondition)&&(n=e.fieldTransforms,i=r.fieldTransforms,!!(void 0===n&&void 0===i||!(!n||!i)&&ea(n,i,(e,r)=>{var n,i;return e.field.isEqual(r.field)&&(n=e.transform,i=r.transform,n instanceof nU&&i instanceof nU||n instanceof nG&&i instanceof nG?ea(n.elements,i.elements,rx):n instanceof nB&&i instanceof nB?rx(n.Ee,i.Ee):n instanceof nF&&i instanceof nF)})))&&(0===e.type?e.value.isEqual(r.value):1!==e.type||e.data.isEqual(r.data)&&e.fieldMask.isEqual(r.fieldMask))}class nZ extends nQ{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class n0 extends nQ{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function n1(e){let r=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let i=e.data.field(n);r.set(n,i)}}),r}function n2(e,r,n){let i=new Map;V(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let a=0;a<n.length;a++){var o;let s=e[a],u=s.transform,c=r.data.field(s.field);i.set(s.field,(o=n[a],u instanceof nU?nM(u,c):u instanceof nG?nV(u,c):o))}return i}function n3(e,r,n){let i=new Map;for(let o of e){let e=o.transform,a=n.data.field(o.field);i.set(o.field,e instanceof nF?function(e,r){let n={fields:{[ra]:{stringValue:ro},[ru]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return r&&rc(r)&&(r=rl(r)),r&&(n.fields[rs]=r),{mapValue:n}}(r,a):e instanceof nU?nM(e,a):e instanceof nG?nV(e,a):function(e,r){let n=nj(e,r),i=nz(n)+nz(e.Ee);return rP(n)&&rP(e.Ee)?nL(i):nN(e.serializer,i)}(e,a))}return i}class n4 extends nQ{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class n5 extends nQ{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class n6{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){let n=r.mutationResults;for(let r=0;r<this.mutations.length;r++){let i=this.mutations[r];i.key.isEqual(e.key)&&function(e,r,n){e instanceof nZ?function(e,r,n){let i=e.value.clone(),o=n2(e.fieldTransforms,r,n.transformResults);i.setAll(o),r.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,r,n):e instanceof n0?function(e,r,n){if(!nW(e.precondition,r))return r.convertToUnknownDocument(n.version);let i=n2(e.fieldTransforms,r,n.transformResults),o=r.data;o.setAll(n1(e)),o.setAll(i),r.convertToFoundDocument(n.version,o).setHasCommittedMutations()}(e,r,n):r.convertToNoDocument(n.version).setHasCommittedMutations()}(i,e,n[r])}}applyToLocalView(e,r){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(r=nY(n,e,r,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(r=nY(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){let n=n_();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,s=this.applyToLocalView(a,o.mutatedFields),u=nJ(a,s=r.has(i.key)?null:s);null!==u&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(eI.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),nO())}isEqual(e){return this.batchId===e.batchId&&ea(this.mutations,e.mutations,(e,r)=>nX(e,r))&&ea(this.baseMutations,e.baseMutations,(e,r)=>nX(e,r))}}class n8{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){V(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=nA,o=e.mutations;for(let e=0;e<o.length;e++)i=i.insert(o[e].key,n[e].version);return new n8(e,r,n,i)}}class n7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class n9{constructor(e,r,n){this.alias=e,this.aggregateType=r,this.fieldPath=n}}class ie{constructor(e,r){this.count=e,this.unchangedNames=r}}function it(e){switch(e){case z.OK:return M(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return M(15467,{code:e})}}function ir(e){if(void 0===e)return j("GRPC error has no .code"),z.UNKNOWN;switch(e){case p.OK:return z.OK;case p.CANCELLED:return z.CANCELLED;case p.UNKNOWN:return z.UNKNOWN;case p.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case p.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case p.INTERNAL:return z.INTERNAL;case p.UNAVAILABLE:return z.UNAVAILABLE;case p.UNAUTHENTICATED:return z.UNAUTHENTICATED;case p.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case p.NOT_FOUND:return z.NOT_FOUND;case p.ALREADY_EXISTS:return z.ALREADY_EXISTS;case p.PERMISSION_DENIED:return z.PERMISSION_DENIED;case p.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case p.ABORTED:return z.ABORTED;case p.OUT_OF_RANGE:return z.OUT_OF_RANGE;case p.UNIMPLEMENTED:return z.UNIMPLEMENTED;case p.DATA_LOSS:return z.DATA_LOSS;default:return M(39323,{code:e})}}(m=p||(p={}))[m.OK=0]="OK",m[m.CANCELLED=1]="CANCELLED",m[m.UNKNOWN=2]="UNKNOWN",m[m.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",m[m.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",m[m.NOT_FOUND=5]="NOT_FOUND",m[m.ALREADY_EXISTS=6]="ALREADY_EXISTS",m[m.PERMISSION_DENIED=7]="PERMISSION_DENIED",m[m.UNAUTHENTICATED=16]="UNAUTHENTICATED",m[m.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",m[m.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",m[m.ABORTED=10]="ABORTED",m[m.OUT_OF_RANGE=11]="OUT_OF_RANGE",m[m.UNIMPLEMENTED=12]="UNIMPLEMENTED",m[m.INTERNAL=13]="INTERNAL",m[m.UNAVAILABLE=14]="UNAVAILABLE",m[m.DATA_LOSS=15]="DATA_LOSS";let ii=null,io=new i([0xffffffff,0xffffffff],0);function ia(e){let r=et().encode(e),n=new o;return n.update(r),new Uint8Array(n.digest())}function is(e){let r=new DataView(e.buffer),n=r.getUint32(0,!0),o=r.getUint32(4,!0),a=r.getUint32(8,!0),s=r.getUint32(12,!0);return[new i([n,o],0),new i([a,s],0)]}class iu{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ic(`Invalid padding: ${r}`);if(n<0||e.length>0&&0===this.hashCount)throw new ic(`Invalid hash count: ${n}`);if(0===e.length&&0!==r)throw new ic(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=i.fromNumber(this.fe)}pe(e,r,n){let o=e.add(r.multiply(i.fromNumber(n)));return 1===o.compare(io)&&(o=new i([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.fe)return!1;let[r,n]=is(ia(e));for(let e=0;e<this.hashCount;e++){let i=this.pe(r,n,e);if(!this.ye(i))return!1}return!0}static create(e,r,n){let i=new iu(new Uint8Array(Math.ceil(e/8)),e%8==0?0:8-e%8,r);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.fe)return;let[r,n]=is(ia(e));for(let e=0;e<this.hashCount;e++){let i=this.pe(r,n,e);this.we(i)}}we(e){let r=Math.floor(e/8);this.bitmap[r]|=1<<e%8}}class ic extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class il{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){let i=new Map;return i.set(e,ih.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new il(eI.min(),i,new t1(en),nE,nO())}}class ih{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new ih(n,r,nO(),nO(),nO())}}class id{constructor(e,r,n,i){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=i}}class ip{constructor(e,r){this.targetId=e,this.De=r}}class im{constructor(e,r,n=re.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ig{constructor(){this.ve=0,this.Ce=ib(),this.Fe=re.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=nO(),r=nO(),n=nO();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:M(38017,{changeType:o})}}),new ih(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=ib()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,V(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class iy{constructor(e){this.We=e,this.Ge=new Map,this.ze=nE,this.je=iv(),this.Je=iv(),this.He=new t1(en)}Ye(e){for(let r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(let r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{let n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:M(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((e,n)=>{this.nt(n)&&r(n)})}it(e){let r=e.targetId,n=e.De.count,i=this.st(r);if(i){let o=i.target;if(nr(o))if(0===n){let e=new ed(o.path);this.Xe(r,e,rV.newNoDocument(e,eI.min()))}else V(1===n,20013,{expectedCount:n});else{let i=this.ot(r);if(i!==n){let n=this._t(e),o=n?this.ut(n,e,i):1;0!==o&&(this.rt(r),this.He=this.He.insert(r,2===o?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null==ii||ii.ct(function(e,r,n,i,o){var a,s,u,c,l,h;let d={localCacheCount:e,existenceFilterCount:r.count,databaseId:n.database,projectId:n.projectId},f=r.unchangedNames;return f&&(d.bloomFilter={applied:0===o,hashCount:null!=(a=null==f?void 0:f.hashCount)?a:0,bitmapLength:null!=(c=null==(u=null==(s=null==f?void 0:f.bits)?void 0:s.bitmap)?void 0:u.length)?c:0,padding:null!=(h=null==(l=null==f?void 0:f.bits)?void 0:l.padding)?h:0,mightContain:e=>{var r;return null!=(r=null==i?void 0:i.mightContain(e))&&r}}),d}(i,e.De,this.We.lt(),n,o))}}}}_t(e){let r,n,i=e.De.unchangedNames;if(!i||!i.bits)return null;let{bits:{bitmap:o="",padding:a=0},hashCount:s=0}=i;try{r=ri(o).toUint8Array()}catch(e){if(e instanceof t7)return F("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{n=new iu(r,a,s)}catch(e){return F(e instanceof ic?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===n.fe?null:n}ut(e,r,n){return 2*(r.De.count!==n-this.ht(e,r.targetId))}ht(e,r){let n=this.We.getRemoteKeysForTarget(r),i=0;return n.forEach(n=>{let o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.Xe(r,n,null),i++)}),i}Pt(e){let r=new Map;this.Ge.forEach((n,i)=>{let o=this.st(i);if(o){if(n.current&&nr(o.target)){let r=new ed(o.target.path);this.Tt(r).has(i)||this.It(i,r)||this.Xe(i,r,rV.newNoDocument(r,e))}n.Ne&&(r.set(i,n.Le()),n.ke())}});let n=nO();this.Je.forEach((e,r)=>{let i=!0;r.forEachWhile(e=>{let r=this.st(e);return!r||"TargetPurposeLimboResolution"===r.purpose||(i=!1,!1)}),i&&(n=n.add(e))}),this.ze.forEach((r,n)=>n.setReadTime(e));let i=new il(e,r,this.He,this.ze,n);return this.ze=nE,this.je=iv(),this.Je=iv(),this.He=new t1(en),i}Ze(e,r){if(!this.nt(e))return;let n=2*!!this.It(e,r.key);this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;let i=this.tt(e);this.It(e,r)?i.qe(r,1):i.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){let r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new ig,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new t4(en),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new t4(en),this.je=this.je.insert(e,r)),r}nt(e){let r=null!==this.st(e);return r||R("WatchChangeAggregator","Detected inactive target",e),r}st(e){let r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new ig),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function iv(){return new t1(ed.comparator)}function ib(){return new t1(ed.comparator)}let iw={asc:"ASCENDING",desc:"DESCENDING"},iS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ix={and:"AND",or:"OR"};class iE{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function iI(e,r){return e.useProto3Json||e0(r)?r:{value:r}}function iT(e,r){return e.useProto3Json?`${new Date(1e3*r.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+r.nanoseconds).slice(-9)}Z`:{seconds:""+r.seconds,nanos:r.nanoseconds}}function ik(e,r){return e.useProto3Json?r.toBase64():r.toUint8Array()}function i_(e){return V(!!e,49232),eI.fromTimestamp(function(e){let r=rr(e);return new eE(r.seconds,r.nanos)}(e))}function iA(e,r){return iP(e,r).canonicalString()}function iP(e,r){let n=new ec(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===r?n:n.child(r)}function iO(e){let r=ec.fromString(e);return V(iK(r),10190,{key:r.toString()}),r}function iC(e,r){return iA(e.databaseId,r.path)}function iN(e,r){let n=iO(r);if(n.get(1)!==e.databaseId.projectId)throw new q(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new q(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ed(ij(n))}function iL(e,r){return iA(e.databaseId,r)}function iD(e){let r=iO(e);return 4===r.length?ec.emptyPath():ij(r)}function iR(e){return new ec(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ij(e){return V(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function iF(e,r,n){return{name:iC(e,r),fields:n.value.mapValue.fields}}function iU(e,r,n){let i=iN(e,r.name),o=i_(r.updateTime),a=r.createTime?i_(r.createTime):eI.min(),s=new rG({mapValue:{fields:r.fields}}),u=rV.newFoundDocument(i,o,a,s);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function iM(e,r){var n;let i;if(r instanceof nZ)i={update:iF(e,r.key,r.value)};else if(r instanceof n4)i={delete:iC(e,r.key)};else if(r instanceof n0)i={update:iF(e,r.key,r.data),updateMask:function(e){let r=[];return e.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r}}(r.fieldMask)};else{if(!(r instanceof n5))return M(16599,{Rt:r.type});i={verify:iC(e,r.key)}}return r.fieldTransforms.length>0&&(i.updateTransforms=r.fieldTransforms.map(e=>(function(e,r){let n=r.transform;if(n instanceof nF)return{fieldPath:r.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof nU)return{fieldPath:r.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof nG)return{fieldPath:r.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof nB)return{fieldPath:r.field.canonicalString(),increment:n.Ee};throw M(20930,{transform:r.transform})})(0,e))),r.precondition.isNone||(i.currentDocument=void 0!==(n=r.precondition).updateTime?{updateTime:iT(e,n.updateTime.toTimestamp())}:void 0!==n.exists?{exists:n.exists}:M(27497)),i}function iG(e,r){var n;let i=r.currentDocument?void 0!==(n=r.currentDocument).updateTime?nK.updateTime(i_(n.updateTime)):void 0!==n.exists?nK.exists(n.exists):nK.none():nK.none(),o=r.updateTransforms?r.updateTransforms.map(r=>{let n;return n=null,"setToServerValue"in r?(V("REQUEST_TIME"===r.setToServerValue,16630,{proto:r}),n=new nF):"appendMissingElements"in r?n=new nU(r.appendMissingElements.values||[]):"removeAllFromArray"in r?n=new nG(r.removeAllFromArray.values||[]):"increment"in r?n=new nB(e,r.increment):M(16584,{proto:r}),new nH(eh.fromServerFormat(r.fieldPath),n)}):[];if(r.update){r.update.name;let n=iN(e,r.update.name),a=new rG({mapValue:{fields:r.update.fields}});return r.updateMask?new n0(n,a,new t8((r.updateMask.fieldPaths||[]).map(e=>eh.fromServerFormat(e))),i,o):new nZ(n,a,i,o)}return r.delete?new n4(iN(e,r.delete),i):r.verify?new n5(iN(e,r.verify),i):M(1463,{proto:r})}function iV(e,r){return{documents:[iL(e,r.path)]}}function iB(e,r){var n,i;let o,a={structuredQuery:{}},s=r.path;null!==r.collectionGroup?(o=s,a.structuredQuery.from=[{collectionId:r.collectionGroup,allDescendants:!0}]):(o=s.popLast(),a.structuredQuery.from=[{collectionId:s.lastSegment()}]),a.parent=iL(e,o);let u=function(e){if(0!==e.length)return function e(r){return r instanceof rK?function(e){if("=="===e.op){if(rN(e.value))return{unaryFilter:{field:iH(e.field),op:"IS_NAN"}};if(rC(e.value))return{unaryFilter:{field:iH(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(rN(e.value))return{unaryFilter:{field:iH(e.field),op:"IS_NOT_NAN"}};if(rC(e.value))return{unaryFilter:{field:iH(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:iH(e.field),op:iS[e.op],value:e.value}}}(r):r instanceof rW?function(r){let n=r.getFilters().map(r=>e(r));return 1===n.length?n[0]:{compositeFilter:{op:ix[r.op],filters:n}}}(r):M(54877,{filter:r})}(rW.create(e,"and"))}(r.filters);u&&(a.structuredQuery.where=u);let c=function(e){if(0!==e.length)return e.map(e=>({field:iH(e.field),direction:iw[e.dir]}))}(r.orderBy);c&&(a.structuredQuery.orderBy=c);let l=iI(e,r.limit);return null!==l&&(a.structuredQuery.limit=l),r.startAt&&(a.structuredQuery.startAt={before:(n=r.startAt).inclusive,values:n.position}),r.endAt&&(a.structuredQuery.endAt={before:!(i=r.endAt).inclusive,values:i.position}),{Vt:a,parent:o}}function iz(e,r,n,i){let{Vt:o,parent:a}=iB(e,r),s={},u=[],c=0;return n.forEach(e=>{let r=i?e.alias:"aggregate_"+c++;s[r]=e.alias,"count"===e.aggregateType?u.push({alias:r,count:{}}):"avg"===e.aggregateType?u.push({alias:r,avg:{field:iH(e.fieldPath)}}):"sum"===e.aggregateType&&u.push({alias:r,sum:{field:iH(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:u,structuredQuery:o.structuredQuery},parent:o.parent},ft:s,parent:a}}function iq(e){var r;let n,i=iD(e.parent),o=e.structuredQuery,a=o.from?o.from.length:0,s=null;if(a>0){V(1===a,65062);let e=o.from[0];e.allDescendants?s=e.collectionId:i=i.child(e.collectionId)}let u=[];o.where&&(u=function(e){let r=function e(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let r=i$(e.unaryFilter.field);return rK.create(r,"==",{doubleValue:NaN});case"IS_NULL":let n=i$(e.unaryFilter.field);return rK.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=i$(e.unaryFilter.field);return rK.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=i$(e.unaryFilter.field);return rK.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return M(61313);default:return M(60726)}}(r):void 0!==r.fieldFilter?rK.create(i$(r.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return M(58110);default:return M(50506)}}(r.fieldFilter.op),r.fieldFilter.value):void 0!==r.compositeFilter?rW.create(r.compositeFilter.filters.map(r=>e(r)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return M(1026)}}(r.compositeFilter.op)):M(30097,{filter:r})}(e);return r instanceof rW&&rY(r)?r.getFilters():[r]}(o.where));let c=[];o.orderBy&&(c=o.orderBy.map(e=>new rH(i$(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let l=null;o.limit&&(l=e0(n="object"==typeof(r=o.limit)?r.value:r)?null:n);let h=null;o.startAt&&(h=function(e){let r=!!e.before;return new rB(e.values||[],r)}(o.startAt));let d=null;return o.endAt&&(d=function(e){let r=!e.before;return new rB(e.values||[],r)}(o.endAt)),new na(i,s,c,u,l,"F",h,d)}function iH(e){return{fieldPath:e.canonicalString()}}function i$(e){return eh.fromServerFormat(e.fieldPath)}function iK(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class iW{constructor(e,r,n,i,o=eI.min(),a=eI.min(),s=re.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=u}withSequenceNumber(e){return new iW(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new iW(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new iW(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new iW(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class iQ{constructor(e){this.gt=e}}function iJ(e,r){let n=r.key,i={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:iY(r.readTime),hasCommittedMutations:r.hasCommittedMutations};if(r.isFoundDocument()){var o;i.document={name:iC(o=e.gt,r.key),fields:r.data.value.mapValue.fields,updateTime:iT(o,r.version.toTimestamp()),createTime:iT(o,r.createTime.toTimestamp())}}else if(r.isNoDocument())i.noDocument={path:n.path.toArray(),readTime:iX(r.version)};else{if(!r.isUnknownDocument())return M(57904,{document:r});i.unknownDocument={path:n.path.toArray(),version:iX(r.version)}}return i}function iY(e){let r=e.toTimestamp();return[r.seconds,r.nanoseconds]}function iX(e){let r=e.toTimestamp();return{seconds:r.seconds,nanoseconds:r.nanoseconds}}function iZ(e){let r=new eE(e.seconds,e.nanoseconds);return eI.fromTimestamp(r)}function i0(e,r){let n=(r.baseMutations||[]).map(r=>iG(e.gt,r));for(let e=0;e<r.mutations.length-1;++e){let n=r.mutations[e];e+1<r.mutations.length&&void 0!==r.mutations[e+1].transform&&(n.updateTransforms=r.mutations[e+1].transform.fieldTransforms,r.mutations.splice(e+1,1),++e)}let i=r.mutations.map(r=>iG(e.gt,r)),o=eE.fromMillis(r.localWriteTimeMs);return new n6(r.batchId,o,n,i)}function i1(e){let r=iZ(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?iZ(e.lastLimboFreeSnapshotVersion):eI.min();return new iW(void 0!==e.query.documents?function(e){let r=e.documents.length;return V(1===r,1966,{count:r}),nh(ns(iD(e.documents[0])))}(e.query):nh(iq(e.query)),e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,n,re.fromBase64String(e.resumeToken))}function i2(e,r){let n,i=iX(r.snapshotVersion),o=iX(r.lastLimboFreeSnapshotVersion);n=nr(r.target)?iV(e.gt,r.target):iB(e.gt,r.target).Vt;let a=r.resumeToken.toBase64();return{targetId:r.targetId,canonicalId:ne(r.target),readTime:i,resumeToken:a,lastListenSequenceNumber:r.sequenceNumber,lastLimboFreeSnapshotVersion:o,query:n}}function i3(e){let r=iq({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?nm(r,r.limit,"L"):r}function i4(e,r){return new n7(r.largestBatchId,iG(e.gt,r.overlayMutation))}function i5(e,r){let n=r.path.lastSegment();return[e,e3(r.path.popLast()),n]}function i6(e,r,n,i){return{indexId:e,uid:r,sequenceNumber:n,readTime:iX(i.readTime),documentKey:e3(i.documentKey.path),largestBatchId:i.largestBatchId}}class i8{getBundleMetadata(e,r){return tJ(e,tT).get(r).next(e=>{if(e)return{id:e.bundleId,createTime:iZ(e.createTime),version:e.version}})}saveBundleMetadata(e,r){return tJ(e,tT).put({bundleId:r.id,createTime:iX(i_(r.createTime)),version:r.version})}getNamedQuery(e,r){return tJ(e,tk).get(r).next(e=>{if(e)return{name:e.name,query:i3(e.bundledQuery),readTime:iZ(e.readTime)}})}saveNamedQuery(e,r){return tJ(e,tk).put({name:r.name,readTime:iX(i_(r.readTime)),bundledQuery:r.bundledQuery})}}class i7{constructor(e,r){this.serializer=e,this.userId=r}static yt(e,r){return new i7(e,r.uid||"")}getOverlay(e,r){return tJ(e,tF).get(i5(this.userId,r)).next(e=>e?i4(this.serializer,e):null)}getOverlays(e,r){let n=n_();return eU.forEach(r,r=>this.getOverlay(e,r).next(e=>{null!==e&&n.set(r,e)})).next(()=>n)}saveOverlays(e,r,n){let i=[];return n.forEach((n,o)=>{let a=new n7(r,o);i.push(this.wt(e,a))}),eU.waitFor(i)}removeOverlaysForBatchId(e,r,n){let i=new Set;r.forEach(e=>i.add(e3(e.getCollectionPath())));let o=[];return i.forEach(r=>{let i=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,n+1],!1,!0);o.push(tJ(e,tF).Y(tM,i))}),eU.waitFor(o)}getOverlaysForCollection(e,r,n){let i=n_(),o=e3(r),a=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,1/0],!0);return tJ(e,tF).j(tM,a).next(e=>{for(let r of e){let e=i4(this.serializer,r);i.set(e.getKey(),e)}return i})}getOverlaysForCollectionGroup(e,r,n,i){let o,a=n_(),s=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,1/0],!0);return tJ(e,tF).X({index:tV,range:s},(e,r,n)=>{let s=i4(this.serializer,r);a.size()<i||s.largestBatchId===o?(a.set(s.getKey(),s),o=s.largestBatchId):n.done()}).next(()=>a)}wt(e,r){return tJ(e,tF).put(function(e,r,n){let[i,o,a]=i5(r,n.mutation.key);return{userId:r,collectionPath:o,documentId:a,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:iM(e.gt,n.mutation)}}(this.serializer,this.userId,r))}}class i9{St(e){return tJ(e,tz)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{let r=null==e?void 0:e.value;return r?re.fromUint8Array(r):re.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.St(e).put({name:"sessionToken",value:r.toUint8Array()})}}class oe{constructor(){}bt(e,r){this.Dt(e,r),r.vt()}Dt(e,r){if("nullValue"in e)this.Ct(r,5);else if("booleanValue"in e)this.Ct(r,10),r.Ft(+!!e.booleanValue);else if("integerValue"in e)this.Ct(r,15),r.Ft(rn(e.integerValue));else if("doubleValue"in e){let n=rn(e.doubleValue);isNaN(n)?this.Ct(r,13):(this.Ct(r,15),e1(n)?r.Ft(0):r.Ft(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ct(r,20),"string"==typeof n&&(n=rr(n)),r.Mt(`${n.seconds||""}`),r.Ft(n.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,r),this.Ot(r);else if("bytesValue"in e)this.Ct(r,30),r.Nt(ri(e.bytesValue)),this.Ot(r);else if("referenceValue"in e)this.Bt(e.referenceValue,r);else if("geoPointValue"in e){let n=e.geoPointValue;this.Ct(r,45),r.Ft(n.latitude||0),r.Ft(n.longitude||0)}else"mapValue"in e?rj(e)?this.Ct(r,Number.MAX_SAFE_INTEGER):rD(e)?this.Lt(e.mapValue,r):(this.kt(e.mapValue,r),this.Ot(r)):"arrayValue"in e?(this.qt(e.arrayValue,r),this.Ot(r)):M(19022,{Qt:e})}xt(e,r){this.Ct(r,25),this.$t(e,r)}$t(e,r){r.Mt(e)}kt(e,r){let n=e.fields||{};for(let e of(this.Ct(r,55),Object.keys(n)))this.xt(e,r),this.Dt(n[e],r)}Lt(e,r){var n,i;let o=e.fields||{};this.Ct(r,53);let a=(null==(i=null==(n=o[rb].arrayValue)?void 0:n.values)?void 0:i.length)||0;this.Ct(r,15),r.Ft(rn(a)),this.xt(rb,r),this.Dt(o[rb],r)}qt(e,r){let n=e.values||[];for(let e of(this.Ct(r,50),n))this.Dt(e,r)}Bt(e,r){this.Ct(r,37),ed.fromName(e).path.forEach(e=>{this.Ct(r,60),this.$t(e,r)})}Ct(e,r){e.Ft(r)}Ot(e){e.Ft(2)}}function ot(e){return Math.ceil((64-function(e){let r=0;for(let n=0;n<8;++n){let i=function(e){if(0===e)return 8;let r=0;return e>>4||(r+=4,e<<=4),e>>6||(r+=2,e<<=2),e>>7||(r+=1),r}(255&e[n]);if(r+=i,8!==i)break}return r}(e))/8)}oe.Ut=new oe;class or{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){let r=e[Symbol.iterator](),n=r.next();for(;!n.done;)this.Wt(n.value),n=r.next();this.Gt()}zt(e){let r=e[Symbol.iterator](),n=r.next();for(;!n.done;)this.jt(n.value),n=r.next();this.Jt()}Ht(e){for(let r of e){let e=r.charCodeAt(0);if(e<128)this.Wt(e);else if(e<2048)this.Wt(960|e>>>6),this.Wt(128|63&e);else if(r<"\ud800"||"\udbff"<r)this.Wt(480|e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e);else{let e=r.codePointAt(0);this.Wt(240|e>>>18),this.Wt(128|63&e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e)}}this.Gt()}Yt(e){for(let r of e){let e=r.charCodeAt(0);if(e<128)this.jt(e);else if(e<2048)this.jt(960|e>>>6),this.jt(128|63&e);else if(r<"\ud800"||"\udbff"<r)this.jt(480|e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e);else{let e=r.codePointAt(0);this.jt(240|e>>>18),this.jt(128|63&e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e)}}this.Jt()}Zt(e){let r=this.Xt(e),n=ot(r);this.en(1+n),this.buffer[this.position++]=255&n;for(let e=r.length-n;e<r.length;++e)this.buffer[this.position++]=255&r[e]}tn(e){let r=this.Xt(e),n=ot(r);this.en(1+n),this.buffer[this.position++]=~(255&n);for(let e=r.length-n;e<r.length;++e)this.buffer[this.position++]=~(255&r[e])}nn(){this.rn(255),this.rn(255)}sn(){this._n(255),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){let r=function(e){let r=new DataView(new ArrayBuffer(8));return r.setFloat64(0,e,!1),new Uint8Array(r.buffer)}(e),n=!!(128&r[0]);r[0]^=n?255:128;for(let e=1;e<r.length;++e)r[e]^=255*!!n;return r}Wt(e){let r=255&e;0===r?(this.rn(0),this.rn(255)):255===r?(this.rn(255),this.rn(0)):this.rn(r)}jt(e){let r=255&e;0===r?(this._n(0),this._n(255)):255===r?(this._n(255),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){let r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);let i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class on{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}}class oi{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}}class oo{constructor(){this.un=new or,this.cn=new on(this.un),this.ln=new oi(this.un)}seed(e){this.un.seed(e)}hn(e){return 0===e?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}}class oa{constructor(e,r,n,i){this.Pn=e,this.Tn=r,this.In=n,this.dn=i}En(){let e=this.dn.length,r=0===e||255===this.dn[e-1]?e+1:e,n=new Uint8Array(r);return n.set(this.dn,0),r!==e?n.set([0],this.dn.length):++n[n.length-1],new oa(this.Pn,this.Tn,this.In,n)}An(e,r,n){return{indexId:this.Pn,uid:e,arrayValue:oc(this.In),directionalValue:oc(this.dn),orderedDocumentKey:oc(r),documentKey:n.path.toArray()}}Rn(e,r,n){let i=this.An(e,r,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function os(e,r){let n=e.Pn-r.Pn;return 0!==n||0!==(n=ou(e.In,r.In))||0!==(n=ou(e.dn,r.dn))?n:ed.comparator(e.Tn,r.Tn)}function ou(e,r){for(let n=0;n<e.length&&n<r.length;++n){let i=e[n]-r[n];if(0!==i)return i}return e.length-r.length}function oc(e){return(0,S.Ov)()?function(e){let r="";for(let n=0;n<e.length;n++)r+=String.fromCharCode(e[n]);return r}(e):e}function ol(e){return"string"!=typeof e?e:function(e){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}(e)}class oh{constructor(e){for(let r of(this.Vn=new t4((e,r)=>eh.comparator(e.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[],e.filters))r.isInequality()?this.Vn=this.Vn.add(r):this.fn.push(r)}get gn(){return this.Vn.size>1}pn(e){if(V(e.collectionGroup===this.collectionId,49279),this.gn)return!1;let r=ek(e);if(void 0!==r&&!this.yn(r))return!1;let n=e_(e),i=new Set,o=0,a=0;for(;o<n.length&&this.yn(n[o]);++o)i=i.add(n[o].fieldPath.canonicalString());if(o===n.length)return!0;if(this.Vn.size>0){let e=this.Vn.getIterator().getNext();if(!i.has(e.field.canonicalString())){let r=n[o];if(!this.wn(e,r)||!this.Sn(this.mn[a++],r))return!1}++o}for(;o<n.length;++o){let e=n[o];if(a>=this.mn.length||!this.Sn(this.mn[a++],e))return!1}return!0}bn(){if(this.gn)return null;let e=new t4(eh.comparator),r=[];for(let n of this.fn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)r.push(new eP(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new eP(n.field,0))}for(let n of this.mn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new eP(n.field,+("asc"!==n.dir))));return new eT(eT.UNKNOWN_ID,this.collectionId,r,eO.empty())}yn(e){for(let r of this.fn)if(this.wn(r,e))return!0;return!1}wn(e,r){if(void 0===e||!e.field.isEqual(r.fieldPath))return!1;let n="array-contains"===e.op||"array-contains-any"===e.op;return 2===r.kind===n}Sn(e,r){return!!e.field.isEqual(r.fieldPath)&&(0===r.kind&&"asc"===e.dir||1===r.kind&&"desc"===e.dir)}}function od(e){return e instanceof rK}function of(e){return e instanceof rW&&rY(e)}function op(e){return od(e)||of(e)||function(e){if(e instanceof rW&&rJ(e)){for(let r of e.getFilters())if(!od(r)&&!of(r))return!1;return!0}return!1}(e)}function om(e,r){return V(e instanceof rK||e instanceof rW,38388),V(r instanceof rK||r instanceof rW,25473),oy(e instanceof rK?r instanceof rK?rW.create([e,r],"and"):og(e,r):r instanceof rK?og(r,e):function(e,r){if(V(e.filters.length>0&&r.filters.length>0,48005),rQ(e)&&rQ(r))return rZ(e,r.getFilters());let n=rJ(e)?e:r,i=rJ(e)?r:e,o=n.filters.map(e=>om(e,i));return rW.create(o,"or")}(e,r))}function og(e,r){if(rQ(r))return rZ(r,e.getFilters());{let n=r.filters.map(r=>om(e,r));return rW.create(n,"or")}}function oy(e){if(V(e instanceof rK||e instanceof rW,11850),e instanceof rK)return e;let r=e.getFilters();if(1===r.length)return oy(r[0]);if(rX(e))return e;let n=r.map(e=>oy(e)),i=[];return n.forEach(r=>{r instanceof rK?i.push(r):r instanceof rW&&(r.op===e.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:rW.create(i,e.op)}class ov{constructor(){this.Dn=new ob}addToCollectionParentIndex(e,r){return this.Dn.add(r),eU.resolve()}getCollectionParents(e,r){return eU.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return eU.resolve()}deleteFieldIndex(e,r){return eU.resolve()}deleteAllFieldIndexes(e){return eU.resolve()}createTargetIndexes(e,r){return eU.resolve()}getDocumentsMatchingTarget(e,r){return eU.resolve(null)}getIndexType(e,r){return eU.resolve(0)}getFieldIndexes(e,r){return eU.resolve([])}getNextCollectionGroupToUpdate(e){return eU.resolve(null)}getMinOffset(e,r){return eU.resolve(eL.min())}getMinOffsetFromCollectionGroup(e,r){return eU.resolve(eL.min())}updateCollectionGroup(e,r,n){return eU.resolve()}updateIndexEntries(e,r){return eU.resolve()}}class ob{constructor(){this.index={}}add(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new t4(ec.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new t4(ec.comparator)).toArray()}}let ow="IndexedDbIndexManager",oS=new Uint8Array(0);class ox{constructor(e,r){this.databaseId=r,this.vn=new ob,this.Cn=new nx(e=>ne(e),(e,r)=>nt(e,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.vn.has(r)){let n=r.lastSegment(),i=r.popLast();e.addOnCommittedListener(()=>{this.vn.add(r)});let o={collectionId:n,parent:e3(i)};return tJ(e,tx).put(o)}return eU.resolve()}getCollectionParents(e,r){let n=[],i=IDBKeyRange.bound([r,""],[r+"\0",""],!1,!0);return tJ(e,tx).j(i).next(e=>{for(let i of e){if(i.collectionId!==r)break;n.push(e4(i.parent))}return n})}addFieldIndex(e,r){let n=tJ(e,t_),i={indexId:r.indexId,collectionGroup:r.collectionGroup,fields:r.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete i.indexId;let o=n.add(i);if(r.indexState){let n=tJ(e,tP);return o.next(e=>{n.put(i6(e,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return o.next()}deleteFieldIndex(e,r){let n=tJ(e,t_),i=tJ(e,tP),o=tJ(e,tL);return n.delete(r.indexId).next(()=>i.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let r=tJ(e,t_),n=tJ(e,tL),i=tJ(e,tP);return r.Y().next(()=>n.Y()).next(()=>i.Y())}createTargetIndexes(e,r){return eU.forEach(this.Fn(r),r=>this.getIndexType(e,r).next(n=>{if(0===n||1===n){let n=new oh(r).bn();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,r){let n=tJ(e,tL),i=!0,o=new Map;return eU.forEach(this.Fn(r),r=>this.Mn(e,r).next(e=>{i&&(i=!!e),o.set(r,e)})).next(()=>{if(i){let e=nO(),i=[];return eU.forEach(o,(o,a)=>{R(ow,`Using index id=${o.indexId}|cg=${o.collectionGroup}|f=${o.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")} to execute ${ne(r)}`);let s=function(e,r){let n=ek(r);if(void 0===n)return null;for(let r of nn(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(a,o),u=function(e,r){let n=new Map;for(let i of e_(r))for(let r of nn(e,i.fieldPath))switch(r.op){case"==":case"in":n.set(i.fieldPath.canonicalString(),r.value);break;case"not-in":case"!=":return n.set(i.fieldPath.canonicalString(),r.value),Array.from(n.values())}return null}(a,o),c=function(e,r){let n=[],i=!0;for(let o of e_(r)){let r=0===o.kind?ni(e,o.fieldPath,e.startAt):no(e,o.fieldPath,e.startAt);n.push(r.value),i&&(i=r.inclusive)}return new rB(n,i)}(a,o),l=function(e,r){let n=[],i=!0;for(let o of e_(r)){let r=0===o.kind?no(e,o.fieldPath,e.endAt):ni(e,o.fieldPath,e.endAt);n.push(r.value),i&&(i=r.inclusive)}return new rB(n,i)}(a,o),h=this.xn(o,a,c),d=this.xn(o,a,l),f=this.On(o,a,u),p=this.Nn(o.indexId,s,h,c.inclusive,d,l.inclusive,f);return eU.forEach(p,o=>n.H(o,r.limit).next(r=>{r.forEach(r=>{let n=ed.fromSegments(r.documentKey);e.has(n)||(e=e.add(n),i.push(n))})}))}).next(()=>i)}return eU.resolve(null)})}Fn(e){let r=this.Cn.get(e);return r||(r=0===e.filters.length?[e]:(function(e){if(0===e.getFilters().length)return[];let r=function e(r){if(V(r instanceof rK||r instanceof rW,34018),r instanceof rK)return r;if(1===r.filters.length)return e(r.filters[0]);let n=r.filters.map(r=>e(r)),i=rW.create(n,r.op);return op(i=oy(i))?i:(V(i instanceof rW,64498),V(rQ(i),40251),V(i.filters.length>1,57927),i.filters.reduce((e,r)=>om(e,r)))}(function e(r){var n,i;if(V(r instanceof rK||r instanceof rW,20012),r instanceof rK){if(r instanceof r5){let e=(null==(i=null==(n=r.value.arrayValue)?void 0:n.values)?void 0:i.map(e=>rK.create(r.field,"==",e)))||[];return rW.create(e,"or")}return r}let o=r.filters.map(r=>e(r));return rW.create(o,r.op)}(e));return V(op(r),7391),od(r)||of(r)?[r]:r.getFilters()})(rW.create(e.filters,"and")).map(r=>r9(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,r)),r}Nn(e,r,n,i,o,a,s){let u=(null!=r?r.length:1)*Math.max(n.length,o.length),c=u/(null!=r?r.length:1),l=[];for(let h=0;h<u;++h){let u=r?this.Bn(r[h/c]):oS,d=this.Ln(e,u,n[h%c],i),f=this.kn(e,u,o[h%c],a),p=s.map(r=>this.Ln(e,u,r,!0));l.push(...this.createRange(d,f,p))}return l}Ln(e,r,n,i){let o=new oa(e,ed.empty(),r,n);return i?o:o.En()}kn(e,r,n,i){let o=new oa(e,ed.empty(),r,n);return i?o.En():o}Mn(e,r){let n=new oh(r),i=null!=r.collectionGroup?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,i).next(e=>{let r=null;for(let i of e)n.pn(i)&&(!r||i.fields.length>r.fields.length)&&(r=i);return r})}getIndexType(e,r){let n=2,i=this.Fn(r);return eU.forEach(i,r=>this.Mn(e,r).next(e=>{e?0!==n&&e.fields.length<function(e){let r=new t4(eh.comparator),n=!1;for(let i of e.filters)for(let e of i.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:r=r.add(e.field));for(let n of e.orderBy)n.field.isKeyField()||(r=r.add(n.field));return r.size+ +!!n}(r)&&(n=1):n=0})).next(()=>null!==r.limit&&i.length>1&&2===n?1:n)}qn(e,r){let n=new oo;for(let i of e_(e)){let e=r.data.field(i.fieldPath);if(null==e)return null;let o=n.hn(i.kind);oe.Ut.bt(e,o)}return n.an()}Bn(e){let r=new oo;return oe.Ut.bt(e,r.hn(0)),r.an()}Qn(e,r){let n=new oo;return oe.Ut.bt(rA(this.databaseId,r),n.hn(function(e){let r=e_(e);return 0===r.length?0:r[r.length-1].kind}(e))),n.an()}On(e,r,n){if(null===n)return[];let i=[];i.push(new oo);let o=0;for(let a of e_(e)){let e=n[o++];for(let n of i)if(this.$n(r,a.fieldPath)&&rO(e))i=this.Un(i,a,e);else{let r=n.hn(a.kind);oe.Ut.bt(e,r)}}return this.Kn(i)}xn(e,r,n){return this.On(e,r,n.position)}Kn(e){let r=[];for(let n=0;n<e.length;++n)r[n]=e[n].an();return r}Un(e,r,n){let i=[...e],o=[];for(let e of n.arrayValue.values||[])for(let n of i){let i=new oo;i.seed(n.an()),oe.Ut.bt(e,i.hn(r.kind)),o.push(i)}return o}$n(e,r){return!!e.filters.find(e=>e instanceof rK&&e.field.isEqual(r)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,r){let n=tJ(e,t_),i=tJ(e,tP);return(r?n.j(tA,IDBKeyRange.bound(r,r)):n.j()).next(e=>{let r=[];return eU.forEach(e,e=>i.get([e.indexId,this.uid]).next(n=>{r.push(function(e,r){let n=r?new eO(r.sequenceNumber,new eL(iZ(r.readTime),new ed(e4(r.documentKey)),r.largestBatchId)):eO.empty(),i=e.fields.map(([e,r])=>new eP(eh.fromServerFormat(e),r));return new eT(e.indexId,e.collectionGroup,i,n)}(e,n))})).next(()=>r)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,r)=>{let n=e.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==n?n:en(e.collectionGroup,r.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,r,n){let i=tJ(e,t_),o=tJ(e,tP);return this.Wn(e).next(e=>i.j(tA,IDBKeyRange.bound(r,r)).next(r=>eU.forEach(r,r=>o.put(i6(r.indexId,this.uid,e,n)))))}updateIndexEntries(e,r){let n=new Map;return eU.forEach(r,(r,i)=>{let o=n.get(r.collectionGroup);return(o?eU.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(o=>(n.set(r.collectionGroup,o),eU.forEach(o,n=>this.Gn(e,r,n).next(r=>{let o=this.zn(i,n);return r.isEqual(o)?eU.resolve():this.jn(e,i,n,r,o)}))))})}Jn(e,r,n,i){return tJ(e,tL).put(i.An(this.uid,this.Qn(n,r.key),r.key))}Hn(e,r,n,i){return tJ(e,tL).delete(i.Rn(this.uid,this.Qn(n,r.key),r.key))}Gn(e,r,n){let i=tJ(e,tL),o=new t4(os);return i.X({index:tR,range:IDBKeyRange.only([n.indexId,this.uid,oc(this.Qn(n,r))])},(e,i)=>{o=o.add(new oa(n.indexId,r,ol(i.arrayValue),ol(i.directionalValue)))}).next(()=>o)}zn(e,r){let n=new t4(os),i=this.qn(r,e);if(null==i)return n;let o=ek(r);if(null!=o){let a=e.data.field(o.fieldPath);if(rO(a))for(let o of a.arrayValue.values||[])n=n.add(new oa(r.indexId,e.key,this.Bn(o),i))}else n=n.add(new oa(r.indexId,e.key,oS,i));return n}jn(e,r,n,i,o){R(ow,"Updating index entries for document '%s'",r.key);let a=[];return function(e,r,n,i,o){let a=e.getIterator(),s=r.getIterator(),u=t6(a),c=t6(s);for(;u||c;){let e=!1,r=!1;if(u&&c){let i=n(u,c);i<0?r=!0:i>0&&(e=!0)}else null!=u?r=!0:e=!0;e?(i(c),c=t6(s)):r?(o(u),u=t6(a)):(u=t6(a),c=t6(s))}}(i,o,os,i=>{a.push(this.Jn(e,r,n,i))},i=>{a.push(this.Hn(e,r,n,i))}),eU.waitFor(a)}Wn(e){let r=1;return tJ(e,tP).X({index:tC,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,i)=>{i.done(),r=n.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((e,r)=>os(e,r)).filter((e,r,n)=>!r||0!==os(e,n[r-1]));let i=[];for(let o of(i.push(e),n)){let n=os(o,e),a=os(o,r);if(0===n)i[0]=e.En();else if(n>0&&a<0)i.push(o),i.push(o.En());else if(a>0)break}i.push(r);let o=[];for(let e=0;e<i.length;e+=2){if(this.Yn(i[e],i[e+1]))return[];let r=i[e].Rn(this.uid,oS,ed.empty()),n=i[e+1].Rn(this.uid,oS,ed.empty());o.push(IDBKeyRange.bound(r,n))}return o}Yn(e,r){return os(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(oE)}getMinOffset(e,r){return eU.mapArray(this.Fn(r),r=>this.Mn(e,r).next(e=>e||M(44426))).next(oE)}}function oE(e){V(0!==e.length,28825);let r=e[0].indexState.offset,n=r.largestBatchId;for(let i=1;i<e.length;i++){let o=e[i].indexState.offset;0>eD(o,r)&&(r=o),n<o.largestBatchId&&(n=o.largestBatchId)}return new eL(r.readTime,r.documentKey,n)}let oI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class oT{static withCacheSize(e){return new oT(e,oT.DEFAULT_COLLECTION_PERCENTILE,oT.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}function ok(e,r,n){let i=e.store(e9),o=e.store(ti),a=[],s=IDBKeyRange.only(n.batchId),u=0,c=i.X({range:s},(e,r,n)=>(u++,n.delete()));a.push(c.next(()=>{V(1===u,47070,{batchId:n.batchId})}));let l=[];for(let e of n.mutations){var h,d;let i=(h=e.key.path,d=n.batchId,[r,e3(h),d]);a.push(o.delete(i)),l.push(e.key)}return eU.waitFor(a).next(()=>l)}function o_(e){let r;if(!e)return 0;if(e.document)r=e.document;else if(e.unknownDocument)r=e.unknownDocument;else{if(!e.noDocument)throw M(14731);r=e.noDocument}return JSON.stringify(r).length}oT.DEFAULT_COLLECTION_PERCENTILE=10,oT.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oT.DEFAULT=new oT(0x2800000,oT.DEFAULT_COLLECTION_PERCENTILE,oT.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oT.DISABLED=new oT(-1,0,0);class oA{constructor(e,r,n,i){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=i,this.Zn={}}static yt(e,r,n,i){return V(""!==e.uid,64387),new oA(e.isAuthenticated()?e.uid:"",r,n,i)}checkEmpty(e){let r=!0,n=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return oO(e).X({index:tt,range:n},(e,n,i)=>{r=!1,i.done()}).next(()=>r)}addMutationBatch(e,r,n,i){let o=tJ(e,ti),a=oO(e);return a.add({}).next(s=>{V("number"==typeof s,49019);let u=new n6(s,r,n,i),c=function(e,r,n){let i=n.baseMutations.map(r=>iM(e.gt,r)),o=n.mutations.map(r=>iM(e.gt,r));return{userId:r,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:i,mutations:o}}(this.serializer,this.userId,u),l=[],h=new t4((e,r)=>en(e.canonicalString(),r.canonicalString()));for(let e of i){var d,f;let r=(d=this.userId,f=e.key.path,[d,e3(f),s]);h=h.add(e.key.path.popLast()),l.push(a.put(c)),l.push(o.put(r,tn))}return h.forEach(r=>{l.push(this.indexManager.addToCollectionParentIndex(e,r))}),e.addOnCommittedListener(()=>{this.Zn[s]=u.keys()}),eU.waitFor(l).next(()=>u)})}lookupMutationBatch(e,r){return oO(e).get(r).next(e=>e?(V(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:r}),i0(this.serializer,e)):null)}Xn(e,r){return this.Zn[r]?eU.resolve(this.Zn[r]):this.lookupMutationBatch(e,r).next(e=>{if(e){let n=e.keys();return this.Zn[r]=n,n}return null})}getNextMutationBatchAfterBatchId(e,r){let n=r+1,i=IDBKeyRange.lowerBound([this.userId,n]),o=null;return oO(e).X({index:tt,range:i},(e,r,i)=>{r.userId===this.userId&&(V(r.batchId>=n,47524,{er:n}),o=i0(this.serializer,r)),i.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let r=IDBKeyRange.upperBound([this.userId,1/0]),n=-1;return oO(e).X({index:tt,range:r,reverse:!0},(e,r,i)=>{n=r.batchId,i.done()}).next(()=>n)}getAllMutationBatches(e){let r=IDBKeyRange.bound([this.userId,-1],[this.userId,1/0]);return oO(e).j(tt,r).next(e=>e.map(e=>i0(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,r){let n=[this.userId,e3(r.path)],i=IDBKeyRange.lowerBound(n),o=[];return tJ(e,ti).X({range:i},(n,i,a)=>{let[s,u,c]=n,l=e4(u);if(s===this.userId&&r.path.isEqual(l))return oO(e).get(c).next(e=>{if(!e)throw M(61480,{tr:n,batchId:c});V(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:c}),o.push(i0(this.serializer,e))});a.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new t4(en),i=[];return r.forEach(r=>{let o=[this.userId,e3(r.path)],a=IDBKeyRange.lowerBound(o),s=tJ(e,ti).X({range:a},(e,i,o)=>{let[a,s,u]=e,c=e4(s);a===this.userId&&r.path.isEqual(c)?n=n.add(u):o.done()});i.push(s)}),eU.waitFor(i).next(()=>this.nr(e,n))}getAllMutationBatchesAffectingQuery(e,r){let n=r.path,i=n.length+1,o=[this.userId,e3(n)],a=IDBKeyRange.lowerBound(o),s=new t4(en);return tJ(e,ti).X({range:a},(e,r,o)=>{let[a,u,c]=e,l=e4(u);a===this.userId&&n.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()}).next(()=>this.nr(e,s))}nr(e,r){let n=[],i=[];return r.forEach(r=>{i.push(oO(e).get(r).next(e=>{if(null===e)throw M(35274,{batchId:r});V(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:r}),n.push(i0(this.serializer,e))}))}),eU.waitFor(i).next(()=>n)}removeMutationBatch(e,r){return ok(e.ce,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.rr(r.batchId)}),eU.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return eU.resolve();let n=IDBKeyRange.lowerBound([this.userId]),i=[];return tJ(e,ti).X({range:n},(e,r,n)=>{if(e[0]===this.userId){let r=e4(e[1]);i.push(r)}else n.done()}).next(()=>{V(0===i.length,56720,{ir:i.map(e=>e.canonicalString())})})})}containsKey(e,r){return oP(e,this.userId,r)}sr(e){return tJ(e,e7).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function oP(e,r,n){let i=[r,e3(n.path)],o=i[1],a=IDBKeyRange.lowerBound(i),s=!1;return tJ(e,ti).X({range:a,Z:!0},(e,n,i)=>{let[a,u,c]=e;a===r&&u===o&&(s=!0),i.done()}).next(()=>s)}function oO(e){return tJ(e,e9)}class oC{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new oC(0)}static ur(){return new oC(-1)}}class oN{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.cr(e).next(r=>{let n=new oC(r.highestTargetId);return r.highestTargetId=n.next(),this.lr(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.cr(e).next(e=>eI.fromTimestamp(new eE(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.cr(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.cr(e).next(i=>(i.highestListenSequenceNumber=r,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),r>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=r),this.lr(e,i)))}addTargetData(e,r){return this.hr(e,r).next(()=>this.cr(e).next(n=>(n.targetCount+=1,this.Pr(r,n),this.lr(e,n))))}updateTargetData(e,r){return this.hr(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>tJ(e,tf).delete(r.targetId)).next(()=>this.cr(e)).next(r=>(V(r.targetCount>0,8065),r.targetCount-=1,this.lr(e,r)))}removeTargets(e,r,n){let i=0,o=[];return tJ(e,tf).X((a,s)=>{let u=i1(s);u.sequenceNumber<=r&&null===n.get(u.targetId)&&(i++,o.push(this.removeTargetData(e,u)))}).next(()=>eU.waitFor(o)).next(()=>i)}forEachTarget(e,r){return tJ(e,tf).X((e,n)=>{r(i1(n))})}cr(e){return tJ(e,tS).get(tw).next(e=>(V(null!==e,2888),e))}lr(e,r){return tJ(e,tS).put(tw,r)}hr(e,r){return tJ(e,tf).put(i2(this.serializer,r))}Pr(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.cr(e).next(e=>e.targetCount)}getTargetData(e,r){let n=ne(r),i=IDBKeyRange.bound([n,-1/0],[n,1/0]),o=null;return tJ(e,tf).X({range:i,index:tp},(e,n,i)=>{let a=i1(n);nt(r,a.target)&&(o=a,i.done())}).next(()=>o)}addMatchingKeys(e,r,n){let i=[],o=oL(e);return r.forEach(r=>{let a=e3(r.path);i.push(o.put({targetId:n,path:a})),i.push(this.referenceDelegate.addReference(e,n,r))}),eU.waitFor(i)}removeMatchingKeys(e,r,n){let i=oL(e);return eU.forEach(r,r=>{let o=e3(r.path);return eU.waitFor([i.delete([n,o]),this.referenceDelegate.removeReference(e,n,r)])})}removeMatchingKeysForTargetId(e,r){let n=oL(e),i=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,r){let n=IDBKeyRange.bound([r],[r+1],!1,!0),i=oL(e),o=nO();return i.X({range:n,Z:!0},(e,r,n)=>{let i=new ed(e4(e[1]));o=o.add(i)}).next(()=>o)}containsKey(e,r){let n=e3(r.path),i=IDBKeyRange.bound([n],[n+"\0"],!1,!0),o=0;return oL(e).X({index:tv,Z:!0,range:i},([e,r],n,i)=>{0!==e&&(o++,i.done())}).next(()=>o>0)}Et(e,r){return tJ(e,tf).get(r).next(e=>e?i1(e):null)}}function oL(e){return tJ(e,tg)}let oD="LruGarbageCollector";function oR([e,r],[n,i]){let o=en(e,n);return 0===o?en(r,i):o}class oj{constructor(e){this.Tr=e,this.buffer=new t4(oR),this.Ir=0}dr(){return++this.Ir}Er(e){let r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{let e=this.buffer.last();0>oR(r,e)&&(this.buffer=this.buffer.delete(e).add(r))}}get maxValue(){return this.buffer.last()[0]}}class oF{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(e){R(oD,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){eH(e)?R(oD,"Ignoring IndexedDB error during garbage collection: ",e):await eF(e)}await this.Rr(3e5)})}}class oU{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(e=>Math.floor(r/100*e))}nthSequenceNumber(e,r){if(0===r)return eU.resolve(eZ.ue);let n=new oj(r);return this.Vr.forEachTarget(e,e=>n.Er(e.sequenceNumber)).next(()=>this.Vr.gr(e,e=>n.Er(e))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return -1===this.params.cacheSizeCollectionThreshold?(R("LruGarbageCollector","Garbage collection skipped; disabled"),eU.resolve(oI)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(R("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oI):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,i,o,a,s,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(r=>(r>this.params.maximumSequenceNumbersToCollect?(R("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${r}`),i=this.params.maximumSequenceNumbersToCollect):i=r,a=Date.now(),this.nthSequenceNumber(e,i))).next(i=>(n=i,s=Date.now(),this.removeTargets(e,n,r))).next(r=>(o=r,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),L()<=w.$b.DEBUG&&R("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-l}ms
	Determined least recently used ${i} in `+(s-a)+"ms\n"+`	Removed ${o} targets in `+(u-s)+"ms\n"+`	Removed ${e} documents in `+(c-u)+"ms\n"+`Total Duration: ${c-l}ms`),eU.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:e})))}}class oM{constructor(e,r){this.db=e,this.garbageCollector=new oU(this,r)}mr(e){let r=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>r.next(r=>e+r))}yr(e){let r=0;return this.gr(e,e=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}gr(e,r){return this.wr(e,(e,n)=>r(n))}addReference(e,r,n){return oG(e,n)}removeReference(e,r,n){return oG(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return oG(e,r)}Sr(e,r){let n;return n=!1,tJ(e,e7).ee(i=>oP(e,i,r).next(e=>(e&&(n=!0),eU.resolve(!e)))).next(()=>n)}removeOrphanedDocuments(e,r){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.wr(e,(a,s)=>{if(s<=r){let r=this.Sr(e,a).next(r=>{if(!r)return o++,n.getEntry(e,a).next(()=>(n.removeEntry(a,eI.min()),oL(e).delete([0,e3(a.path)])))});i.push(r)}}).next(()=>eU.waitFor(i)).next(()=>n.apply(e)).next(()=>o)}removeTarget(e,r){let n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return oG(e,r)}wr(e,r){let n=oL(e),i,o=eZ.ue;return n.X({index:tv},([e,n],{path:a,sequenceNumber:s})=>{0===e?(o!==eZ.ue&&r(new ed(e4(i)),o),o=s,i=a):o=eZ.ue}).next(()=>{o!==eZ.ue&&r(new ed(e4(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function oG(e,r){var n;return oL(e).put((n=e.currentSequenceNumber,{targetId:0,path:e3(r.path),sequenceNumber:n}))}class oV{constructor(){this.changes=new nx(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,rV.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();let n=this.changes.get(r);return void 0!==n?eU.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class oB{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return tJ(e,to).put(n)}removeEntry(e,r,n){return tJ(e,to).delete(function(e,r){let n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],iY(r),n[n.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.br(e,n)))}getEntry(e,r){let n=rV.newInvalidDocument(r);return tJ(e,to).X({index:ts,range:IDBKeyRange.only(oq(r))},(e,i)=>{n=this.Dr(r,i)}).next(()=>n)}vr(e,r){let n={size:0,document:rV.newInvalidDocument(r)};return tJ(e,to).X({index:ts,range:IDBKeyRange.only(oq(r))},(e,i)=>{n={document:this.Dr(r,i),size:o_(i)}}).next(()=>n)}getEntries(e,r){let n=nE;return this.Cr(e,r,(e,r)=>{let i=this.Dr(e,r);n=n.insert(e,i)}).next(()=>n)}Fr(e,r){let n=nE,i=new t1(ed.comparator);return this.Cr(e,r,(e,r)=>{let o=this.Dr(e,r);n=n.insert(e,o),i=i.insert(e,o_(r))}).next(()=>({documents:n,Mr:i}))}Cr(e,r,n){if(r.isEmpty())return eU.resolve();let i=new t4(o$);r.forEach(e=>i=i.add(e));let o=IDBKeyRange.bound(oq(i.first()),oq(i.last())),a=i.getIterator(),s=a.getNext();return tJ(e,to).X({index:ts,range:o},(e,r,i)=>{let o=ed.fromSegments([...r.prefixPath,r.collectionGroup,r.documentId]);for(;s&&0>o$(s,o);)n(s,null),s=a.getNext();s&&s.isEqual(o)&&(n(s,r),s=a.hasNext()?a.getNext():null),s?i.G(oq(s)):i.done()}).next(()=>{for(;s;)n(s,null),s=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,r,n,i,o){let a=r.path,s=[a.popLast().toArray(),a.lastSegment(),iY(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],u=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return tJ(e,to).j(IDBKeyRange.bound(s,u,!0)).next(e=>{null==o||o.incrementDocumentReadCount(e.length);let n=nE;for(let o of e){let e=this.Dr(ed.fromSegments(o.prefixPath.concat(o.collectionGroup,o.documentId)),o);e.isFoundDocument()&&(nb(r,e)||i.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,r,n,i){let o=nE,a=oH(r,n),s=oH(r,eL.max());return tJ(e,to).X({index:tc,range:IDBKeyRange.bound(a,s,!0)},(e,r,n)=>{let a=this.Dr(ed.fromSegments(r.prefixPath.concat(r.collectionGroup,r.documentId)),r);(o=o.insert(a.key,a)).size===i&&n.done()}).next(()=>o)}newChangeBuffer(e){return new oz(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return tJ(e,th).get(td).next(e=>(V(!!e,20021),e))}br(e,r){return tJ(e,th).put(td,r)}Dr(e,r){if(r){let e=function(e,r){let n;if(r.document)n=iU(e.gt,r.document,!!r.hasCommittedMutations);else if(r.noDocument){let e=ed.fromSegments(r.noDocument.path),i=iZ(r.noDocument.readTime);n=rV.newNoDocument(e,i),r.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!r.unknownDocument)return M(56709);{let e=ed.fromSegments(r.unknownDocument.path),i=iZ(r.unknownDocument.version);n=rV.newUnknownDocument(e,i)}}return r.readTime&&n.setReadTime(function(e){let r=new eE(e[0],e[1]);return eI.fromTimestamp(r)}(r.readTime)),n}(this.serializer,r);if(!(e.isNoDocument()&&e.version.isEqual(eI.min())))return e}return rV.newInvalidDocument(e)}}class oz extends oV{constructor(e,r){super(),this.Or=e,this.trackRemovals=r,this.Nr=new nx(e=>e.toString(),(e,r)=>e.isEqual(r))}applyChanges(e){let r=[],n=0,i=new t4((e,r)=>en(e.canonicalString(),r.canonicalString()));return this.changes.forEach((o,a)=>{let s=this.Nr.get(o);if(r.push(this.Or.removeEntry(e,o,s.readTime)),a.isValidDocument()){let u=iJ(this.Or.serializer,a);i=i.add(o.path.popLast());let c=o_(u);n+=c-s.size,r.push(this.Or.addEntry(e,o,u))}else if(n-=s.size,this.trackRemovals){let n=iJ(this.Or.serializer,a.convertToNoDocument(eI.min()));r.push(this.Or.addEntry(e,o,n))}}),i.forEach(n=>{r.push(this.Or.indexManager.addToCollectionParentIndex(e,n))}),r.push(this.Or.updateMetadata(e,n)),eU.waitFor(r)}getFromCache(e,r){return this.Or.vr(e,r).next(e=>(this.Nr.set(r,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,r){return this.Or.Fr(e,r).next(({documents:e,Mr:r})=>(r.forEach((r,n)=>{this.Nr.set(r,{size:n,readTime:e.get(r).readTime})}),e))}}function oq(e){let r=e.path.toArray();return[r.slice(0,r.length-2),r[r.length-2],r[r.length-1]]}function oH(e,r){let n=r.documentKey.path.toArray();return[e,iY(r.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function o$(e,r){let n=e.path.toArray(),i=r.path.toArray(),o=0;for(let e=0;e<n.length-2&&e<i.length-2;++e)if(o=en(n[e],i[e]))return o;return(o=en(n.length,i.length))||(o=en(n[n.length-2],i[i.length-2]))||en(n[n.length-1],i[i.length-1])}class oK{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class oW{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(e=>(null!==n&&nY(n.mutation,e,t8.empty(),eE.now()),e))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(r=>this.getLocalViewOfDocuments(e,r,nO()).next(()=>r))}getLocalViewOfDocuments(e,r,n=nO()){let i=n_();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(e=>{let r=nT();return e.forEach((e,n)=>{r=r.insert(e,n.overlayedDocument)}),r}))}getOverlayedDocuments(e,r){let n=n_();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,nO()))}populateOverlays(e,r,n){let i=[];return n.forEach(e=>{r.has(e)||i.push(e)}),this.documentOverlayCache.getOverlays(e,i).next(e=>{e.forEach((e,n)=>{r.set(e,n)})})}computeViews(e,r,n,i){let o=nE,a=n_(),s=n_();return r.forEach((e,r)=>{let s=n.get(r.key);i.has(r.key)&&(void 0===s||s.mutation instanceof n0)?o=o.insert(r.key,r):void 0!==s?(a.set(r.key,s.mutation.getFieldMask()),nY(s.mutation,r,s.mutation.getFieldMask(),eE.now())):a.set(r.key,t8.empty())}),this.recalculateAndSaveOverlays(e,o).next(e=>(e.forEach((e,r)=>a.set(e,r)),r.forEach((e,r)=>{var n;return s.set(e,new oK(r,null!=(n=a.get(e))?n:null))}),s))}recalculateAndSaveOverlays(e,r){let n=n_(),i=new t1((e,r)=>e-r),o=nO();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(e=>{for(let o of e)o.keys().forEach(e=>{let a=r.get(e);if(null===a)return;let s=n.get(e)||t8.empty();s=o.applyToLocalView(a,s),n.set(e,s);let u=(i.get(o.batchId)||nO()).add(e);i=i.insert(o.batchId,u)})}).next(()=>{let a=[],s=i.getReverseIterator();for(;s.hasNext();){let i=s.getNext(),u=i.key,c=i.value,l=n_();c.forEach(e=>{if(!o.has(e)){let i=nJ(r.get(e),n.get(e));null!==i&&l.set(e,i),o=o.add(e)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,l))}return eU.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,r,n,i){return ed.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,r.path):nc(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):eU.resolve(n_()),s=-1,u=o;return a.next(r=>eU.forEach(r,(r,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),o.get(r)?eU.resolve():this.remoteDocumentCache.getEntry(e,r).next(e=>{u=u.insert(r,e)}))).next(()=>this.populateOverlays(e,r,o)).next(()=>this.computeViews(e,u,r,nO())).next(e=>({batchId:s,changes:nk(e)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ed(r)).next(e=>{let r=nT();return e.isFoundDocument()&&(r=r.insert(e.key,e)),r})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){let o=r.collectionGroup,a=nT();return this.indexManager.getCollectionParents(e,o).next(s=>eU.forEach(s,s=>{let u=new na(s.child(o),null,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt);return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(e=>{e.forEach((e,r)=>{a=a.insert(e,r)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(e=>{o.forEach((r,n)=>{let i=n.getKey();null===e.get(i)&&(e=e.insert(i,rV.newInvalidDocument(i)))});let n=nT();return e.forEach((e,i)=>{let a=o.get(e);void 0!==a&&nY(a.mutation,i,t8.empty(),eE.now()),nb(r,i)&&(n=n.insert(e,i))}),n})}}class oQ{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return eU.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,{id:r.id,version:r.version,createTime:i_(r.createTime)}),eU.resolve()}getNamedQuery(e,r){return eU.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,{name:r.name,query:i3(r.bundledQuery),readTime:i_(r.readTime)}),eU.resolve()}}class oJ{constructor(){this.overlays=new t1(ed.comparator),this.kr=new Map}getOverlay(e,r){return eU.resolve(this.overlays.get(r))}getOverlays(e,r){let n=n_();return eU.forEach(r,r=>this.getOverlay(e,r).next(e=>{null!==e&&n.set(r,e)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((n,i)=>{this.wt(e,r,i)}),eU.resolve()}removeOverlaysForBatchId(e,r,n){let i=this.kr.get(n);return void 0!==i&&(i.forEach(e=>this.overlays=this.overlays.remove(e)),this.kr.delete(n)),eU.resolve()}getOverlaysForCollection(e,r,n){let i=n_(),o=r.length+1,a=new ed(r.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){let e=s.getNext().value,a=e.getKey();if(!r.isPrefixOf(a.path))break;a.path.length===o&&e.largestBatchId>n&&i.set(e.getKey(),e)}return eU.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new t1((e,r)=>e-r),a=this.overlays.getIterator();for(;a.hasNext();){let e=a.getNext().value;if(e.getKey().getCollectionGroup()===r&&e.largestBatchId>n){let r=o.get(e.largestBatchId);null===r&&(r=n_(),o=o.insert(e.largestBatchId,r)),r.set(e.getKey(),e)}}let s=n_(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((e,r)=>s.set(e,r)),!(s.size()>=i)););return eU.resolve(s)}wt(e,r,n){let i=this.overlays.get(n.key);if(null!==i){let e=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new n7(r,n));let o=this.kr.get(r);void 0===o&&(o=nO(),this.kr.set(r,o)),this.kr.set(r,o.add(n.key))}}class oY{constructor(){this.sessionToken=re.EMPTY_BYTE_STRING}getSessionToken(e){return eU.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,eU.resolve()}}class oX{constructor(){this.qr=new t4(oZ.Qr),this.$r=new t4(oZ.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){let n=new oZ(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(e=>this.addReference(e,r))}removeReference(e,r){this.Wr(new oZ(e,r))}Gr(e,r){e.forEach(e=>this.removeReference(e,r))}zr(e){let r=new ed(new ec([])),n=new oZ(r,e),i=new oZ(r,e+1),o=[];return this.$r.forEachInRange([n,i],e=>{this.Wr(e),o.push(e.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let r=new ed(new ec([])),n=new oZ(r,e),i=new oZ(r,e+1),o=nO();return this.$r.forEachInRange([n,i],e=>{o=o.add(e.key)}),o}containsKey(e){let r=new oZ(e,0),n=this.qr.firstAfterOrEqual(r);return null!==n&&e.isEqual(n.key)}}class oZ{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return ed.comparator(e.key,r.key)||en(e.Hr,r.Hr)}static Ur(e,r){return en(e.Hr,r.Hr)||ed.comparator(e.key,r.key)}}class o0{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new t4(oZ.Qr)}checkEmpty(e){return eU.resolve(0===this.mutationQueue.length)}addMutationBatch(e,r,n,i){let o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new n6(o,r,n,i);for(let r of(this.mutationQueue.push(a),i))this.Yr=this.Yr.add(new oZ(r.key,o)),this.indexManager.addToCollectionParentIndex(e,r.key.path.popLast());return eU.resolve(a)}lookupMutationBatch(e,r){return eU.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){let n=this.Xr(r+1),i=n<0?0:n;return eU.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return eU.resolve(0===this.mutationQueue.length?-1:this.er-1)}getAllMutationBatches(e){return eU.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){let n=new oZ(r,0),i=new oZ(r,1/0),o=[];return this.Yr.forEachInRange([n,i],e=>{let r=this.Zr(e.Hr);o.push(r)}),eU.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new t4(en);return r.forEach(e=>{let r=new oZ(e,0),i=new oZ(e,1/0);this.Yr.forEachInRange([r,i],e=>{n=n.add(e.Hr)})}),eU.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){let n=r.path,i=n.length+1,o=n;ed.isDocumentKey(o)||(o=o.child(""));let a=new oZ(new ed(o),0),s=new t4(en);return this.Yr.forEachWhile(e=>{let r=e.key.path;return!!n.isPrefixOf(r)&&(r.length===i&&(s=s.add(e.Hr)),!0)},a),eU.resolve(this.ei(s))}ei(e){let r=[];return e.forEach(e=>{let n=this.Zr(e);null!==n&&r.push(n)}),r}removeMutationBatch(e,r){V(0===this.ti(r.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return eU.forEach(r.mutations,i=>{let o=new oZ(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){let n=new oZ(r,0),i=this.Yr.firstAfterOrEqual(n);return eU.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,eU.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){let r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class o1{constructor(e){this.ni=e,this.docs=new t1(ed.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){let n=r.key,i=this.docs.get(n),o=i?i.size:0,a=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){let n=this.docs.get(r);return eU.resolve(n?n.document.mutableCopy():rV.newInvalidDocument(r))}getEntries(e,r){let n=nE;return r.forEach(e=>{let r=this.docs.get(e);n=n.insert(e,r?r.document.mutableCopy():rV.newInvalidDocument(e))}),eU.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=nE,a=r.path,s=new ed(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(s);for(;u.hasNext();){let{key:e,value:{document:s}}=u.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||0>=eD(eN(s),n)||(i.has(s.key)||nb(r,s))&&(o=o.insert(s.key,s.mutableCopy()))}return eU.resolve(o)}getAllFromCollectionGroup(e,r,n,i){M(9500)}ri(e,r){return eU.forEach(this.docs,e=>r(e))}newChangeBuffer(e){return new o2(this)}getSize(e){return eU.resolve(this.size)}}class o2 extends oV{constructor(e){super(),this.Or=e}applyChanges(e){let r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),eU.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}class o3{constructor(e){this.persistence=e,this.ii=new nx(e=>ne(e),nt),this.lastRemoteSnapshotVersion=eI.min(),this.highestTargetId=0,this.si=0,this.oi=new oX,this.targetCount=0,this._i=oC.ar()}forEachTarget(e,r){return this.ii.forEach((e,n)=>r(n)),eU.resolve()}getLastRemoteSnapshotVersion(e){return eU.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return eU.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),eU.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),eU.resolve()}hr(e){this.ii.set(e.target,e);let r=e.targetId;r>this.highestTargetId&&(this._i=new oC(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,eU.resolve()}updateTargetData(e,r){return this.hr(r),eU.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,eU.resolve()}removeTargets(e,r,n){let i=0,o=[];return this.ii.forEach((a,s)=>{s.sequenceNumber<=r&&null===n.get(s.targetId)&&(this.ii.delete(a),o.push(this.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),eU.waitFor(o).next(()=>i)}getTargetCount(e){return eU.resolve(this.targetCount)}getTargetData(e,r){let n=this.ii.get(r)||null;return eU.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),eU.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);let i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(r=>{o.push(i.markPotentiallyOrphaned(e,r))}),eU.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),eU.resolve()}getMatchingKeysForTargetId(e,r){let n=this.oi.Jr(r);return eU.resolve(n)}containsKey(e,r){return eU.resolve(this.oi.containsKey(r))}}class o4{constructor(e,r){this.ai={},this.overlays={},this.ui=new eZ(0),this.ci=!1,this.ci=!0,this.li=new oY,this.referenceDelegate=e(this),this.hi=new o3(this),this.indexManager=new ov,this.remoteDocumentCache=new o1(e=>this.referenceDelegate.Pi(e)),this.serializer=new iQ(r),this.Ti=new oQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new oJ,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new o0(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){R("MemoryPersistence","Starting transaction:",e);let i=new o5(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(e=>this.referenceDelegate.di(i).next(()=>e)).toPromise().then(e=>(i.raiseOnCommittedEvent(),e))}Ei(e,r){return eU.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class o5 extends ej{constructor(e){super(),this.currentSequenceNumber=e}}class o6{constructor(e){this.persistence=e,this.Ai=new oX,this.Ri=null}static Vi(e){return new o6(e)}get mi(){if(this.Ri)return this.Ri;throw M(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),eU.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),eU.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),eU.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(e=>this.mi.add(e.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(e=>{e.forEach(e=>this.mi.add(e.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return eU.forEach(this.mi,n=>{let i=ed.fromPath(n);return this.fi(e,i).next(e=>{e||r.removeEntry(i,eI.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(e=>{e?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return eU.or([()=>eU.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class o8{constructor(e,r){this.persistence=e,this.gi=new nx(e=>e3(e.path),(e,r)=>e.isEqual(r)),this.garbageCollector=new oU(this,r)}static Vi(e,r){return new o8(e,r)}Ii(){}di(e){return eU.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){let r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>r.next(r=>e+r))}yr(e){let r=0;return this.gr(e,e=>{r++}).next(()=>r)}gr(e,r){return eU.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(e=>e?eU.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,i=>this.Sr(e,i,r).next(e=>{e||(n++,o.removeEntry(i,eI.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),eU.resolve()}removeTarget(e,r){let n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),eU.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),eU.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),eU.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=function e(r){switch(rS(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let n=rl(r);return n?16+e(n):16;case 5:return 2*r.stringValue.length;case 6:return ri(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(r.arrayValue.values||[]).reduce((r,n)=>r+e(n),0);case 10:case 11:var i;let o;return i=r.mapValue,o=0,tX(i.fields,(r,n)=>{o+=r.length+e(n)}),o;default:throw M(13486,{value:r})}}(e.data.value)),r}Sr(e,r,n){return eU.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{let e=this.gi.get(r);return eU.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class o7{constructor(e){this.serializer=e}q(e,r,n,i){let o=new eG("createOrUpgrade",r);n<1&&i>=1&&(e.createObjectStore(e6),e.createObjectStore(e7,{keyPath:"userId"}),e.createObjectStore(e9,{keyPath:te,autoIncrement:!0}).createIndex(tt,tr,{unique:!0}),e.createObjectStore(ti),o9(e),e.createObjectStore(e5));let a=eU.resolve();return n<3&&i>=3&&(0!==n&&(e.deleteObjectStore(tg),e.deleteObjectStore(tf),e.deleteObjectStore(tS),o9(e)),a=a.next(()=>(function(e){let r=e.store(tS),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:eI.min().toTimestamp(),targetCount:0};return r.put(tw,n)})(o))),n<4&&i>=4&&(0!==n&&(a=a.next(()=>o.store(e9).j().next(r=>{e.deleteObjectStore(e9),e.createObjectStore(e9,{keyPath:te,autoIncrement:!0}).createIndex(tt,tr,{unique:!0});let n=o.store(e9),i=r.map(e=>n.put(e));return eU.waitFor(i)}))),a=a.next(()=>{e.createObjectStore(tI,{keyPath:"clientId"})})),n<5&&i>=5&&(a=a.next(()=>this.pi(o))),n<6&&i>=6&&(a=a.next(()=>(e.createObjectStore(th),this.yi(o)))),n<7&&i>=7&&(a=a.next(()=>this.wi(o))),n<8&&i>=8&&(a=a.next(()=>this.Si(e,o))),n<9&&i>=9&&(a=a.next(()=>{e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),n<10&&i>=10&&(a=a.next(()=>this.bi(o))),n<11&&i>=11&&(a=a.next(()=>{e.createObjectStore(tT,{keyPath:"bundleId"}),e.createObjectStore(tk,{keyPath:"name"})})),n<12&&i>=12&&(a=a.next(()=>{let r=e.createObjectStore(tF,{keyPath:tU});r.createIndex(tM,tG,{unique:!1}),r.createIndex(tV,tB,{unique:!1})})),n<13&&i>=13&&(a=a.next(()=>(function(e){let r=e.createObjectStore(to,{keyPath:ta});r.createIndex(ts,tu),r.createIndex(tc,tl)})(e)).next(()=>this.Di(e,o)).next(()=>e.deleteObjectStore(e5))),n<14&&i>=14&&(a=a.next(()=>this.Ci(e,o))),n<15&&i>=15&&(a=a.next(()=>{e.createObjectStore(t_,{keyPath:"indexId",autoIncrement:!0}).createIndex(tA,"collectionGroup",{unique:!1}),e.createObjectStore(tP,{keyPath:tO}).createIndex(tC,tN,{unique:!1}),e.createObjectStore(tL,{keyPath:tD}).createIndex(tR,tj,{unique:!1})})),n<16&&i>=16&&(a=a.next(()=>{r.objectStore(tP).clear()}).next(()=>{r.objectStore(tL).clear()})),n<17&&i>=17&&(a=a.next(()=>{e.createObjectStore(tz,{keyPath:"name"})})),n<18&&i>=18&&(0,S.Ov)()&&(a=a.next(()=>{r.objectStore(tP).clear()}).next(()=>{r.objectStore(tL).clear()})),a}yi(e){let r=0;return e.store(e5).X((e,n)=>{r+=o_(n)}).next(()=>{let n={byteSize:r};return e.store(th).put(td,n)})}pi(e){let r=e.store(e7),n=e.store(e9);return r.j().next(r=>eU.forEach(r,r=>{let i=IDBKeyRange.bound([r.userId,-1],[r.userId,r.lastAcknowledgedBatchId]);return n.j(tt,i).next(n=>eU.forEach(n,n=>{V(n.userId===r.userId,18650,"Cannot process batch from unexpected user",{batchId:n.batchId});let i=i0(this.serializer,n);return ok(e,r.userId,i).next(()=>{})}))}))}wi(e){let r=e.store(tg),n=e.store(e5);return e.store(tS).get(tw).next(e=>{let i=[];return n.X((n,o)=>{let a=new ec(n),s=[0,e3(a)];i.push(r.get(s).next(n=>n?eU.resolve():r.put({targetId:0,path:e3(a),sequenceNumber:e.highestListenSequenceNumber})))}).next(()=>eU.waitFor(i))})}Si(e,r){e.createObjectStore(tx,{keyPath:tE});let n=r.store(tx),i=new ob,o=e=>{if(i.add(e)){let r=e.lastSegment(),i=e.popLast();return n.put({collectionId:r,parent:e3(i)})}};return r.store(e5).X({Z:!0},(e,r)=>o(new ec(e).popLast())).next(()=>r.store(ti).X({Z:!0},([e,r,n],i)=>o(e4(r).popLast())))}bi(e){let r=e.store(tf);return r.X((e,n)=>{let i=i1(n),o=i2(this.serializer,i);return r.put(o)})}Di(e,r){let n=r.store(e5),i=[];return n.X((e,n)=>{let o=r.store(to),a=(n.document?new ed(ec.fromString(n.document.name).popFirst(5)):n.noDocument?ed.fromSegments(n.noDocument.path):n.unknownDocument?ed.fromSegments(n.unknownDocument.path):M(36783)).path.toArray(),s={prefixPath:a.slice(0,a.length-2),collectionGroup:a[a.length-2],documentId:a[a.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};i.push(o.put(s))}).next(()=>eU.waitFor(i))}Ci(e,r){let n=r.store(e9),i=new oB(this.serializer),o=new o4(o6.Vi,this.serializer.gt);return n.j().next(e=>{let n=new Map;return e.forEach(e=>{var r;let i=null!=(r=n.get(e.userId))?r:nO();i0(this.serializer,e).keys().forEach(e=>i=i.add(e)),n.set(e.userId,i)}),eU.forEach(n,(e,n)=>{let a=new O(n),s=i7.yt(this.serializer,a),u=o.getIndexManager(a);return new oW(i,oA.yt(a,this.serializer,u,o.referenceDelegate),s,u).recalculateAndSaveOverlaysForDocumentKeys(new tQ(r,eZ.ue),e).next()})})}}function o9(e){e.createObjectStore(tg,{keyPath:ty}).createIndex(tv,tb,{unique:!0}),e.createObjectStore(tf,{keyPath:"targetId"}).createIndex(tp,tm,{unique:!0}),e.createObjectStore(tS)}let ae="IndexedDbPersistence",at="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ar="main";class an{constructor(e,r,n,i,o,a,s,u,c,l,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.Fi=o,this.window=a,this.document=s,this.Mi=c,this.xi=l,this.Oi=h,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=-1/0,this.qi=e=>Promise.resolve(),!an.C())throw new q(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oM(this,i),this.Qi=r+ar,this.serializer=new iQ(u),this.$i=new eV(this.Qi,this.Oi,new o7(this.serializer)),this.li=new i9,this.hi=new oN(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new oB(this.serializer),this.Ti=new i8,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===l&&j(ae,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new q(z.FAILED_PRECONDITION,at);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hi.getHighestSequenceNumber(e))}).then(e=>{this.ui=new eZ(e,this.Mi)}).then(()=>{this.ci=!0}).catch(e=>(this.$i&&this.$i.close(),Promise.reject(e)))}ji(e){return this.qi=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget(async()=>{this.started&&await this.Ki()}))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>tJ(e,tI).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ji(e).next(e=>{e||(this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)))})}).next(()=>this.Hi(e)).next(r=>this.isPrimary&&!r?this.Yi(e).next(()=>!1):!!r&&this.Zi(e).next(()=>!0))).catch(e=>{if(eH(e))return R(ae,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return R(ae,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable(()=>this.qi(e)),this.isPrimary=e})}Ji(e){return tJ(e,e6).get(e8).next(e=>eU.resolve(this.Xi(e)))}es(e){return tJ(e,tI).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,18e5)){this.ki=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let r=tJ(e,tI);return r.j().next(e=>{let n=this.rs(e,18e5),i=e.filter(e=>-1===n.indexOf(e));return eU.forEach(i,e=>r.delete(e.clientId)).next(()=>i)})}).catch(()=>[]);if(this.Ui)for(let r of e)this.Ui.removeItem(this.ss(r.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ki().then(()=>this.ts()).then(()=>this.zi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?eU.resolve(!0):tJ(e,e6).get(e8).next(r=>{if(null!==r&&this.ns(r.leaseTimestampMs,5e3)&&!this._s(r.ownerId)){if(this.Xi(r)&&this.networkEnabled)return!0;if(!this.Xi(r)){if(!r.allowTabSynchronization)throw new q(z.FAILED_PRECONDITION,at);return!1}}return!(!this.networkEnabled||!this.inForeground)||tJ(e,tI).j().next(e=>void 0===this.rs(e,5e3).find(e=>{if(this.clientId!==e.clientId){let r=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,i=this.networkEnabled===e.networkEnabled;if(r||n&&i)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&R(ae,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[e6,tI],e=>{let r=new tQ(e,eZ.ue);return this.Yi(r).next(()=>this.es(r))}),this.$i.close(),this.hs()}rs(e,r){return e.filter(e=>this.ns(e.updateTimeMs,r)&&!this._s(e.clientId))}Ps(){return this.runTransaction("getActiveClients","readonly",e=>tJ(e,tI).j().next(e=>this.rs(e,18e5).map(e=>e.clientId)))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,r){return oA.yt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ox(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return i7.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,r,n){var i;let o;R(ae,"Starting transaction:",e);let a=18===(i=this.Oi)||17===i?tW:16===i||15===i?tK:14===i||13===i?t$:12===i?tH:11===i?tq:void M(60245);return this.$i.runTransaction(e,"readonly"===r?"readonly":"readwrite",a,i=>(o=new tQ(i,this.ui?this.ui.next():eZ.ue),"readwrite-primary"===r?this.Ji(o).next(e=>!!e||this.Hi(o)).next(r=>{if(!r)throw j(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)),new q(z.FAILED_PRECONDITION,eR);return n(o)}).next(e=>this.Zi(o).next(()=>e)):this.Ts(o).next(()=>n(o)))).then(e=>(o.raiseOnCommittedEvent(),e))}Ts(e){return tJ(e,e6).get(e8).next(e=>{if(null!==e&&this.ns(e.leaseTimestampMs,5e3)&&!this._s(e.ownerId)&&!this.Xi(e)&&!(this.xi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new q(z.FAILED_PRECONDITION,at)})}Zi(e){let r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return tJ(e,e6).put(e8,r)}static C(){return eV.C()}Yi(e){let r=tJ(e,e6);return r.get(e8).next(e=>this.Xi(e)?(R(ae,"Releasing primary lease."),r.delete(e8)):eU.resolve())}ns(e,r){let n=Date.now();return!(e<n-r)&&(!(e>n)||(j(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bi=()=>{this.Fi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ki()))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground="visible"===this.document.visibilityState)}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;"function"==typeof(null==(e=this.window)?void 0:e.addEventListener)&&(this.Ni=()=>{this.us();let e=/(?:Version|Mobile)\/1[456]/;(0,S.nr)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var r;try{let n=null!==(null==(r=this.Ui)?void 0:r.getItem(this.ss(e)));return R(ae,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return j(ae,"Failed to get zombied client id.",e),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){j("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch(e){}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ai(e,r){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+r+"/"+n+"/"}class ao{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=i}static Es(e,r){let n=nO(),i=nO();for(let e of r.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new ao(e,r.fromCache,n,i)}}class aa{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class as{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(0,S.nr)()?8:eB((0,S.ZQ)())>0?6:4}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,i){let o={result:null};return this.ps(e,r).next(e=>{o.result=e}).next(()=>{if(!o.result)return this.ys(e,r,i,n).next(e=>{o.result=e})}).next(()=>{if(o.result)return;let n=new aa;return this.ws(e,r,n).next(i=>{if(o.result=i,this.Rs)return this.Ss(e,r,n,i.size)})}).next(()=>o.result)}Ss(e,r,n,i){return n.documentReadCount<this.Vs?(L()<=w.$b.DEBUG&&R("QueryEngine","SDK will not create cache indexes for query:",nv(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),eU.resolve()):(L()<=w.$b.DEBUG&&R("QueryEngine","Query:",nv(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(L()<=w.$b.DEBUG&&R("QueryEngine","The SDK decides to create cache indexes for query:",nv(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nh(r))):eU.resolve())}ps(e,r){if(nu(r))return eU.resolve(null);let n=nh(r);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==r.limit&&1===i&&(n=nh(r=nm(r,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{let o=nO(...i);return this.gs.getDocuments(e,o).next(i=>this.indexManager.getMinOffset(e,n).next(n=>{let a=this.bs(r,i);return this.Ds(r,a,o,n.readTime)?this.ps(e,nm(r,null,"F")):this.vs(e,a,r,n)}))})))}ys(e,r,n,i){return nu(r)||i.isEqual(eI.min())?eU.resolve(null):this.gs.getDocuments(e,n).next(o=>{let a=this.bs(r,o);return this.Ds(r,a,n,i)?eU.resolve(null):(L()<=w.$b.DEBUG&&R("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nv(r)),this.vs(e,a,r,eC(i,-1)).next(e=>e))})}bs(e,r){let n=new t4(nS(e));return r.forEach((r,i)=>{nb(e,i)&&(n=n.add(i))}),n}Ds(e,r,n,i){if(null===e.limit)return!1;if(n.size!==r.size)return!0;let o="F"===e.limitType?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,r,n){return L()<=w.$b.DEBUG&&R("QueryEngine","Using full collection scan to execute query:",nv(r)),this.gs.getDocumentsMatchingQuery(e,r,eL.min(),n)}vs(e,r,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(e=>(r.forEach(r=>{e=e.insert(r.key,r)}),e))}}let au="LocalStore";class ac{constructor(e,r,n,i){this.persistence=e,this.Cs=r,this.serializer=i,this.Fs=new t1(en),this.Ms=new nx(e=>ne(e),nt),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oW(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}async function al(e,r){return await e.persistence.runTransaction("Handle user change","readonly",n=>{let i;return e.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,e.Ns(r),e.mutationQueue.getAllMutationBatches(n))).next(r=>{let o=[],a=[],s=nO();for(let e of i)for(let r of(o.push(e.batchId),e.mutations))s=s.add(r.key);for(let e of r)for(let r of(a.push(e.batchId),e.mutations))s=s.add(r.key);return e.localDocuments.getDocuments(n,s).next(e=>({Bs:e,removedBatchIds:o,addedBatchIds:a}))})})}function ah(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function ad(e,r,n){let i=nO(),o=nO();return n.forEach(e=>i=i.add(e)),r.getEntries(e,i).next(e=>{let i=nE;return n.forEach((n,a)=>{let s=e.get(n);a.isFoundDocument()!==s.isFoundDocument()&&(o=o.add(n)),a.isNoDocument()&&a.version.isEqual(eI.min())?(r.removeEntry(n,a.readTime),i=i.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(r.addEntry(a),i=i.insert(n,a)):R(au,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)}),{Ls:i,ks:o}})}function af(e,r){return e.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return e.hi.getTargetData(n,r).next(o=>o?(i=o,eU.resolve(i)):e.hi.allocateTargetId(n).next(o=>(i=new iW(r,o,"TargetPurposeListen",n.currentSequenceNumber),e.hi.addTargetData(n,i).next(()=>i))))}).then(n=>{let i=e.Fs.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Fs=e.Fs.insert(n.targetId,n),e.Ms.set(r,n.targetId)),n})}async function ap(e,r,n){let i=e.Fs.get(r);try{n||await e.persistence.runTransaction("Release target",n?"readwrite":"readwrite-primary",r=>e.persistence.referenceDelegate.removeTarget(r,i))}catch(e){if(!eH(e))throw e;R(au,`Failed to update sequence numbers for target ${r}: ${e}`)}e.Fs=e.Fs.remove(r),e.Ms.delete(i.target)}function am(e,r,n){let i=eI.min(),o=nO();return e.persistence.runTransaction("Execute query","readwrite",a=>(function(e,r,n){let i=e.Ms.get(n);return void 0!==i?eU.resolve(e.Fs.get(i)):e.hi.getTargetData(r,n)})(e,a,nh(r)).next(r=>{if(r)return i=r.lastLimboFreeSnapshotVersion,e.hi.getMatchingKeysForTargetId(a,r.targetId).next(e=>{o=e})}).next(()=>e.Cs.getDocumentsMatchingQuery(a,r,n?i:eI.min(),n?o:nO())).next(n=>(av(e,nw(r),n),{documents:n,qs:o})))}function ag(e,r){let n=e.hi,i=e.Fs.get(r);return i?Promise.resolve(i.target):e.persistence.runTransaction("Get target data","readonly",e=>n.Et(e,r).next(e=>e?e.target:null))}function ay(e,r){let n=e.xs.get(r)||eI.min();return e.persistence.runTransaction("Get new document changes","readonly",i=>e.Os.getAllFromCollectionGroup(i,r,eC(n,-1),Number.MAX_SAFE_INTEGER)).then(n=>(av(e,r,n),n))}function av(e,r,n){let i=e.xs.get(r)||eI.min();n.forEach((e,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)}),e.xs.set(r,i)}async function ab(e,r,n,i){let o=nO(),a=nE;for(let e of n){let n=r.Qs(e.metadata.name);e.document&&(o=o.add(n));let i=r.$s(e);i.setReadTime(r.Us(e.metadata.readTime)),a=a.insert(n,i)}let s=e.Os.newChangeBuffer({trackRemovals:!0}),u=await af(e,nh(ns(ec.fromString(`__bundle__/docs/${i}`))));return e.persistence.runTransaction("Apply bundle documents","readwrite",r=>ad(r,s,a).next(e=>(s.apply(r),e)).next(n=>e.hi.removeMatchingKeysForTargetId(r,u.targetId).next(()=>e.hi.addMatchingKeys(r,o,u.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(r,n.Ls,n.ks)).next(()=>n.Ls)))}async function aw(e,r,n=nO()){let i=await af(e,nh(i3(r.bundledQuery)));return e.persistence.runTransaction("Save named query","readwrite",o=>{let a=i_(r.readTime);if(i.snapshotVersion.compareTo(a)>=0)return e.Ti.saveNamedQuery(o,r);let s=i.withResumeToken(re.EMPTY_BYTE_STRING,a);return e.Fs=e.Fs.insert(s.targetId,s),e.hi.updateTargetData(o,s).next(()=>e.hi.removeMatchingKeysForTargetId(o,i.targetId)).next(()=>e.hi.addMatchingKeys(o,n,i.targetId)).next(()=>e.Ti.saveNamedQuery(o,r))})}let aS="firestore_clients";function ax(e,r){return`${aS}_${e}_${r}`}let aE="firestore_mutations";function aI(e,r,n){let i=`${aE}_${e}_${n}`;return r.isAuthenticated()&&(i+=`_${r.uid}`),i}let aT="firestore_targets";function ak(e,r){return`${aT}_${e}_${r}`}let a_="SharedClientState";class aA{constructor(e,r,n,i){this.user=e,this.batchId=r,this.state=n,this.error=i}static Ks(e,r,n){let i=JSON.parse(n),o,a="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&(a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(o=new q(i.error.code,i.error.message)),a?new aA(e,r,i.state,o):(j(a_,`Failed to parse mutation state for ID '${r}': ${n}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class aP{constructor(e,r,n){this.targetId=e,this.state=r,this.error=n}static Ks(e,r){let n=JSON.parse(r),i,o="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return o&&n.error&&(o="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new q(n.error.code,n.error.message)),o?new aP(e,n.state,i):(j(a_,`Failed to parse target state for ID '${e}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class aO{constructor(e,r){this.clientId=e,this.activeTargetIds=r}static Ks(e,r){let n=JSON.parse(r),i="object"==typeof n&&n.activeTargetIds instanceof Array,o=nC;for(let e=0;i&&e<n.activeTargetIds.length;++e)i=e2(n.activeTargetIds[e]),o=o.add(n.activeTargetIds[e]);return i?new aO(e,o):(j(a_,`Failed to parse client data for instance '${e}': ${r}`),null)}}class aC{constructor(e,r){this.clientId=e,this.onlineState=r}static Ks(e){let r=JSON.parse(e);return"object"==typeof r&&-1!==["Unknown","Online","Offline"].indexOf(r.onlineState)&&"string"==typeof r.clientId?new aC(r.clientId,r.onlineState):(j(a_,`Failed to parse online state: ${e}`),null)}}class aN{constructor(){this.activeTargetIds=nC}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class aL{constructor(e,r,n,i,o){var a,s,u;this.window=e,this.Fi=r,this.persistenceKey=n,this.js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Js=this.Hs.bind(this),this.Ys=new t1(en),this.started=!1,this.Zs=[];let c=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Xs=ax(this.persistenceKey,this.js),this.eo=(a=this.persistenceKey,`firestore_sequence_number_${a}`),this.Ys=this.Ys.insert(this.js,new aN),this.no=RegExp(`^${aS}_${c}_([^_]*)$`),this.ro=RegExp(`^${aE}_${c}_(\\d+)(?:_(.*))?$`),this.io=RegExp(`^${aT}_${c}_(\\d+)$`),this.so=(s=this.persistenceKey,`firestore_online_state_${s}`),this.oo=(u=this.persistenceKey,`firestore_bundle_loaded_v2_${u}`),this.window.addEventListener("storage",this.Js)}static C(e){return!(!e||!e.localStorage)}async start(){for(let e of(await this.syncEngine.Ps())){if(e===this.js)continue;let r=this.getItem(ax(this.persistenceKey,e));if(r){let n=aO.Ks(e,r);n&&(this.Ys=this.Ys.insert(n.clientId,n))}}this._o();let e=this.storage.getItem(this.so);if(e){let r=this.ao(e);r&&this.uo(r)}for(let e of this.Zs)this.Hs(e);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.eo,JSON.stringify(e))}getAllActiveQueryTargets(){return this.co(this.Ys)}isActiveQueryTarget(e){let r=!1;return this.Ys.forEach((n,i)=>{i.activeTargetIds.has(e)&&(r=!0)}),r}addPendingMutation(e){this.lo(e,"pending")}updateMutationState(e,r,n){this.lo(e,r,n),this.ho(e)}addLocalQueryTarget(e,r=!0){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(ak(this.persistenceKey,e));if(r){let i=aP.Ks(e,r);i&&(n=i.state)}}return r&&this.Po.Gs(e),this._o(),n}removeLocalQueryTarget(e){this.Po.zs(e),this._o()}isLocalQueryTarget(e){return this.Po.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ak(this.persistenceKey,e))}updateQueryState(e,r,n){this.To(e,r,n)}handleUserChange(e,r,n){r.forEach(e=>{this.ho(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Io(e)}notifyBundleLoaded(e){this.Eo(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let r=this.storage.getItem(e);return R(a_,"READ",e,r),r}setItem(e,r){R(a_,"SET",e,r),this.storage.setItem(e,r)}removeItem(e){R(a_,"REMOVE",e),this.storage.removeItem(e)}Hs(e){if(e.storageArea===this.storage){if(R(a_,"EVENT",e.key,e.newValue),e.key===this.Xs)return void j("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fi.enqueueRetryable(async()=>{if(this.started){if(null!==e.key){if(this.no.test(e.key)){if(null==e.newValue){let r=this.Ao(e.key);return this.Ro(r,null)}{let r=this.Vo(e.key,e.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.ro.test(e.key)){if(null!==e.newValue){let r=this.mo(e.key,e.newValue);if(r)return this.fo(r)}}else if(this.io.test(e.key)){if(null!==e.newValue){let r=this.po(e.key,e.newValue);if(r)return this.yo(r)}}else if(e.key===this.so){if(null!==e.newValue){let r=this.ao(e.newValue);if(r)return this.uo(r)}}else if(e.key===this.eo){let r=function(e){let r=eZ.ue;if(null!=e)try{let n=JSON.parse(e);V("number"==typeof n,30636,{wo:e}),r=n}catch(e){j(a_,"Failed to read sequence number from WebStorage",e)}return r}(e.newValue);r!==eZ.ue&&this.sequenceNumberHandler(r)}else if(e.key===this.oo){let r=this.So(e.newValue);await Promise.all(r.map(e=>this.syncEngine.bo(e)))}}}else this.Zs.push(e)})}}get Po(){return this.Ys.get(this.js)}_o(){this.setItem(this.Xs,this.Po.Ws())}lo(e,r,n){let i=new aA(this.currentUser,e,r,n),o=aI(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Ws())}ho(e){let r=aI(this.persistenceKey,this.currentUser,e);this.removeItem(r)}Io(e){let r={clientId:this.js,onlineState:e};this.storage.setItem(this.so,JSON.stringify(r))}To(e,r,n){let i=ak(this.persistenceKey,e),o=new aP(e,r,n);this.setItem(i,o.Ws())}Eo(e){let r=JSON.stringify(Array.from(e));this.setItem(this.oo,r)}Ao(e){let r=this.no.exec(e);return r?r[1]:null}Vo(e,r){let n=this.Ao(e);return aO.Ks(n,r)}mo(e,r){let n=this.ro.exec(e),i=Number(n[1]),o=void 0!==n[2]?n[2]:null;return aA.Ks(new O(o),i,r)}po(e,r){let n=Number(this.io.exec(e)[1]);return aP.Ks(n,r)}ao(e){return aC.Ks(e)}So(e){return JSON.parse(e)}async fo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Do(e.batchId,e.state,e.error);R(a_,`Ignoring mutation for non-active user ${e.user.uid}`)}yo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Ro(e,r){let n=r?this.Ys.insert(e,r):this.Ys.remove(e),i=this.co(this.Ys),o=this.co(n),a=[],s=[];return o.forEach(e=>{i.has(e)||a.push(e)}),i.forEach(e=>{o.has(e)||s.push(e)}),this.syncEngine.Co(a,s).then(()=>{this.Ys=n})}uo(e){this.Ys.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}co(e){let r=nC;return e.forEach((e,n)=>{r=r.unionWith(n.activeTargetIds)}),r}}class aD{constructor(){this.Fo=new aN,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new aN,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class aR{xo(e){}shutdown(){}}let aj="ConnectivityMonitor";class aF{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){for(let e of(R(aj,"Network connectivity changed: AVAILABLE"),this.ko))e(0)}Lo(){for(let e of(R(aj,"Network connectivity changed: UNAVAILABLE"),this.ko))e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let aU=null;function aM(){return null===aU?aU=0x10000000+Math.round(0x80000000*Math.random()):aU++,"0x"+aU.toString(16)}let aG="RestConnection",aV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aB{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===rf?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,r,n,i,o){let a=aM(),s=this.Go(e,r.toUriEncodedString());R(aG,`Sending RPC '${e}' ${a}:`,s,n);let u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,o);let{host:c}=new URL(s),l=(0,S.zJ)(c);return this.jo(e,s,u,n,l).then(r=>(R(aG,`Received RPC '${e}' ${a}: `,r),r),r=>{throw F(aG,`RPC '${e}' ${a} failed with error: `,r,"url: ",s,"request:",n),r})}Jo(e,r,n,i,o,a){return this.Wo(e,r,n,i,o)}zo(e,r,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+C,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((r,n)=>e[n]=r),n&&n.headers.forEach((r,n)=>e[n]=r)}Go(e,r){let n=aV[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}class az{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}let aq="WebChannelConnection";class aH extends aB{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,i,o){let s=aM();return new Promise((o,l)=>{let h=new a;h.setWithCredentials(!0),h.listenOnce(u.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case c.NO_ERROR:let r=h.getResponseJson();R(aq,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(r)),o(r);break;case c.TIMEOUT:R(aq,`RPC '${e}' ${s} timed out`),l(new q(z.DEADLINE_EXCEEDED,"Request time out"));break;case c.HTTP_ERROR:let n=h.getStatus();if(R(aq,`RPC '${e}' ${s} failed with status:`,n,"response text:",h.getResponseText()),n>0){let e=h.getResponseJson();Array.isArray(e)&&(e=e[0]);let r=null==e?void 0:e.error;if(r&&r.status&&r.message){let e=function(e){let r=e.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(r)>=0?r:z.UNKNOWN}(r.status);l(new q(e,r.message))}else l(new q(z.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new q(z.UNAVAILABLE,"Connection failed."));break;default:M(9055,{c_:e,streamId:s,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{R(aq,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);R(aq,`RPC '${e}' ${s} sending request:`,i),h.send(r,"POST",d,n,15)})}P_(e,r,n){let i=aM(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=f(),u=d(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;void 0!==m&&(c.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;let g=o.join("");R(aq,`Creating RPC '${e}' stream ${i}: ${g}`,c);let y=a.createWebChannel(g,c);this.T_(y);let v=!1,b=!1,w=new az({Ho:r=>{b?R(aq,`Not sending because RPC '${e}' stream ${i} is closed:`,r):(v||(R(aq,`Opening RPC '${e}' stream ${i} transport.`),y.open(),v=!0),R(aq,`RPC '${e}' stream ${i} sending:`,r),y.send(r))},Yo:()=>y.close()}),S=(e,r,n)=>{e.listen(r,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return S(y,s.EventType.OPEN,()=>{b||(R(aq,`RPC '${e}' stream ${i} transport opened.`),w.s_())}),S(y,s.EventType.CLOSE,()=>{b||(b=!0,R(aq,`RPC '${e}' stream ${i} transport closed`),w.__(),this.I_(y))}),S(y,s.EventType.ERROR,r=>{b||(b=!0,F(aq,`RPC '${e}' stream ${i} transport errored. Name:`,r.name,"Message:",r.message),w.__(new q(z.UNAVAILABLE,"The operation could not be completed")))}),S(y,s.EventType.MESSAGE,r=>{var n;if(!b){let o=r.data[0];V(!!o,16349);let a=(null==o?void 0:o.error)||(null==(n=o[0])?void 0:n.error);if(a){R(aq,`RPC '${e}' stream ${i} received error:`,a);let r=a.status,n=function(e){let r=p[e];if(void 0!==r)return ir(r)}(r),o=a.message;void 0===n&&(n=z.INTERNAL,o="Unknown error status: "+r+" with message "+a.message),b=!0,w.__(new q(n,o)),y.close()}else R(aq,`RPC '${e}' stream ${i} received:`,o),w.a_(o)}}),S(u,h.STAT_EVENT,r=>{r.stat===l.PROXY?R(aq,`RPC '${e}' stream ${i} detected buffering proxy`):r.stat===l.NOPROXY&&R(aq,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function a$(){return"undefined"!=typeof window?window:null}function aK(){return"undefined"!=typeof document?document:null}function aW(e){return new iE(e,!0)}class aQ{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,r-n);i>0&&R("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}let aJ="PersistentStream";class aY{constructor(e,r,n,i,o,a,s,u){this.Fi=e,this.w_=n,this.S_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new aQ(e,r)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==e?this.F_.reset():r&&r.code===z.RESOURCE_EXHAUSTED?(j(r.toString()),j("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===z.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.b_===r&&this.W_(e,n)},r=>{e(()=>{let e=new q(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(e)})})}W_(e,r){let n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(e=>{n(()=>this.G_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.C_?this.j_(e):this.onNext(e))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return R(aJ,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(R(aJ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class aX extends aY{constructor(e,r,n,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let r=function(e,r){let n;if("targetChange"in r){var i,o;r.targetChange;let a="NO_CHANGE"===(i=r.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:M(39313,{state:i}),s=r.targetChange.targetIds||[],u=(o=r.targetChange.resumeToken,e.useProto3Json?(V(void 0===o||"string"==typeof o,58123),re.fromBase64String(o||"")):(V(void 0===o||o instanceof _||o instanceof Uint8Array,16193),re.fromUint8Array(o||new Uint8Array))),c=r.targetChange.cause;n=new im(a,s,u,c&&new q(void 0===c.code?z.UNKNOWN:ir(c.code),c.message||"")||null)}else if("documentChange"in r){r.documentChange;let i=r.documentChange;i.document,i.document.name,i.document.updateTime;let o=iN(e,i.document.name),a=i_(i.document.updateTime),s=i.document.createTime?i_(i.document.createTime):eI.min(),u=new rG({mapValue:{fields:i.document.fields}}),c=rV.newFoundDocument(o,a,s,u);n=new id(i.targetIds||[],i.removedTargetIds||[],c.key,c)}else if("documentDelete"in r){r.documentDelete;let i=r.documentDelete;i.document;let o=iN(e,i.document),a=i.readTime?i_(i.readTime):eI.min(),s=rV.newNoDocument(o,a);n=new id([],i.removedTargetIds||[],s.key,s)}else if("documentRemove"in r){r.documentRemove;let i=r.documentRemove;i.document;let o=iN(e,i.document);n=new id([],i.removedTargetIds||[],o,null)}else{if(!("filter"in r))return M(11601,{At:r});{r.filter;let e=r.filter;e.targetId;let{count:i=0,unchangedNames:o}=e,a=new ie(i,o);n=new ip(e.targetId,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return eI.min();let r=e.targetChange;return r.targetIds&&r.targetIds.length?eI.min():r.readTime?i_(r.readTime):eI.min()}(e);return this.listener.J_(r,n)}H_(e){let r={};r.database=iR(this.serializer),r.addTarget=function(e,r){let n,i=r.target;if((n=nr(i)?{documents:iV(e,i)}:{query:iB(e,i).Vt}).targetId=r.targetId,r.resumeToken.approximateByteSize()>0){n.resumeToken=ik(e,r.resumeToken);let i=iI(e,r.expectedCount);null!==i&&(n.expectedCount=i)}else if(r.snapshotVersion.compareTo(eI.min())>0){n.readTime=iT(e,r.snapshotVersion.toTimestamp());let i=iI(e,r.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);let n=function(e,r){let n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return M(28987,{purpose:e})}}(r.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){let r={};r.database=iR(this.serializer),r.removeTarget=e,this.k_(r)}}class aZ extends aY{constructor(e,r,n,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return V(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,V(!e.writeResults||0===e.writeResults.length,55816),this.listener.ea()}onNext(e){var r,n;V(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let i=(r=e.writeResults,n=e.commitTime,r&&r.length>0?(V(void 0!==n,14353),r.map(e=>{let r;return(r=e.updateTime?i_(e.updateTime):i_(n)).isEqual(eI.min())&&(r=i_(n)),new n$(r,e.transformResults||[])})):[]),o=i_(e.commitTime);return this.listener.ta(o,i)}na(){let e={};e.database=iR(this.serializer),this.k_(e)}X_(e){let r={streamToken:this.lastStreamToken,writes:e.map(e=>iM(this.serializer,e))};this.k_(r)}}class a0{}class a1 extends a0{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new q(z.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Wo(e,iP(r,n),i,o,a)).catch(e=>{throw"FirebaseError"===e.name?(e.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new q(z.UNKNOWN,e.toString())})}Jo(e,r,n,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Jo(e,iP(r,n),i,a,s,o)).catch(e=>{throw"FirebaseError"===e.name?(e.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new q(z.UNKNOWN,e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class a2{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,"Online"===e&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(j(r),this._a=!1):R("OnlineStateTracker",r)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}let a3="RemoteStore";class a4{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(e=>{n.enqueueAndForget(async()=>{sn(this)&&(R(a3,"Restarting streams for network reachability change."),await async function(e){e.Ia.add(4),await a6(e),e.Aa.set("Unknown"),e.Ia.delete(4),await a5(e)}(this))})}),this.Aa=new a2(n,i)}}async function a5(e){if(sn(e))for(let r of e.da)await r(!0)}async function a6(e){for(let r of e.da)await r(!1)}function a8(e,r){e.Ta.has(r.targetId)||(e.Ta.set(r.targetId,r),sr(e)?st(e):sb(e).x_()&&a9(e,r))}function a7(e,r){let n=sb(e);e.Ta.delete(r),n.x_()&&se(e,r),0===e.Ta.size&&(n.x_()?n.B_():sn(e)&&e.Aa.set("Unknown"))}function a9(e,r){if(e.Ra.$e(r.targetId),r.resumeToken.approximateByteSize()>0||r.snapshotVersion.compareTo(eI.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(r.targetId).size;r=r.withExpectedCount(n)}sb(e).H_(r)}function se(e,r){e.Ra.$e(r),sb(e).Y_(r)}function st(e){e.Ra=new iy({getRemoteKeysForTarget:r=>e.remoteSyncer.getRemoteKeysForTarget(r),Et:r=>e.Ta.get(r)||null,lt:()=>e.datastore.serializer.databaseId}),sb(e).start(),e.Aa.aa()}function sr(e){return sn(e)&&!sb(e).M_()&&e.Ta.size>0}function sn(e){return 0===e.Ia.size}async function si(e){e.Aa.set("Online")}async function so(e){e.Ta.forEach((r,n)=>{a9(e,r)})}async function sa(e,r){e.Ra=void 0,sr(e)?(e.Aa.la(r),st(e)):e.Aa.set("Unknown")}async function ss(e,r,n){if(e.Aa.set("Online"),r instanceof im&&2===r.state&&r.cause)try{await async function(e,r){let n=r.cause;for(let i of r.targetIds)e.Ta.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.Ta.delete(i),e.Ra.removeTarget(i))}(e,r)}catch(n){R(a3,"Failed to remove targets %s: %s ",r.targetIds.join(","),n),await su(e,n)}else if(r instanceof id?e.Ra.Ye(r):r instanceof ip?e.Ra.it(r):e.Ra.et(r),!n.isEqual(eI.min()))try{let r=await ah(e.localStore);n.compareTo(r)>=0&&await function(e,r){let n=e.Ra.Pt(r);return n.targetChanges.forEach((n,i)=>{if(n.resumeToken.approximateByteSize()>0){let o=e.Ta.get(i);o&&e.Ta.set(i,o.withResumeToken(n.resumeToken,r))}}),n.targetMismatches.forEach((r,n)=>{let i=e.Ta.get(r);if(!i)return;e.Ta.set(r,i.withResumeToken(re.EMPTY_BYTE_STRING,i.snapshotVersion)),se(e,r);let o=new iW(i.target,r,n,i.sequenceNumber);a9(e,o)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(r){R(a3,"Failed to raise snapshot:",r),await su(e,r)}}async function su(e,r,n){if(!eH(r))throw r;e.Ia.add(1),await a6(e),e.Aa.set("Offline"),n||(n=()=>ah(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{R(a3,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await a5(e)})}function sc(e,r){return r().catch(n=>su(e,n,r))}async function sl(e){var r;let n=sw(e),i=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:-1;for(;sn(r=e)&&r.Pa.length<10;)try{let r=await function(e,r){return e.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===r&&(r=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,r)))}(e.localStore,i);if(null===r){0===e.Pa.length&&n.B_();break}i=r.batchId,function(e,r){e.Pa.push(r);let n=sw(e);n.x_()&&n.Z_&&n.X_(r.mutations)}(e,r)}catch(r){await su(e,r)}sh(e)&&sd(e)}function sh(e){return sn(e)&&!sw(e).M_()&&e.Pa.length>0}function sd(e){sw(e).start()}async function sf(e){sw(e).na()}async function sp(e){let r=sw(e);for(let n of e.Pa)r.X_(n.mutations)}async function sm(e,r,n){let i=e.Pa.shift(),o=n8.from(i,r,n);await sc(e,()=>e.remoteSyncer.applySuccessfulWrite(o)),await sl(e)}async function sg(e,r){r&&sw(e).Z_&&await async function(e,r){var n;if(it(n=r.code)&&n!==z.ABORTED){let n=e.Pa.shift();sw(e).N_(),await sc(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,r)),await sl(e)}}(e,r),sh(e)&&sd(e)}async function sy(e,r){e.asyncQueue.verifyOperationInProgress(),R(a3,"RemoteStore received new credentials");let n=sn(e);e.Ia.add(3),await a6(e),n&&e.Aa.set("Unknown"),await e.remoteSyncer.handleCredentialChange(r),e.Ia.delete(3),await a5(e)}async function sv(e,r){r?(e.Ia.delete(2),await a5(e)):r||(e.Ia.add(2),await a6(e),e.Aa.set("Unknown"))}function sb(e){var r,n,i;return e.Va||(r=e.datastore,n=e.asyncQueue,i={Zo:si.bind(null,e),e_:so.bind(null,e),n_:sa.bind(null,e),J_:ss.bind(null,e)},r.ia(),e.Va=new aX(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i),e.da.push(async r=>{r?(e.Va.N_(),sr(e)?st(e):e.Aa.set("Unknown")):(await e.Va.stop(),e.Ra=void 0)})),e.Va}function sw(e){var r,n,i;return e.ma||(r=e.datastore,n=e.asyncQueue,i={Zo:()=>Promise.resolve(),e_:sf.bind(null,e),n_:sg.bind(null,e),ea:sp.bind(null,e),ta:sm.bind(null,e)},r.ia(),e.ma=new aZ(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i),e.da.push(async r=>{r?(e.ma.N_(),await sl(e)):(await e.ma.stop(),e.Pa.length>0&&(R(a3,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}class sS{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new H,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){let a=new sS(e,r,Date.now()+n,i,o);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new q(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sx(e,r){if(j("AsyncQueue",`${r}: ${e}`),eH(e))return new q(z.UNAVAILABLE,`${r}: ${e}`);throw e}class sE{static emptySet(e){return new sE(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ed.comparator(r.key,n.key):(e,r)=>ed.comparator(e.key,r.key),this.keyedMap=nT(),this.sortedSet=new t1(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){let r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){let r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof sE)||this.size!==e.size)return!1;let r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){let e=r.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){let e=[];return this.forEach(r=>{e.push(r.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,r){let n=new sE;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class sI{constructor(){this.fa=new t1(ed.comparator)}track(e){let r=e.doc.key,n=this.fa.get(r);n?0!==e.type&&3===n.type?this.fa=this.fa.insert(r,e):3===e.type&&1!==n.type?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.fa=this.fa.remove(r):1===e.type&&2===n.type?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):M(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){let e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class sT{constructor(e,r,n,i,o,a,s,u,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,o){let a=[];return r.forEach(e=>{a.push({type:0,doc:e})}),new sT(e,r,sE.emptySet(r),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ng(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++)if(r[e].type!==n[e].type||!r[e].doc.isEqual(n[e].doc))return!1;return!0}}class sk{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class s_{constructor(){this.queries=sA(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(e,r){let n=e.queries;e.queries=sA(),n.forEach((e,n)=>{for(let e of n.wa)e.onError(r)})}(this,new q(z.ABORTED,"Firestore shutting down"))}}function sA(){return new nx(e=>ny(e),ng)}async function sP(e,r){let n=3,i=r.query,o=e.queries.get(i);o?!o.Sa()&&r.ba()&&(n=2):(o=new sk,n=+!r.ba());try{switch(n){case 0:o.ya=await e.onListen(i,!0);break;case 1:o.ya=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(n){let e=sx(n,`Initialization of query '${nv(r.query)}' failed`);return void r.onError(e)}e.queries.set(i,o),o.wa.push(r),r.va(e.onlineState),o.ya&&r.Ca(o.ya)&&sL(e)}async function sO(e,r){let n=r.query,i=3,o=e.queries.get(n);if(o){let e=o.wa.indexOf(r);e>=0&&(o.wa.splice(e,1),0===o.wa.length?i=+!r.ba():!o.Sa()&&r.ba()&&(i=2))}switch(i){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function sC(e,r){let n=!1;for(let i of r){let r=i.query,o=e.queries.get(r);if(o){for(let e of o.wa)e.Ca(i)&&(n=!0);o.ya=i}}n&&sL(e)}function sN(e,r,n){let i=e.queries.get(r);if(i)for(let e of i.wa)e.onError(n);e.queries.delete(r)}function sL(e){e.Da.forEach(e=>{e.next()})}(y=g||(g={})).Fa="default",y.Cache="cache";class sD{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let n of e.docChanges)3!==n.type&&r.push(n);e=new sT(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){return!(e.fromCache&&this.ba())||(!this.options.ka||"Offline"===r)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===r)}Na(e){if(e.docChanges.length>0)return!0;let r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&!0===this.options.includeMetadataChanges}La(e){e=sT.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==g.Cache}}class sR{constructor(e,r){this.qa=e,this.byteLength=r}Qa(){return"metadata"in this.qa}}class sj{constructor(e){this.serializer=e}Qs(e){return iN(this.serializer,e)}$s(e){return e.metadata.exists?iU(this.serializer,e.document,!1):rV.newNoDocument(this.Qs(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return i_(e)}}class sF{constructor(e,r){this.$a=e,this.serializer=r,this.Ua=[],this.Ka=[],this.collectionGroups=new Set,this.progress=sU(e)}get queries(){return this.Ua}get documents(){return this.Ka}Wa(e){this.progress.bytesLoaded+=e.byteLength;let r=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Ua.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Ka.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++r;let n=ec.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.qa.document&&(this.Ka[this.Ka.length-1].document=e.qa.document,++r);return r!==this.progress.documentsLoaded?(this.progress.documentsLoaded=r,Object.assign({},this.progress)):null}Ga(e){let r=new Map,n=new sj(this.serializer);for(let i of e)if(i.metadata.queries){let e=n.Qs(i.metadata.name);for(let n of i.metadata.queries){let i=(r.get(n)||nO()).add(e);r.set(n,i)}}return r}async za(e){let r=await ab(e,new sj(this.serializer),this.Ka,this.$a.id),n=this.Ga(this.documents);for(let r of this.Ua)await aw(e,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ja:this.collectionGroups,Ja:r}}}function sU(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class sM{constructor(e){this.key=e}}class sG{constructor(e){this.key=e}}class sV{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=nO(),this.mutatedKeys=nO(),this.Xa=nS(e),this.eu=new sE(this.Xa)}get tu(){return this.Ha}nu(e,r){let n=r?r.ru:new sI,i=r?r.eu:this.eu,o=r?r.mutatedKeys:this.mutatedKeys,a=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((e,r)=>{let l=i.get(e),h=nb(this.query,r)?r:null,d=!!l&&this.mutatedKeys.has(l.key),f=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?d!==f&&(n.track({type:3,doc:h}),p=!0):this.iu(l,h)||(n.track({type:2,doc:h}),p=!0,(u&&this.Xa(h,u)>0||c&&0>this.Xa(h,c))&&(s=!0)):!l&&h?(n.track({type:0,doc:h}),p=!0):l&&!h&&(n.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(a=a.add(h),o=f?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))}),null!==this.query.limit)for(;a.size>this.query.limit;){let e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),o=o.delete(e.key),n.track({type:1,doc:e})}return{eu:a,ru:n,Ds:s,mutatedKeys:o}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){let o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let a=e.ru.pa();a.sort((e,r)=>(function(e,r){let n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return M(20277,{At:e})}};return n(e)-n(r)})(e.type,r.type)||this.Xa(e.doc,r.doc)),this.su(n),i=null!=i&&i;let s=r&&!i?this.ou():[],u=0===this.Za.size&&this.current&&!i?1:0,c=u!==this.Ya;return(this.Ya=u,0!==a.length||c)?{snapshot:new sT(this.query,e.eu,o,a,e.mutatedKeys,0===u,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:s}:{_u:s}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({eu:this.eu,ru:new sI,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=nO(),this.eu.forEach(e=>{this.au(e.key)&&(this.Za=this.Za.add(e.key))});let r=[];return e.forEach(e=>{this.Za.has(e)||r.push(new sG(e))}),this.Za.forEach(n=>{e.has(n)||r.push(new sM(n))}),r}uu(e){this.Ha=e.qs,this.Za=nO();let r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return sT.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}let sB="SyncEngine";class sz{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class sq{constructor(e){this.key=e,this.lu=!1}}class sH{constructor(e,r,n,i,o,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new nx(e=>ny(e),ng),this.Tu=new Map,this.Iu=new Set,this.du=new t1(ed.comparator),this.Eu=new Map,this.Au=new oX,this.Ru={},this.Vu=new Map,this.mu=oC.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function s$(e,r,n=!0){let i,o=uf(e),a=o.Pu.get(r);return a?(o.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.cu()):i=await sW(o,r,n,!0),i}async function sK(e,r){let n=uf(e);await sW(n,r,!0,!1)}async function sW(e,r,n,i){let o,a=await af(e.localStore,nh(r)),s=a.targetId,u=e.sharedClientState.addLocalQueryTarget(s,n);return i&&(o=await sQ(e,r,s,"current"===u,a.resumeToken)),e.isPrimaryClient&&n&&a8(e.remoteStore,a),o}async function sQ(e,r,n,i,o){e.gu=(r,n,i)=>(async function(e,r,n,i){let o=r.view.nu(n);o.Ds&&(o=await am(e.localStore,r.query,!1).then(({documents:e})=>r.view.nu(e,o)));let a=i&&i.targetChanges.get(r.targetId),s=i&&null!=i.targetMismatches.get(r.targetId),u=r.view.applyChanges(o,e.isPrimaryClient,a,s);return s9(e,r.targetId,u._u),u.snapshot})(e,r,n,i);let a=await am(e.localStore,r,!0),s=new sV(r,a.qs),u=s.nu(a.documents),c=ih.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,o),l=s.applyChanges(u,e.isPrimaryClient,c);s9(e,n,l._u);let h=new sz(r,n,s);return e.Pu.set(r,h),e.Tu.has(n)?e.Tu.get(n).push(r):e.Tu.set(n,[r]),l.snapshot}async function sJ(e,r,n){let i=e.Pu.get(r),o=e.Tu.get(i.targetId);if(o.length>1)return e.Tu.set(i.targetId,o.filter(e=>!ng(e,r))),void e.Pu.delete(r);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(i.targetId),e.sharedClientState.isActiveQueryTarget(i.targetId)||await ap(e.localStore,i.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(i.targetId),n&&a7(e.remoteStore,i.targetId),s8(e,i.targetId)}).catch(eF)):(s8(e,i.targetId),await ap(e.localStore,i.targetId,!0))}async function sY(e,r){let n=e.Pu.get(r),i=e.Tu.get(n.targetId);e.isPrimaryClient&&1===i.length&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),a7(e.remoteStore,n.targetId))}async function sX(e,r,n){let i=up(e);try{var o;let e,a=await function(e,r){let n,i,o=eE.now(),a=r.reduce((e,r)=>e.add(r.key),nO());return e.persistence.runTransaction("Locally write mutations","readwrite",s=>{let u=nE,c=nO();return e.Os.getEntries(s,a).next(e=>{(u=e).forEach((e,r)=>{r.isValidDocument()||(c=c.add(e))})}).next(()=>e.localDocuments.getOverlayedDocuments(s,u)).next(i=>{n=i;let a=[];for(let e of r){let r=function(e,r){let n=null;for(let i of e.fieldTransforms){let e=r.data.field(i.field),o=nj(i.transform,e||null);null!=o&&(null===n&&(n=rG.empty()),n.set(i.field,o))}return n||null}(e,n.get(e.key).overlayedDocument);null!=r&&a.push(new n0(e.key,r,function e(r){let n=[];return tX(r.fields,(r,i)=>{let o=new eh([r]);if(rL(i)){let r=e(i.mapValue).fields;if(0===r.length)n.push(o);else for(let e of r)n.push(o.child(e))}else n.push(o)}),new t8(n)}(r.value.mapValue),nK.exists(!0)))}return e.mutationQueue.addMutationBatch(s,o,a,r)}).next(r=>{i=r;let o=r.applyToLocalDocumentSet(n,c);return e.documentOverlayCache.saveOverlays(s,r.batchId,o)})}).then(()=>({batchId:i.batchId,changes:nk(n)}))}(i.localStore,r);i.sharedClientState.addPendingMutation(a.batchId),o=a.batchId,(e=i.Ru[i.currentUser.toKey()])||(e=new t1(en)),e=e.insert(o,n),i.Ru[i.currentUser.toKey()]=e,await ut(i,a.changes),await sl(i.remoteStore)}catch(r){let e=sx(r,"Failed to persist write");n.reject(e)}}async function sZ(e,r){try{let n=await function(e,r){let n=r.snapshotVersion,i=e.Fs;return e.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=e.Os.newChangeBuffer({trackRemovals:!0});i=e.Fs;let s=[];r.targetChanges.forEach((a,u)=>{var c;let l=i.get(u);if(!l)return;s.push(e.hi.removeMatchingKeys(o,a.removedDocuments,u).next(()=>e.hi.addMatchingKeys(o,a.addedDocuments,u)));let h=l.withSequenceNumber(o.currentSequenceNumber);null!==r.targetMismatches.get(u)?h=h.withResumeToken(re.EMPTY_BYTE_STRING,eI.min()).withLastLimboFreeSnapshotVersion(eI.min()):a.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(a.resumeToken,n)),i=i.insert(u,h),c=h,(0===l.resumeToken.approximateByteSize()||c.snapshotVersion.toMicroseconds()-l.snapshotVersion.toMicroseconds()>=3e8||a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size>0)&&s.push(e.hi.updateTargetData(o,h))});let u=nE,c=nO();if(r.documentUpdates.forEach(n=>{r.resolvedLimboDocuments.has(n)&&s.push(e.persistence.referenceDelegate.updateLimboDocument(o,n))}),s.push(ad(o,a,r.documentUpdates).next(e=>{u=e.Ls,c=e.ks})),!n.isEqual(eI.min())){let r=e.hi.getLastRemoteSnapshotVersion(o).next(r=>e.hi.setTargetsMetadata(o,o.currentSequenceNumber,n));s.push(r)}return eU.waitFor(s).next(()=>a.apply(o)).next(()=>e.localDocuments.getLocalViewOfDocuments(o,u,c)).next(()=>u)}).then(r=>(e.Fs=i,r))}(e.localStore,r);r.targetChanges.forEach((r,n)=>{let i=e.Eu.get(n);i&&(V(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?i.lu=!0:r.modifiedDocuments.size>0?V(i.lu,14607):r.removedDocuments.size>0&&(V(i.lu,42227),i.lu=!1))}),await ut(e,n,r)}catch(e){await eF(e)}}function s0(e,r,n){var i;if(e.isPrimaryClient&&0===n||!e.isPrimaryClient&&1===n){let n,o=[];e.Pu.forEach((e,n)=>{let i=n.view.va(r);i.snapshot&&o.push(i.snapshot)}),(i=e.eventManager).onlineState=r,n=!1,i.queries.forEach((e,i)=>{for(let e of i.wa)e.va(r)&&(n=!0)}),n&&sL(i),o.length&&e.hu.J_(o),e.onlineState=r,e.isPrimaryClient&&e.sharedClientState.setOnlineState(r)}}async function s1(e,r,n){e.sharedClientState.updateQueryState(r,"rejected",n);let i=e.Eu.get(r),o=i&&i.key;if(o){let n=new t1(ed.comparator);n=n.insert(o,rV.newNoDocument(o,eI.min()));let i=nO().add(o),a=new il(eI.min(),new Map,new t1(en),n,i);await sZ(e,a),e.du=e.du.remove(o),e.Eu.delete(r),ue(e)}else await ap(e.localStore,r,!1).then(()=>s8(e,r,n)).catch(eF)}async function s2(e,r){var n;let i=r.batch.batchId;try{let o=await (n=e.localStore,n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let i=r.batch.keys(),o=n.Os.newChangeBuffer({trackRemovals:!0});return(function(e,r,n,i){let o=n.batch,a=o.keys(),s=eU.resolve();return a.forEach(e=>{s=s.next(()=>i.getEntry(r,e)).next(r=>{let a=n.docVersions.get(e);V(null!==a,48541),0>r.version.compareTo(a)&&(o.applyToRemoteDocument(r,n),r.isValidDocument()&&(r.setReadTime(n.commitVersion),i.addEntry(r)))})}),s.next(()=>e.mutationQueue.removeMutationBatch(r,o))})(n,e,r,o).next(()=>o.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,r.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let r=nO();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(r=r.add(e.batch.mutations[n].key));return r}(r))).next(()=>n.localDocuments.getDocuments(e,i))}));s6(e,i,null),s5(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await ut(e,o)}catch(e){await eF(e)}}async function s3(e,r,n){var i;try{let o=await (i=e.localStore,i.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let n;return i.mutationQueue.lookupMutationBatch(e,r).next(r=>(V(null!==r,37113),n=r.keys(),i.mutationQueue.removeMutationBatch(e,r))).next(()=>i.mutationQueue.performConsistencyCheck(e)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(e,n,r)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,n)).next(()=>i.localDocuments.getDocuments(e,n))}));s6(e,r,n),s5(e,r),e.sharedClientState.updateMutationState(r,"rejected",n),await ut(e,o)}catch(e){await eF(e)}}async function s4(e,r){var n;sn(e.remoteStore)||R(sB,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let i=await (n=e.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>n.mutationQueue.getHighestUnacknowledgedBatchId(e));if(-1===i)return void r.resolve();let o=e.Vu.get(i)||[];o.push(r),e.Vu.set(i,o)}catch(n){let e=sx(n,"Initialization of waitForPendingWrites() operation failed");r.reject(e)}}function s5(e,r){(e.Vu.get(r)||[]).forEach(e=>{e.resolve()}),e.Vu.delete(r)}function s6(e,r,n){let i=e.Ru[e.currentUser.toKey()];if(i){let o=i.get(r);o&&(n?o.reject(n):o.resolve(),i=i.remove(r)),e.Ru[e.currentUser.toKey()]=i}}function s8(e,r,n=null){for(let i of(e.sharedClientState.removeLocalQueryTarget(r),e.Tu.get(r)))e.Pu.delete(i),n&&e.hu.pu(i,n);e.Tu.delete(r),e.isPrimaryClient&&e.Au.zr(r).forEach(r=>{e.Au.containsKey(r)||s7(e,r)})}function s7(e,r){e.Iu.delete(r.path.canonicalString());let n=e.du.get(r);null!==n&&(a7(e.remoteStore,n),e.du=e.du.remove(r),e.Eu.delete(n),ue(e))}function s9(e,r,n){for(let i of n)i instanceof sM?(e.Au.addReference(i.key,r),function(e,r){let n=r.key,i=n.path.canonicalString();e.du.get(n)||e.Iu.has(i)||(R(sB,"New document in limbo: "+n),e.Iu.add(i),ue(e))}(e,i)):i instanceof sG?(R(sB,"Document no longer in limbo: "+i.key),e.Au.removeReference(i.key,r),e.Au.containsKey(i.key)||s7(e,i.key)):M(19791,{yu:i})}function ue(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){let r=e.Iu.values().next().value;e.Iu.delete(r);let n=new ed(ec.fromString(r)),i=e.mu.next();e.Eu.set(i,new sq(n)),e.du=e.du.insert(n,i),a8(e.remoteStore,new iW(nh(ns(n.path)),i,"TargetPurposeLimboResolution",eZ.ue))}}async function ut(e,r,n){let i=[],o=[],a=[];e.Pu.isEmpty()||(e.Pu.forEach((s,u)=>{a.push(e.gu(u,r,n).then(r=>{var a;if((r||n)&&e.isPrimaryClient){let i=r?!r.fromCache:null==(a=null==n?void 0:n.targetChanges.get(u.targetId))?void 0:a.current;e.sharedClientState.updateQueryState(u.targetId,i?"current":"not-current")}if(r){i.push(r);let e=ao.Es(u.targetId,r);o.push(e)}}))}),await Promise.all(a),e.hu.J_(i),await async function(e,r){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",n=>eU.forEach(r,r=>eU.forEach(r.Is,i=>e.persistence.referenceDelegate.addReference(n,r.targetId,i)).next(()=>eU.forEach(r.ds,i=>e.persistence.referenceDelegate.removeReference(n,r.targetId,i)))))}catch(e){if(!eH(e))throw e;R(au,"Failed to update sequence numbers: "+e)}for(let n of r){let r=n.targetId;if(!n.fromCache){let n=e.Fs.get(r),i=n.snapshotVersion,o=n.withLastLimboFreeSnapshotVersion(i);e.Fs=e.Fs.insert(r,o)}}}(e.localStore,o))}async function ur(e,r){if(!e.currentUser.isEqual(r)){R(sB,"User change. New user:",r.toKey());let n=await al(e.localStore,r);e.currentUser=r,e.Vu.forEach(e=>{e.forEach(e=>{e.reject(new q(z.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Vu.clear(),e.sharedClientState.handleUserChange(r,n.removedBatchIds,n.addedBatchIds),await ut(e,n.Bs)}}function un(e,r){let n=e.Eu.get(r);if(n&&n.lu)return nO().add(n.key);{let n=nO(),i=e.Tu.get(r);if(!i)return n;for(let r of i){let i=e.Pu.get(r);n=n.unionWith(i.view.tu)}return n}}async function ui(e,r){let n=await am(e.localStore,r.query,!0),i=r.view.uu(n);return e.isPrimaryClient&&s9(e,r.targetId,i._u),i}async function uo(e,r){return ay(e.localStore,r).then(r=>ut(e,r))}async function ua(e,r,n,i){var o;let a=await function(e,r){let n=e.mutationQueue;return e.persistence.runTransaction("Lookup mutation documents","readonly",i=>n.Xn(i,r).next(r=>r?e.localDocuments.getDocuments(i,r):eU.resolve(null)))}(e.localStore,r);null!==a?("pending"===n?await sl(e.remoteStore):"acknowledged"===n||"rejected"===n?(s6(e,r,i||null),s5(e,r),o=e.localStore,o.mutationQueue.rr(r)):M(6720,"Unknown batchState",{wu:n}),await ut(e,a)):R(sB,"Cannot apply mutation batch with id: "+r)}async function us(e,r){if(uf(e),up(e),!0===r&&!0!==e.fu){let r=e.sharedClientState.getAllActiveQueryTargets(),n=await uu(e,r.toArray());for(let r of(e.fu=!0,await sv(e.remoteStore,!0),n))a8(e.remoteStore,r)}else if(!1===r&&!1!==e.fu){let r=[],n=Promise.resolve();e.Tu.forEach((i,o)=>{e.sharedClientState.isLocalQueryTarget(o)?r.push(o):n=n.then(()=>(s8(e,o),ap(e.localStore,o,!0))),a7(e.remoteStore,o)}),await n,await uu(e,r),e.Eu.forEach((r,n)=>{a7(e.remoteStore,n)}),e.Au.jr(),e.Eu=new Map,e.du=new t1(ed.comparator),e.fu=!1,await sv(e.remoteStore,!1)}}async function uu(e,r,n){let i=[],o=[];for(let n of r){let r,a=e.Tu.get(n);if(a&&0!==a.length)for(let n of(r=await af(e.localStore,nh(a[0])),a)){let r=e.Pu.get(n),i=await ui(e,r);i.snapshot&&o.push(i.snapshot)}else{let i=await ag(e.localStore,n);r=await af(e.localStore,i),await sQ(e,uc(i),n,!1,r.resumeToken)}i.push(r)}return e.hu.J_(o),i}function uc(e){var r,n,i,o,a;return r=e.path,n=e.collectionGroup,i=e.orderBy,o=e.filters,a=e.limit,new na(r,n,i,o,a,"F",e.startAt,e.endAt)}function ul(e){return e.localStore.persistence.Ps()}async function uh(e,r,n,i){if(e.fu)return void R(sB,"Ignoring unexpected query state notification.");let o=e.Tu.get(r);if(o&&o.length>0)switch(n){case"current":case"not-current":{let i=await ay(e.localStore,nw(o[0])),a=il.createSynthesizedRemoteEventForCurrentChange(r,"current"===n,re.EMPTY_BYTE_STRING);await ut(e,i,a);break}case"rejected":await ap(e.localStore,r,!0),s8(e,r,i);break;default:M(64155,n)}}async function ud(e,r,n){let i=uf(e);if(i.fu){for(let e of r){if(i.Tu.has(e)&&i.sharedClientState.isActiveQueryTarget(e)){R(sB,"Adding an already active target "+e);continue}let r=await ag(i.localStore,e),n=await af(i.localStore,r);await sQ(i,uc(r),n.targetId,!1,n.resumeToken),a8(i.remoteStore,n)}for(let e of n)i.Tu.has(e)&&await ap(i.localStore,e,!1).then(()=>{a7(i.remoteStore,e),s8(i,e)}).catch(eF)}}function uf(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=sZ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=un.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=s1.bind(null,e),e.hu.J_=sC.bind(null,e.eventManager),e.hu.pu=sN.bind(null,e.eventManager),e}function up(e){return e.remoteStore.remoteSyncer.applySuccessfulWrite=s2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s3.bind(null,e),e}class um{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=aW(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){var r,n;return r=this.persistence,n=new as,new ac(r,n,e.initialUser,this.serializer)}Du(e){return new o4(o6.Vi,this.serializer)}bu(e){return new aD}async terminate(){var e,r;null==(e=this.gcScheduler)||e.stop(),null==(r=this.indexBackfillerScheduler)||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}um.provider={build:()=>new um};class ug extends um{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){return V(this.persistence.referenceDelegate instanceof o8,46915),new oF(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,r)}Du(e){let r=void 0!==this.cacheSizeBytes?oT.withCacheSize(this.cacheSizeBytes):oT.DEFAULT;return new o4(e=>o8.Vi(e,r),this.serializer)}}class uy extends um{constructor(e,r,n){super(),this.Mu=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await up(this.Mu.syncEngine),await sl(this.Mu.remoteStore),await this.persistence.ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){var r,n;return r=this.persistence,n=new as,new ac(r,n,e.initialUser,this.serializer)}Cu(e,r){return new oF(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,r)}Fu(e,r){let n=new eX(r,this.persistence);return new eY(e.asyncQueue,n)}Du(e){let r=ai(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?oT.withCacheSize(this.cacheSizeBytes):oT.DEFAULT;return new an(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,a$(),aK(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new aD}}class uv extends uy{constructor(e,r){super(e,r,!1),this.Mu=e,this.cacheSizeBytes=r,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let r=this.Mu.syncEngine;this.sharedClientState instanceof aL&&(this.sharedClientState.syncEngine={Do:ua.bind(null,r),vo:uh.bind(null,r),Co:ud.bind(null,r),Ps:ul.bind(null,r),bo:uo.bind(null,r)},await this.sharedClientState.start()),await this.persistence.ji(async e=>{await us(this.Mu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}bu(e){let r=a$();if(!aL.C(r))throw new q(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=ai(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new aL(r,e.asyncQueue,n,e.clientId,e.initialUser)}}class ub{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>s0(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=ur.bind(null,this.syncEngine),await sv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new s_}createDatastore(e){var r;let n=aW(e.databaseInfo.databaseId),i=new aH(e.databaseInfo);return r=e.authCredentials,new a1(r,e.appCheckCredentials,i,n)}createRemoteStore(e){var r,n;return r=this.localStore,n=this.datastore,new a4(r,n,e.asyncQueue,e=>s0(this.syncEngine,e,0),aF.C()?new aF:new aR)}createSyncEngine(e,r){return function(e,r,n,i,o,a,s){let u=new sH(e,r,n,i,o,a);return s&&(u.fu=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(e){R(a3,"RemoteStore shutting down."),e.Ia.add(5),await a6(e),e.Ea.shutdown(),e.Aa.set("Unknown")}(this.remoteStore),null==(e=this.datastore)||e.terminate(),null==(r=this.eventManager)||r.terminate()}}function uw(e,r=10240){let n=0;return{async read(){if(n<e.byteLength){let i={value:e.slice(n,n+r),done:!1};return n+=r,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}ub.provider={build:()=>new ub};class uS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):j("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}class ux{constructor(e,r){this.Nu=e,this.serializer=r,this.metadata=new H,this.buffer=new Uint8Array,this.Bu=new TextDecoder("utf-8"),this.Lu().then(e=>{e&&e.Qa()?this.metadata.resolve(e.qa.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==e?void 0:e.qa)}`))},e=>this.metadata.reject(e))}close(){return this.Nu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.Lu()}async Lu(){let e=await this.ku();if(null===e)return null;let r=this.Bu.decode(e),n=Number(r);return isNaN(n)&&this.qu(`length string (${r}) is not valid number`),new sR(JSON.parse(await this.Qu(n)),e.length+n)}$u(){return this.buffer.findIndex(e=>123===e)}async ku(){for(;0>this.$u()&&!await this.Uu(););if(0===this.buffer.length)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let r=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),r}async Qu(e){for(;this.buffer.length<e;)await this.Uu()&&this.qu("Reached the end of bundle when more is expected.");let r=this.Bu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),r}qu(e){throw this.Nu.cancel(),Error(`Invalid bundle format: ${e}`)}async Uu(){let e=await this.Nu.read();if(!e.done){let r=new Uint8Array(this.buffer.length+e.value.length);r.set(this.buffer),r.set(e.value,this.buffer.length),this.buffer=r}return e.done}}class uE{constructor(e,r){this.bundleData=e,this.serializer=r,this.cursor=0,this.elements=[];let n=this.Su();if(!n||!n.Qa())throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(null==n?void 0:n.qa)}`);this.metadata=n;do null!==(n=this.Su())&&this.elements.push(n);while(null!==n)}getMetadata(){return this.metadata}Ku(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.ku();return new sR(JSON.parse(this.Qu(e)),e)}Qu(e){if(this.cursor+e>this.bundleData.length)throw new q(z.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}ku(){let e=this.cursor,r=this.cursor;for(;r<this.bundleData.length;){if("{"===this.bundleData[r]){if(r===e)throw Error("First character is a bracket and not a number");return this.cursor=r,Number(this.bundleData.slice(e,r))}r++}throw Error("Reached the end of bundle when more is expected.")}}class uI{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new q(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let r=await async function(e,r){let n={documents:r.map(r=>iC(e.serializer,r))},i=await e.Jo("BatchGetDocuments",e.serializer.databaseId,ec.emptyPath(),n,r.length),o=new Map;i.forEach(r=>{var n;let i=(n=e.serializer,"found"in r?function(e,r){V(!!r.found,43571),r.found.name,r.found.updateTime;let n=iN(e,r.found.name),i=i_(r.found.updateTime),o=r.found.createTime?i_(r.found.createTime):eI.min(),a=new rG({mapValue:{fields:r.found.fields}});return rV.newFoundDocument(n,i,o,a)}(n,r):"missing"in r?function(e,r){V(!!r.missing,3894),V(!!r.readTime,22933);let n=iN(e,r.missing),i=i_(r.readTime);return rV.newNoDocument(n,i)}(n,r):M(7234,{result:r}));o.set(i.key.toString(),i)});let a=[];return r.forEach(e=>{let r=o.get(e.toString());V(!!r,55234,{key:e}),a.push(r)}),a}(this.datastore,e);return r.forEach(e=>this.recordVersion(e)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new n4(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((e,r)=>{let n=ed.fromPath(r);this.mutations.push(new n5(n,this.precondition(n)))}),await async function(e,r){let n={writes:r.map(r=>iM(e.serializer,r))};await e.Wo("Commit",e.serializer.databaseId,ec.emptyPath(),n)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw M(50498,{Wu:e.constructor.name});r=eI.min()}let n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new q(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){let r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(eI.min())?nK.exists(!1):nK.updateTime(r):nK.none()}preconditionForUpdate(e){let r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(eI.min()))throw new q(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return nK.updateTime(r)}return nK.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class uT{constructor(e,r,n,i,o){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=i,this.deferred=o,this.Gu=n.maxAttempts,this.F_=new aQ(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{let e=new uI(this.datastore),r=this.Ju(e);r&&r.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(e=>{this.Hu(e)}))}).catch(e=>{this.Hu(e)})})}Ju(e){try{let r=this.updateFunction(e);return!e0(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if("FirebaseError"===e.name){let r=e.code;return"aborted"===r||"failed-precondition"===r||"already-exists"===r||!it(r)}return!1}}let uk="FirestoreClient";class u_{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=O.UNAUTHENTICATED,this.clientId=er.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async e=>{R(uk,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(R(uk,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new H;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=sx(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function uA(e,r){e.asyncQueue.verifyOperationInProgress(),R(uk,"Initializing OfflineComponentProvider");let n=e.configuration;await r.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async e=>{i.isEqual(e)||(await al(r.localStore,e),i=e)}),r.persistence.setDatabaseDeletedListener(()=>{F("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{R("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(e=>{F("Terminating Firestore due to IndexedDb database deletion failed",e)})}),e._offlineComponents=r}async function uP(e,r){e.asyncQueue.verifyOperationInProgress();let n=await uO(e);R(uk,"Initializing OnlineComponentProvider"),await r.initialize(n,e.configuration),e.setCredentialChangeListener(e=>sy(r.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>sy(r.remoteStore,n)),e._onlineComponents=r}async function uO(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){R(uk,"Using user provided OfflineComponentProvider");try{await uA(e,e._uninitializedComponentsProvider._offline)}catch(r){if(!("FirebaseError"===r.name?r.code===z.FAILED_PRECONDITION||r.code===z.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code))throw r;F("Error using user provided cache. Falling back to memory cache: "+r),await uA(e,new um)}}else R(uk,"Using default OfflineComponentProvider"),await uA(e,new ug(void 0));return e._offlineComponents}async function uC(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(R(uk,"Using user provided OnlineComponentProvider"),await uP(e,e._uninitializedComponentsProvider._online)):(R(uk,"Using default OnlineComponentProvider"),await uP(e,new ub))),e._onlineComponents}function uN(e){return uO(e).then(e=>e.persistence)}function uL(e){return uO(e).then(e=>e.localStore)}function uD(e){return uC(e).then(e=>e.remoteStore)}function uR(e){return uC(e).then(e=>e.syncEngine)}function uj(e){return uC(e).then(e=>e.datastore)}async function uF(e){let r=await uC(e),n=r.eventManager;return n.onListen=s$.bind(null,r.syncEngine),n.onUnlisten=sJ.bind(null,r.syncEngine),n.onFirstRemoteStoreListen=sK.bind(null,r.syncEngine),n.onLastRemoteStoreUnlisten=sY.bind(null,r.syncEngine),n}function uU(e,r,n={}){let i=new H;return e.asyncQueue.enqueueAndForget(async()=>(function(e,r,n,i,o){let a=new uS({next:u=>{a.Ou(),r.enqueueAndForget(()=>sO(e,s));let c=u.docs.has(n);!c&&u.fromCache?o.reject(new q(z.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&u.fromCache&&i&&"server"===i.source?o.reject(new q(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(u)},error:e=>o.reject(e)}),s=new sD(ns(n.path),a,{includeMetadataChanges:!0,ka:!0});return sP(e,s)})(await uF(e),e.asyncQueue,r,n,i)),i.promise}function uM(e,r,n={}){let i=new H;return e.asyncQueue.enqueueAndForget(async()=>(function(e,r,n,i,o){let a=new uS({next:n=>{a.Ou(),r.enqueueAndForget(()=>sO(e,s)),n.fromCache&&"server"===i.source?o.reject(new q(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(n)},error:e=>o.reject(e)}),s=new sD(n,a,{includeMetadataChanges:!0,ka:!0});return sP(e,s)})(await uF(e),e.asyncQueue,r,n,i)),i.promise}function uG(e){let r={};return void 0!==e.timeoutSeconds&&(r.timeoutSeconds=e.timeoutSeconds),r}let uV=new Map,uB="firestore.googleapis.com";class uz{constructor(e){var r,n;if(void 0===e.host){if(void 0!==e.ssl)throw new q(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uB,this.ssl=!0}else this.host=e.host,this.ssl=null==(r=e.ssl)||r;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ep("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uG(null!=(n=e.experimentalLongPollingOptions)?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var r,n;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(r=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,r.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uq{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uz({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new q(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uz(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new K;switch(e.type){case"firstParty":return new Y(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new q(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let r=uV.get(e);r&&(R("ComponentProvider","Removing Datastore"),uV.delete(e),r.terminate())}(this),Promise.resolve()}}function uH(e,r,n,i={}){var o;e=eb(e,uq);let a=(0,S.zJ)(r),s=e._getSettings(),u=Object.assign(Object.assign({},s),{emulatorOptions:e._getEmulatorOptions()}),c=`${r}:${n}`;a&&((0,S.gE)(`https://${c}`),(0,S.P1)("Firestore",!0)),s.host!==uB&&s.host!==c&&F("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=Object.assign(Object.assign({},s),{host:c,ssl:a,emulatorOptions:i});if(!(0,S.bD)(l,u)&&(e._setSettings(l),i.mockUserToken)){let r,n;if("string"==typeof i.mockUserToken)r=i.mockUserToken,n=O.MOCK_USER;else{r=(0,S.Fy)(i.mockUserToken,null==(o=e._app)?void 0:o.options.projectId);let a=i.mockUserToken.sub||i.mockUserToken.user_id;if(!a)throw new q(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new O(a)}e._authCredentials=new W(new $(r,n))}}class u${constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new u$(this.firestore,e,this._query)}}class uK{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uW(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new uK(this.firestore,e,this._key)}toJSON(){return{type:uK._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ex(r,uK._jsonSchema))return new uK(e,n||null,new ed(ec.fromString(r.referencePath)))}}uK._jsonSchemaVersion="firestore/documentReference/1.0",uK._jsonSchema={type:eS("string",uK._jsonSchemaVersion),referencePath:eS("string")};class uW extends u${constructor(e,r,n){super(e,r,ns(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new uK(this.firestore,null,new ed(e))}withConverter(e){return new uW(this.firestore,e,this._path)}}function uQ(e,r,...n){if(e=(0,S.Ku)(e),ef("collection","path",r),e instanceof uq){let i=ec.fromString(r,...n);return eg(i),new uW(e,null,i)}{if(!(e instanceof uK||e instanceof uW))throw new q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(ec.fromString(r,...n));return eg(i),new uW(e.firestore,null,i)}}function uJ(e,r){if(e=eb(e,uq),ef("collectionGroup","collection id",r),r.indexOf("/")>=0)throw new q(z.INVALID_ARGUMENT,`Invalid collection ID '${r}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new u$(e,null,new na(ec.emptyPath(),r))}function uY(e,r,...n){if(e=(0,S.Ku)(e),1==arguments.length&&(r=er.newId()),ef("doc","path",r),e instanceof uq){let i=ec.fromString(r,...n);return em(i),new uK(e,null,new ed(i))}{if(!(e instanceof uK||e instanceof uW))throw new q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(ec.fromString(r,...n));return em(i),new uK(e.firestore,e instanceof uW?e.converter:null,new ed(i))}}function uX(e,r){return e=(0,S.Ku)(e),r=(0,S.Ku)(r),(e instanceof uK||e instanceof uW)&&(r instanceof uK||r instanceof uW)&&e.firestore===r.firestore&&e.path===r.path&&e.converter===r.converter}function uZ(e,r){return e=(0,S.Ku)(e),r=(0,S.Ku)(r),e instanceof u$&&r instanceof u$&&e.firestore===r.firestore&&ng(e._query,r._query)&&e.converter===r.converter}let u0="AsyncQueue";class u1{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new aQ(this,"async_queue_retry"),this.oc=()=>{let e=aK();e&&R(u0,"Visibility state changed to "+e.visibilityState),this.F_.y_()},this._c=e;let r=aK();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let r=aK();r&&"function"==typeof r.removeEventListener&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let r=new H;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!eH(e))throw e;R(u0,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let r=this._c.then(()=>(this.nc=!0,e().catch(e=>{throw this.tc=e,this.nc=!1,j("INTERNAL UNHANDLED ERROR: ",u2(e)),e}).then(e=>(this.nc=!1,e))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);let i=sS.createAndSchedule(this,e,r,n,e=>this.lc(e));return this.ec.push(i),i}ac(){this.tc&&M(47125,{hc:u2(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{for(let r of(this.ec.sort((e,r)=>e.targetTimeMs-r.targetTimeMs),this.ec))if(r.skipDelay(),"all"!==e&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let r=this.ec.indexOf(e);this.ec.splice(r,1)}}function u2(e){let r=e.message||"";return e.stack&&(r=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),r}function u3(e){if("object"!=typeof e||null===e)return!1;for(let r of["next","error","complete"])if(r in e&&"function"==typeof e[r])return!0;return!1}class u4{constructor(){this._progressObserver={},this._taskCompletionResolver=new H,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,r,n){this._progressObserver={next:e,error:r,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,r){return this._taskCompletionResolver.promise.then(e,r)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}let u5=-1;class u6 extends uq{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new u1,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new u1(e),this._firestoreClient=void 0,await e}}}function u8(e,r,n){n||(n=rf);let i=(0,v.j6)(e,"firestore");if(i.isInitialized(n)){let e=i.getImmediate({identifier:n}),o=i.getOptions(n);if((0,S.bD)(o,r))return e;throw new q(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==r.cacheSizeBytes&&void 0!==r.localCache)throw new q(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==r.cacheSizeBytes&&-1!==r.cacheSizeBytes&&r.cacheSizeBytes<1048576)throw new q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.host&&(0,S.zJ)(r.host)&&(0,S.gE)(r.host),i.initialize({options:r,instanceIdentifier:n})}function u7(e,r){let n="object"==typeof e?e:(0,v.Sx)(),i="string"==typeof e?e:r||rf,o=(0,v.j6)(n,"firestore").getImmediate({identifier:i});if(!o._initialized){let e=(0,S.yU)("firestore");e&&uH(o,...e)}return o}function u9(e){if(e._terminated)throw new q(z.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||ce(e),e._firestoreClient}function ce(e){var r,n,i,o,a;let s=e._freezeSettings(),u=(o=e._databaseId,a=(null==(r=e._app)?void 0:r.options.appId)||"",new rd(o,a,e._persistenceKey,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,uG(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator));e._componentsProvider||(null==(n=s.localCache)?void 0:n._offlineComponentProvider)&&(null==(i=s.localCache)?void 0:i._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new u_(e._authCredentials,e._appCheckCredentials,e._queue,u,e._componentsProvider&&function(e){let r=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(r),_online:r}}(e._componentsProvider))}function ct(e,r){F("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=e._freezeSettings();return cn(e,ub.provider,{build:e=>new uy(e,n.cacheSizeBytes,null==r?void 0:r.forceOwnership)}),Promise.resolve()}async function cr(e){F("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=e._freezeSettings();cn(e,ub.provider,{build:e=>new uv(e,r.cacheSizeBytes)})}function cn(e,r,n){if((e=eb(e,u6))._firestoreClient||e._terminated)throw new q(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new q(z.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:r,_offline:n},ce(e)}function ci(e){if(e._initialized&&!e._terminated)throw new q(z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let r=new H;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!eV.C())return Promise.resolve();await eV.delete(e+ar)}(ai(e._databaseId,e._persistenceKey)),r.resolve()}catch(e){r.reject(e)}}),r.promise}function co(e){var r=u9(e=eb(e,u6));let n=new H;return r.asyncQueue.enqueueAndForget(async()=>s4(await uR(r),n)),n.promise}function ca(e){var r;return(r=u9(e=eb(e,u6))).asyncQueue.enqueue(async()=>{let e=await uN(r),n=await uD(r);return e.setNetworkEnabled(!0),n.Ia.delete(0),a5(n)})}function cs(e){var r;return(r=u9(e=eb(e,u6))).asyncQueue.enqueue(async()=>{let e=await uN(r),n=await uD(r);return e.setNetworkEnabled(!1),async function(e){e.Ia.add(0),await a6(e),e.Aa.set("Offline")}(n)})}function cu(e){return(0,v.Us)(e.app,"firestore",e._databaseId.database),e._delete()}function cc(e,r){let n=u9(e=eb(e,u6)),i=new u4;return function(e,r,n,i){var o;let a=(o=aW(r),new ux(function(e,r){if(e instanceof Uint8Array)return uw(e,void 0);if(e instanceof ArrayBuffer)return uw(new Uint8Array(e),void 0);if(e instanceof ReadableStream)return e.getReader();throw Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof n?et().encode(n):n),o));e.asyncQueue.enqueueAndForget(async()=>{var r;(async function(e,r,n){try{var i;let o=await r.getMetadata();if(await function(e,r){let n=i_(r.createTime);return e.persistence.runTransaction("hasNewerBundle","readonly",n=>e.Ti.getBundleMetadata(n,r.id)).then(e=>!!e&&e.createTime.compareTo(n)>=0)}(e.localStore,o))return await r.close(),n._completeWith({taskState:"Success",documentsLoaded:o.totalDocuments,bytesLoaded:o.totalBytes,totalDocuments:o.totalDocuments,totalBytes:o.totalBytes}),Promise.resolve(new Set);n._updateProgress(sU(o));let a=new sF(o,r.serializer),s=await r.Su();for(;s;){let e=await a.Wa(s);e&&n._updateProgress(e),s=await r.Su()}let u=await a.za(e.localStore);return await ut(e,u.Ja,void 0),await (i=e.localStore,i.persistence.runTransaction("Save bundle","readwrite",e=>i.Ti.saveBundleMetadata(e,o))),n._completeWith(u.progress),Promise.resolve(u.ja)}catch(e){return F(sB,`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r=await uR(e),a,i).then(e=>{r.sharedClientState.notifyBundleLoaded(e)})})}(n,e._databaseId,r,i),i}function cl(e,r){var n;return(n=u9(e=eb(e,u6)),n.asyncQueue.enqueue(async()=>{var e;return e=await uL(n),e.persistence.runTransaction("Get named query","readonly",n=>e.Ti.getNamedQuery(n,r))})).then(r=>r?new u$(e,null,r.query):null)}class ch{constructor(e="count",r){this._internalFieldPath=r,this.type="AggregateField",this.aggregateType=e}}class cd{constructor(e,r,n){this._userDataWriter=r,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class cf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cf(re.fromBase64String(e))}catch(e){throw new q(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new cf(re.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:cf._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ex(e,cf._jsonSchema))return cf.fromBase64String(e.bytes)}}cf._jsonSchemaVersion="firestore/bytes/1.0",cf._jsonSchema={type:eS("string",cf._jsonSchemaVersion),bytes:eS("string")};class cp{constructor(...e){for(let r=0;r<e.length;++r)if(0===e[r].length)throw new q(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new eh(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function cm(){return new cp(es)}class cg{constructor(e){this._methodName=e}}class cy{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new q(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new q(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return en(this._lat,e._lat)||en(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cy._jsonSchemaVersion}}static fromJSON(e){if(ex(e,cy._jsonSchema))return new cy(e.latitude,e.longitude)}}cy._jsonSchemaVersion="firestore/geoPoint/1.0",cy._jsonSchema={type:eS("string",cy._jsonSchemaVersion),latitude:eS("number"),longitude:eS("number")};class cv{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,r){if(e.length!==r.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==r[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:cv._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ex(e,cv._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new cv(e.vectorValues);throw new q(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}cv._jsonSchemaVersion="firestore/vectorValue/1.0",cv._jsonSchema={type:eS("string",cv._jsonSchemaVersion),vectorValues:eS("object")};let cb=/^__.*__$/;class cw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return null!==this.fieldMask?new n0(e,this.data,this.fieldMask,r,this.fieldTransforms):new nZ(e,this.data,r,this.fieldTransforms)}}class cS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new n0(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function cx(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M(40011,{Ec:e})}}class cE{constructor(e,r,n,i,o,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===o&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new cE(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;let n=null==(r=this.path)?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var r;let n=null==(r=this.path)?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return cz(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return void 0!==this.fieldMask.find(r=>e.isPrefixOf(r))||void 0!==this.fieldTransforms.find(r=>e.isPrefixOf(r.field))}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(0===e.length)throw this.wc("Document fields must not be empty");if(cx(this.Ec)&&cb.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class cI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||aW(e)}Dc(e,r,n,i=!1){return new cE({Ec:e,methodName:r,bc:n,path:eh.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cT(e){let r=e._freezeSettings(),n=aW(e._databaseId);return new cI(e._databaseId,!!r.ignoreUndefinedProperties,n)}function ck(e,r,n,i,o,a={}){let s,u,c=e.Dc(a.merge||a.mergeFields?2:0,r,n,o);cM("Data must be an object, but it was:",c,i);let l=cF(i,c);if(a.merge)s=new t8(c.fieldMask),u=c.fieldTransforms;else if(a.mergeFields){let e=[];for(let i of a.mergeFields){let o=cG(r,i,n);if(!c.contains(o))throw new q(z.INVALID_ARGUMENT,`Field '${o}' is specified in your field mask but missing from your input data.`);cq(e,o)||e.push(o)}s=new t8(e),u=c.fieldTransforms.filter(e=>s.covers(e.field))}else s=null,u=c.fieldTransforms;return new cw(new rG(l),s,u)}class c_ extends cg{_toFieldTransform(e){if(2!==e.Ec)throw 1===e.Ec?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof c_}}function cA(e,r,n){return new cE({Ec:3,bc:r.settings.bc,methodName:e._methodName,mc:n},r.databaseId,r.serializer,r.ignoreUndefinedProperties)}class cP extends cg{_toFieldTransform(e){return new nH(e.path,new nF)}isEqual(e){return e instanceof cP}}class cO extends cg{constructor(e,r){super(e),this.vc=r}_toFieldTransform(e){let r=cA(this,e,!0),n=new nU(this.vc.map(e=>cj(e,r)));return new nH(e.path,n)}isEqual(e){return e instanceof cO&&(0,S.bD)(this.vc,e.vc)}}class cC extends cg{constructor(e,r){super(e),this.vc=r}_toFieldTransform(e){let r=cA(this,e,!0),n=new nG(this.vc.map(e=>cj(e,r)));return new nH(e.path,n)}isEqual(e){return e instanceof cC&&(0,S.bD)(this.vc,e.vc)}}class cN extends cg{constructor(e,r){super(e),this.Cc=r}_toFieldTransform(e){let r=new nB(e.serializer,nD(e.serializer,this.Cc));return new nH(e.path,r)}isEqual(e){return e instanceof cN&&this.Cc===e.Cc}}function cL(e,r,n,i){let o=e.Dc(1,r,n);cM("Data must be an object, but it was:",o,i);let a=[],s=rG.empty();return tX(i,(e,i)=>{let u=cB(r,e,n);i=(0,S.Ku)(i);let c=o.gc(u);if(i instanceof c_)a.push(u);else{let e=cj(i,c);null!=e&&(a.push(u),s.set(u,e))}}),new cS(s,new t8(a),o.fieldTransforms)}function cD(e,r,n,i,o,a){let s=e.Dc(1,r,n),u=[cG(r,i,n)],c=[o];if(a.length%2!=0)throw new q(z.INVALID_ARGUMENT,`Function ${r}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<a.length;e+=2)u.push(cG(r,a[e])),c.push(a[e+1]);let l=[],h=rG.empty();for(let e=u.length-1;e>=0;--e)if(!cq(l,u[e])){let r=u[e],n=c[e];n=(0,S.Ku)(n);let i=s.gc(r);if(n instanceof c_)l.push(r);else{let e=cj(n,i);null!=e&&(l.push(r),h.set(r,e))}}return new cS(h,new t8(l),s.fieldTransforms)}function cR(e,r,n,i=!1){return cj(n,e.Dc(i?4:3,r))}function cj(e,r){if(cU(e=(0,S.Ku)(e)))return cM("Unsupported field value:",r,e),cF(e,r);if(e instanceof cg)return function(e,r){if(!cx(r.Ec))throw r.wc(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.wc(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(r);n&&r.fieldTransforms.push(n)}(e,r),null;if(void 0===e&&r.ignoreUndefinedProperties)return null;if(r.path&&r.fieldMask.push(r.path),e instanceof Array){if(r.settings.mc&&4!==r.Ec)throw r.wc("Nested arrays are not supported");let n=[],i=0;for(let o of e){let e=cj(o,r.yc(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}return function(e,r){if(null===(e=(0,S.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return nD(r.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let n=eE.fromDate(e);return{timestampValue:iT(r.serializer,n)}}if(e instanceof eE){let n=new eE(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:iT(r.serializer,n)}}if(e instanceof cy)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof cf)return{bytesValue:ik(r.serializer,e._byteString)};if(e instanceof uK){let n=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw r.wc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:iA(e.firestore._databaseId||r.databaseId,e._key.path)}}if(e instanceof cv)return{mapValue:{fields:{[rm]:{stringValue:rv},[rb]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw r.wc("VectorValues must only contain numeric values.");return nN(r.serializer,e)})}}}}};throw r.wc(`Unsupported field value: ${ev(e)}`)}(e,r)}function cF(e,r){let n={};return t0(e)?r.path&&r.path.length>0&&r.fieldMask.push(r.path):tX(e,(e,i)=>{let o=cj(i,r.Vc(e));null!=o&&(n[e]=o)}),{mapValue:{fields:n}}}function cU(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof eE||e instanceof cy||e instanceof cf||e instanceof uK||e instanceof cg||e instanceof cv)}function cM(e,r,n){if(!cU(n)||!ey(n)){let i=ev(n);throw"an object"===i?r.wc(e+" a custom object"):r.wc(e+" "+i)}}function cG(e,r,n){if((r=(0,S.Ku)(r))instanceof cp)return r._internalPath;if("string"==typeof r)return cB(e,r);throw cz("Field path arguments must be of type string or ",e,!1,void 0,n)}let cV=RegExp("[~\\*/\\[\\]]");function cB(e,r,n){if(r.search(cV)>=0)throw cz(`Invalid field path (${r}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new cp(...r.split("."))._internalPath}catch(i){throw cz(`Invalid field path (${r}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function cz(e,r,n,i,o){let a=i&&!i.isEmpty(),s=void 0!==o,u=`Function ${r}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(a||s)&&(c+=" (found",a&&(c+=` in field ${i}`),s&&(c+=` in document ${o}`),c+=")"),new q(z.INVALID_ARGUMENT,u+e+c)}function cq(e,r){return e.some(e=>e.isEqual(r))}class cH{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new uK(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new c$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let r=this._document.data.field(cK("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r)}}}class c$ extends cH{data(){return super.data()}}function cK(e,r){return"string"==typeof r?cB(e,r):r instanceof cp?r._internalPath:r._delegate._internalPath}function cW(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new q(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cQ{}class cJ extends cQ{}function cY(e,r,...n){let i=[];for(let o of(r instanceof cQ&&i.push(r),function(e){let r=e.filter(e=>e instanceof c0).length,n=e.filter(e=>e instanceof cX).length;if(r>1||r>0&&n>0)throw new q(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i=i.concat(n)),i))e=o._apply(e);return e}class cX extends cJ{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new cX(e,r,n)}_apply(e){let r=this._parse(e);return ls(e._query,r),new u$(e.firestore,e.converter,np(e._query,r))}_parse(e){let r=cT(e.firestore);return function(e,r,n,i,o,a,s){let u;if(o.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new q(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if("in"===a||"not-in"===a){la(s,a);let r=[];for(let n of s)r.push(lo(i,e,n));u={arrayValue:{values:r}}}else u=lo(i,e,s)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||la(s,a),u=cR(n,r,s,"in"===a||"not-in"===a);return rK.create(o,a,u)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function cZ(e,r,n){let i=cK("where",e);return cX._create(i,r,n)}class c0 extends cQ{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new c0(e,r)}_parse(e){let r=this._queryConstraints.map(r=>r._parse(e)).filter(e=>e.getFilters().length>0);return 1===r.length?r[0]:rW.create(r,this._getOperator())}_apply(e){let r=this._parse(e);return 0===r.getFilters().length?e:(function(e,r){let n=e;for(let e of r.getFlattenedFilters())ls(n,e),n=np(n,e)}(e._query,r),new u$(e.firestore,e.converter,np(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function c1(...e){return e.forEach(e=>lu("or",e)),c0._create("or",e)}function c2(...e){return e.forEach(e=>lu("and",e)),c0._create("and",e)}class c3 extends cJ{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new c3(e,r)}_apply(e){let r=function(e,r,n){if(null!==e.startAt)throw new q(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new q(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rH(r,n)}(e._query,this._field,this._direction);return new u$(e.firestore,e.converter,function(e,r){let n=e.explicitOrderBy.concat([r]);return new na(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,r))}}function c4(e,r="asc"){let n=cK("orderBy",e);return c3._create(n,r)}class c5 extends cJ{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new c5(e,r,n)}_apply(e){return new u$(e.firestore,e.converter,nm(e._query,this._limit,this._limitType))}}function c6(e){return ew("limit",e),c5._create("limit",e,"F")}function c8(e){return ew("limitToLast",e),c5._create("limitToLast",e,"L")}class c7 extends cJ{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new c7(e,r,n)}_apply(e){var r;let n=li(e,this.type,this._docOrFields,this._inclusive);return new u$(e.firestore,e.converter,(r=e._query,new na(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,n,r.endAt)))}}function c9(...e){return c7._create("startAt",e,!0)}function le(...e){return c7._create("startAfter",e,!1)}class lt extends cJ{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new lt(e,r,n)}_apply(e){var r;let n=li(e,this.type,this._docOrFields,this._inclusive);return new u$(e.firestore,e.converter,(r=e._query,new na(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,n)))}}function lr(...e){return lt._create("endBefore",e,!1)}function ln(...e){return lt._create("endAt",e,!0)}function li(e,r,n,i){if(n[0]=(0,S.Ku)(n[0]),n[0]instanceof cH)return function(e,r,n,i,o){if(!i)throw new q(z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);let a=[];for(let n of nl(e))if(n.field.isKeyField())a.push(rA(r,i.key));else{let e=i.data.field(n.field);if(rc(e))throw new q(z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){let e=n.field.canonicalString();throw new q(z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}a.push(e)}return new rB(a,o)}(e._query,e.firestore._databaseId,r,n[0]._document,i);{let o=cT(e.firestore);return function(e,r,n,i,o,a){let s=e.explicitOrderBy;if(o.length>s.length)throw new q(z.INVALID_ARGUMENT,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let u=[];for(let a=0;a<o.length;a++){let c=o[a];if(s[a].field.isKeyField()){if("string"!=typeof c)throw new q(z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof c}`);if(!nc(e)&&-1!==c.indexOf("/"))throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${c}' contains a slash.`);let n=e.path.child(ec.fromString(c));if(!ed.isDocumentKey(n))throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);let o=new ed(n);u.push(rA(r,o))}else{let e=cR(n,i,c);u.push(e)}}return new rB(u,a)}(e._query,e.firestore._databaseId,o,r,n,i)}}function lo(e,r,n){if("string"==typeof(n=(0,S.Ku)(n))){if(""===n)throw new q(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nc(r)&&-1!==n.indexOf("/"))throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let i=r.path.child(ec.fromString(n));if(!ed.isDocumentKey(i))throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return rA(e,new ed(i))}if(n instanceof uK)return rA(e,n._key);throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ev(n)}.`)}function la(e,r){if(!Array.isArray(e)||0===e.length)throw new q(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${r.toString()}' filters.`)}function ls(e,r){let n=function(e,r){for(let n of e)for(let e of n.getFlattenedFilters())if(r.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(r.op));if(null!==n)throw n===r.op?new q(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${r.op.toString()}' filter.`):new q(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${r.op.toString()}' filters with '${n.toString()}' filters.`)}function lu(e,r){if(!(r instanceof cX||r instanceof c0))throw new q(z.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class lc{convertValue(e,r="none"){switch(rS(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ri(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw M(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){let n={};return tX(e,(e,i)=>{n[e]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,i;return new cv(null==(i=null==(n=null==(r=e.fields)?void 0:r[rb].arrayValue)?void 0:n.values)?void 0:i.map(e=>rn(e.doubleValue)))}convertGeoPoint(e){return new cy(rn(e.latitude),rn(e.longitude))}convertArray(e,r){return(e.values||[]).map(e=>this.convertValue(e,r))}convertServerTimestamp(e,r){switch(r){case"previous":let n=rl(e);return null==n?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(rh(e));default:return null}}convertTimestamp(e){let r=rr(e);return new eE(r.seconds,r.nanos)}convertDocumentKey(e,r){let n=ec.fromString(e);V(iK(n),9688,{name:e});let i=new rp(n.get(1),n.get(3)),o=new ed(n.popFirst(5));return i.isEqual(r)||j(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}function ll(e,r,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(r,n):e.toFirestore(r):r}class lh extends lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new cf(e)}convertReference(e){let r=this.convertDocumentKey(e,this.firestore._databaseId);return new uK(this.firestore,null,r)}}function ld(e){return new ch("sum",cG("sum",e))}function lf(e){return new ch("avg",cG("average",e))}function lp(){return new ch("count")}function lm(e,r){var n,i;return e instanceof ch&&r instanceof ch&&e.aggregateType===r.aggregateType&&(null==(n=e._internalFieldPath)?void 0:n.canonicalString())===(null==(i=r._internalFieldPath)?void 0:i.canonicalString())}function lg(e,r){return uZ(e.query,r.query)&&(0,S.bD)(e.data(),r.data())}let ly="NOT SUPPORTED";class lv{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lb extends cH{constructor(e,r,n,i,o,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let r=new lS(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){let n=this._document.data.field(cK("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,r={};return r.type=lb._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),this._firestore,this.ref.path,r.bundle="NOT SUPPORTED"),r}}function lw(e,r,n){if(ex(r,lb._jsonSchema)){var i;if(r.bundle===ly)throw new q(z.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let o=aW(e._databaseId),a=(i=r.bundle,new uE(i,o)),s=a.Ku(),u=new sF(a.getMetadata(),o);for(let e of s)u.Wa(e);let c=u.documents;if(1!==c.length)throw new q(z.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${c.length} documents.`);let l=iU(o,c[0].document),h=new ed(ec.fromString(r.bundleName));return new lb(e,new lh(e),h,l,new lv(!1,!1),n||null)}}lb._jsonSchemaVersion="firestore/documentSnapshot/1.0",lb._jsonSchema={type:eS("string",lb._jsonSchemaVersion),bundleSource:eS("string","DocumentSnapshot"),bundleName:eS("string"),bundle:eS("string")};class lS extends lb{data(e={}){return super.data(e)}}class lx{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new lv(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){let e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new lS(this._firestore,this._userDataWriter,n.key,n,new lv(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new q(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(e,r){if(e._snapshot.oldDocs.isEmpty()){let r=0;return e._snapshot.docChanges.map(n=>{let i=new lS(e._firestore,e._userDataWriter,n.doc.key,n.doc,new lv(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>r||3!==e.type).map(r=>{let i=new lS(e._firestore,e._userDataWriter,r.doc.key,r.doc,new lv(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter),o=-1,a=-1;return 0!==r.type&&(o=n.indexOf(r.doc.key),n=n.delete(r.doc.key)),1!==r.type&&(a=(n=n.add(r.doc)).indexOf(r.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return M(61501,{type:e})}}(r.type),doc:i,oldIndex:o,newIndex:a}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=lx._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=er.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let r=[],n=[],i=[];return this.docs.forEach(e=>{null!==e._document&&(r.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),i.push(e.ref.path))}),this._firestore,this.query._query,e.bundleName,e.bundle="NOT SUPPORTED",e}}function lE(e,r,n){if(ex(r,lx._jsonSchema)){var i;if(r.bundle===ly)throw new q(z.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let o=aW(e._databaseId),a=(i=r.bundle,new uE(i,o)),s=a.Ku(),u=new sF(a.getMetadata(),o);for(let e of s)u.Wa(e);if(1!==u.queries.length)throw new q(z.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${u.queries.length} queries.`);let c=i3(u.queries[0].bundledQuery),l=u.documents,h=new sE;l.map(e=>{let r=iU(o,e.document);h=h.add(r)});let d=sT.fromInitialDocuments(c,h,nO(),!1,!1),f=new u$(e,n||null,c);return new lx(e,new lh(e),f,d)}}function lI(e,r){return e instanceof lb&&r instanceof lb?e._firestore===r._firestore&&e._key.isEqual(r._key)&&(null===e._document?null===r._document:e._document.isEqual(r._document))&&e._converter===r._converter:e instanceof lx&&r instanceof lx&&e._firestore===r._firestore&&uZ(e.query,r.query)&&e.metadata.isEqual(r.metadata)&&e._snapshot.isEqual(r._snapshot)}function lT(e){e=eb(e,uK);let r=eb(e.firestore,u6);return uU(u9(r),e._key).then(n=>lG(r,e,n))}lx._jsonSchemaVersion="firestore/querySnapshot/1.0",lx._jsonSchema={type:eS("string",lx._jsonSchemaVersion),bundleSource:eS("string","QuerySnapshot"),bundleName:eS("string"),bundle:eS("string")};class lk extends lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new cf(e)}convertReference(e){let r=this.convertDocumentKey(e,this.firestore._databaseId);return new uK(this.firestore,null,r)}}function l_(e){e=eb(e,uK);let r=eb(e.firestore,u6),n=u9(r),i=new lk(r);return(function(e,r){let n=new H;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,r,n){try{let i=await e.persistence.runTransaction("read document","readonly",n=>e.localDocuments.getDocument(n,r));i.isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new q(z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(i){let e=sx(i,`Failed to get document '${r} from cache`);n.reject(e)}})(await uL(e),r,n)),n.promise})(n,e._key).then(n=>new lb(r,i,e._key,n,new lv(null!==n&&n.hasLocalMutations,!0),e.converter))}function lA(e){e=eb(e,uK);let r=eb(e.firestore,u6);return uU(u9(r),e._key,{source:"server"}).then(n=>lG(r,e,n))}function lP(e){e=eb(e,u$);let r=eb(e.firestore,u6),n=u9(r),i=new lk(r);return cW(e._query),uM(n,e._query).then(n=>new lx(r,i,e,n))}function lO(e){e=eb(e,u$);let r=eb(e.firestore,u6),n=u9(r),i=new lk(r);return(function(e,r){let n=new H;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,r,n){try{let i=await am(e,r,!0),o=new sV(r,i.qs),a=o.nu(i.documents),s=o.applyChanges(a,!1);n.resolve(s.snapshot)}catch(i){let e=sx(i,`Failed to execute query '${r} against cache`);n.reject(e)}})(await uL(e),r,n)),n.promise})(n,e._query).then(n=>new lx(r,i,e,n))}function lC(e){e=eb(e,u$);let r=eb(e.firestore,u6),n=u9(r),i=new lk(r);return uM(n,e._query,{source:"server"}).then(n=>new lx(r,i,e,n))}function lN(e,r,n){e=eb(e,uK);let i=eb(e.firestore,u6),o=ll(e.converter,r,n);return lM(i,[ck(cT(i),"setDoc",e._key,o,null!==e.converter,n).toMutation(e._key,nK.none())])}function lL(e,r,n,...i){e=eb(e,uK);let o=eb(e.firestore,u6),a=cT(o);return lM(o,[("string"==typeof(r=(0,S.Ku)(r))||r instanceof cp?cD(a,"updateDoc",e._key,r,n,i):cL(a,"updateDoc",e._key,r)).toMutation(e._key,nK.exists(!0))])}function lD(e){return lM(eb(e.firestore,u6),[new n4(e._key,nK.none())])}function lR(e,r){let n=eb(e.firestore,u6),i=uY(e),o=ll(e.converter,r);return lM(n,[ck(cT(e.firestore),"addDoc",i._key,o,null!==e.converter,{}).toMutation(i._key,nK.exists(!1))]).then(()=>i)}function lj(e,...r){let n,i,o;e=(0,S.Ku)(e);let a={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof r[0]||u3(r[s])||(a=r[s++]);let u={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(u3(r[s])){let e=r[s];r[s]=null==(c=e.next)?void 0:c.bind(e),r[s+1]=null==(l=e.error)?void 0:l.bind(e),r[s+2]=null==(h=e.complete)?void 0:h.bind(e)}if(e instanceof uK)i=eb(e.firestore,u6),o=ns(e._key.path),n={next:n=>{r[s]&&r[s](lG(i,e,n))},error:r[s+1],complete:r[s+2]};else{let a=eb(e,u$);i=eb(a.firestore,u6),o=a._query;let u=new lk(i);n={next:e=>{r[s]&&r[s](new lx(i,u,a,e))},error:r[s+1],complete:r[s+2]},cW(e._query)}var c,l,h,d=u9(i),f=o;let p=new uS(n),m=new sD(f,p,u);return d.asyncQueue.enqueueAndForget(async()=>sP(await uF(d),m)),()=>{p.Ou(),d.asyncQueue.enqueueAndForget(async()=>sO(await uF(d),m))}}function lF(e,r,...n){var i,o,a,s,u,c;let l=(0,S.Ku)(e),h=function(e){let r={bundle:"",bundleName:"",bundleSource:""};for(let n of["bundle","bundleName","bundleSource"]){if(!(n in e)){r.error=`snapshotJson missing required field: ${n}`;break}let i=e[n];if("string"!=typeof i){r.error=`snapshotJson field '${n}' must be a string.`;break}if(0===i.length){r.error=`snapshotJson field '${n}' cannot be an empty string.`;break}"bundle"===n?r.bundle=i:"bundleName"===n?r.bundleName=i:"bundleSource"===n&&(r.bundleSource=i)}return r}(r);if(h.error)throw new q(z.INVALID_ARGUMENT,h.error);let d,f=0;if("object"!=typeof n[0]||u3(n[f])||(d=n[f++]),"QuerySnapshot"===h.bundleSource){let e,r,s=null;if("object"==typeof n[f]&&u3(n[f])){let e=n[f++];s={next:e.next,error:e.error,complete:e.complete}}else s={next:n[f++],error:n[f++],complete:n[f++]};return i=d,o=s,a=n[f],r=!1,cc(l,h.bundle).then(()=>cl(l,h.bundleName)).then(n=>{n&&!r&&(a&&n.withConverter(a),e=lj(n,i||{},o))}).catch(e=>(o.error&&o.error(e),()=>{})),()=>{r||(r=!0,e&&e())}}if("DocumentSnapshot"===h.bundleSource){let e,r,i=null;if("object"==typeof n[f]&&u3(n[f])){let e=n[f++];i={next:e.next,error:e.error,complete:e.complete}}else i={next:n[f++],error:n[f++],complete:n[f++]};return s=d,u=i,c=n[f],r=!1,cc(l,h.bundle).then(()=>{r||(e=lj(new uK(l,c||null,ed.fromPath(h.bundleName)),s||{},u))}).catch(e=>(u.error&&u.error(e),()=>{})),()=>{r||(r=!0,e&&e())}}throw new q(z.INVALID_ARGUMENT,`unsupported bundle source: ${h.bundleSource}`)}function lU(e,r){return function(e,r){let n=new uS(r);return e.asyncQueue.enqueueAndForget(async()=>{var r;return r=await uF(e),void(r.Da.add(n),n.next())}),()=>{n.Ou(),e.asyncQueue.enqueueAndForget(async()=>{var r;return r=await uF(e),void r.Da.delete(n)})}}(u9(e=eb(e,u6)),u3(r)?r:{next:r})}function lM(e,r){var n=u9(e);let i=new H;return n.asyncQueue.enqueueAndForget(async()=>sX(await uR(n),r,i)),i.promise}function lG(e,r,n){let i=n.docs.get(r._key),o=new lk(e);return new lb(e,o,r._key,i,new lv(n.hasPendingWrites,n.fromCache),r.converter)}function lV(e){return lB(e,{count:lp()})}function lB(e,r){let n=eb(e.firestore,u6),i=u9(n),o=tZ(r,(e,r)=>new n9(r,e.aggregateType,e._internalFieldPath));return(function(e,r,n){let i=new H;return e.asyncQueue.enqueueAndForget(async()=>{try{let o=await uj(e);i.resolve(async function(e,r,n){var i;let{request:o,ft:a,parent:s}=iz(e.serializer,nd(r),n);e.connection.Qo||delete o.parent;let u=(await e.Jo("RunAggregationQuery",e.serializer.databaseId,s,o,1)).filter(e=>!!e.result);V(1===u.length,64727);let c=null==(i=u[0].result)?void 0:i.aggregateFields;return Object.keys(c).reduce((e,r)=>(e[a[r]]=c[r],e),{})}(o,r,n))}catch(e){i.reject(e)}}),i.promise})(i,e._query,o).then(r=>new cd(e,new lk(n),r))}class lz{constructor(e){this.kind="memory",this._onlineComponentProvider=ub.provider,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new ug(void 0)}}toJSON(){return{kind:this.kind}}}class lq{constructor(e){let r;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),r=e.tabManager):(r=lZ(void 0))._initialize(e),this._onlineComponentProvider=r._onlineComponentProvider,this._offlineComponentProvider=r._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class lH{constructor(){this.kind="memoryEager",this._offlineComponentProvider=um.provider}toJSON(){return{kind:this.kind}}}class l${constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new ug(e)}}toJSON(){return{kind:this.kind}}}function lK(){return new lH}function lW(e){return new l$(null==e?void 0:e.cacheSizeBytes)}function lQ(e){return new lz(e)}function lJ(e){return new lq(e)}class lY{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ub.provider,this._offlineComponentProvider={build:r=>new uy(r,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class lX{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ub.provider,this._offlineComponentProvider={build:r=>new uv(r,null==e?void 0:e.cacheSizeBytes)}}}function lZ(e){return new lY(null==e?void 0:e.forceOwnership)}function l0(){return new lX}let l1={maxAttempts:5};class l2{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=cT(e)}set(e,r,n){this._verifyNotCommitted();let i=l3(e,this._firestore),o=ll(i.converter,r,n),a=ck(this._dataReader,"WriteBatch.set",i._key,o,null!==i.converter,n);return this._mutations.push(a.toMutation(i._key,nK.none())),this}update(e,r,n,...i){let o;this._verifyNotCommitted();let a=l3(e,this._firestore);return o="string"==typeof(r=(0,S.Ku)(r))||r instanceof cp?cD(this._dataReader,"WriteBatch.update",a._key,r,n,i):cL(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(o.toMutation(a._key,nK.exists(!0))),this}delete(e){this._verifyNotCommitted();let r=l3(e,this._firestore);return this._mutations=this._mutations.concat(new n4(r._key,nK.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new q(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function l3(e,r){if((e=(0,S.Ku)(e)).firestore!==r)throw new q(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class l4{constructor(e,r){this._firestore=e,this._transaction=r,this._dataReader=cT(e)}get(e){let r=l3(e,this._firestore),n=new lh(this._firestore);return this._transaction.lookup([r._key]).then(e=>{if(!e||1!==e.length)return M(24041);let i=e[0];if(i.isFoundDocument())return new cH(this._firestore,n,i.key,i,r.converter);if(i.isNoDocument())return new cH(this._firestore,n,r._key,null,r.converter);throw M(18433,{doc:i})})}set(e,r,n){let i=l3(e,this._firestore),o=ll(i.converter,r,n),a=ck(this._dataReader,"Transaction.set",i._key,o,null!==i.converter,n);return this._transaction.set(i._key,a),this}update(e,r,n,...i){let o,a=l3(e,this._firestore);return o="string"==typeof(r=(0,S.Ku)(r))||r instanceof cp?cD(this._dataReader,"Transaction.update",a._key,r,n,i):cL(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,o),this}delete(e){let r=l3(e,this._firestore);return this._transaction.delete(r._key),this}}class l5 extends l4{constructor(e,r){super(e,r),this._firestore=e}get(e){let r=l3(e,this._firestore),n=new lk(this._firestore);return super.get(e).then(e=>new lb(this._firestore,n,r._key,e._document,new lv(!1,!1),r.converter))}}function l6(e,r,n){e=eb(e,u6);let i=Object.assign(Object.assign({},l1),n);if(i.maxAttempts<1)throw new q(z.INVALID_ARGUMENT,"Max attempts must be at least 1");return function(e,r,n){let i=new H;return e.asyncQueue.enqueueAndForget(async()=>{let o=await uj(e);new uT(e.asyncQueue,o,n,r,i).zu()}),i.promise}(u9(e),n=>r(new l5(e,n)),i)}function l8(){return new c_("deleteField")}function l7(){return new cP("serverTimestamp")}function l9(...e){return new cO("arrayUnion",e)}function he(...e){return new cC("arrayRemove",e)}function ht(e){return new cN("increment",e)}function hr(e){return new cv(e)}function hn(e){return u9(e=eb(e,u6)),new l2(e,r=>lM(e,r))}function hi(e,r){let n=u9(e=eb(e,u6));if(!n._uninitializedComponentsProvider||"memory"===n._uninitializedComponentsProvider._offline.kind)return F("Cannot enable indexes when persistence is disabled"),Promise.resolve();let i=function(e){let r="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new q(z.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(r.indexes))for(let e of r.indexes){let r=ho(e,"collectionGroup"),i=[];if(Array.isArray(e.fields))for(let r of e.fields){let e=cB("setIndexConfiguration",ho(r,"fieldPath"));"CONTAINS"===r.arrayConfig?i.push(new eP(e,2)):"ASCENDING"===r.order?i.push(new eP(e,0)):"DESCENDING"===r.order&&i.push(new eP(e,1))}n.push(new eT(eT.UNKNOWN_ID,r,i,eO.empty()))}return n}(r);return n.asyncQueue.enqueue(async()=>(async function(e,r){let n=e.indexManager,i=[];return e.persistence.runTransaction("Configure indexes","readwrite",e=>n.getFieldIndexes(e).next(o=>(function(e,r,n,i,o){r=[...r],(e=[...e]).sort(n),r.sort(n);let a=e.length,s=r.length,u=0,c=0;for(;u<s&&c<a;){let a=n(e[c],r[u]);a<0?o(e[c++]):a>0?i(r[u++]):(u++,c++)}for(;u<s;)i(r[u++]);for(;c<a;)o(e[c++])})(o,r,eA,r=>{i.push(n.addFieldIndex(e,r))},r=>{i.push(n.deleteFieldIndex(e,r))})).next(()=>eU.waitFor(i)))})(await uL(n),i))}function ho(e,r){if("string"!=typeof e[r])throw new q(z.INVALID_ARGUMENT,"Missing string value for: "+r);return e[r]}class ha{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function hs(e){var r;e=eb(e,u6);let n=hd.get(e);if(n)return n;if("persistent"!==(null==(r=u9(e)._uninitializedComponentsProvider)?void 0:r._offline.kind))return null;let i=new ha(e);return hd.set(e,i),i}function hu(e){hh(e,!0)}function hc(e){hh(e,!1)}function hl(e){var r;(r=u9(e._firestore)).asyncQueue.enqueue(async()=>(function(e){let r=e.indexManager;return e.persistence.runTransaction("Delete All Indexes","readwrite",e=>r.deleteAllFieldIndexes(e))})(await uL(r))).then(e=>R("deleting all persistent cache indexes succeeded")).catch(e=>F("deleting all persistent cache indexes failed",e))}function hh(e,r){var n;(n=u9(e._firestore),n.asyncQueue.enqueue(async()=>{var e;return e=await uL(n),void(e.Cs.Rs=r)})).then(e=>R(`setting persistent cache index auto creation isEnabled=${r} succeeded`)).catch(e=>F(`setting persistent cache index auto creation isEnabled=${r} failed`,e))}let hd=new WeakMap;function hf(e){var r;let n=null==(r=u9(eb(e.firestore,u6))._onlineComponents)?void 0:r.datastore.serializer;return void 0===n?null:iB(n,nh(e._query)).Vt}function hp(e,r){var n;let i=tZ(r,(e,r)=>new n9(r,e.aggregateType,e._internalFieldPath)),o=null==(n=u9(eb(e.firestore,u6))._onlineComponents)?void 0:n.datastore.serializer;return void 0===o?null:iz(o,nd(e._query),i,!0).request}class hm{constructor(){throw Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return hg.instance.onExistenceFilterMismatch(e)}}class hg{constructor(){this.Fc=new Map}static get instance(){return hy||function(e){if(ii)throw Error("a TestingHooksSpi instance is already set");ii=e}(hy=new hg),hy}ct(e){this.Fc.forEach(r=>r(e))}onExistenceFilterMismatch(e){let r=Symbol(),n=this.Fc;return n.set(r,e),()=>n.delete(r)}}let hy=null;!function(e,r=!0){C=v.MF,(0,v.om)(new b.uA("firestore",(e,{instanceIdentifier:n,options:i})=>{let o=e.getProvider("app").getImmediate(),a=new u6(new Q(e.getProvider("auth-internal")),new Z(o,e.getProvider("app-check-internal")),function(e,r){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new q(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rp(e.options.projectId,r)}(o,n),o);return i=Object.assign({useFetchStreams:r},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),(0,v.KO)(A,P,void 0),(0,v.KO)(A,P,"esm2017")}()},42471:(e,r,n)=>{"use strict";n.d(r,{yB:()=>s,zh:()=>a});var i=function(e){return e.JASSGROUP="JASSGROUP",e}({}),o={berg:1,sieg:2,matsch:1},a={schneider:2,kontermatsch:2};i.JASSGROUP,o.berg,o.sieg,o.matsch,a.schneider,a.kontermatsch;var s=function(e){return(void 0===e.schneider||!![0,1,2].includes(e.schneider))&&(void 0===e.kontermatsch||!![0,1,2].includes(e.kontermatsch))}},47137:(e,r,n)=>{"use strict";n.d(r,{F:()=>s});var i=n(69241);let o=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,a=i.$,s=(e,r)=>n=>{var i;if((null==r?void 0:r.variants)==null)return a(e,null==n?void 0:n.class,null==n?void 0:n.className);let{variants:s,defaultVariants:u}=r,c=Object.keys(s).map(e=>{let r=null==n?void 0:n[e],i=null==u?void 0:u[e];if(null===r)return null;let a=o(r)||o(i);return s[e][a]}),l=n&&Object.entries(n).reduce((e,r)=>{let[n,i]=r;return void 0===i||(e[n]=i),e},{});return a(e,c,null==r||null==(i=r.compoundVariants)?void 0:i.reduce((e,r)=>{let{class:n,className:i,...o}=r;return Object.entries(o).every(e=>{let[r,n]=e;return Array.isArray(n)?n.includes({...u,...l}[r]):({...u,...l})[r]===n})?[...e,n,i]:e},[]),null==n?void 0:n.class,null==n?void 0:n.className)}},48101:(e,r,n)=>{"use strict";n.d(r,{At:()=>I,FH:()=>T,cK:()=>_,jl:()=>k,nX:()=>A,yu:()=>E});var i=n(8106),o=n(93504),a=n(42009),s=n(13848),u=n(38791),c=n(42471),l=n(85253),h=n(28742);function d(e,r){if(e){if("string"==typeof e)return f(e,r);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,r):void 0}}function f(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(){m=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==p(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(p(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=l(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function g(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function y(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){g(a,i,o,s,u,"next",e)}function u(e){g(a,i,o,s,u,"throw",e)}s(void 0)})}}function v(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function b(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?v(Object(n),!0).forEach(function(r){w(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function w(e,r,n){var i;return(i=function(e,r){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=p(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(r,"string"),(r="symbol"==p(i)?i:i+"")in e)?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var S={rankingMode:"total_points",scoreSettings:u.$d,strokeSettings:c.zh,farbeSettings:l.FT,minParticipants:4,maxParticipants:null},x={currentTournamentInstance:null,detailsStatus:"idle",loadingInstanceId:null,currentTournamentGames:[],gamesStatus:"idle",tournamentParticipants:[],participantsStatus:"idle",userTournamentInstances:[],userActiveTournamentId:null,userActiveTournamentStatus:"idle",userActiveTournamentError:null,activePasse:null,tournamentPlayerStats:null,status:"idle",error:null,passeRoundsCache:{},passeRoundsStatus:{},currentViewingPasse:null,passeDetailsStatus:"idle",tournamentListenerUnsubscribe:null},E=(0,i.v)(function(e,r){var i,g,v,E,I,T,k,_,A,P,O,C,N,L,D,R,j,F,U,M,G;return b(b({},x),{},{createTournament:(i=y(m().mark(function n(i,a,s,h,d){var f,p,g,y,v,b,w,S,x;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"loading-list",error:null}),n.prev=1,b={rankingMode:d.rankingMode,scoreSettings:null!=(f=d.scoreSettings)?f:u.$d,strokeSettings:null!=(p=d.strokeSettings)?p:c.zh,farbeSettings:null!=(g=d.farbeSettings)?g:l.FT,minParticipants:null!=(y=d.minParticipants)?y:4,maxParticipants:null!=(v=d.maxParticipants)?v:null},n.next=2,(0,o.createTournamentInstance)(i,a,s,h,b,"upcoming");case 2:return w=n.sent,n.next=3,r().loadUserTournamentInstances(a);case 3:return e({status:"success",currentTournamentInstance:null}),n.abrupt("return",w);case 4:throw n.prev=4,S=(x=n.catch(1))instanceof Error?x.message:"Fehler beim Erstellen des Turniers.",console.error("[TournamentStore] Error creating tournament:",x),e({status:"error",error:S}),x;case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r,n,o,a){return i.apply(this,arguments)}),loadUserTournamentInstances:(g=y(m().mark(function r(n,i){var a,s;return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e({status:"loading-list",error:null}),r.prev=1,!i){r.next=3;break}return r.next=2,(0,o.fetchTournamentInstancesForGroup)(i);case 2:e({userTournamentInstances:r.sent,status:"success"}),r.next=5;break;case 3:return r.next=4,(0,o.fetchTournamentsForUser)(n);case 4:e({userTournamentInstances:r.sent,status:"success"});case 5:r.next=7;break;case 6:r.prev=6,a=(s=r.catch(1))instanceof Error?s.message:"Fehler beim Laden der Turnier-Instanzen.",console.error("[TournamentStore] Error loading tournament instances:",s),e({status:"error",error:a});case 7:case"end":return r.stop()}},r,null,[[1,6]])})),function(e,r){return g.apply(this,arguments)}),setCurrentTournamentInstance:function(r){e({currentTournamentInstance:r}),r&&e({currentTournamentGames:[],tournamentParticipants:[],passeRoundsCache:{},passeRoundsStatus:{}})},fetchTournamentInstanceDetails:(v=y(m().mark(function n(i){var a,s,h,d,f,g,y,v,w,x,E,I,T;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(((null==(a=(h=r()).currentTournamentInstance)?void 0:a.id)!==i||"success"!==h.detailsStatus)&&("loading"!==h.detailsStatus||h.loadingInstanceId!==i)){n.next=1;break}return(null==(d=h.currentTournamentInstance)?void 0:d.id)!==i||h.tournamentListenerUnsubscribe||r().setupTournamentListener(i),n.abrupt("return");case 1:return console.log("[TournamentStore] Fetching details for tournament: ".concat(i)),(null==(s=h.currentTournamentInstance)?void 0:s.id)===i&&h.currentTournamentInstance||(console.log("[TournamentStore] Instance ID changed or no current instance. Clearing games and participants for ".concat(i,".")),e({currentTournamentGames:[],gamesStatus:"idle",tournamentParticipants:[],participantsStatus:"idle",passeRoundsCache:{},passeRoundsStatus:{},currentViewingPasse:null,passeDetailsStatus:"idle"})),e({detailsStatus:"loading",loadingInstanceId:i,error:null}),n.prev=2,n.next=3,(0,o.fetchTournamentInstanceDetails)(i);case 3:(f=n.sent)?((E=b(b({},S),f.settings||{})).scoreSettings=b(b({},u.$d),(null==(g=f.settings)?void 0:g.scoreSettings)||{}),E.strokeSettings=b(b({},c.zh),(null==(y=f.settings)?void 0:y.strokeSettings)||{}),E.farbeSettings=b(b({},l.FT),(null==(v=f.settings)?void 0:v.farbeSettings)||{}),E.farbeSettings&&"object"===p(E.farbeSettings)&&(E.farbeSettings.values=b(b({},l.FT.values),E.farbeSettings.values||{})),I=b(b({},f),{},{settings:E}),console.log("[TournamentStore] Normalisierte Turniereinstellungen f\xfcr ".concat(i,":"),{hat_settings:!!I.settings,hat_farbeSettings:!!(null!=(w=I.settings)&&w.farbeSettings),cardStyle:null==(x=I.settings)||null==(x=x.farbeSettings)?void 0:x.cardStyle}),r().loadingInstanceId===i&&(e({currentTournamentInstance:I,status:"success",detailsStatus:"success",loadingInstanceId:null}),r().setupTournamentListener(i))):r().loadingInstanceId===i&&(console.warn("[TournamentStore] Tournament instance ".concat(i," not found by service or access denied.")),e({status:"error",detailsStatus:"error",error:"Turnier nicht gefunden oder Zugriff verweigert.",currentTournamentInstance:null,loadingInstanceId:null})),n.next=5;break;case 4:n.prev=4,T=n.catch(2),console.error("[TournamentStore] Error in fetchTournamentInstanceDetails for ".concat(i,":"),T),r().loadingInstanceId===i&&e({status:"error",detailsStatus:"error",error:T instanceof Error?T.message:"Fehler beim Laden der Turnier-Details.",currentTournamentInstance:null,loadingInstanceId:null});case 5:case"end":return n.stop()}},n,null,[[2,4]])})),function(e){return v.apply(this,arguments)}),loadTournamentGames:(E=y(m().mark(function n(i){var a,s;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("loading"!==r().gamesStatus){n.next=1;break}return console.log("[TournamentStore] Games for ".concat(i," are already loading. Skipping redundant fetch.")),n.abrupt("return");case 1:return e({status:"loading-games",gamesStatus:"loading",error:null}),n.prev=2,n.next=3,(0,o.fetchTournamentGames)(i);case 3:e({currentTournamentGames:n.sent,status:"success",gamesStatus:"success"}),n.next=5;break;case 4:n.prev=4,a=(s=n.catch(2))instanceof Error?s.message:"Fehler beim Laden der Turnier-Spiele.",console.error("[TournamentStore] Error loading tournament games for ".concat(i,":"),s),e({status:"error",gamesStatus:"error",error:a});case 5:case"end":return n.stop()}},n,null,[[2,4]])})),function(e){return E.apply(this,arguments)}),loadTournamentParticipants:(I=y(m().mark(function n(i){var a,s;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("loading"!==r().participantsStatus){n.next=1;break}return console.log("[TournamentStore] Participants for ".concat(i," are already loading. Skipping redundant fetch.")),n.abrupt("return");case 1:return e({status:"loading-participants",participantsStatus:"loading",error:null}),n.prev=2,n.next=3,(0,o.fetchTournamentParticipants)(i);case 3:e({tournamentParticipants:n.sent.map(function(e){var r=e.userId,n=e.id;return r?b(b({},e),{},{uid:r,playerId:n,completedPassesCount:e.completedPassesCount||0,currentPasseNumberForPlayer:e.currentPasseNumberForPlayer||1}):(console.error("[TournamentStore] loadTournamentParticipants: Player ".concat(e.displayName," (ID: ").concat(n,") has no userId. Skipping.")),null)}).filter(function(e){return null!==e}),status:"success",participantsStatus:"success"}),n.next=5;break;case 4:n.prev=4,a=(s=n.catch(2))instanceof Error?s.message:"Fehler beim Laden der Teilnehmer.",console.error("[TournamentStore] Error loading participants for ".concat(i,":"),s),e({status:"error",participantsStatus:"error",error:a});case 5:case"end":return n.stop()}},n,null,[[2,4]])})),function(e){return I.apply(this,arguments)}),startNewPasse:(T=y(m().mark(function n(i,o,p){var g,v,w,S,x,E,I,T,k,_,A,P,O,C,N,L,D,R,j,F,U;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e({status:"loading-games",error:null}),!(!(g=r().currentTournamentInstance)||!g.settings)){n.next=1;break}return e({status:"error",error:"Turnierdetails oder -einstellungen nicht geladen, um Passe zu starten."}),console.error("[TournamentStore] startNewPasse: ","Turnierdetails oder -einstellungen nicht geladen, um Passe zu starten."),n.abrupt("return",null);case 1:if(w=(v=g.settings).scoreSettings,S=v.strokeSettings,x=v.farbeSettings,E=null!=w?w:u.$d,I=null!=S?S:c.zh,T=null!=x?x:l.FT,console.log("[TournamentStore] Turniereinstellungen f\xfcr Passe-Start (direkt aus currentTournament.settings):",{scoreSettingsValid:!!E,strokeSettingsValid:!!I,farbeSettingsValid:!!T,cardStyle:T.cardStyle,siegPunkte:E.values.sieg,schneiderStriche:I.schneider}),!o.some(function(e){return"number"!=typeof e.completedPassesCount})){n.next=2;break}return console.error("[TournamentStore] startNewPasse: ","Fehler: completedPassesCount fehlt f\xfcr einen oder mehrere Spieler.",o),e({status:"error",error:"Fehler: completedPassesCount fehlt f\xfcr einen oder mehrere Spieler."}),n.abrupt("return",null);case 2:var M;return k=1+Math.min.apply(Math,function(e){if(Array.isArray(e))return f(e)}(M=o.map(function(e){return e.completedPassesCount}))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(M)||d(M)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),_=Number(p),A=o.map(function(e){return b(b({},e),{},{playerNumber:Number(e.playerNumber)})}),console.log("[TournamentStore] startNewPasse - \xdcbergebene Spieler (Input):"),o.forEach(function(e){return console.log("  - UID: ".concat(e.uid,", Name: ").concat(e.name,", PlayerNum: ").concat(e.playerNumber,", completedPasses: ").concat(e.completedPassesCount))}),P=A.reduce(function(e,r){return e[r.playerNumber]=r.name,e},{}),O=A.reduce(function(e,r){return e[r.playerNumber]={type:"member",uid:r.uid,name:r.name,photoURL:r.photoURL||null},e},{}),console.log("[TournamentStore] startNewPasse - gamePlayersForGame erstellt:"),Object.entries(O).forEach(function(e){var r=function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,u=[],c=!0,l=!1;try{a=(n=n.call(e)).next,!1;for(;!(c=(i=a.call(n)).done)&&(u.push(i.value),u.length!==r);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return u}}(e,2)||d(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],i=r[1];return console.log("  - Player ".concat(n,": UID: ").concat(i.uid,", Name: ").concat(i.name))}),C={top:[2,4],bottom:[1,3]},console.log("[TournamentStore] Turniereinstellungen bei Passe-Start:",{scoreSettings:E?"vorhanden":"fehlend",strokeSettings:I?"vorhanden":"fehlend",farbeSettings:T?"vorhanden":"fehlend",cardStyle:null==T?void 0:T.cardStyle}),N={groupId:null,sessionId:"tournament_".concat(i,"_passe_").concat(k),currentGameNumber:k,teams:{top:C.top,bottom:C.bottom},lastUpdated:(0,a.serverTimestamp)(),tournamentInstanceId:i,participantUids:o.map(function(e){return e.uid}),playerNames:P,gamePlayers:O,startingPlayer:_,initialStartingPlayer:_,currentPlayer:_,currentRound:1,scores:{top:0,bottom:0},striche:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},roundHistory:[],status:"live",createdAt:(0,a.serverTimestamp)(),passeTournamentNumber:k,weisPoints:{top:0,bottom:0},jassPoints:{top:0,bottom:0},currentRoundWeis:[],isGameStarted:!0,isRoundCompleted:!1,isGameCompleted:!1,scoreSettings:E,strokeSettings:I,farbeSettings:T},L=(0,a.collection)(s.db,"activeGames"),n.next=3,(0,a.addDoc)(L,N);case 3:return R=(D=n.sent).id,j=(0,a.doc)(s.db,"tournaments",i),n.prev=4,n.next=5,(0,a.runTransaction)(s.db,function(){var e=y(m().mark(function e(r){var n,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,r.get(j);case 1:if((n=e.sent).exists()){e.next=2;break}throw"Tournament document does not exist!";case 2:i=(n.data().participants||[]).map(function(e){return o.some(function(r){return r.uid===e.uid})?b(b({},e),{},{currentPasseNumberForPlayer:k}):e}),r.update(j,{participants:i});case 3:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}());case 5:n.next=8;break;case 6:return n.prev=6,console.error("[TournamentStore] Transaction failed to update participant passe numbers: ",U=n.catch(4)),n.next=7,(0,a.deleteDoc)(D);case 7:throw e({status:"error",error:"Fehler beim Aktualisieren der Teilnehmerdaten f\xfcr die Passe."}),U;case 8:return F=b(b({},N),{},{activeGameId:R,createdAt:a.Timestamp.now(),lastUpdated:a.Timestamp.now()}),h.useGameStore.getState().resetGame(_,R,{farbeSettings:T,scoreSettings:E,strokeSettings:I}),console.log("[TournamentStore] gameStore.resetGame f\xfcr Passe ".concat(R," mit Turniereinstellungen aufgerufen.")),e({activePasse:F,status:"success"}),n.abrupt("return",R);case 9:case"end":return n.stop()}},n,null,[[4,6]])})),function(e,r,n){return T.apply(this,arguments)}),updateActivePasse:function(r){e(function(e){return{activePasse:e.activePasse?b(b({},e.activePasse),r):null}})},completePasse:(k=y(m().mark(function n(i,a){var s,u;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"loading-games",error:null}),n.prev=1,n.next=2,(0,o.completeTournamentPasse)(i,a);case 2:if(!a.tournamentInstanceId){n.next=3;break}return n.next=3,r().loadTournamentGames(a.tournamentInstanceId);case 3:e({activePasse:null,status:"success"}),n.next=5;break;case 4:n.prev=4,s=(u=n.catch(1))instanceof Error?u.message:"Fehler beim Abschliessen der Passe.",console.error("[TournamentStore] Error completing passe:",u),e({status:"error",error:s});case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r){return k.apply(this,arguments)}),updateTournamentSettings:(_=y(m().mark(function n(i,a){var s,h,d,f,p,g,y,v;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r().status,e({status:"updating-settings",error:null}),n.prev=1,!(!(h=r().currentTournamentInstance)||h.id!==i)){n.next=2;break}return n.next=2,r().fetchTournamentInstanceDetails(i);case 2:if(!(!(d=r().currentTournamentInstance)||d.id!==i)){n.next=3;break}return console.error("[TournamentStore] Konnte Turnierdetails nicht abrufen f\xfcr Update: ".concat(i)),e({status:"error",error:"Turnierdetails konnten nicht abgerufen werden."}),n.abrupt("return",!1);case 3:return p=b(b({},f=d.settings||S),a),a.scoreSettings&&(p.scoreSettings=b(b(b({},u.$d),f.scoreSettings||{}),a.scoreSettings)),a.strokeSettings&&(p.strokeSettings=b(b(b({},c.zh),f.strokeSettings||{}),a.strokeSettings)),a.farbeSettings&&(p.farbeSettings=b(b(b({},l.FT),f.farbeSettings||{}),a.farbeSettings),a.farbeSettings.values&&(p.farbeSettings.values=b(b(b({},l.FT.values),(null==(g=f.farbeSettings)?void 0:g.values)||{}),a.farbeSettings.values))),console.log("[TournamentStore] Aktualisierte Turniereinstellungen:",{hat_settings:!!p,hat_farbeSettings:!!p.farbeSettings,cardStyle:null==(s=p.farbeSettings)?void 0:s.cardStyle}),n.next=4,(0,o.updateTournamentSettings)(i,p);case 4:return n.next=5,r().fetchTournamentInstanceDetails(i);case 5:if("error"!==r().detailsStatus){n.next=6;break}return n.abrupt("return",!1);case 6:return e({status:"success"}),n.abrupt("return",!0);case 7:return n.prev=7,y=(v=n.catch(1))instanceof Error?v.message:"Fehler beim Aktualisieren der Turnier-Einstellungen.",console.error("[TournamentStore] Error updating tournament settings for ".concat(i,":"),v),e({status:"error",error:y}),n.abrupt("return",!1);case 8:case"end":return n.stop()}},n,null,[[1,7]])})),function(e,r){return _.apply(this,arguments)}),updateTournamentDetails:(A=y(m().mark(function n(i,a){var s,u,c;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=r().status,e({status:"updating-settings",error:null}),n.prev=1,n.next=2,(0,o.updateTournamentBaseDetails)(i,a);case 2:return n.next=3,r().fetchTournamentInstanceDetails(i);case 3:if("error"!==r().detailsStatus){n.next=4;break}return e({status:s}),n.abrupt("return",!1);case 4:return e({status:"success"}),n.abrupt("return",!0);case 5:return n.prev=5,u=(c=n.catch(1))instanceof Error?c.message:"Fehler beim Aktualisieren der Turnierdetails (Name/Beschreibung).",console.error("[TournamentStore] Error updating tournament base details for ".concat(i,":"),c),e({status:"error",error:u}),n.abrupt("return",!1);case 6:case"end":return n.stop()}},n,null,[[1,5]])})),function(e,r){return A.apply(this,arguments)}),removeParticipant:(P=y(m().mark(function n(i,a){var s,u;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"managing-participant",error:null}),n.prev=1,n.next=2,(0,o.removeParticipantFromTournament)(i,a);case 2:return n.next=3,r().fetchTournamentInstanceDetails(i);case 3:return e({status:"success"}),n.abrupt("return",!0);case 4:return n.prev=4,s=(u=n.catch(1))instanceof Error?u.message:"Fehler beim Entfernen des Teilnehmers.",console.error("[TournamentStore] Error removing participant ".concat(a," from ").concat(i,":"),u),e({status:"error",error:s}),n.abrupt("return",!1);case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r){return P.apply(this,arguments)}),makeParticipantAdmin:(O=y(m().mark(function n(i,a){var s,u;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"managing-participant",error:null}),n.prev=1,n.next=2,(0,o.addTournamentAdmin)(i,a);case 2:return n.next=3,r().fetchTournamentInstanceDetails(i);case 3:return e({status:"success"}),n.abrupt("return",!0);case 4:return n.prev=4,s=(u=n.catch(1))instanceof Error?u.message:"Fehler beim Ernennen zum Admin.",console.error("[TournamentStore] Error making participant ".concat(a," admin in ").concat(i,":"),u),e({status:"error",error:s}),n.abrupt("return",!1);case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r){return O.apply(this,arguments)}),removeParticipantAdmin:(C=y(m().mark(function n(i,a){var s,u;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"managing-participant",error:null}),n.prev=1,n.next=2,(0,o.removeTournamentAdmin)(i,a);case 2:return n.next=3,r().fetchTournamentInstanceDetails(i);case 3:return e({status:"success"}),n.abrupt("return",!0);case 4:return n.prev=4,s=(u=n.catch(1))instanceof Error?u.message:"Fehler beim Entfernen des Admin-Status.",console.error("[TournamentStore] Error removing admin status for ".concat(a," in ").concat(i,":"),u),e({status:"error",error:s}),n.abrupt("return",!1);case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r){return C.apply(this,arguments)}),addParticipantManual:(N=y(m().mark(function n(i,a){var s,u;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"managing-participant",error:null}),n.prev=1,n.next=2,(0,o.addParticipantToTournament)(i,a);case 2:return n.next=3,r().fetchTournamentInstanceDetails(i);case 3:return e({status:"success"}),n.abrupt("return",!0);case 4:return n.prev=4,s=(u=n.catch(1))instanceof Error?u.message:"Fehler beim Hinzuf\xfcgen des Teilnehmers.",console.error("[TournamentStore] Error adding participant ".concat(a," to ").concat(i,":"),u),e({status:"error",error:s}),n.abrupt("return",!1);case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r){return N.apply(this,arguments)}),leaveTournament:(L=y(m().mark(function n(i,a){var s,u,c;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"leaving-tournament",error:null}),n.prev=1,n.next=2,(0,o.leaveTournament)(i,a);case 2:return n.next=3,r().loadUserTournamentInstances(a);case 3:return(null==(s=r().currentTournamentInstance)?void 0:s.id)===i&&e({currentTournamentInstance:null}),e({status:"success"}),n.abrupt("return",!0);case 4:return n.prev=4,u=(c=n.catch(1))instanceof Error?c.message:"Fehler beim Verlassen des Turniers.",console.error("[TournamentStore] Error leaving tournament ".concat(i," for user ").concat(a,":"),c),e({status:"error",error:u}),n.abrupt("return",!1);case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r){return L.apply(this,arguments)}),clearError:function(){e({error:null,status:r().currentTournamentInstance?"success":"idle"})},clearCurrentTournamentInstance:function(){console.log("[TournamentStore] Clearing current tournament instance and related data.");var n=r().tournamentListenerUnsubscribe;n&&(console.log("[TournamentStore] Removing tournament listener."),n()),e({currentTournamentInstance:null,currentTournamentGames:[],tournamentParticipants:[],activePasse:null,detailsStatus:"idle",participantsStatus:"idle",gamesStatus:"idle",passeRoundsCache:{},passeRoundsStatus:{},error:null,status:"idle",loadingInstanceId:null,currentViewingPasse:null,passeDetailsStatus:"idle",tournamentListenerUnsubscribe:null})},loadPasseRounds:(D=y(m().mark(function n(i,a){var s,u,c,l;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("loading"!==(s=r().passeRoundsStatus[a])&&"success"!==s){n.next=1;break}return n.abrupt("return");case 1:return console.log("[TournamentStore] Fetching rounds for passe: ".concat(a," in instance: ").concat(i)),e(function(e){return{passeRoundsStatus:b(b({},e.passeRoundsStatus),{},w({},a,"loading")),status:"loading-passe-rounds",error:null}}),n.prev=2,n.next=3,(0,o.fetchPasseRounds)(i,a);case 3:u=n.sent,e(function(e){return{passeRoundsCache:b(b({},e.passeRoundsCache),{},w({},a,u)),passeRoundsStatus:b(b({},e.passeRoundsStatus),{},w({},a,"success")),status:"success"}}),n.next=5;break;case 4:n.prev=4,c=(l=n.catch(2))instanceof Error?l.message:"Fehler beim Laden der Runden f\xfcr Passe ".concat(a,"."),console.error("[TournamentStore] Error loading rounds for passe ".concat(a,":"),l),e(function(e){return{passeRoundsStatus:b(b({},e.passeRoundsStatus),{},w({},a,"error")),status:"error",error:c}});case 5:case"end":return n.stop()}},n,null,[[2,4]])})),function(e,r){return D.apply(this,arguments)}),addMultipleParticipants:(R=y(m().mark(function n(i,a){var s,u,c,l,h,f,p;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e({status:"managing-participant",error:null}),n.prev=1,s=!0,u=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=d(e))){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(a),n.prev=2,u.s();case 3:if((c=u.n()).done){n.next=8;break}return l=c.value,n.prev=4,n.next=5,(0,o.addParticipantToTournament)(i,l);case 5:n.next=7;break;case 6:n.prev=6,h=n.catch(4),s=!1,console.error("[TournamentStore] Error adding participant ".concat(l," in batch:"),h);case 7:n.next=3;break;case 8:n.next=10;break;case 9:n.prev=9,f=n.catch(2),u.e(f);case 10:return n.prev=10,u.f(),n.finish(10);case 11:if(!s){n.next=13;break}return n.next=12,r().loadTournamentParticipants(i);case 12:return e({status:"success"}),n.abrupt("return",!0);case 13:return n.next=14,r().loadTournamentParticipants(i);case 14:return e({status:"error",error:"Nicht alle Teilnehmer konnten hinzugef\xfcgt werden."}),n.abrupt("return",!1);case 15:n.next=17;break;case 16:return n.prev=16,e({status:"error",error:(p=n.catch(1))instanceof Error?p.message:"Fehler beim Hinzuf\xfcgen der Teilnehmer."}),n.abrupt("return",!1);case 17:case"end":return n.stop()}},n,null,[[1,16],[2,9,10,11],[4,6]])})),function(e,r){return R.apply(this,arguments)}),checkUserActiveTournament:(j=y(m().mark(function i(o){var a,s,u,c;return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if("loading"!==r().userActiveTournamentStatus){i.next=1;break}return i.abrupt("return",!1);case 1:return e({userActiveTournamentStatus:"loading",userActiveTournamentError:null}),i.prev=2,i.next=3,Promise.resolve().then(n.bind(n,93504));case 3:return a=i.sent.fetchActiveTournamentForUser,i.next=4,a(o);case 4:if(!(s=i.sent)){i.next=5;break}return e({userActiveTournamentId:s.id,userActiveTournamentStatus:"success"}),i.abrupt("return",!0);case 5:return e({userActiveTournamentId:null,userActiveTournamentStatus:"success"}),i.abrupt("return",!1);case 6:i.next=8;break;case 7:return i.prev=7,u=(c=i.catch(2))instanceof Error?c.message:"Fehler beim Pr\xfcfen des aktiven Turniers.",console.error("[TournamentStore] Error in checkUserActiveTournament:",c),e({userActiveTournamentId:null,userActiveTournamentStatus:"error",userActiveTournamentError:u}),i.abrupt("return",!1);case 8:case"end":return i.stop()}},i,null,[[2,7]])})),function(e){return j.apply(this,arguments)}),fetchTournamentGameById:(F=y(m().mark(function r(n,i){var o,u,c,l;return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("[TournamentStore] Fetching details for passe ".concat(i," in tournament ").concat(n)),e({passeDetailsStatus:"loading",error:null}),r.prev=1,o=(0,a.doc)(s.db,"tournaments",n,"games",i),r.next=2,(0,a.getDoc)(o);case 2:(u=r.sent).exists()?(c=b(b({},u.data()),{},{passeId:u.id}),console.log("[TournamentStore] Passe ".concat(i," found.")),e({currentViewingPasse:c,passeDetailsStatus:"success"})):(console.warn("[TournamentStore] Passe ".concat(i," not found in tournament ").concat(n,".")),e({currentViewingPasse:null,passeDetailsStatus:"error",error:"Passe nicht gefunden."})),r.next=4;break;case 3:r.prev=3,l=r.catch(1),console.error("[TournamentStore] Error fetching passe ".concat(i,":"),l),e({currentViewingPasse:null,passeDetailsStatus:"error",error:l.message||"Fehler beim Laden der Passen-Details."});case 4:case"end":return r.stop()}},r,null,[[1,3]])})),function(e,r){return F.apply(this,arguments)}),completeTournament:(U=y(m().mark(function n(i){var s,u,c;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"updating-settings",error:null}),n.prev=1,n.next=2,(0,o.markTournamentAsCompletedService)(i);case 2:if(!((s=r().currentTournamentInstance)&&s.id===i)){n.next=3;break}e({currentTournamentInstance:b(b({},s),{},{status:"completed",completedAt:a.Timestamp.now()}),status:"success"}),n.next=5;break;case 3:return n.next=4,r().fetchTournamentInstanceDetails(i);case 4:e({status:"success"});case 5:return n.abrupt("return",!0);case 6:return n.prev=6,u=(c=n.catch(1))instanceof Error?c.message:"Fehler beim Abschliessen des Turniers.",console.error("[TournamentStore] Error completing tournament:",c),e({status:"error",error:u}),n.abrupt("return",!1);case 7:case"end":return n.stop()}},n,null,[[1,6]])})),function(e){return U.apply(this,arguments)}),setupTournamentListener:function(n){var i,o=r().tournamentListenerUnsubscribe;if(o&&(null==(i=r().currentTournamentInstance)?void 0:i.id)===n)return void console.log("[TournamentStore] Listener already exists for tournament ".concat(n,", skipping setup"));o&&o(),console.log("[TournamentStore] Setting up real-time listener for tournament ".concat(n));var h=(0,a.doc)(s.db,"tournaments",n),d=(0,a.onSnapshot)(h,function(i){if(i.exists()){var o,a,s,h,d,f,p,m,g,y,v,w,x,E=i.data(),I=b(b(b({},S),E.settings||{}),{},{scoreSettings:b(b({},u.$d),(null==(o=E.settings)?void 0:o.scoreSettings)||{}),strokeSettings:b(b({},c.zh),(null==(a=E.settings)?void 0:a.strokeSettings)||{}),farbeSettings:b(b({},l.FT),(null==(s=E.settings)?void 0:s.farbeSettings)||{})}),T=b(b({id:i.id},E),{},{settings:I}),k=r().currentTournamentInstance;(null==k?void 0:k.id)===n?k.completedPasseCount!==T.completedPasseCount||k.status!==T.status||JSON.stringify(k.participantUids)!==JSON.stringify(T.participantUids)||k.logoUrl!==T.logoUrl||k.description!==T.description||k.name!==T.name||JSON.stringify(null==(h=k.settings)?void 0:h.rankingMode)!==JSON.stringify(null==(d=T.settings)?void 0:d.rankingMode)||JSON.stringify(null==(f=k.settings)?void 0:f.scoreSettings)!==JSON.stringify(null==(p=T.settings)?void 0:p.scoreSettings)||JSON.stringify(null==(m=k.settings)?void 0:m.strokeSettings)!==JSON.stringify(null==(g=T.settings)?void 0:g.strokeSettings)||JSON.stringify(null==(y=k.settings)?void 0:y.farbeSettings)!==JSON.stringify(null==(v=T.settings)?void 0:v.farbeSettings)||(null==(w=k.settings)?void 0:w.logoUrl)!==(null==(x=T.settings)?void 0:x.logoUrl)?(console.log("[TournamentStore] Relevant changes detected for tournament ".concat(n,", updating state")),e({currentTournamentInstance:T,detailsStatus:"success"}),k.completedPasseCount!==T.completedPasseCount&&(console.log("[TournamentStore] Detected completedPasseCount change, reloading games..."),r().loadTournamentGames(n))):console.log("[TournamentStore] No relevant changes for tournament ".concat(n,", skipping update")):e({currentTournamentInstance:T,detailsStatus:"success"})}else console.warn("[TournamentStore] Tournament ".concat(n," was deleted or is no longer accessible.")),e({currentTournamentInstance:null,detailsStatus:"error",error:"Turnier wurde gel\xf6scht oder ist nicht mehr zug\xe4nglich."})},function(r){console.error("[TournamentStore] Error in tournament real-time listener for ".concat(n,":"),r),e({detailsStatus:"error",error:"Fehler beim Empfangen von Turnier-Updates."})});e({tournamentListenerUnsubscribe:d})},clearTournamentListener:function(){var n=r().tournamentListenerUnsubscribe;n&&(console.log("[TournamentStore] Clearing tournament real-time listener"),n(),e({tournamentListenerUnsubscribe:null}))},resetTournamentState:function(){var n=r().tournamentListenerUnsubscribe;n&&(console.log("[TournamentStore] Removing tournament listener during reset."),n()),e(x)},activateTournament:(M=y(m().mark(function n(i){var a,s;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"updating-settings",error:null}),n.prev=1,n.next=2,(0,o.activateTournamentService)(i);case 2:return n.next=3,r().fetchTournamentInstanceDetails(i);case 3:if("error"!==r().detailsStatus){n.next=4;break}return n.abrupt("return",!1);case 4:return e({status:"success"}),n.abrupt("return",!0);case 5:return n.prev=5,a=(s=n.catch(1))instanceof Error?s.message:"Fehler beim Aktivieren des Turniers.",console.error("[TournamentStore] Error activating tournament ".concat(i,":"),s),e({status:"error",error:a}),n.abrupt("return",!1);case 6:case"end":return n.stop()}},n,null,[[1,5]])})),function(e){return M.apply(this,arguments)}),recordPasseCompletion:(G=y(m().mark(function n(i,o,u,c,l){var h,d,f,p,g,v,w;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e({status:"loading-games",error:null}),console.log("[TournamentStore] Recording completion for passe ".concat(o," in tournament ").concat(i)),n.prev=1,d=(0,a.doc)(s.db,"tournaments",i),f=(0,a.doc)(s.db,"activeGames",o),n.next=2,(0,a.runTransaction)(s.db,function(){var e=y(m().mark(function e(r){var n,o;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,r.get(d);case 1:if((n=e.sent).exists()){e.next=2;break}throw Error("Tournament ".concat(i," not found."));case 2:o=(n.data().participants||[]).map(function(e){if(u.includes(e.uid)){var r=(e.completedPassesCount||0)+1;return b(b({},e),{},{completedPassesCount:r,currentPasseNumberForPlayer:r+1})}return e}),r.update(d,{participants:o}),r.update(f,{status:"completed",completedAt:(0,a.serverTimestamp)(),scores:c,striche:l});case 3:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}());case 2:return(p=r().currentTournamentInstance)&&p.id===i&&(g=(p.participants||[]).map(function(e){if(u.includes(e.uid)){var r=(e.completedPassesCount||0)+1;return b(b({},e),{},{completedPassesCount:r,currentPasseNumberForPlayer:r+1})}return e}),e({currentTournamentInstance:b(b({},p),{},{participants:g}),status:"success"})),(null==(h=r().activePasse)?void 0:h.activeGameId)===o&&e({activePasse:null}),n.next=3,r().loadTournamentGames(i);case 3:n.next=5;break;case 4:throw n.prev=4,v=(w=n.catch(1))instanceof Error?w.message:"Fehler beim Abschliessen der Passe im Turnier.",console.error("[TournamentStore] Error in recordPasseCompletion for passe ".concat(o,":"),w),e({status:"error",error:v}),w;case 5:case"end":return n.stop()}},n,null,[[1,4]])})),function(e,r,n,i,o){return G.apply(this,arguments)})})}),I=function(e){return e.tournamentParticipants},T=function(e){return e.detailsStatus},k=function(e){return e.participantsStatus},_=function(e){return e.gamesStatus},A=function(e){return e.loadingInstanceId}},48449:(e,r,n)=>{"use strict";n.d(r,{Ak:()=>i});let i=(e=21)=>{let r="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)r+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[e]];return r}},48610:(e,r,n)=>{"use strict";n.d(r,{g:()=>u});var i=n(77328),o=n.n(i),a=n(89099),s=n(37876),u=function(e){var r=e.title,n=e.description,i=e.canonicalUrl,u=e.noIndex,c=(0,a.useRouter)(),l="".concat("https://jassguru.ch").concat(c.asPath.endsWith("/")?c.asPath:c.asPath+"/"),h=i||l,d="Jassguru.ch - Die Jass-Community in deiner Tasche",f="Schneller, smarter, vernetzter Jassen. Deine digitale Jasstafel f\xfcr Ranglisten, Statistiken und Turniere. Werde Teil der Jass-Community!";return(0,s.jsxs)(o(),{children:[(0,s.jsx)("title",{children:r||d}),(0,s.jsx)("meta",{name:"description",content:n||f}),u?(0,s.jsx)("meta",{name:"robots",content:"noindex, nofollow"}):(0,s.jsx)("link",{rel:"canonical",href:h}),(0,s.jsx)("meta",{property:"og:site_name",content:"Jassguru"}),(0,s.jsx)("meta",{property:"og:type",content:"website"}),(0,s.jsx)("meta",{property:"og:title",content:r||d}),(0,s.jsx)("meta",{property:"og:description",content:n||f}),(0,s.jsx)("meta",{property:"og:url",content:h}),(0,s.jsx)("meta",{property:"og:image",content:"https://jassguru.ch/apple-touch-icon.png"}),(0,s.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]})}},49397:(e,r,n)=>{"use strict";n.d(r,{O:()=>o});var i=n(37876);function o(e){var r=e.children;return(0,i.jsx)(i.Fragment,{children:r})}},50181:(e,r,n)=>{"use strict";n.d(r,{E:()=>o});var i=n(14232);let o=n(2205).B?i.useLayoutEffect:i.useEffect},50498:(e,r,n)=>{"use strict";n.d(r,{A:()=>h,W:()=>l});var i=n(14232),o=n(50679),a=n(94566),s=n(27212),u=n(23355),c=n(37876),l="Resultat wirklich korrigieren? Folgerunden werden gel\xf6scht.";let h=function(e){var r=e.message,n=e.onConfirm,l=e.onDismiss,h=e.show,d=e.swipePosition,f=void 0===d?"bottom":d,p=(0,a.useUIStore)().closeHistoryWarning,m=(0,i.useRef)(0);(0,i.useEffect)(function(){h&&(m.current=Date.now())},[h]);var g=(0,i.useCallback)(function(){p(),n()},[n,p]),y=(0,i.useCallback)(function(){p(),l()},[l,p]),v=(0,i.useCallback)(function(e){if(Date.now()-m.current<200){e.preventDefault(),e.stopPropagation();return}y()},[y]);return(0,c.jsx)(s.N,{children:h&&(0,c.jsxs)(u.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center z-[9999] p-4 pointer-events-auto",children:[(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:v}),(0,c.jsx)(u.P.div,{initial:{scale:.95},animate:{scale:1},exit:{scale:.95},className:"bg-gray-800 p-6 rounded-lg shadow-lg max-w-xs w-full relative text-white z-10\n              ".concat("top"===f?"rotate-180":""),children:(0,c.jsxs)("div",{className:"".concat("top"===f?"rotate-180":""),children:[(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center mb-4",children:[(0,c.jsx)(o.BS8,{className:"w-12 h-12 text-red-600 mb-6"}),(0,c.jsx)("p",{className:"text-center mb-6",children:r})]}),(0,c.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,c.jsx)("button",{onClick:g,className:"flex-1 bg-yellow-600 text-white px-6 py-2 rounded-full hover:bg-yellow-700 transition-colors text-lg font-semibold",children:"Ja"}),(0,c.jsx)("button",{onClick:y,className:"flex-1 bg-gray-600 text-white px-6 py-2 rounded-full hover:bg-gray-700 transition-colors text-lg font-semibold",children:"Abbrechen"})]})]})})]})})}},50679:(e,r,n)=>{"use strict";n.d(r,{A7C:()=>c,BS8:()=>h,DGu:()=>o,HZi:()=>d,Mbp:()=>m,Pcn:()=>l,QVr:()=>s,RCe:()=>g,Z0P:()=>u,__w:()=>p,eMv:()=>a,rQ8:()=>f,x$1:()=>y});var i=n(67378);function o(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M420.55,301.93a24,24,0,1,1,24-24,24,24,0,0,1-24,24m-265.1,0a24,24,0,1,1,24-24,24,24,0,0,1-24,24m273.7-144.48,47.94-83a10,10,0,1,0-17.27-10h0l-48.54,84.07a301.25,301.25,0,0,0-246.56,0L116.18,64.45a10,10,0,1,0-17.27,10h0l47.94,83C64.53,202.22,8.24,285.55,0,384H576c-8.24-98.45-64.54-181.78-146.85-226.55"},child:[]}]})(e)}function a(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"},child:[]}]})(e)}function s(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function u(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"},child:[]}]})(e)}function c(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(e)}function l(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function h(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function d(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 256 512"},child:[{tag:"path",attr:{d:"M96 496V16c0-8.8-7.2-16-16-16H48c-8.8 0-16 7.2-16 16v480c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16zm128 0V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v480c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16z"},child:[]}]})(e)}function f(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function p(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function m(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"},child:[]}]})(e)}function g(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"},child:[]}]})(e)}function y(e){return(0,i.k5)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}},51139:(e,r,n)=>{"use strict";n.d(r,{cY:()=>v,FA:()=>U,g:()=>F,dM:()=>j,u:()=>h,Uj:()=>l,p9:()=>W,Fy:()=>S,tD:()=>H,bD:()=>function e(r,n){if(r===n)return!0;let i=Object.keys(r),o=Object.keys(n);for(let a of i){if(!o.includes(a))return!1;let i=r[a],s=n[a];if(V(i)&&V(s)){if(!e(i,s))return!1}else if(i!==s)return!1}for(let e of o)if(!i.includes(e))return!1;return!0},hp:()=>q,T9:()=>g,Tj:()=>p,yU:()=>m,XA:()=>y,mS:()=>d,Ku:()=>Q,ZQ:()=>T,sr:()=>P,zJ:()=>b,c1:()=>A,Im:()=>G,lT:()=>C,zW:()=>D,jZ:()=>k,lV:()=>O,nr:()=>N,Ov:()=>L,gE:()=>w,Am:()=>B,I9:()=>z,P1:()=>I,eX:()=>R});var i=n(65364);let o=function(e){let r=[],n=0;for(let i=0;i<e.length;i++){let o=e.charCodeAt(i);o<128?r[n++]=o:(o<2048?r[n++]=o>>6|192:((64512&o)==55296&&i+1<e.length&&(64512&e.charCodeAt(i+1))==56320?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++i)),r[n++]=o>>18|240,r[n++]=o>>12&63|128):r[n++]=o>>12|224,r[n++]=o>>6&63|128),r[n++]=63&o|128)}return r},a=function(e){let r=[],n=0,i=0;for(;n<e.length;){let o=e[n++];if(o<128)r[i++]=String.fromCharCode(o);else if(o>191&&o<224){let a=e[n++];r[i++]=String.fromCharCode((31&o)<<6|63&a)}else if(o>239&&o<365){let a=e[n++],s=((7&o)<<18|(63&a)<<12|(63&e[n++])<<6|63&e[n++])-65536;r[i++]=String.fromCharCode(55296+(s>>10)),r[i++]=String.fromCharCode(56320+(1023&s))}else{let a=e[n++],s=e[n++];r[i++]=String.fromCharCode((15&o)<<12|(63&a)<<6|63&s)}}return r.join("")},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,r){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){let o=e[r],a=r+1<e.length,s=a?e[r+1]:0,u=r+2<e.length,c=u?e[r+2]:0,l=o>>2,h=(3&o)<<4|s>>4,d=(15&s)<<2|c>>6,f=63&c;!u&&(f=64,a||(d=64)),i.push(n[l],n[h],n[d],n[f])}return i.join("")},encodeString(e,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(e):this.encodeByteArray(o(e),r)},decodeString(e,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(e):a(this.decodeStringToByteArray(e,r))},decodeStringToByteArray(e,r){this.init_();let n=r?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){let o=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0,s=++r<e.length?n[e.charAt(r)]:64,c=++r<e.length?n[e.charAt(r)]:64;if(++r,null==o||null==a||null==s||null==c)throw new u;let l=o<<2|a>>4;if(i.push(l),64!==s){let e=a<<4&240|s>>2;if(i.push(e),64!==c){let e=s<<6&192|c;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class u extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let c=function(e){let r=o(e);return s.encodeByteArray(r,!0)},l=function(e){return c(e).replace(/\./g,"")},h=function(e){try{return s.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function d(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw Error("Unable to locate global object.")}let f=()=>{try{return d().__FIREBASE_DEFAULTS__||(()=>{if(void 0===i||void 0===i.env)return;let e=i.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let r=e&&h(e[1]);return r&&JSON.parse(r)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},p=e=>{var r,n;return null==(n=null==(r=f())?void 0:r.emulatorHosts)?void 0:n[e]},m=e=>{let r=p(e);if(!r)return;let n=r.lastIndexOf(":");if(n<=0||n+1===r.length)throw Error(`Invalid host ${r} with no separate hostname and port!`);let i=parseInt(r.substring(n+1),10);return"["===r[0]?[r.substring(1,n-1),i]:[r.substring(0,n),i]},g=()=>{var e;return null==(e=f())?void 0:e.config},y=e=>{var r;return null==(r=f())?void 0:r[`_${e}`]};class v{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(r):e(r,n))}}}function b(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(e){return!1}}async function w(e){return(await fetch(e,{credentials:"include"})).ok}function S(e,r){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n=r||"demo-project",i=e.iat||0,o=e.sub||e.user_id;if(!o)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(a)),""].join(".")}let x={},E=!1;function I(e,r){if("undefined"==typeof window||"undefined"==typeof document||!b(window.location.host)||x[e]===r||x[e]||E)return;function n(e){return`__firebase__banner__${e}`}x[e]=r;let i="__firebase__banner",o=function(){let e={prod:[],emulator:[]};for(let r of Object.keys(x))x[r]?e.emulator.push(r):e.prod.push(r);return e}().prod.length>0;function a(){let e,r,a=(e=document.getElementById(i),r=!1,e||((e=document.createElement("div")).setAttribute("id",i),r=!0),{created:r,element:e}),s=n("text"),u=document.getElementById(s)||document.createElement("span"),c=n("learnmore"),l=document.getElementById(c)||document.createElement("a"),h=n("preprendIcon"),d=document.getElementById(h)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(a.created){let e=a.element;e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center",l.setAttribute("id",c),l.innerText="Learn more",l.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",l.setAttribute("target","__blank"),l.style.paddingLeft="5px",l.style.textDecoration="underline";let r=function(){let e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{E=!0;let e=document.getElementById(i);e&&e.remove()},e}();d.setAttribute("width","24"),d.setAttribute("id",h),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px",e.append(d,u,l,r),document.body.appendChild(e)}o?(u.innerText="Preview backend disconnected.",d.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(d.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,u.innerText="Preview backend running in this workspace."),u.setAttribute("id",s)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function T(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function k(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(T())}function _(){var e;let r=null==(e=f())?void 0:e.forceEnvironment;if("node"===r)return!0;if("browser"===r)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}function A(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function P(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function O(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function C(){let e=T();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function N(){return!_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L(){return!_()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function D(){try{return"object"==typeof indexedDB}catch(e){return!1}}function R(){return new Promise((e,r)=>{try{let n=!0,i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var e;r((null==(e=o.error)?void 0:e.message)||"")}}catch(e){r(e)}})}function j(){return"undefined"!=typeof navigator&&!!navigator.cookieEnabled}class F extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,F.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,U.prototype.create)}}class U{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){var n,i;let o=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],u=s?(n=s,i=o,n.replace(M,(e,r)=>{let n=i[r];return null!=n?String(n):`<${r}?>`})):"Error",c=`${this.serviceName}: ${u} (${a}).`;return new F(a,c,o)}}let M=/\{\$([^}]+)}/g;function G(e){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function V(e){return null!==e&&"object"==typeof e}function B(e){let r=[];for(let[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(e=>{r.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):r.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return r.length?"&"+r.join("&"):""}function z(e){let r={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[n,i]=e.split("=");r[decodeURIComponent(n)]=decodeURIComponent(i)}}),r}function q(e){let r=e.indexOf("?");if(!r)return"";let n=e.indexOf("#",r);return e.substring(r,n>0?n:void 0)}function H(e,r){let n=new $(e,r);return n.subscribe.bind(n)}class ${constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(void 0===e&&void 0===r&&void 0===n)throw Error("Missing Observer.");void 0===(i=!function(e,r){if("object"!=typeof e||null===e)return!1;for(let n of r)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?{next:e,error:r,complete:n}:e).next&&(i.next=K),void 0===i.error&&(i.error=K),void 0===i.complete&&(i.complete=K);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}}),this.observers.push(i),o}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{r(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function K(){}function W(e,r=1e3,n=2){let i=r*Math.pow(n,e),o=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+o)}function Q(e){return e&&e._delegate?e._delegate:e}},53551:(e,r,n)=>{"use strict";n.d(r,{cn:()=>en,N:()=>ei,B:()=>eo});var i=n(69241);let o=(e,r)=>{if(0===e.length)return r.classGroupId;let n=e[0],i=r.nextPart.get(n),a=i?o(e.slice(1),i):void 0;if(a)return a;if(0===r.validators.length)return;let s=e.join("-");return r.validators.find(({validator:e})=>e(s))?.classGroupId},a=/^\[(.+)\]$/,s=(e,r,n,i)=>{e.forEach(e=>{if("string"==typeof e){(""===e?r:u(r,e)).classGroupId=n;return}if("function"==typeof e)return c(e)?void s(e(i),r,n,i):void r.validators.push({validator:e,classGroupId:n});Object.entries(e).forEach(([e,o])=>{s(o,u(r,e),n,i)})})},u=(e,r)=>{let n=e;return r.split("-").forEach(e=>{n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)}),n},c=e=>e.isThemeGetter,l=/\s+/;function h(){let e,r,n=0,i="";for(;n<arguments.length;)(e=arguments[n++])&&(r=d(e))&&(i&&(i+=" "),i+=r);return i}let d=e=>{let r;if("string"==typeof e)return e;let n="";for(let i=0;i<e.length;i++)e[i]&&(r=d(e[i]))&&(n&&(n+=" "),n+=r);return n},f=e=>{let r=r=>r[e]||[];return r.isThemeGetter=!0,r},p=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,m=/^\((?:(\w[\w-]*):)?(.+)\)$/i,g=/^\d+\/\d+$/,y=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,v=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,b=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,w=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,S=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,x=e=>g.test(e),E=e=>!!e&&!Number.isNaN(Number(e)),I=e=>!!e&&Number.isInteger(Number(e)),T=e=>e.endsWith("%")&&E(e.slice(0,-1)),k=e=>y.test(e),_=()=>!0,A=e=>v.test(e)&&!b.test(e),P=()=>!1,O=e=>w.test(e),C=e=>S.test(e),N=e=>!D(e)&&!G(e),L=e=>K(e,Y,P),D=e=>p.test(e),R=e=>K(e,X,A),j=e=>K(e,Z,E),F=e=>K(e,Q,P),U=e=>K(e,J,C),M=e=>K(e,et,O),G=e=>m.test(e),V=e=>W(e,X),B=e=>W(e,ee),z=e=>W(e,Q),q=e=>W(e,Y),H=e=>W(e,J),$=e=>W(e,et,!0),K=(e,r,n)=>{let i=p.exec(e);return!!i&&(i[1]?r(i[1]):n(i[2]))},W=(e,r,n=!1)=>{let i=m.exec(e);return!!i&&(i[1]?r(i[1]):n)},Q=e=>"position"===e||"percentage"===e,J=e=>"image"===e||"url"===e,Y=e=>"length"===e||"size"===e||"bg-size"===e,X=e=>"length"===e,Z=e=>"number"===e,ee=e=>"family-name"===e,et=e=>"shadow"===e;Symbol.toStringTag;let er=function(e,...r){let n,i,u,c=function(l){let h;return i=(n={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let r=0,n=new Map,i=new Map,o=(o,a)=>{n.set(o,a),++r>e&&(r=0,i=n,n=new Map)};return{get(e){let r=n.get(e);return void 0!==r?r:void 0!==(r=i.get(e))?(o(e,r),r):void 0},set(e,r){n.has(e)?n.set(e,r):o(e,r)}}})((h=r.reduce((e,r)=>r(e),e())).cacheSize),parseClassName:(e=>{let{prefix:r,experimentalParseClassName:n}=e,i=e=>{let r,n,i=[],o=0,a=0,s=0;for(let n=0;n<e.length;n++){let u=e[n];if(0===o&&0===a){if(":"===u){i.push(e.slice(s,n)),s=n+1;continue}if("/"===u){r=n;continue}}"["===u?o++:"]"===u?o--:"("===u?a++:")"===u&&a--}let u=0===i.length?e:e.substring(s),c=(n=u).endsWith("!")?n.substring(0,n.length-1):n.startsWith("!")?n.substring(1):n;return{modifiers:i,hasImportantModifier:c!==u,baseClassName:c,maybePostfixModifierPosition:r&&r>s?r-s:void 0}};if(r){let e=r+":",n=i;i=r=>r.startsWith(e)?n(r.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:r,maybePostfixModifierPosition:void 0}}if(n){let e=i;i=r=>n({className:r,parseClassName:e})}return i})(h),sortModifiers:(e=>{let r=Object.fromEntries(e.orderSensitiveModifiers.map(e=>[e,!0]));return e=>{if(e.length<=1)return e;let n=[],i=[];return e.forEach(e=>{"["===e[0]||r[e]?(n.push(...i.sort(),e),i=[]):i.push(e)}),n.push(...i.sort()),n}})(h),...(e=>{let r=(e=>{let{theme:r,classGroups:n}=e,i={nextPart:new Map,validators:[]};for(let e in n)s(n[e],i,e,r);return i})(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:e=>{let n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),o(n,r)||(e=>{if(a.test(e)){let r=a.exec(e)[1],n=r?.substring(0,r.indexOf(":"));if(n)return"arbitrary.."+n}})(e)},getConflictingClassGroupIds:(e,r)=>{let o=n[e]||[];return r&&i[e]?[...o,...i[e]]:o}}})(h)}).cache.get,u=n.cache.set,c=d,d(l)};function d(e){let r=i(e);if(r)return r;let o=((e,r)=>{let{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:o,sortModifiers:a}=r,s=[],u=e.trim().split(l),c="";for(let e=u.length-1;e>=0;e-=1){let r=u[e],{isExternal:l,modifiers:h,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:p}=n(r);if(l){c=r+(c.length>0?" "+c:c);continue}let m=!!p,g=i(m?f.substring(0,p):f);if(!g){if(!m||!(g=i(f))){c=r+(c.length>0?" "+c:c);continue}m=!1}let y=a(h).join(":"),v=d?y+"!":y,b=v+g;if(s.includes(b))continue;s.push(b);let w=o(g,m);for(let e=0;e<w.length;++e){let r=w[e];s.push(v+r)}c=r+(c.length>0?" "+c:c)}return c})(e,n);return u(e,o),o}return function(){return c(h.apply(null,arguments))}}(()=>{let e=f("color"),r=f("font"),n=f("text"),i=f("font-weight"),o=f("tracking"),a=f("leading"),s=f("breakpoint"),u=f("container"),c=f("spacing"),l=f("radius"),h=f("shadow"),d=f("inset-shadow"),p=f("text-shadow"),m=f("drop-shadow"),g=f("blur"),y=f("perspective"),v=f("aspect"),b=f("ease"),w=f("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],A=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],P=()=>[...A(),G,D],O=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto","contain","none"],K=()=>[G,D,c],W=()=>[x,"full","auto",...K()],Q=()=>[I,"none","subgrid",G,D],J=()=>["auto",{span:["full",I,G,D]},I,G,D],Y=()=>[I,"auto",G,D],X=()=>["auto","min","max","fr",G,D],Z=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ee=()=>["start","end","center","stretch","center-safe","end-safe"],et=()=>["auto",...K()],er=()=>[x,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...K()],en=()=>[e,G,D],ei=()=>[...A(),z,F,{position:[G,D]}],eo=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ea=()=>["auto","cover","contain",q,L,{size:[G,D]}],es=()=>[T,V,R],eu=()=>["","none","full",l,G,D],ec=()=>["",E,V,R],el=()=>["solid","dashed","dotted","double"],eh=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ed=()=>[E,T,z,F],ef=()=>["","none",g,G,D],ep=()=>["none",E,G,D],em=()=>["none",E,G,D],eg=()=>[E,G,D],ey=()=>[x,"full",...K()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[k],breakpoint:[k],color:[_],container:[k],"drop-shadow":[k],ease:["in","out","in-out"],font:[N],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[k],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[k],shadow:[k],spacing:["px",E],text:[k],"text-shadow":[k],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",x,D,G,v]}],container:["container"],columns:[{columns:[E,D,G,u]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:P()}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:W()}],"inset-x":[{"inset-x":W()}],"inset-y":[{"inset-y":W()}],start:[{start:W()}],end:[{end:W()}],top:[{top:W()}],right:[{right:W()}],bottom:[{bottom:W()}],left:[{left:W()}],visibility:["visible","invisible","collapse"],z:[{z:[I,"auto",G,D]}],basis:[{basis:[x,"full","auto",u,...K()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[E,x,"auto","initial","none",D]}],grow:[{grow:["",E,G,D]}],shrink:[{shrink:["",E,G,D]}],order:[{order:[I,"first","last","none",G,D]}],"grid-cols":[{"grid-cols":Q()}],"col-start-end":[{col:J()}],"col-start":[{"col-start":Y()}],"col-end":[{"col-end":Y()}],"grid-rows":[{"grid-rows":Q()}],"row-start-end":[{row:J()}],"row-start":[{"row-start":Y()}],"row-end":[{"row-end":Y()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":X()}],"auto-rows":[{"auto-rows":X()}],gap:[{gap:K()}],"gap-x":[{"gap-x":K()}],"gap-y":[{"gap-y":K()}],"justify-content":[{justify:[...Z(),"normal"]}],"justify-items":[{"justify-items":[...ee(),"normal"]}],"justify-self":[{"justify-self":["auto",...ee()]}],"align-content":[{content:["normal",...Z()]}],"align-items":[{items:[...ee(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ee(),{baseline:["","last"]}]}],"place-content":[{"place-content":Z()}],"place-items":[{"place-items":[...ee(),"baseline"]}],"place-self":[{"place-self":["auto",...ee()]}],p:[{p:K()}],px:[{px:K()}],py:[{py:K()}],ps:[{ps:K()}],pe:[{pe:K()}],pt:[{pt:K()}],pr:[{pr:K()}],pb:[{pb:K()}],pl:[{pl:K()}],m:[{m:et()}],mx:[{mx:et()}],my:[{my:et()}],ms:[{ms:et()}],me:[{me:et()}],mt:[{mt:et()}],mr:[{mr:et()}],mb:[{mb:et()}],ml:[{ml:et()}],"space-x":[{"space-x":K()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":K()}],"space-y-reverse":["space-y-reverse"],size:[{size:er()}],w:[{w:[u,"screen",...er()]}],"min-w":[{"min-w":[u,"screen","none",...er()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[s]},...er()]}],h:[{h:["screen","lh",...er()]}],"min-h":[{"min-h":["screen","lh","none",...er()]}],"max-h":[{"max-h":["screen","lh",...er()]}],"font-size":[{text:["base",n,V,R]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,G,j]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",T,D]}],"font-family":[{font:[B,D,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,G,D]}],"line-clamp":[{"line-clamp":[E,"none",G,j]}],leading:[{leading:[a,...K()]}],"list-image":[{"list-image":["none",G,D]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",G,D]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:en()}],"text-color":[{text:en()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...el(),"wavy"]}],"text-decoration-thickness":[{decoration:[E,"from-font","auto",G,R]}],"text-decoration-color":[{decoration:en()}],"underline-offset":[{"underline-offset":[E,"auto",G,D]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:K()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",G,D]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",G,D]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ei()}],"bg-repeat":[{bg:eo()}],"bg-size":[{bg:ea()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},I,G,D],radial:["",G,D],conic:[I,G,D]},H,U]}],"bg-color":[{bg:en()}],"gradient-from-pos":[{from:es()}],"gradient-via-pos":[{via:es()}],"gradient-to-pos":[{to:es()}],"gradient-from":[{from:en()}],"gradient-via":[{via:en()}],"gradient-to":[{to:en()}],rounded:[{rounded:eu()}],"rounded-s":[{"rounded-s":eu()}],"rounded-e":[{"rounded-e":eu()}],"rounded-t":[{"rounded-t":eu()}],"rounded-r":[{"rounded-r":eu()}],"rounded-b":[{"rounded-b":eu()}],"rounded-l":[{"rounded-l":eu()}],"rounded-ss":[{"rounded-ss":eu()}],"rounded-se":[{"rounded-se":eu()}],"rounded-ee":[{"rounded-ee":eu()}],"rounded-es":[{"rounded-es":eu()}],"rounded-tl":[{"rounded-tl":eu()}],"rounded-tr":[{"rounded-tr":eu()}],"rounded-br":[{"rounded-br":eu()}],"rounded-bl":[{"rounded-bl":eu()}],"border-w":[{border:ec()}],"border-w-x":[{"border-x":ec()}],"border-w-y":[{"border-y":ec()}],"border-w-s":[{"border-s":ec()}],"border-w-e":[{"border-e":ec()}],"border-w-t":[{"border-t":ec()}],"border-w-r":[{"border-r":ec()}],"border-w-b":[{"border-b":ec()}],"border-w-l":[{"border-l":ec()}],"divide-x":[{"divide-x":ec()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ec()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...el(),"hidden","none"]}],"divide-style":[{divide:[...el(),"hidden","none"]}],"border-color":[{border:en()}],"border-color-x":[{"border-x":en()}],"border-color-y":[{"border-y":en()}],"border-color-s":[{"border-s":en()}],"border-color-e":[{"border-e":en()}],"border-color-t":[{"border-t":en()}],"border-color-r":[{"border-r":en()}],"border-color-b":[{"border-b":en()}],"border-color-l":[{"border-l":en()}],"divide-color":[{divide:en()}],"outline-style":[{outline:[...el(),"none","hidden"]}],"outline-offset":[{"outline-offset":[E,G,D]}],"outline-w":[{outline:["",E,V,R]}],"outline-color":[{outline:en()}],shadow:[{shadow:["","none",h,$,M]}],"shadow-color":[{shadow:en()}],"inset-shadow":[{"inset-shadow":["none",d,$,M]}],"inset-shadow-color":[{"inset-shadow":en()}],"ring-w":[{ring:ec()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:en()}],"ring-offset-w":[{"ring-offset":[E,R]}],"ring-offset-color":[{"ring-offset":en()}],"inset-ring-w":[{"inset-ring":ec()}],"inset-ring-color":[{"inset-ring":en()}],"text-shadow":[{"text-shadow":["none",p,$,M]}],"text-shadow-color":[{"text-shadow":en()}],opacity:[{opacity:[E,G,D]}],"mix-blend":[{"mix-blend":[...eh(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":eh()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[E]}],"mask-image-linear-from-pos":[{"mask-linear-from":ed()}],"mask-image-linear-to-pos":[{"mask-linear-to":ed()}],"mask-image-linear-from-color":[{"mask-linear-from":en()}],"mask-image-linear-to-color":[{"mask-linear-to":en()}],"mask-image-t-from-pos":[{"mask-t-from":ed()}],"mask-image-t-to-pos":[{"mask-t-to":ed()}],"mask-image-t-from-color":[{"mask-t-from":en()}],"mask-image-t-to-color":[{"mask-t-to":en()}],"mask-image-r-from-pos":[{"mask-r-from":ed()}],"mask-image-r-to-pos":[{"mask-r-to":ed()}],"mask-image-r-from-color":[{"mask-r-from":en()}],"mask-image-r-to-color":[{"mask-r-to":en()}],"mask-image-b-from-pos":[{"mask-b-from":ed()}],"mask-image-b-to-pos":[{"mask-b-to":ed()}],"mask-image-b-from-color":[{"mask-b-from":en()}],"mask-image-b-to-color":[{"mask-b-to":en()}],"mask-image-l-from-pos":[{"mask-l-from":ed()}],"mask-image-l-to-pos":[{"mask-l-to":ed()}],"mask-image-l-from-color":[{"mask-l-from":en()}],"mask-image-l-to-color":[{"mask-l-to":en()}],"mask-image-x-from-pos":[{"mask-x-from":ed()}],"mask-image-x-to-pos":[{"mask-x-to":ed()}],"mask-image-x-from-color":[{"mask-x-from":en()}],"mask-image-x-to-color":[{"mask-x-to":en()}],"mask-image-y-from-pos":[{"mask-y-from":ed()}],"mask-image-y-to-pos":[{"mask-y-to":ed()}],"mask-image-y-from-color":[{"mask-y-from":en()}],"mask-image-y-to-color":[{"mask-y-to":en()}],"mask-image-radial":[{"mask-radial":[G,D]}],"mask-image-radial-from-pos":[{"mask-radial-from":ed()}],"mask-image-radial-to-pos":[{"mask-radial-to":ed()}],"mask-image-radial-from-color":[{"mask-radial-from":en()}],"mask-image-radial-to-color":[{"mask-radial-to":en()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":A()}],"mask-image-conic-pos":[{"mask-conic":[E]}],"mask-image-conic-from-pos":[{"mask-conic-from":ed()}],"mask-image-conic-to-pos":[{"mask-conic-to":ed()}],"mask-image-conic-from-color":[{"mask-conic-from":en()}],"mask-image-conic-to-color":[{"mask-conic-to":en()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ei()}],"mask-repeat":[{mask:eo()}],"mask-size":[{mask:ea()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",G,D]}],filter:[{filter:["","none",G,D]}],blur:[{blur:ef()}],brightness:[{brightness:[E,G,D]}],contrast:[{contrast:[E,G,D]}],"drop-shadow":[{"drop-shadow":["","none",m,$,M]}],"drop-shadow-color":[{"drop-shadow":en()}],grayscale:[{grayscale:["",E,G,D]}],"hue-rotate":[{"hue-rotate":[E,G,D]}],invert:[{invert:["",E,G,D]}],saturate:[{saturate:[E,G,D]}],sepia:[{sepia:["",E,G,D]}],"backdrop-filter":[{"backdrop-filter":["","none",G,D]}],"backdrop-blur":[{"backdrop-blur":ef()}],"backdrop-brightness":[{"backdrop-brightness":[E,G,D]}],"backdrop-contrast":[{"backdrop-contrast":[E,G,D]}],"backdrop-grayscale":[{"backdrop-grayscale":["",E,G,D]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[E,G,D]}],"backdrop-invert":[{"backdrop-invert":["",E,G,D]}],"backdrop-opacity":[{"backdrop-opacity":[E,G,D]}],"backdrop-saturate":[{"backdrop-saturate":[E,G,D]}],"backdrop-sepia":[{"backdrop-sepia":["",E,G,D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":K()}],"border-spacing-x":[{"border-spacing-x":K()}],"border-spacing-y":[{"border-spacing-y":K()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",G,D]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[E,"initial",G,D]}],ease:[{ease:["linear","initial",b,G,D]}],delay:[{delay:[E,G,D]}],animate:[{animate:["none",w,G,D]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,G,D]}],"perspective-origin":[{"perspective-origin":P()}],rotate:[{rotate:ep()}],"rotate-x":[{"rotate-x":ep()}],"rotate-y":[{"rotate-y":ep()}],"rotate-z":[{"rotate-z":ep()}],scale:[{scale:em()}],"scale-x":[{"scale-x":em()}],"scale-y":[{"scale-y":em()}],"scale-z":[{"scale-z":em()}],"scale-3d":["scale-3d"],skew:[{skew:eg()}],"skew-x":[{"skew-x":eg()}],"skew-y":[{"skew-y":eg()}],transform:[{transform:[G,D,"","none","gpu","cpu"]}],"transform-origin":[{origin:P()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ey()}],"translate-x":[{"translate-x":ey()}],"translate-y":[{"translate-y":ey()}],"translate-z":[{"translate-z":ey()}],"translate-none":["translate-none"],accent:[{accent:en()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:en()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",G,D]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":K()}],"scroll-mx":[{"scroll-mx":K()}],"scroll-my":[{"scroll-my":K()}],"scroll-ms":[{"scroll-ms":K()}],"scroll-me":[{"scroll-me":K()}],"scroll-mt":[{"scroll-mt":K()}],"scroll-mr":[{"scroll-mr":K()}],"scroll-mb":[{"scroll-mb":K()}],"scroll-ml":[{"scroll-ml":K()}],"scroll-p":[{"scroll-p":K()}],"scroll-px":[{"scroll-px":K()}],"scroll-py":[{"scroll-py":K()}],"scroll-ps":[{"scroll-ps":K()}],"scroll-pe":[{"scroll-pe":K()}],"scroll-pt":[{"scroll-pt":K()}],"scroll-pr":[{"scroll-pr":K()}],"scroll-pb":[{"scroll-pb":K()}],"scroll-pl":[{"scroll-pl":K()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",G,D]}],fill:[{fill:["none",...en()]}],"stroke-w":[{stroke:[E,V,R,j]}],stroke:[{stroke:["none",...en()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function en(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return er((0,i.$)(r))}var ei=function(e){var r=e.length>1&&e.endsWith("/")?e.slice(0,-1):e;return!!(["/","/auth/login","/auth/register","/auth/reset-password","/agb","/datenschutz","/impressum","/clear-cache","/join","/features"].includes(r)||r.startsWith("/wissen")||r.startsWith("/view")||r.startsWith("/profile"))},eo=function(e){return e?e.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9_]+/g,"-").replace(/(^-|-$)+/g,""):""}},54176:(e,r)=>{"use strict";function n(e){var r=void 0===e?{}:e,n=r.ampFirst,i=r.hybrid,o=r.hasQuery;return void 0!==n&&n||void 0!==i&&i&&void 0!==o&&o}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isInAmpMode",{enumerable:!0,get:function(){return n}})},57724:(e,r,n)=>{"use strict";n.d(r,{J:()=>i});var i=function(e){var r={100:Math.floor(e/100),50:0,20:0},n=e%100;return n>=50&&(r[50]=Math.floor(n/50),n%=50),n>=20&&(r[20]=Math.floor(n/20),n%=20),{striche:r,restZahl:n}}},60481:(e,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return s}});var i=n(14232),o=i.useLayoutEffect,a=i.useEffect;function s(e){var r=e.headManager,n=e.reduceComponentsToState;function s(){if(r&&r.mountedInstances){var o=i.Children.toArray(Array.from(r.mountedInstances).filter(Boolean));r.updateHead(n(o,e))}}return o(function(){var n;return null==r||null==(n=r.mountedInstances)||n.add(e.children),function(){var n;null==r||null==(n=r.mountedInstances)||n.delete(e.children)}}),o(function(){return r&&(r._pendingUpdate=s),function(){r&&(r._pendingUpdate=s)}}),a(function(){return r&&r._pendingUpdate&&(r._pendingUpdate(),r._pendingUpdate=null),function(){r&&r._pendingUpdate&&(r._pendingUpdate(),r._pendingUpdate=null)}}),null}},62704:(e,r,n)=>{"use strict";let i,o;n.d(r,{P2:()=>p});let a=new WeakMap,s=new WeakMap,u=new WeakMap,c=new WeakMap,l=new WeakMap,h={get(e,r,n){if(e instanceof IDBTransaction){if("done"===r)return s.get(e);if("objectStoreNames"===r)return e.objectStoreNames||u.get(e);if("store"===r)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(e[r])},set:(e,r,n)=>(e[r]=n,!0),has:(e,r)=>e instanceof IDBTransaction&&("done"===r||"store"===r)||r in e};function d(e){if(e instanceof IDBRequest){let r=new Promise((r,n)=>{let i=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{r(d(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",o),e.addEventListener("error",a)});return r.then(r=>{r instanceof IDBCursor&&a.set(r,e)}).catch(()=>{}),l.set(r,e),r}if(c.has(e))return c.get(e);let r=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...r){return e.apply(f(this),r),d(a.get(this))}:function(...r){return d(e.apply(f(this),r))}:function(r,...n){let i=e.call(f(this),r,...n);return u.set(i,r.sort?r.sort():[r]),d(i)};return e instanceof IDBTransaction&&function(e){if(s.has(e))return;let r=new Promise((r,n)=>{let i=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{r(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)});s.set(e,r)}(e),(i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(r=>e instanceof r)?new Proxy(e,h):e}(e);return r!==e&&(c.set(e,r),l.set(r,e)),r}let f=e=>l.get(e);function p(e,r,{blocked:n,upgrade:i,blocking:o,terminated:a}={}){let s=indexedDB.open(e,r),u=d(s);return i&&s.addEventListener("upgradeneeded",e=>{i(d(s.result),e.oldVersion,e.newVersion,d(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),u.then(e=>{a&&e.addEventListener("close",()=>a()),o&&e.addEventListener("versionchange",e=>o(e.oldVersion,e.newVersion,e))}).catch(()=>{}),u}let m=["get","getKey","getAll","getAllKeys","count"],g=["put","add","delete","clear"],y=new Map;function v(e,r){if(!(e instanceof IDBDatabase&&!(r in e)&&"string"==typeof r))return;if(y.get(r))return y.get(r);let n=r.replace(/FromIndex$/,""),i=r!==n,o=g.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(o||m.includes(n)))return;let a=async function(e,...r){let a=this.transaction(e,o?"readwrite":"readonly"),s=a.store;return i&&(s=s.index(r.shift())),(await Promise.all([s[n](...r),o&&a.done]))[0]};return y.set(r,a),a}h=(e=>({...e,get:(r,n,i)=>v(r,n)||e.get(r,n,i),has:(r,n)=>!!v(r,n)||e.has(r,n)}))(h)},64609:(e,r,n)=>{"use strict";n.d(r,{jM:()=>q});var i,o=Symbol.for("immer-nothing"),a=Symbol.for("immer-draftable"),s=Symbol.for("immer-state");function u(e){throw Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var c=Object.getPrototypeOf;function l(e){return!!e&&!!e[s]}function h(e){return!!e&&(f(e)||Array.isArray(e)||!!e[a]||!!e.constructor?.[a]||v(e)||b(e))}var d=Object.prototype.constructor.toString();function f(e){if(!e||"object"!=typeof e)return!1;let r=c(e);if(null===r)return!0;let n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===d}function p(e,r){0===m(e)?Reflect.ownKeys(e).forEach(n=>{r(n,e[n],e)}):e.forEach((n,i)=>r(i,n,e))}function m(e){let r=e[s];return r?r.type_:Array.isArray(e)?1:v(e)?2:3*!!b(e)}function g(e,r){return 2===m(e)?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function y(e,r,n){let i=m(e);2===i?e.set(r,n):3===i?e.add(n):e[r]=n}function v(e){return e instanceof Map}function b(e){return e instanceof Set}function w(e){return e.copy_||e.base_}function S(e,r){if(v(e))return new Map(e);if(b(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let n=f(e);if(!0!==r&&("class_only"!==r||n)){let r=c(e);return null!==r&&n?{...e}:Object.assign(Object.create(r),e)}{let r=Object.getOwnPropertyDescriptors(e);delete r[s];let n=Reflect.ownKeys(r);for(let i=0;i<n.length;i++){let o=n[i],a=r[o];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(c(e),r)}}function x(e,r=!1){return I(e)||l(e)||!h(e)||(m(e)>1&&(e.set=e.add=e.clear=e.delete=E),Object.freeze(e),r&&Object.entries(e).forEach(([e,r])=>x(r,!0))),e}function E(){u(2)}function I(e){return Object.isFrozen(e)}var T={};function k(e){let r=T[e];return r||u(0,e),r}function _(e,r){r&&(k("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function A(e){P(e),e.drafts_.forEach(C),e.drafts_=null}function P(e){e===i&&(i=e.parent_)}function O(e){return i={drafts_:[],parent_:i,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function C(e){let r=e[s];0===r.type_||1===r.type_?r.revoke_():r.revoked_=!0}function N(e,r){r.unfinalizedDrafts_=r.drafts_.length;let n=r.drafts_[0];return void 0!==e&&e!==n?(n[s].modified_&&(A(r),u(4)),h(e)&&(e=L(r,e),r.parent_||R(r,e)),r.patches_&&k("Patches").generateReplacementPatches_(n[s].base_,e,r.patches_,r.inversePatches_)):e=L(r,n,[]),A(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==o?e:void 0}function L(e,r,n){if(I(r))return r;let i=r[s];if(!i)return p(r,(o,a)=>D(e,i,r,o,a,n)),r;if(i.scope_!==e)return r;if(!i.modified_)return R(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;let r=i.copy_,o=r,a=!1;3===i.type_&&(o=new Set(r),r.clear(),a=!0),p(o,(o,s)=>D(e,i,r,o,s,n,a)),R(e,r,!1),n&&e.patches_&&k("Patches").generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function D(e,r,n,i,o,a,s){if(l(o)){let s=L(e,o,a&&r&&3!==r.type_&&!g(r.assigned_,i)?a.concat(i):void 0);if(y(n,i,s),!l(s))return;e.canAutoFreeze_=!1}else s&&n.add(o);if(h(o)&&!I(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;L(e,o),(!r||!r.scope_.parent_)&&"symbol"!=typeof i&&Object.prototype.propertyIsEnumerable.call(n,i)&&R(e,o)}}function R(e,r,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&x(r,n)}var j={get(e,r){if(r===s)return e;let n=w(e);if(!g(n,r)){var i=e,o=n,a=r;let s=M(o,a);return s?"value"in s?s.value:s.get?.call(i.draft_):void 0}let u=n[r];return e.finalized_||!h(u)?u:u===U(e.base_,r)?(V(e),e.copy_[r]=B(u,e)):u},has:(e,r)=>r in w(e),ownKeys:e=>Reflect.ownKeys(w(e)),set(e,r,n){let i=M(w(e),r);if(i?.set)return i.set.call(e.draft_,n),!0;if(!e.modified_){let i=U(w(e),r),o=i?.[s];if(o&&o.base_===n)return e.copy_[r]=n,e.assigned_[r]=!1,!0;if((n===i?0!==n||1/n==1/i:n!=n&&i!=i)&&(void 0!==n||g(e.base_,r)))return!0;V(e),G(e)}return!!(e.copy_[r]===n&&(void 0!==n||r in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[r]))||(e.copy_[r]=n,e.assigned_[r]=!0,!0)},deleteProperty:(e,r)=>(void 0!==U(e.base_,r)||r in e.base_?(e.assigned_[r]=!1,V(e),G(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0),getOwnPropertyDescriptor(e,r){let n=w(e),i=Reflect.getOwnPropertyDescriptor(n,r);return i?{writable:!0,configurable:1!==e.type_||"length"!==r,enumerable:i.enumerable,value:n[r]}:i},defineProperty(){u(11)},getPrototypeOf:e=>c(e.base_),setPrototypeOf(){u(12)}},F={};function U(e,r){let n=e[s];return(n?w(n):e)[r]}function M(e,r){if(!(r in e))return;let n=c(e);for(;n;){let e=Object.getOwnPropertyDescriptor(n,r);if(e)return e;n=c(n)}}function G(e){!e.modified_&&(e.modified_=!0,e.parent_&&G(e.parent_))}function V(e){e.copy_||(e.copy_=S(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function B(e,r){let n=v(e)?k("MapSet").proxyMap_(e,r):b(e)?k("MapSet").proxySet_(e,r):function(e,r){let n=Array.isArray(e),o={type_:+!!n,scope_:r?r.scope_:i,modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=o,s=j;n&&(a=[o],s=F);let{revoke:u,proxy:c}=Proxy.revocable(a,s);return o.draft_=c,o.revoke_=u,c}(e,r);return(r?r.scope_:i).drafts_.push(n),n}p(j,(e,r)=>{F[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}}),F.deleteProperty=function(e,r){return F.set.call(this,e,r,void 0)},F.set=function(e,r,n){return j.set.call(this,e[0],r,n,e[0])};var z=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{let i;if("function"==typeof e&&"function"!=typeof r){let n=r;r=e;let i=this;return function(e=n,...o){return i.produce(e,e=>r.call(this,e,...o))}}if("function"!=typeof r&&u(6),void 0!==n&&"function"!=typeof n&&u(7),h(e)){let o=O(this),a=B(e,void 0),s=!0;try{i=r(a),s=!1}finally{s?A(o):P(o)}return _(o,n),N(i,o)}if(e&&"object"==typeof e)u(1,e);else{if(void 0===(i=r(e))&&(i=e),i===o&&(i=void 0),this.autoFreeze_&&x(i,!0),n){let r=[],o=[];k("Patches").generateReplacementPatches_(e,i,r,o),n(r,o)}return i}},this.produceWithPatches=(e,r)=>{let n,i;return"function"==typeof e?(r,...n)=>this.produceWithPatches(r,r=>e(r,...n)):[this.produce(e,r,(e,r)=>{n=e,i=r}),n,i]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){var r;h(e)||u(8),l(e)&&(l(r=e)||u(10,r),e=function e(r){let n;if(!h(r)||I(r))return r;let i=r[s];if(i){if(!i.modified_)return i.base_;i.finalized_=!0,n=S(r,i.scope_.immer_.useStrictShallowCopy_)}else n=S(r,!0);return p(n,(r,i)=>{y(n,r,e(i))}),i&&(i.finalized_=!1),n}(r));let n=O(this),i=B(e,void 0);return i[s].isManual_=!0,P(n),i}finishDraft(e,r){let n=e&&e[s];n&&n.isManual_||u(9);let{scope_:i}=n;return _(i,r),N(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){let i=r[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(r=r.slice(n+1));let i=k("Patches").applyPatches_;return l(e)?i(e,r):this.produce(e,e=>i(e,r))}},q=z.produce;z.produceWithPatches.bind(z),z.setAutoFreeze.bind(z),z.setUseStrictShallowCopy.bind(z),z.applyPatches.bind(z),z.createDraft.bind(z),z.finishDraft.bind(z)},65364:(e,r,n)=>{"use strict";var i,o;e.exports=(null==(i=n.g.process)?void 0:i.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(15861)},65454:()=>{},66534:(e,r,n)=>{"use strict";n.r(r),n.d(r,{createGuestPlayer:()=>S,createPlayer:()=>y,ensurePlayersExist:()=>_,getGroupMembersSortedByGames:()=>A,getPlayerByNickname:()=>v,getPlayerByUserId:()=>b,getPlayerDocument:()=>k,getPlayerIdForUser:()=>I,getPlayersByIds:()=>N,getPublicPlayerProfile:()=>w,getPublicPlayerProfilesByUserIds:()=>O,syncDisplayNameAcrossCollections:()=>P,updatePlayerDocument:()=>C});var i=n(13848),o=n(42009),a=n(48449),s=n(38556);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function l(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?c(Object(n),!0).forEach(function(r){h(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function h(e,r,n){var i;return(i=function(e,r){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=u(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(r,"string"),(r="symbol"==u(i)?i:i+"")in e)?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function d(e,r){if(e){if("string"==typeof e)return f(e,r);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,r):void 0}}function f(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function p(){p=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{h({},"")}catch(e){h=function(e,r,n){return e[r]=n}}function d(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=f(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=f(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function f(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=d;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};h(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){h(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,c){var l=f(e[o],e,a);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==u(d)&&i.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,s,c)},function(e){n("throw",e,s,c)}):r.resolve(d).then(function(e){h.value=e,s(h)},function(e){return n("throw",e,s,c)})}c(l.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(u(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=h(S,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,h(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),h(_.prototype,c,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(d(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),h(T,l,"Generator"),h(T,s,function(){return this}),h(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function m(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function g(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){m(a,i,o,s,u,"next",e)}function u(e){m(a,i,o,s,u,"throw",e)}s(void 0)})}}var y=function(){var e=g(p().mark(function e(r){var n,o,s,u,c,l,h,d,f=arguments;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:null,o=f.length>2?f[2]:void 0,i.collections.players){e.next=1;break}return e.abrupt("return",x(r,null==n?void 0:n.uid));case 1:return e.prev=1,e.next=2,v(r);case 2:if(!e.sent){e.next=3;break}throw Error("Ein Spieler mit dem Nickname '".concat(r,"' existiert bereits."));case 3:return s=!n,u=(null==n?void 0:n.uid)||null,l={id:c=(0,a.Ak)(),displayName:r,userId:u,isGuest:s,createdAt:(0,i.serverTimestamp)(),updatedAt:(0,i.serverTimestamp)(),groupIds:o?[o]:[],metadata:{isOG:!0}},e.next=4,(0,i.setDoc)((0,i.doc)(i.collections.players,c),l);case 4:if(!(n&&i.collections.users)){e.next=6;break}return h=(0,i.doc)(i.collections.users,n.uid),e.next=5,(0,i.getDoc)(h);case 5:if(!e.sent.exists()){e.next=6;break}return e.next=6,(0,i.setDoc)(h,{playerId:c},{merge:!0});case 6:return e.abrupt("return",l);case 7:throw e.prev=7,console.error("Fehler beim Erstellen des Spielers:",d=e.catch(1)),d;case 8:case"end":return e.stop()}},e,null,[[1,7]])}));return function(r){return e.apply(this,arguments)}}(),v=function(){var e=g(p().mark(function e(r){var n,o,a;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.collections.players){e.next=1;break}return e.abrupt("return",null);case 1:return e.prev=1,n=(0,i.query)(i.collections.players,(0,i.where)("displayName","==",r)),e.next=2,(0,i.getDocs)(n);case 2:if(!(o=e.sent).empty){e.next=3;break}return e.abrupt("return",null);case 3:return e.abrupt("return",o.docs[0].data());case 4:throw e.prev=4,console.error("Fehler beim Abrufen des Spielers nach Nickname:",a=e.catch(1)),a;case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r){return e.apply(this,arguments)}}(),b=function(){var e=g(p().mark(function e(r){var n,o,a,s;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.collections.players){e.next=1;break}return console.error("[getPlayerByUserId] collections.players is NULL for userId ".concat(r,"!"),{collections:i.collections,hasDB:!!i.db,collectionsPlayers:i.collections.players}),e.abrupt("return",null);case 1:return e.prev=1,n=(0,i.query)(i.collections.players,(0,i.where)("userId","==",r)),e.next=2,(0,i.getDocs)(n);case 2:if(!(o=e.sent).empty){e.next=3;break}return e.abrupt("return",null);case 3:return(a=o.docs[0].data()).id=o.docs[0].id,e.abrupt("return",a);case 4:throw e.prev=4,console.error("Fehler beim Abrufen des Spielers nach User-ID:",s=e.catch(1)),s;case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r){return e.apply(this,arguments)}}(),w=function(){var e=g(p().mark(function e(r){var n,o,a;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.collections.players){e.next=1;break}return e.abrupt("return",null);case 1:return e.prev=1,e.next=2,(0,i.getDoc)((0,i.doc)(i.collections.players,r));case 2:if((n=e.sent).exists()){e.next=3;break}return e.abrupt("return",null);case 3:return(o=n.data()).id=n.id,"email"in o&&delete o.email,e.abrupt("return",o);case 4:throw e.prev=4,console.error("Fehler beim Abrufen des \xf6ffentlichen Spielerprofils nach ID:",a=e.catch(1)),a;case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r){return e.apply(this,arguments)}}(),S=function(){var e=g(p().mark(function e(r,n){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y(r,null,n));case 1:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),x=function(e,r){return{id:(0,a.Ak)(),displayName:e,userId:r||null,isGuest:!r,createdAt:i.Timestamp.fromDate(new Date),updatedAt:i.Timestamp.fromDate(new Date),groupIds:[],metadata:{isMock:!0}}},E=function(e,r,n){return{displayName:n||"Spieler ".concat(e.slice(0,8),"..."),userId:r,isGuest:!1,createdAt:(0,i.serverTimestamp)(),updatedAt:(0,i.serverTimestamp)(),groupIds:[],metadata:{isOG:!1}}},I=function(){var e=g(p().mark(function e(r,n){var o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!i.db||!r)){e.next=1;break}return console.error("getPlayerIdForUser: Ung\xfcltige Parameter (db, userId)."),e.abrupt("return",null);case 1:return e.prev=2,e.next=3,T(r,n);case 3:return e.abrupt("return",e.sent);case 4:return e.prev=4,o=e.catch(2),console.error("[getPlayerIdForUser] Error processing userId ".concat(r,":"),o),e.abrupt("return",null);case 5:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r,n){return e.apply(this,arguments)}}(),T=function(){var e=g(p().mark(function e(r,n){var u,c,l,h,d,f,m,g,y,v,b,w,S,x,I,T,k,_,A,P;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,o.collection)(i.db,s.eZ),c=(0,i.doc)(i.db,s.sb,r),e.prev=1,e.next=2,(0,i.getDoc)(c);case 2:if(!(l=e.sent).exists()){e.next=10;break}if(!(null!=(h=l.data())&&h.playerId&&"string"==typeof h.playerId)){e.next=9;break}return d=h.playerId,f=(0,i.doc)(u,d),e.next=3,(0,i.getDoc)(f);case 3:if(!e.sent.exists()){e.next=5;break}return e.next=4,(0,i.setDoc)(c,{playerId:d},{merge:!0});case 4:case 7:return e.abrupt("return",d);case 5:return m=(null==h?void 0:h.displayName)||n||"Spieler ".concat(d.slice(0,8),"..."),g=E(d,r,m),e.next=6,(0,i.setDoc)(f,g);case 6:return e.next=7,(0,i.setDoc)(c,{playerId:d},{merge:!0});case 8:e.next=9;break;case 9:e.next=10;break;case 10:return y=(0,i.query)(u,(0,i.where)("userId","==",r)),e.next=11,(0,i.getDocs)(y);case 11:if((v=e.sent).empty){e.next=13;break}return v.size>1&&console.warn("getPlayerIdForUser: Found MULTIPLE (".concat(v.size,") players for userId ").concat(r,". Using the first one.")),b=v.docs[0].id,e.next=12,(0,i.setDoc)(c,{playerId:b},{merge:!0});case 12:return e.abrupt("return",b);case 13:return w=(0,a.Ak)(),S=n||"Spieler ".concat(w.slice(0,8),"..."),x=E(w,r,S),console.log("getPlayerIdForUserInternal: Erstelle neuen Player ".concat(w," f\xfcr userId ").concat(r,"...")),e.prev=14,(I=(0,o.writeBatch)(i.db)).set((0,i.doc)(u,w),x),I.set(c,{playerId:w},{merge:!0}),e.next=15,I.commit();case 15:return console.log("getPlayerIdForUserInternal: ✅ Player ".concat(w," erfolgreich erstellt f\xfcr userId ").concat(r)),e.abrupt("return",w);case 16:return e.prev=16,A=e.catch(14),console.error("getPlayerIdForUserInternal: ❌ Fehler beim Erstellen von Player ".concat(w," f\xfcr userId ").concat(r,":"),A),T=(0,i.query)(u,(0,i.where)("userId","==",r)),e.next=17,(0,i.getDocs)(T);case 17:if((k=e.sent).empty){e.next=19;break}return _=k.docs[0].id,console.log("getPlayerIdForUserInternal: \uD83D\uDD04 Fallback erfolgreich - gefundener Player ".concat(_," f\xfcr userId ").concat(r)),e.next=18,(0,i.setDoc)(c,{playerId:_},{merge:!0});case 18:return e.abrupt("return",_);case 19:return console.error("getPlayerIdForUserInternal: Fallback-Suche nach Erstellungsfehler war erfolglos."),e.abrupt("return",null);case 20:e.next=22;break;case 21:return e.prev=21,P=e.catch(1),console.error("getPlayerIdForUserInternal: General error processing userId ".concat(r,":"),P),e.abrupt("return",null);case 22:case"end":return e.stop()}},e,null,[[1,21],[14,16]])}));return function(r,n){return e.apply(this,arguments)}}(),k=function(){var e=g(p().mark(function e(r){var n,a,u,c,l,h,d,f,m,g;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!i.db||!r)){e.next=1;break}return console.error("getPlayerDocument: Ung\xfcltige Parameter (db, playerId)."),e.abrupt("return",null);case 1:return n=(0,i.doc)(i.db,s.eZ,r),a=null,e.prev=2,e.next=3,(0,o.getDocFromServer)(n);case 3:if(!(u=e.sent).exists()){e.next=4;break}(a=u.data()).id=u.id,e.next=5;break;case 4:return console.warn("getPlayerDocument: Kein Player-Dokument gefunden f\xfcr playerId ".concat(r,".")),e.abrupt("return",null);case 5:e.next=7;break;case 6:return e.prev=6,f=e.catch(2),console.error("getPlayerDocument: Fehler beim initialen Abrufen des Player-Dokuments f\xfcr playerId ".concat(r,":"),f),e.abrupt("return",null);case 7:if(!(a&&!a.userId)){e.next=17;break}return console.warn("getPlayerDocument: userId fehlt im Player-Dokument ".concat(r,". Versuche Fallback \xfcber users-Collection...")),e.prev=8,c=(0,o.collection)(i.db,s.sb),l=(0,i.query)(c,(0,i.where)("playerId","==",r)),e.next=9,(0,i.getDocs)(l);case 9:if((h=e.sent).empty){e.next=14;break}return h.size>1&&console.warn("getPlayerDocument: Mehrere User-Dokumente gefunden f\xfcr playerId ".concat(r,". Verwende das erste.")),d=h.docs[0].id,console.log("getPlayerDocument: Fallback erfolgreich. userId ".concat(d," f\xfcr playerId ").concat(r," gefunden.")),a.userId=d,e.prev=10,e.next=11,(0,o.updateDoc)(n,{userId:d,updatedAt:(0,i.serverTimestamp)()});case 11:console.log("getPlayerDocument: Self-healing erfolgreich. userId im Player-Dokument ".concat(r," aktualisiert.")),e.next=13;break;case 12:e.prev=12,m=e.catch(10),console.error("getPlayerDocument: Fehler beim Self-healing (Aktualisieren der userId im Player-Dokument ".concat(r,"):"),m);case 13:e.next=15;break;case 14:console.error("getPlayerDocument: Fallback fehlgeschlagen. Kein User-Dokument gefunden mit playerId ".concat(r,"."));case 15:e.next=17;break;case 16:e.prev=16,g=e.catch(8),console.error("getPlayerDocument: Fehler beim Fallback-Versuch (Suche in users-Collection) f\xfcr playerId ".concat(r,":"),g);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},e,null,[[2,6],[8,16],[10,12]])}));return function(r){return e.apply(this,arguments)}}(),_=function(){var e=g(p().mark(function e(r,n){var a,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.collections.players){e.next=1;break}return console.warn("ensurePlayersExist: players collection not available (offline?). Returning empty array."),e.abrupt("return",[]);case 1:if(!(!r||0===r.length)){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=3,a=r.filter(function(e){return"string"==typeof e&&""!==e.trim()}).map(function(){var e=g(p().mark(function e(r){var a,u,c,l,h,d,f,m,g,y;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,w(r);case 1:if(!(u=e.sent)){e.next=2;break}return e.abrupt("return",u);case 2:return c=(0,i.doc)(i.db,s.sb,r),e.next=3,(0,i.getDoc)(c);case 3:if(!((l=e.sent).exists()&&null!=(a=l.data())&&a.playerId)){e.next=10;break}return d=null==(h=l.data())?void 0:h.playerId,e.next=4,w(d);case 4:if(!(f=e.sent)){e.next=10;break}return e.prev=5,m=(0,i.doc)(i.db,"groups",n),e.next=6,(0,o.updateDoc)(m,{playerIds:(0,o.arrayRemove)(r)});case 6:return e.next=7,(0,o.updateDoc)(m,{playerIds:(0,o.arrayUnion)(d)});case 7:e.next=9;break;case 8:e.prev=8,g=e.catch(5),console.error("[ensurePlayersExist] ❌ Fehler bei Datenkorrektur f\xfcr Gruppe ".concat(n,":"),g);case 9:return e.abrupt("return",f);case 10:return e.abrupt("return",{id:r,displayName:"Unbekannter Spieler ".concat(r.slice(0,4),"..."),userId:null,isGuest:!1,createdAt:i.Timestamp.fromDate(new Date),updatedAt:i.Timestamp.fromDate(new Date),groupIds:[n],stats:{gamesPlayed:0,wins:0,totalScore:0},_isPlaceholder:!0});case 11:return e.prev=11,y=e.catch(0),console.error("[ensurePlayersExist] Fehler beim Laden/Korrigieren von ID ".concat(r,":"),y),e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,11],[5,8]])}));return function(r){return e.apply(this,arguments)}}()),e.next=4,Promise.all(a);case 4:return u=e.sent.filter(function(e){return null!==e}),e.abrupt("return",u);case 5:throw e.prev=5,console.error("[ensurePlayersExist] Schwerwiegender Fehler beim Laden der Mitgliederdetails:",e.catch(3)),Error("Mitgliederdetails konnten nicht sichergestellt werden.");case 6:case"end":return e.stop()}},e,null,[[3,5]])}));return function(r,n){return e.apply(this,arguments)}}(),A=function(){var e=g(p().mark(function e(r){var n,o,a,s,u,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.collections.groups){e.next=1;break}return console.warn("getGroupMembersSortedByGames: groups collection not available."),e.abrupt("return",[]);case 1:return e.prev=1,n=(0,i.doc)(i.collections.groups,r),e.next=2,(0,i.getDoc)(n);case 2:if((o=e.sent).exists()){e.next=3;break}return console.warn("getGroupMembersSortedByGames: Group with id ".concat(r," not found.")),e.abrupt("return",[]);case 3:if(0!==(s=null!=(a=o.data())&&a.players?Object.keys(a.players):[]).length){e.next=4;break}return console.log("[getGroupMembersSortedByGames] No players found in group object for group ".concat(r,".")),e.abrupt("return",[]);case 4:return e.next=5,_(s,r);case 5:var l;return u=((function(e){if(Array.isArray(e))return f(e)})(l=e.sent)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(l)||d(l)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,r){var n,i,o,a;return(null!=(n=null==(i=r.stats)?void 0:i.gamesPlayed)?n:0)-(null!=(o=null==(a=e.stats)?void 0:a.gamesPlayed)?o:0)}),e.abrupt("return",u);case 6:throw e.prev=6,c=e.catch(1),console.error("Fehler beim Laden und Sortieren der Mitglieder f\xfcr Gruppe ".concat(r,":"),c),Error("Mitglieder konnten nicht geladen oder sortiert werden.");case 7:case"end":return e.stop()}},e,null,[[1,6]])}));return function(r){return e.apply(this,arguments)}}(),P=function(){var e=g(p().mark(function e(r,n,a){var u,c,l,f,m,g,y,v,b,w,S,x,E;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.db){e.next=1;break}throw Error("Firestore ist nicht initialisiert.");case 1:if(!(!r||!n||!a)){e.next=2;break}throw console.error("syncDisplayNameAcrossCollections: Fehlende Parameter",{userId:r,playerId:n,displayName:a}),Error("F\xfcr die Synchronisation sind User-ID, Player-ID und DisplayName erforderlich.");case 2:return e.prev=2,u=[],c=(0,i.doc)(i.db,s.sb,r),l={displayName:a,lastUpdated:(0,i.serverTimestamp)()},u.push((0,i.setDoc)(c,l,{merge:!0}).then(function(){}).catch(function(e){return console.error("Fehler beim Aktualisieren des User-Dokuments ".concat(r,":"),e)})),f=(0,i.doc)(i.db,s.eZ,n),m={displayName:a,updatedAt:(0,i.serverTimestamp)()},u.push((0,i.setDoc)(f,m,{merge:!0}).then(function(){}).catch(function(e){return console.error("Fehler beim Aktualisieren des Player-Dokuments ".concat(n,":"),e)})),e.prev=3,e.next=4,(0,i.getDoc)(f);case 4:if(!(g=e.sent).exists()){e.next=13;break}if(!((v=(null==(y=g.data())?void 0:y.groupIds)||[]).length>0)){e.next=12;break}console.log("Aktualisiere DisplayName in ".concat(v.length," Gruppen-Dokumenten...")),b=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=d(e))){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(v),e.prev=5,S=p().mark(function e(){var r,s,c;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=w.value,s=(0,i.doc)(i.db,"groups",r),c=h({},"players.".concat(n,".displayName"),a),u.push((0,o.updateDoc)(s,c).then(function(){return console.log("DisplayName f\xfcr Player ".concat(n," in Gruppe ").concat(r," aktualisiert."))}).catch(function(e){return console.error("Fehler beim Aktualisieren des DisplayName in Gruppe ".concat(r,":"),e)}));case 1:case"end":return e.stop()}},e)}),b.s();case 6:if((w=b.n()).done){e.next=8;break}return e.delegateYield(S(),"t0",7);case 7:e.next=6;break;case 8:e.next=10;break;case 9:e.prev=9,x=e.catch(5),b.e(x);case 10:return e.prev=10,b.f(),e.finish(10);case 11:e.next=13;break;case 12:case 13:e.next=15;break;case 14:e.prev=14,console.error("Fehler beim Aktualisieren von Gruppen:",e.catch(3));case 15:return e.next=16,Promise.all(u);case 16:e.next=18;break;case 17:throw e.prev=17,console.error("Fehler bei der Synchronisation des DisplayName:",E=e.catch(2)),Error("DisplayName-Synchronisation fehlgeschlagen: ".concat(E instanceof Error?E.message:String(E)));case 18:case"end":return e.stop()}},e,null,[[2,17],[3,14],[5,9,10,11]])}));return function(r,n,i){return e.apply(this,arguments)}}(),O=function(){var e=g(p().mark(function e(r){var n,o,a,s,u,c,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!i.collections.players||!r||0===r.length)){e.next=1;break}return e.abrupt("return",[]);case 1:for(o=0,n=[];o<r.length;o+=30)n.push(r.slice(o,o+30));a=[],s=0,u=n;case 2:if(!(s<u.length)){e.next=7;break}return c=u[s],e.prev=3,h=(0,i.query)(i.collections.players,(0,i.where)("userId","in",c)),e.next=4,(0,i.getDocs)(h);case 4:e.sent.forEach(function(e){var r=e.data();"email"in r&&delete r.email,a.push(l(l({},r),{},{id:e.id}))}),e.next=6;break;case 5:e.prev=5,console.error("Fehler beim Abrufen der Spielerprofile f\xfcr Chunk:",e.catch(3));case 6:s++,e.next=2;break;case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}},e,null,[[3,5]])}));return function(r){return e.apply(this,arguments)}}(),C=function(){var e=g(p().mark(function e(r,n){var a,s,u,c,h;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!i.collections.players||!r)){e.next=1;break}return console.error("updatePlayerDocument: Ung\xfcltige Parameter (collections.players, playerId)."),e.abrupt("return");case 1:a=0,s=["id","userId","isGuest","createdAt"];case 2:if(!(a<s.length)){e.next=4;break}if(!((u=s[a])in n)){e.next=3;break}throw console.error("updatePlayerDocument: Versuch, das gesch\xfctzte Feld '".concat(u,"' zu \xe4ndern, wurde blockiert.")),Error("Das Feld '".concat(u,"' kann nicht aktualisiert werden."));case 3:a++,e.next=2;break;case 4:return e.prev=4,c=(0,i.doc)(i.collections.players,r),e.next=5,(0,o.updateDoc)(c,l(l({},n),{},{updatedAt:(0,i.serverTimestamp)()}));case 5:e.next=7;break;case 6:throw e.prev=6,h=e.catch(4),console.error("Fehler beim Aktualisieren des Spieler-Dokuments ".concat(r,":"),h),h;case 7:case"end":return e.stop()}},e,null,[[4,6]])}));return function(r,n){return e.apply(this,arguments)}}(),N=function(){var e=g(p().mark(function e(r){var n,i;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.warn("[playerService] getPlayersByIds: Stub implementation - function not used in codebase"),!(!r||0===r.length)){e.next=1;break}return e.abrupt("return",new Map);case 1:return n=new Map,e.prev=2,i=r.map(function(){var e=g(p().mark(function e(r){var i,o;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,k(r);case 1:(i=e.sent)&&n.set(r,i),e.next=3;break;case 2:e.prev=2,o=e.catch(0),console.warn("[getPlayersByIds] Failed to load player ".concat(r,":"),o);case 3:case"end":return e.stop()}},e,null,[[0,2]])}));return function(r){return e.apply(this,arguments)}}()),e.next=3,Promise.all(i);case 3:e.next=5;break;case 4:e.prev=4,console.error("[getPlayersByIds] Error loading players:",e.catch(2));case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r){return e.apply(this,arguments)}}()},67378:(e,r,n)=>{"use strict";n.d(r,{k5:()=>d});var i=n(14232),o={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=i.createContext&&i.createContext(o);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=["attr","size","title"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function l(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function h(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?l(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=s(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==s(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function d(e){return function(r){return i.createElement(f,c({attr:h({},e.attr)},r),function e(r){return r&&r.map(function(r,n){return i.createElement(r.tag,h({key:n},r.attr),e(r.child))})}(e.child))}}function f(e){var r=function(r){var n,o=e.attr,a=e.size,s=e.title,l=function(e,r){if(null==e)return{};var n,i,o=function(e,r){if(null==e)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(r.indexOf(i)>=0)continue;n[i]=e[i]}return n}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,u),d=a||r.size||"1em";return r.className&&(n=r.className),e.className&&(n=(n?n+" ":"")+e.className),i.createElement("svg",c({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,o,l,{className:n,style:h(h({color:e.color||r.color},r.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),s&&i.createElement("title",null,s),e.children)};return void 0!==a?i.createElement(a.Consumer,null,function(e){return r(e)}):r(o)}},69241:(e,r,n)=>{"use strict";function i(){for(var e,r,n=0,i="",o=arguments.length;n<o;n++)(e=arguments[n])&&(r=function e(r){var n,i,o="";if("string"==typeof r||"number"==typeof r)o+=r;else if("object"==typeof r)if(Array.isArray(r)){var a=r.length;for(n=0;n<a;n++)r[n]&&(i=e(r[n]))&&(o&&(o+=" "),o+=i)}else for(i in r)r[i]&&(o&&(o+=" "),o+=i);return o}(e))&&(i&&(i+=" "),i+=r);return i}n.d(r,{$:()=>i})},75695:(e,r,n)=>{"use strict";n.d(r,{FE:()=>S,Wq:()=>b,_N:()=>g,_h:()=>w,eg:()=>k,hE:()=>x,kQ:()=>v,nA:()=>I,ri:()=>E,x:()=>T});var i=n(93786),o=n(42009),a=n(95226),s=n(13848),u=n(66534),c=n(40673);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function d(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?h(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=l(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==l(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function f(){f=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function h(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{h({},"")}catch(e){h=function(e,r,n){return e[r]=n}}function d(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=p(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=d;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};h(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){h(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=p(e[o],e,a);if("throw"!==c.type){var h=c.arg,d=h.value;return d&&"object"==l(d)&&i.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(d).then(function(e){h.value=e,s(h)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(l(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=h(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,h(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),h(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(d(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),h(T,c,"Generator"),h(T,s,function(){return this}),h(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function p(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function m(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){p(a,i,o,s,u,"next",e)}function u(e){p(a,i,o,s,u,"throw",e)}s(void 0)})}}var g=function(e,r){var n,i,o,a;return{uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,emailVerified:e.emailVerified,isAnonymous:e.isAnonymous,metadata:{creationTime:e.metadata.creationTime,lastSignInTime:e.metadata.lastSignInTime},lastActiveGroupId:null!=(n=null==r?void 0:r.lastActiveGroupId)?n:null,statusMessage:null!=(i=null==r?void 0:r.statusMessage)?i:null,playerId:null!=(o=null==r?void 0:r.playerId)?o:null,profileTheme:null!=(a=null==r?void 0:r.profileTheme)?a:null}},y=function(){var e=m(f().mark(function e(r){var n,i,a,u,c=arguments;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]&&c[1],!(!r||!r.uid||!s.db)){e.next=1;break}throw Error("Invalid user or Firestore not initialized.");case 1:return e.prev=1,i=(0,o.doc)(s.db,"users",r.uid),a={email:r.email,displayName:r.displayName,lastLogin:(0,o.serverTimestamp)()},n&&(a.createdAt=(0,o.serverTimestamp)(),a.statusMessage="Gr\xfcezi! Ich jasse mit Jassguru.",a.preferences={theme:"light",notifications:!0}),e.next=2,(0,o.setDoc)(i,a,{merge:!0});case 2:e.next=4;break;case 3:throw e.prev=3,u=e.catch(1),console.error("Error in createOrUpdateFirestoreUser for ".concat(r.uid,":"),u),Error("Failed to save user data: ".concat(u instanceof Error?u.message:String(u)));case 4:case"end":return e.stop()}},e,null,[[1,3]])}));return function(r){return e.apply(this,arguments)}}(),v=function(){var e=m(f().mark(function e(r,n){var i,a,u;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!r||!n||0===Object.keys(n).length)){e.next=1;break}return e.abrupt("return");case 1:if(i=["uid","email","createdAt","provider","displayName","photoURL"],!Object.keys(n).some(function(e){return i.includes(e)})){e.next=2;break}throw Error("Attempted to update forbidden/public fields in private user document.");case 2:return e.prev=2,a=(0,o.doc)(s.db,"users",r),e.next=3,(0,o.updateDoc)(a,d(d({},n),{},{lastUpdated:(0,o.serverTimestamp)()}));case 3:e.next=6;break;case 4:if(e.prev=4,!((u=e.catch(2))instanceof Error&&u.message.includes("No document to update"))){e.next=5;break}return e.abrupt("return");case 5:throw console.error("Error updating user document for ".concat(r,":"),u),Error("Failed to update user document.");case 6:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r,n){return e.apply(this,arguments)}}(),b=function(){var e=m(f().mark(function e(r,n,o){var a,s,u,c;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=(0,i.xI)(),e.next=1,(0,i.eJ)(a,r,n);case 1:if(s=e.sent.user,!o){e.next=2;break}return e.next=2,(0,i.r7)(s,{displayName:o});case 2:return e.next=3,y(s,!0);case 3:return e.next=4,(0,i.gA)(s);case 4:return e.abrupt("return",g(s));case 5:if(e.prev=5,console.error("Registrierungsfehler im Service:",{email:r,error:c=e.catch(0)}),!(c instanceof Error)){e.next=7;break}if("auth/email-already-in-use"!==(u=c.code)){e.next=6;break}throw Error("Diese E-Mail-Adresse wird bereits verwendet.");case 6:if("auth/weak-password"!==u){e.next=7;break}throw Error("Das Passwort ist zu schwach. Es muss mindestens 6 Zeichen lang sein.");case 7:throw Error("Registrierung fehlgeschlagen. Bitte \xfcberpr\xfcfen Sie Ihre Eingaben.");case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(r,n,i){return e.apply(this,arguments)}}(),w=function(){var e=m(f().mark(function e(r,n){var o,a,s,u;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,(0,i.x9)((0,i.xI)(),r,n);case 1:if(!(o=e.sent.user)){e.next=4;break}return e.next=2,y(o,!1);case 2:return e.next=3,_(o.uid);case 3:return a=e.sent,e.abrupt("return",g(o,a));case 4:throw Error("Anmeldung fehlgeschlagen: Kein Benutzerobjekt erhalten.");case 5:e.next=9;break;case 6:if(e.prev=6,console.error("Login Fehler (Email):",{email:r,error:u=e.catch(0)}),!(u instanceof Error)){e.next=8;break}if("auth/user-not-found"!==(s=u.code)&&"auth/wrong-password"!==s&&"auth/invalid-credential"!==s){e.next=7;break}throw Error("Ung\xfcltige E-Mail-Adresse oder Passwort.");case 7:if("auth/user-disabled"!==s){e.next=8;break}throw Error("Dieses Benutzerkonto wurde deaktiviert.");case 8:throw Error("Anmeldung fehlgeschlagen. Bitte versuchen Sie es erneut.");case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(r,n){return e.apply(this,arguments)}}(),S=function(){var e=m(f().mark(function e(){var r,n,a,u,c,l,h,d,p;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new i.HF,e.next=1,(0,i.df)((0,i.xI)(),r);case 1:return n=e.sent.user,a=(0,o.doc)(s.db,"users",n.uid),e.next=2,(0,o.getDoc)(a);case 2:return u=e.sent,e.next=3,y(n,!u.exists());case 3:return e.abrupt("return",g(n));case 4:if(e.prev=4,console.error("Google Sign-In Fehler:",{error:p=e.catch(0)}),!(p instanceof Error)){e.next=8;break}if("auth/popup-closed-by-user"!==(c=p.code)){e.next=5;break}throw Error("Google Sign-In wurde abgebrochen.");case 5:if("auth/account-exists-with-different-credential"!==c){e.next=8;break}if(!(h=null==p||null==(l=p.customData)?void 0:l.email)){e.next=7;break}return e.next=6,(0,i.Wm)((0,i.xI)(),h);case 6:throw d=e.sent,Error("Ein Konto existiert bereits mit dieser E-Mail (".concat(h,"), aber mit einer anderen Anmeldemethode (").concat(d.join(", "),")."));case 7:throw Error("Ein Konto existiert bereits mit dieser E-Mail, aber mit einer anderen Anmeldemethode.");case 8:throw Error("Google Sign-In fehlgeschlagen. Bitte versuchen Sie es erneut.");case 9:case"end":return e.stop()}},e,null,[[0,4]])}));return function(){return e.apply(this,arguments)}}(),x=function(e){return(0,i.J1)((0,i.xI)(),e)},E=function(){return(0,i.CI)((0,i.xI)())},I=function(){var e=s.auth.currentUser;if(!e)throw Error("No user logged in.");return(0,i.gA)(e)},T=function(){var e=m(f().mark(function e(r,n){var o,s,l,h,d,p,m,y,v;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!(o=(0,i.xI)().currentUser)||o.uid!==n)){e.next=1;break}throw Error("Authentication error.");case 1:return console.log("[authService] Komprimiere Profilbild: ".concat(r.size," bytes")),e.next=2,(0,c.w)(r,400,.8);case 2:return(s=e.sent)||console.warn("[authService] Bildkomprimierung fehlgeschlagen, verwende Original"),l=s||r,console.log("[authService] Upload-Dateigr\xf6\xdfe: ".concat(l.size," bytes (").concat((l.size/r.size*100).toFixed(1),"% des Originals)")),h=(0,a.c7)(),d=(0,a.KR)(h,"profilePictures/".concat(n,"/profile.").concat(r.name.split(".").pop())),e.next=3,(0,a.D)(d,l);case 3:return p=e.sent,e.next=4,(0,a.qk)(p.ref);case 4:return m=e.sent,e.next=5,(0,i.r7)(o,{photoURL:m});case 5:return e.next=6,(0,u.getPlayerIdForUser)(n,o.displayName);case 6:if(!(y=e.sent)){e.next=7;break}return e.next=7,(0,u.updatePlayerDocument)(y,{photoURL:m});case 7:return e.next=8,_(n);case 8:return v=e.sent,e.abrupt("return",g(o,v));case 9:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),k=function(){var e=m(f().mark(function e(r){var n,a,u;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,i.xI)().currentUser){e.next=1;break}throw Error("No authenticated user found.");case 1:if(a=n.uid,!r.displayName){e.next=2;break}return e.next=2,(0,i.r7)(n,{displayName:r.displayName});case 2:return u=(0,o.doc)(s.db,"users",a),e.next=3,(0,o.updateDoc)(u,d(d({},r),{},{lastUpdated:(0,o.serverTimestamp)()}));case 3:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}(),_=function(){var e=m(f().mark(function e(r){var n,i;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.db){e.next=1;break}return e.abrupt("return",null);case 1:return n=(0,o.doc)(s.db,"users",r),e.next=2,(0,o.getDoc)(n);case 2:return i=e.sent,e.abrupt("return",i.exists()?i.data():null);case 3:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}()},77328:(e,r,n)=>{e.exports=n(38652)},80360:(e,r,n)=>{"use strict";n.d(r,{$h:()=>I,Nk:()=>w,Qo:()=>b,YY:()=>S,Z0:()=>x,ie:()=>E});var i=n(13848),o=n(40673),a=n(38556),s=n(66534);n(75695);var u=n(95226),c=n(31931),l=n(42009),h=n(85253);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function p(){p=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=f(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=f(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function f(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=f(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==d(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(d(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=l(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function m(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function g(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?m(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=d(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==d(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function y(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function v(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){y(a,i,o,s,u,"next",e)}function u(e){y(a,i,o,s,u,"throw",e)}s(void 0)})}}n(38791),n(42471);var b=function(){var e=v(p().mark(function e(r){var n,o,s,u,c,l,d;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.db){e.next=1;break}throw Error("Firestore ist nicht initialisiert.");case 1:if(r){e.next=2;break}return console.warn("getGroupById ohne groupId aufgerufen."),e.abrupt("return",null);case 2:return e.prev=2,n=(0,i.doc)(i.db,a.ce,r),e.next=3,(0,i.getDoc)(n);case 3:if(!(o=e.sent).exists()){e.next=4;break}return c=null!=(s=(u=o.data()).farbeSettings)?s:h.FT,l=g(g({id:o.id},u),{},{farbeSettings:c}),e.abrupt("return",l);case 4:return console.log("Gruppe mit ID ".concat(r," nicht gefunden.")),e.abrupt("return",null);case 5:e.next=7;break;case 6:throw e.prev=6,d=e.catch(2),console.error("Fehler beim Abrufen der Gruppe ".concat(r,":"),d),Error("Fehler beim Abrufen der Gruppendaten.");case 7:case"end":return e.stop()}},e,null,[[2,6]])}));return function(r){return e.apply(this,arguments)}}(),w=function(){var e=v(p().mark(function e(r){var n,o,a;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.db){e.next=1;break}throw Error("Firestore ist nicht initialisiert.");case 1:if(r){e.next=2;break}throw Error("Ung\xfcltige Gruppen-ID.");case 2:return e.prev=2,n=(0,i.collection)(i.db,"groups",r,"members"),e.next=3,(0,i.getDocs)(n);case 3:return o=e.sent.docs.map(function(e){return{playerId:e.id,displayName:e.data().displayName||"Unbekannt",photoURL:e.data().photoURL||null,joinedAt:e.data().joinedAt||l.Timestamp.now()}}),e.abrupt("return",o);case 4:return e.prev=4,a=e.catch(2),console.error("[getGroupMembers] Fehler beim Laden der Members f\xfcr Gruppe ".concat(r,":"),a),e.abrupt("return",[]);case 5:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r){return e.apply(this,arguments)}}(),S=function(){var e=v(p().mark(function e(r){var o,a,s,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.db){e.next=1;break}throw Error("Firestore ist nicht initialisiert.");case 1:if(r){e.next=2;break}throw Error("Ung\xfcltige Gruppen-ID.");case 2:return e.prev=2,e.next=3,w(r);case 3:if(!((o=e.sent).length>0)){e.next=4;break}return a=o.map(function(e){return{id:e.playerId,displayName:e.displayName,photoURL:e.photoURL,userId:null,isGuest:!1,createdAt:e.joinedAt,updatedAt:e.joinedAt,groupIds:[r],stats:{gamesPlayed:0,wins:0,totalScore:0}}}),e.abrupt("return",a);case 4:return e.next=5,Promise.resolve().then(n.bind(n,66534));case 5:return s=e.sent.getGroupMembersSortedByGames,e.next=6,s(r);case 6:case 10:return e.abrupt("return",e.sent);case 7:return e.prev=7,console.error("[getGroupMembersOptimized] ❌ FALLBACK: Fehler beim optimierten Laden, nutze alte Methode:",e.catch(2)),e.prev=8,e.next=9,Promise.resolve().then(n.bind(n,66534));case 9:return u=e.sent.getGroupMembersSortedByGames,e.next=10,u(r);case 11:return e.prev=11,console.error("[getGroupMembersOptimized] ❌ Auch Fallback fehlgeschlagen:",e.catch(8)),e.abrupt("return",[]);case 12:case"end":return e.stop()}},e,null,[[2,7],[8,11]])}));return function(r){return e.apply(this,arguments)}}(),x=function(){var e=v(p().mark(function e(r){var n,o,u,c,d,m,y,v,b,w,S,x,E,I,T,k,_,A,P,O,C,N,L,D,R,j,F,U,M,G,V,B,z,q,H,$,K,W,Q;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.db){e.next=1;break}throw Error("Firestore ist nicht initialisiert.");case 1:if(r){e.next=2;break}return console.warn("getUserGroupsByPlayerId ohne playerId aufgerufen."),e.abrupt("return",[]);case 2:return e.prev=2,e.next=3,(0,s.getPlayerDocument)(r);case 3:if(!(!(n=e.sent)||!n.groupIds||0===n.groupIds.length)){e.next=4;break}return e.abrupt("return",[]);case 4:o=n.groupIds,u=[],c=new Set,d=30,m=0;case 5:if(!(m<o.length)){e.next=11;break}if(0!==(y=o.slice(m,m+d)).length){e.next=6;break}return e.abrupt("continue",10);case 6:return v=(0,i.query)((0,i.collection)(i.db,a.ce),(0,i.where)((0,l.documentId)(),"in",y)),e.prev=7,e.next=8,(0,i.getDocs)(v);case 8:e.sent.forEach(function(e){var r=e.data();r?(u.push({id:e.id,data:r}),c.add(e.id)):console.warn("getUserGroupsByPlayerId: Document data for group ".concat(e.id," was undefined."))}),e.next=10;break;case 9:e.prev=9,$=e.catch(7),console.error("getUserGroupsByPlayerId: Error fetching group chunk with IDs [".concat(y.join(", "),"]:"),$);case 10:m+=d,e.next=5;break;case 11:if(!((b=Array.from(new Set(o)).filter(function(e){return!c.has(e)})).length>0)){e.next=16;break}if(console.warn("getUserGroupsByPlayerId: WARNING - Could not find group documents for ".concat(b.length," requested IDs using 'in' query:"),b),e.prev=12,w=(0,i.doc)(i.db,a.eZ,r),(S=o.filter(function(e){return c.has(e)})).length===o.length){e.next=14;break}return console.log("getUserGroupsByPlayerId: \uD83D\uDD27 AUTO-HEALING: Bereinige ".concat(b.length," fehlende Gruppenreferenzen f\xfcr Player ").concat(r)),e.next=13,(0,i.updateDoc)(w,{groupIds:S,updatedAt:(0,i.serverTimestamp)()});case 13:console.log("getUserGroupsByPlayerId: ✅ Player-Dokument bereinigt. Neue groupIds: [".concat(S.join(", "),"]"));case 14:e.next=16;break;case 15:e.prev=15,K=e.catch(12),console.error("getUserGroupsByPlayerId: ❌ Fehler beim Auto-Healing f\xfcr Player ".concat(r,":"),K);case 16:if(x=[],E=new Set,u.forEach(function(e){(e.data.playerIds||[]).forEach(function(e){return E.add(e)})}),I=Array.from(E),T=new Map,!(I.length>0)){e.next=24;break}k=30,_=0;case 17:if(!(_<I.length)){e.next=23;break}if(0!==(A=I.slice(_,_+k)).length){e.next=18;break}return e.abrupt("continue",22);case 18:return P=(0,i.query)((0,i.collection)(i.db,a.eZ),(0,i.where)((0,l.documentId)(),"in",A)),e.prev=19,e.next=20,(0,i.getDocs)(P);case 20:e.sent.forEach(function(e){var r=e.data();r?T.set(e.id,g(g({},r),{},{id:e.id})):console.warn("getUserGroupsByPlayerId: Player document data for ID ".concat(e.id," was undefined."))}),e.next=22;break;case 21:e.prev=21,W=e.catch(19),console.error("getUserGroupsByPlayerId: Error fetching player chunk with IDs [".concat(A.join(", "),"]:"),W);case 22:_+=k,e.next=17;break;case 23:e.next=24;break;case 24:for(O=0,C=u;O<C.length;O++){R=(D=(L=C[O]).data).playerIds||[],j={},F=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return f(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,r):void 0}}(e))){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(R);try{for(F.s();!(U=F.n()).done;)G=U.value,V=T.get(G),B=null==(M=D.players)?void 0:M[G],V?(z=V.displayName||"Unbekannt",q=(null==B?void 0:B.joinedAt)instanceof l.Timestamp?B.joinedAt:l.Timestamp.now(),j[G]={displayName:z,joinedAt:q}):j[G]={displayName:"Unbekannter Spieler",joinedAt:(null==B?void 0:B.joinedAt)instanceof l.Timestamp?B.joinedAt:l.Timestamp.now()}}catch(e){F.e(e)}finally{F.f()}H=g(g({id:L.id},D),{},{players:j,farbeSettings:null!=(N=D.farbeSettings)?N:h.FT}),x.push(H)}return e.abrupt("return",x);case 25:throw e.prev=25,Q=e.catch(2),console.error("getUserGroupsByPlayerId: General error for player ".concat(r,":"),Q),Error("Fehler beim Abrufen der Gruppendaten des Spielers.");case 26:case"end":return e.stop()}},e,null,[[2,25],[7,9],[12,15],[19,21]])}));return function(r){return e.apply(this,arguments)}}(),E=function(){var e=v(p().mark(function e(r,n){var s,l,h,f,m,g,y,v,b,w,S,x,E,I,T,k,_,A,P,O,C;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.db){e.next=1;break}throw Error("Firestore ist nicht initialisiert.");case 1:if(r){e.next=2;break}throw Error("Gruppen-ID fehlt.");case 2:if(n){e.next=3;break}throw Error("Keine Datei zum Hochladen ausgew\xe4hlt.");case 3:if(s=(0,u.c7)()){e.next=4;break}throw Error("Firebase Storage nicht initialisiert.");case 4:return l=(0,i.doc)(i.db,a.ce,r),e.prev=5,e.next=6,(0,i.getDoc)(l);case 6:if(!(h=e.sent).exists()){e.next=11;break}if(!(m=null==(f=h.data())?void 0:f.logoUrl)){e.next=10;break}return e.prev=7,g=(0,u.KR)(s,m),console.log("Versuche altes Logo zu l\xf6schen: ".concat(m)),e.next=8,(0,u.XR)(g);case 8:console.log("Altes Gruppenlogo gel\xf6scht."),e.next=10;break;case 9:e.prev=9,P=e.catch(7),y=void 0,"object"===d(P)&&null!==P&&"code"in P&&(y=P.code),"storage/object-not-found"!==y?console.warn("Konnte altes Gruppenlogo nicht l\xf6schen:",P):console.log("Altes Gruppenlogo existierte nicht oder konnte nicht gefunden werden (ignoriert).");case 10:e.next=12;break;case 11:throw Error("Gruppe mit ID ".concat(r," nicht gefunden."));case 12:e.next=14;break;case 13:throw e.prev=13,console.error("Fehler beim Abrufen der Gruppe zum L\xf6schen des alten Logos:",e.catch(5)),Error("Fehler bei der Vorbereitung des Logo-Uploads.");case 14:if(v=n.name.split(".").pop()||"png",b=i.auth.currentUser){e.next=15;break}throw Error("Kein authentifizierter Benutzer f\xfcr Logo-Upload.");case 15:if(w=b.uid,S="groupLogos/".concat(w,"/").concat(r,"/logo.").concat(v),x=(0,u.KR)(s,S),e.prev=16,n.type.toLowerCase().startsWith("image/")){e.next=17;break}throw Error("Die Datei ist kein Bild.");case 17:if(!((E=n.size/1048576)>5)){e.next=18;break}throw Error("Logo ist zu gro\xdf (".concat(E.toFixed(2)," MB). Maximum: 5 MB."));case 18:return console.log("[groupService] Komprimiere Gruppenlogo: ".concat(n.size," bytes")),e.next=19,(0,o.w)(n,512,.85);case 19:return(I=e.sent)||console.warn("[groupService] Bildkomprimierung fehlgeschlagen, verwende Original"),T=I||n,console.log("[groupService] Upload-Dateigr\xf6\xdfe: ".concat(T.size," bytes (").concat((T.size/n.size*100).toFixed(1),"% des Originals)")),console.log("Lade Gruppenlogo hoch nach ".concat(S,"...")),e.next=20,(0,u.D)(x,T);case 20:return k=e.sent,console.log("Upload erfolgreich."),e.next=21,(0,u.qk)(k.ref);case 21:return console.log("Download URL erhalten:",_=e.sent),e.prev=22,e.next=23,(0,i.updateDoc)(l,{logoUrl:_,updatedAt:(0,i.serverTimestamp)()});case 23:console.log("Firestore Gruppe ".concat(r," mit neuer logoUrl aktualisiert.")),e.next=26;break;case 24:if(e.prev=24,!((O=e.catch(22))instanceof Error&&O.message.includes("No document to update"))){e.next=25;break}console.warn("GROUP_SERVICE: Group ".concat(r," does not exist, silently ignoring logo URL update.")),e.next=26;break;case 25:throw console.error("Fehler beim Aktualisieren der logoUrl f\xfcr Gruppe ".concat(r,":"),O),Error("Fehler beim Aktualisieren der Gruppe mit neuer Logo-URL.");case 26:return c.Q5.getState().updateGroupInList(r,{logoUrl:_}),console.log("GroupStore f\xfcr Gruppe ".concat(r," mit neuer logoUrl direkt aktualisiert.")),e.abrupt("return",_);case 27:if(e.prev=27,console.error("Fehler beim Hochladen des Gruppenlogos oder Aktualisieren von Firestore:",C=e.catch(16)),!("object"===d(C)&&null!==C&&"code"in C&&C instanceof Error)){e.next=28;break}throw A=C.code,Error("Fehler beim Logo-Upload (".concat(A,"): ").concat(C.message));case 28:if(!(C instanceof Error)){e.next=29;break}throw Error("Fehler beim Logo-Upload: ".concat(C.message));case 29:throw Error("Fehler beim Hochladen des Gruppenlogos.");case 30:case"end":return e.stop()}},e,null,[[5,13],[7,9],[16,27],[22,24]])}));return function(r,n){return e.apply(this,arguments)}}(),I=function(){var e=v(p().mark(function e(r){var n,o,a,u;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.db){e.next=1;break}throw Error("Firestore ist nicht initialisiert.");case 1:if(r){e.next=2;break}return console.warn("fetchGroupMembers ohne groupId aufgerufen."),e.abrupt("return",[]);case 2:return e.prev=2,e.next=3,b(r);case 3:if(!(!(n=e.sent)||!n.playerIds||0===n.playerIds.length)){e.next=4;break}return console.log("[groupService] Keine Player-IDs in Gruppe ".concat(r," gefunden oder Gruppe existiert nicht.")),e.abrupt("return",[]);case 4:return o=n.playerIds.map(function(e){return(0,s.getPlayerDocument)(e)}),e.next=5,Promise.all(o);case 5:return a=e.sent.filter(function(e){return!!e}),console.log("[groupService] Fetched ".concat(a.length," member profiles for group ").concat(r,".")),e.abrupt("return",a);case 6:return e.prev=6,u=e.catch(2),console.error("[groupService] Fehler beim Abrufen der Gruppenmitglieder f\xfcr Gruppe ".concat(r,":"),u),e.abrupt("return",[]);case 7:case"end":return e.stop()}},e,null,[[2,6]])}));return function(r){return e.apply(this,arguments)}}()},81370:(e,r)=>{"use strict";r.byteLength=function(e){var r=c(e),n=r[0],i=r[1];return(n+i)*3/4-i},r.toByteArray=function(e){var r,n,a=c(e),s=a[0],u=a[1],l=new o((s+u)*3/4-u),h=0,d=u>0?s-4:s;for(n=0;n<d;n+=4)r=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],l[h++]=r>>16&255,l[h++]=r>>8&255,l[h++]=255&r;return 2===u&&(r=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,l[h++]=255&r),1===u&&(r=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,l[h++]=r>>8&255,l[h++]=255&r),l},r.fromByteArray=function(e){for(var r,i=e.length,o=i%3,a=[],s=0,u=i-o;s<u;s+=16383)a.push(function(e,r,i){for(var o,a=[],s=r;s<i;s+=3)o=(e[s]<<16&0xff0000)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[o>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}(e,s,s+16383>u?u:s+16383));return 1===o?a.push(n[(r=e[i-1])>>2]+n[r<<4&63]+"=="):2===o&&a.push(n[(r=(e[i-2]<<8)+e[i-1])>>10]+n[r>>4&63]+n[r<<2&63]+"="),a.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function c(e){var r=e.length;if(r%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=r);var i=n===r?0:4-n%4;return[n,i]}i[45]=62,i[95]=63},82824:(e,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"AmpStateContext",{enumerable:!0,get:function(){return i}});var i=n(64252)._(n(14232)).default.createContext({})},82909:(e,r,n)=>{"use strict";var i=n(81370),o=n(87247),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var r=new Uint8Array(e);return Object.setPrototypeOf(r,u.prototype),r}function u(e,r,n){if("number"==typeof e){if("string"==typeof r)throw TypeError('The "string" argument must be of type string. Received type number');return h(e)}return c(e,r,n)}function c(e,r,n){if("string"==typeof e){var i=e,o=r;if(("string"!=typeof o||""===o)&&(o="utf8"),!u.isEncoding(o))throw TypeError("Unknown encoding: "+o);var a=0|m(i,o),c=s(a),l=c.write(i,o);return l!==a&&(c=c.slice(0,l)),c}if(ArrayBuffer.isView(e)){var h=e;if(O(h,Uint8Array)){var g=new Uint8Array(h);return f(g.buffer,g.byteOffset,g.byteLength)}return d(h)}if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(O(e,ArrayBuffer)||e&&O(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(O(e,SharedArrayBuffer)||e&&O(e.buffer,SharedArrayBuffer)))return f(e,r,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var y=e.valueOf&&e.valueOf();if(null!=y&&y!==e)return u.from(y,r,n);var v=function(e){if(u.isBuffer(e)){var r=0|p(e.length),n=s(r);return 0===n.length||e.copy(n,0,0,r),n}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(v)return v;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),r,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),s(e<0?0:0|p(e))}function d(e){for(var r=e.length<0?0:0|p(e.length),n=s(r),i=0;i<r;i+=1)n[i]=255&e[i];return n}function f(e,r,n){var i;if(r<0||e.byteLength<r)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),u.prototype),i}function p(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function m(e,r){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||O(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var o=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return _(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return A(e).length;default:if(o)return i?-1:_(e).length;r=(""+r).toLowerCase(),o=!0}}function g(e,r,n){var o,a,s,u=!1;if((void 0===r||r<0)&&(r=0),r>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(r>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,r,n){var i=e.length;(!r||r<0)&&(r=0),(!n||n<0||n>i)&&(n=i);for(var o="",a=r;a<n;++a)o+=C[e[a]];return o}(this,r,n);case"utf8":case"utf-8":return w(this,r,n);case"ascii":return function(e,r,n){var i="";n=Math.min(e.length,n);for(var o=r;o<n;++o)i+=String.fromCharCode(127&e[o]);return i}(this,r,n);case"latin1":case"binary":return function(e,r,n){var i="";n=Math.min(e.length,n);for(var o=r;o<n;++o)i+=String.fromCharCode(e[o]);return i}(this,r,n);case"base64":return o=this,a=r,s=n,0===a&&s===o.length?i.fromByteArray(o):i.fromByteArray(o.slice(a,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,r,n){for(var i=e.slice(r,n),o="",a=0;a<i.length-1;a+=2)o+=String.fromCharCode(i[a]+256*i[a+1]);return o}(this,r,n);default:if(u)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),u=!0}}function y(e,r,n){var i=e[r];e[r]=e[n],e[n]=i}function v(e,r,n,i,o){var a;if(0===e.length)return -1;if("string"==typeof n?(i=n,n=0):n>0x7fffffff?n=0x7fffffff:n<-0x80000000&&(n=-0x80000000),(a=n*=1)!=a&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length)if(o)return -1;else n=e.length-1;else if(n<0)if(!o)return -1;else n=0;if("string"==typeof r&&(r=u.from(r,i)),u.isBuffer(r))return 0===r.length?-1:b(e,r,n,i,o);if("number"==typeof r){if(r&=255,"function"==typeof Uint8Array.prototype.indexOf)if(o)return Uint8Array.prototype.indexOf.call(e,r,n);else return Uint8Array.prototype.lastIndexOf.call(e,r,n);return b(e,[r],n,i,o)}throw TypeError("val must be string, number or Buffer")}function b(e,r,n,i,o){var a,s=1,u=e.length,c=r.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||r.length<2)return -1;s=2,u/=2,c/=2,n/=2}function l(e,r){return 1===s?e[r]:e.readUInt16BE(r*s)}if(o){var h=-1;for(a=n;a<u;a++)if(l(e,a)===l(r,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===c)return h*s}else -1!==h&&(a-=a-h),h=-1}else for(n+c>u&&(n=u-c),a=n;a>=0;a--){for(var d=!0,f=0;f<c;f++)if(l(e,a+f)!==l(r,f)){d=!1;break}if(d)return a}return -1}function w(e,r,n){n=Math.min(e.length,n);for(var i=[],o=r;o<n;){var a,s,u,c,l=e[o],h=null,d=l>239?4:l>223?3:l>191?2:1;if(o+d<=n)switch(d){case 1:l<128&&(h=l);break;case 2:(192&(a=e[o+1]))==128&&(c=(31&l)<<6|63&a)>127&&(h=c);break;case 3:a=e[o+1],s=e[o+2],(192&a)==128&&(192&s)==128&&(c=(15&l)<<12|(63&a)<<6|63&s)>2047&&(c<55296||c>57343)&&(h=c);break;case 4:a=e[o+1],s=e[o+2],u=e[o+3],(192&a)==128&&(192&s)==128&&(192&u)==128&&(c=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&u)>65535&&c<1114112&&(h=c)}null===h?(h=65533,d=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),o+=d}var f=i,p=f.length;if(p<=4096)return String.fromCharCode.apply(String,f);for(var m="",g=0;g<p;)m+=String.fromCharCode.apply(String,f.slice(g,g+=4096));return m}function S(e,r,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+r>n)throw RangeError("Trying to access beyond buffer length")}function x(e,r,n,i,o,a){if(!u.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<a)throw RangeError('"value" argument is out of bounds');if(n+i>e.length)throw RangeError("Index out of range")}function E(e,r,n,i,o,a){if(n+i>e.length||n<0)throw RangeError("Index out of range")}function I(e,r,n,i,a){return r*=1,n>>>=0,a||E(e,r,n,4,34028234663852886e22,-34028234663852886e22),o.write(e,r,n,i,23,4),n+4}function T(e,r,n,i,a){return r*=1,n>>>=0,a||E(e,r,n,8,17976931348623157e292,-17976931348623157e292),o.write(e,r,n,i,52,8),n+8}r.hp=u,r.IS=50,u.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(e,r),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,r,n){return c(e,r,n)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,r,n){return(l(e),e<=0)?s(e):void 0!==r?"string"==typeof n?s(e).fill(r,n):s(e).fill(r):s(e)},u.allocUnsafe=function(e){return h(e)},u.allocUnsafeSlow=function(e){return h(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,r){if(O(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),O(r,Uint8Array)&&(r=u.from(r,r.offset,r.byteLength)),!u.isBuffer(e)||!u.isBuffer(r))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,i=r.length,o=0,a=Math.min(n,i);o<a;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:+(i<n)},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,r){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);if(void 0===r)for(n=0,r=0;n<e.length;++n)r+=e[n].length;var n,i=u.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var a=e[n];if(O(a,Uint8Array))o+a.length>i.length?u.from(a).copy(i,o):Uint8Array.prototype.set.call(i,a,o);else if(u.isBuffer(a))a.copy(i,o);else throw TypeError('"list" argument must be an Array of Buffers');o+=a.length}return i},u.byteLength=m,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)y(this,r,r+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)y(this,r,r+3),y(this,r+1,r+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)y(this,r,r+7),y(this,r+1,r+6),y(this,r+2,r+5),y(this,r+3,r+4);return this},u.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?w(this,0,e):g.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=r.IS;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},a&&(u.prototype[a]=u.prototype.inspect),u.prototype.compare=function(e,r,n,i,o){if(O(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return -1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var a=o-i,s=n-r,c=Math.min(a,s),l=this.slice(i,o),h=e.slice(r,n),d=0;d<c;++d)if(l[d]!==h[d]){a=l[d],s=h[d];break}return a<s?-1:+(s<a)},u.prototype.includes=function(e,r,n){return -1!==this.indexOf(e,r,n)},u.prototype.indexOf=function(e,r,n){return v(this,e,r,n,!0)},u.prototype.lastIndexOf=function(e,r,n){return v(this,e,r,n,!1)},u.prototype.write=function(e,r,n,i){if(void 0===r)i="utf8",n=this.length,r=0;else if(void 0===n&&"string"==typeof r)i=r,n=this.length,r=0;else if(isFinite(r))r>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o,a,s,u,c,l,h,d,f=this.length-r;if((void 0===n||n>f)&&(n=f),e.length>0&&(n<0||r<0)||r>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var p=!1;;)switch(i){case"hex":return function(e,r,n,i){n=Number(n)||0;var o=e.length-n;i?(i=Number(i))>o&&(i=o):i=o;var a=r.length;i>a/2&&(i=a/2);for(var s=0;s<i;++s){var u,c=parseInt(r.substr(2*s,2),16);if((u=c)!=u)break;e[n+s]=c}return s}(this,e,r,n);case"utf8":case"utf-8":return o=r,a=n,P(_(e,this.length-o),this,o,a);case"ascii":case"latin1":case"binary":return s=r,u=n,P(function(e){for(var r=[],n=0;n<e.length;++n)r.push(255&e.charCodeAt(n));return r}(e),this,s,u);case"base64":return c=r,l=n,P(A(e),this,c,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h=r,d=n,P(function(e,r){for(var n,i,o=[],a=0;a<e.length&&!((r-=2)<0);++a)i=(n=e.charCodeAt(a))>>8,o.push(n%256),o.push(i);return o}(e,this.length-h),this,h,d);default:if(p)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),p=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(e,r){var n=this.length;e=~~e,r=void 0===r?n:~~r,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),r<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<e&&(r=e);var i=this.subarray(e,r);return Object.setPrototypeOf(i,u.prototype),i},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,r,n){e>>>=0,r>>>=0,n||S(e,r,this.length);for(var i=this[e],o=1,a=0;++a<r&&(o*=256);)i+=this[e+a]*o;return i},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,r,n){e>>>=0,r>>>=0,n||S(e,r,this.length);for(var i=this[e+--r],o=1;r>0&&(o*=256);)i+=this[e+--r]*o;return i},u.prototype.readUint8=u.prototype.readUInt8=function(e,r){return e>>>=0,r||S(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,r){return e>>>=0,r||S(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,r){return e>>>=0,r||S(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,r){return e>>>=0,r||S(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,r){return e>>>=0,r||S(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,r,n){e>>>=0,r>>>=0,n||S(e,r,this.length);for(var i=this[e],o=1,a=0;++a<r&&(o*=256);)i+=this[e+a]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*r)),i},u.prototype.readIntBE=function(e,r,n){e>>>=0,r>>>=0,n||S(e,r,this.length);for(var i=r,o=1,a=this[e+--i];i>0&&(o*=256);)a+=this[e+--i]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*r)),a},u.prototype.readInt8=function(e,r){return(e>>>=0,r||S(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},u.prototype.readInt16LE=function(e,r){e>>>=0,r||S(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?0xffff0000|n:n},u.prototype.readInt16BE=function(e,r){e>>>=0,r||S(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?0xffff0000|n:n},u.prototype.readInt32LE=function(e,r){return e>>>=0,r||S(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,r){return e>>>=0,r||S(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,r){return e>>>=0,r||S(e,4,this.length),o.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,r){return e>>>=0,r||S(e,4,this.length),o.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,r){return e>>>=0,r||S(e,8,this.length),o.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,r){return e>>>=0,r||S(e,8,this.length),o.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,r,n,i){if(e*=1,r>>>=0,n>>>=0,!i){var o=Math.pow(2,8*n)-1;x(this,e,r,n,o,0)}var a=1,s=0;for(this[r]=255&e;++s<n&&(a*=256);)this[r+s]=e/a&255;return r+n},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,r,n,i){if(e*=1,r>>>=0,n>>>=0,!i){var o=Math.pow(2,8*n)-1;x(this,e,r,n,o,0)}var a=n-1,s=1;for(this[r+a]=255&e;--a>=0&&(s*=256);)this[r+a]=e/s&255;return r+n},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,1,255,0),this[r]=255&e,r+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,2,65535,0),this[r]=255&e,this[r+1]=e>>>8,r+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=255&e,r+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,4,0xffffffff,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e,r+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,4,0xffffffff,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},u.prototype.writeIntLE=function(e,r,n,i){if(e*=1,r>>>=0,!i){var o=Math.pow(2,8*n-1);x(this,e,r,n,o-1,-o)}var a=0,s=1,u=0;for(this[r]=255&e;++a<n&&(s*=256);)e<0&&0===u&&0!==this[r+a-1]&&(u=1),this[r+a]=(e/s|0)-u&255;return r+n},u.prototype.writeIntBE=function(e,r,n,i){if(e*=1,r>>>=0,!i){var o=Math.pow(2,8*n-1);x(this,e,r,n,o-1,-o)}var a=n-1,s=1,u=0;for(this[r+a]=255&e;--a>=0&&(s*=256);)e<0&&0===u&&0!==this[r+a+1]&&(u=1),this[r+a]=(e/s|0)-u&255;return r+n},u.prototype.writeInt8=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=255&e,r+1},u.prototype.writeInt16LE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,2,32767,-32768),this[r]=255&e,this[r+1]=e>>>8,r+2},u.prototype.writeInt16BE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=255&e,r+2},u.prototype.writeInt32LE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,4,0x7fffffff,-0x80000000),this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4},u.prototype.writeInt32BE=function(e,r,n){return e*=1,r>>>=0,n||x(this,e,r,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},u.prototype.writeFloatLE=function(e,r,n){return I(this,e,r,!0,n)},u.prototype.writeFloatBE=function(e,r,n){return I(this,e,r,!1,n)},u.prototype.writeDoubleLE=function(e,r,n){return T(this,e,r,!0,n)},u.prototype.writeDoubleBE=function(e,r,n){return T(this,e,r,!1,n)},u.prototype.copy=function(e,r,n,i){if(!u.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||0===e.length||0===this.length)return 0;if(r<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o=i-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),o},u.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!u.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){var o,a=e.charCodeAt(0);("utf8"===i&&a<128||"latin1"===i)&&(e=a)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw RangeError("Out of range index");if(n<=r)return this;if(r>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=r;o<n;++o)this[o]=e;else{var s=u.isBuffer(e)?e:u.from(e,i),c=s.length;if(0===c)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-r;++o)this[o+r]=s[o%c]}return this};var k=/[^+/0-9A-Za-z-_]/g;function _(e,r){r=r||1/0;for(var n,i=e.length,o=null,a=[],s=0;s<i;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319||s+1===i){(r-=3)>-1&&a.push(239,191,189);continue}o=n;continue}if(n<56320){(r-=3)>-1&&a.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(r-=3)>-1&&a.push(239,191,189);if(o=null,n<128){if((r-=1)<0)break;a.push(n)}else if(n<2048){if((r-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((r-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((r-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return a}function A(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function P(e,r,n,i){for(var o=0;o<i&&!(o+n>=r.length)&&!(o>=e.length);++o)r[o+n]=e[o];return o}function O(e,r){return e instanceof r||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===r.name}var C=function(){for(var e="0123456789abcdef",r=Array(256),n=0;n<16;++n)for(var i=16*n,o=0;o<16;++o)r[i+o]=e[n]+e[o];return r}()},82987:(e,r,n)=>{"use strict";n.d(r,{DX:()=>u,Dc:()=>l,TL:()=>s});var i=n(14232),o=n(10714),a=n(37876);function s(e){let r=function(e){let r=i.forwardRef((e,r)=>{let{children:n,...a}=e;if(i.isValidElement(n)){var s;let e,u,c=(s=n,(u=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.ref:(u=(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.props.ref:s.props.ref||s.ref),l=function(e,r){let n={...r};for(let i in r){let o=e[i],a=r[i];/^on[A-Z]/.test(i)?o&&a?n[i]=(...e)=>{let r=a(...e);return o(...e),r}:o&&(n[i]=o):"style"===i?n[i]={...o,...a}:"className"===i&&(n[i]=[o,a].filter(Boolean).join(" "))}return{...e,...n}}(a,n.props);return n.type!==i.Fragment&&(l.ref=r?(0,o.t)(r,c):c),i.cloneElement(n,l)}return i.Children.count(n)>1?i.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}(e),n=i.forwardRef((e,n)=>{let{children:o,...s}=e,u=i.Children.toArray(o),c=u.find(h);if(c){let e=c.props.children,o=u.map(r=>r!==c?r:i.Children.count(e)>1?i.Children.only(null):i.isValidElement(e)?e.props.children:null);return(0,a.jsx)(r,{...s,ref:n,children:i.isValidElement(e)?i.cloneElement(e,void 0,o):null})}return(0,a.jsx)(r,{...s,ref:n,children:o})});return n.displayName=`${e}.Slot`,n}var u=s("Slot"),c=Symbol("radix.slottable");function l(e){let r=({children:e})=>(0,a.jsx)(a.Fragment,{children:e});return r.displayName=`${e}.Slottable`,r.__radixId=c,r}function h(e){return i.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===c}},83587:(e,r,n)=>{"use strict";let i;function o(e,r){return new Promise(function(n,i){let o;return a(e).then(function(e){try{return o=e,n(new Blob([r.slice(0,2),o,r.slice(2)],{type:"image/jpeg"}))}catch(e){return i(e)}},i)})}n.d(r,{A:()=>R});let a=e=>new Promise((r,n)=>{let i=new FileReader;i.addEventListener("load",({target:{result:e}})=>{let i=new DataView(e),o=0;if(65496!==i.getUint16(o))return n("not a valid JPEG");for(o+=2;;){let a=i.getUint16(o);if(65498===a)break;let s=i.getUint16(o+2);if(65505===a&&0x45786966===i.getUint32(o+4)){let a,u=o+10;switch(i.getUint16(u)){case 18761:a=!0;break;case 19789:a=!1;break;default:return n("TIFF header contains invalid endian")}if(42!==i.getUint16(u+2,a))return n("TIFF header contains invalid version");let c=i.getUint32(u+4,a),l=u+c+2+12*i.getUint16(u+c,a);for(let e=u+c+2;e<l;e+=12)if(274==i.getUint16(e,a)){if(3!==i.getUint16(e+2,a))return n("Orientation data type is invalid");if(1!==i.getUint32(e+4,a))return n("Orientation data count is invalid");i.setUint16(e+8,1,a);break}return r(e.slice(o,o+2+s))}o+=2+s}return r(new Blob)}),i.readAsArrayBuffer(e)});var s={},u={get exports(){return s},set exports(t){s=t}};!function(e){var r,n,i={};u.exports=i,i.parse=function(e,r){for(var n=i.bin.readUshort,o=i.bin.readUint,a=0,s={},u=new Uint8Array(e),c=u.length-4;0x6054b50!=o(u,c);)c--;var l=n(u,a=c+4+4);n(u,a+=2);var h=o(u,a+=2),d=o(u,a+=4);a+=4,a=d;for(var f=0;f<l;f++){o(u,a),a+=4,a+=4,a+=4,o(u,a+=4),h=o(u,a+=4);var p=o(u,a+=4),m=n(u,a+=4),g=n(u,a+2),y=n(u,a+4);a+=6;var v=o(u,a+=8);a+=4,a+=m+g+y,i._readLocal(u,v,s,h,p,r)}return s},i._readLocal=function(e,r,n,o,a,s){var u=i.bin.readUshort,c=i.bin.readUint;c(e,r),u(e,r+=4),u(e,r+=2);var l=u(e,r+=2);c(e,r+=2),c(e,r+=4),r+=4;var h=u(e,r+=8),d=u(e,r+=2);r+=2;var f=i.bin.readUTF8(e,r,h);if(r+=h,r+=d,s)n[f]={size:a,csize:o};else{var p=new Uint8Array(e.buffer,r);if(0==l)n[f]=new Uint8Array(p.buffer.slice(r,r+o));else{if(8!=l)throw"unknown compression method: "+l;var m=new Uint8Array(a);i.inflateRaw(p,m),n[f]=m}}},i.inflateRaw=function(e,r){return i.F.inflate(e,r)},i.inflate=function(e,r){return e[0],e[1],i.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),r)},i.deflate=function(e,r){null==r&&(r={level:6});var n=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[n]=120,o[n+1]=156,n+=2,n=i.F.deflateRaw(e,o,n,r.level);var a=i.adler(e,0,e.length);return o[n+0]=a>>>24&255,o[n+1]=a>>>16&255,o[n+2]=a>>>8&255,o[n+3]=a>>>0&255,new Uint8Array(o.buffer,0,n+4)},i.deflateRaw=function(e,r){null==r&&(r={level:6});var n=new Uint8Array(50+Math.floor(1.1*e.length)),o=i.F.deflateRaw(e,n,o,r.level);return new Uint8Array(n.buffer,0,o)},i.encode=function(e,r){null==r&&(r=!1);var n=0,o=i.bin.writeUint,a=i.bin.writeUshort,s={};for(var u in e){var c=!i._noNeed(u)&&!r,l=e[u],h=i.crc.crc(l,0,l.length);s[u]={cpr:c,usize:l.length,crc:h,file:c?i.deflateRaw(l):l}}for(var u in s)n+=s[u].file.length+30+46+2*i.bin.sizeUTF8(u);var d=new Uint8Array(n+=22),f=0,p=[];for(var u in s){var m=s[u];p.push(f),f=i._writeHeader(d,f,u,m,0)}var g=0,y=f;for(var u in s)m=s[u],p.push(f),f=i._writeHeader(d,f,u,m,1,p[g++]);var v=f-y;return o(d,f,0x6054b50),f+=4,a(d,f+=4,g),a(d,f+=2,g),o(d,f+=2,v),o(d,f+=4,y),f+=4,f+=2,d.buffer},i._noNeed=function(e){var r=e.split(".").pop().toLowerCase();return -1!="png,jpg,jpeg,zip".indexOf(r)},i._writeHeader=function(e,r,n,o,a,s){var u=i.bin.writeUint,c=i.bin.writeUshort,l=o.file;return u(e,r,0==a?0x4034b50:0x2014b50),r+=4,1==a&&(r+=2),c(e,r,20),c(e,r+=2,0),c(e,r+=2,8*!!o.cpr),u(e,r+=2,0),u(e,r+=4,o.crc),u(e,r+=4,l.length),u(e,r+=4,o.usize),c(e,r+=4,i.bin.sizeUTF8(n)),c(e,r+=2,0),r+=2,1==a&&(r+=2,r+=2,u(e,r+=6,s),r+=4),r+=i.bin.writeUTF8(e,r,n),0==a&&(e.set(l,r),r+=l.length),r},i.crc={table:function(){for(var e=new Uint32Array(256),r=0;r<256;r++){for(var n=r,i=0;i<8;i++)1&n?n=0xedb88320^n>>>1:n>>>=1;e[r]=n}return e}(),update:function(e,r,n,o){for(var a=0;a<o;a++)e=i.crc.table[255&(e^r[n+a])]^e>>>8;return e},crc:function(e,r,n){return 0xffffffff^i.crc.update(0xffffffff,e,r,n)}},i.adler=function(e,r,n){for(var i=1,o=0,a=r,s=r+n;a<s;){for(var u=Math.min(a+5552,s);a<u;)o+=i+=e[a++];i%=65521,o%=65521}return o<<16|i},i.bin={readUshort:function(e,r){return e[r]|e[r+1]<<8},writeUshort:function(e,r,n){e[r]=255&n,e[r+1]=n>>8&255},readUint:function(e,r){return 0x1000000*e[r+3]+(e[r+2]<<16|e[r+1]<<8|e[r])},writeUint:function(e,r,n){e[r]=255&n,e[r+1]=n>>8&255,e[r+2]=n>>16&255,e[r+3]=n>>24&255},readASCII:function(e,r,n){for(var i="",o=0;o<n;o++)i+=String.fromCharCode(e[r+o]);return i},writeASCII:function(e,r,n){for(var i=0;i<n.length;i++)e[r+i]=n.charCodeAt(i)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,r,n){for(var o,a="",s=0;s<n;s++)a+="%"+i.bin.pad(e[r+s].toString(16));try{o=decodeURIComponent(a)}catch(o){return i.bin.readASCII(e,r,n)}return o},writeUTF8:function(e,r,n){for(var i=n.length,o=0,a=0;a<i;a++){var s=n.charCodeAt(a);if(0==(0xffffff80&s))e[r+o]=s,o++;else if(0==(0xfffff800&s))e[r+o]=192|s>>6,e[r+o+1]=128|(0|s)&63,o+=2;else if(0==(0xffff0000&s))e[r+o]=224|s>>12,e[r+o+1]=128|s>>6&63,e[r+o+2]=128|(0|s)&63,o+=3;else{if(0!=(0xffe00000&s))throw"e";e[r+o]=240|s>>18,e[r+o+1]=128|s>>12&63,e[r+o+2]=128|s>>6&63,e[r+o+3]=128|(0|s)&63,o+=4}}return o},sizeUTF8:function(e){for(var r=e.length,n=0,i=0;i<r;i++){var o=e.charCodeAt(i);if(0==(0xffffff80&o))n++;else if(0==(0xfffff800&o))n+=2;else if(0==(0xffff0000&o))n+=3;else{if(0!=(0xffe00000&o))throw"e";n+=4}}return n}},i.F={},i.F.deflateRaw=function(e,r,n,o){var a=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],s=i.F.U,u=i.F._goodIndex;i.F._hash;var c=i.F._putsE,l=0,h=n<<3,d=0,f=e.length;if(0==o){for(;l<f;)c(r,h,+(l+(T=Math.min(65535,f-l))==f)),h=i.F._copyExact(e,l,T,r,h+8),l+=T;return h>>>3}var p=s.lits,m=s.strt,g=s.prev,y=0,v=0,b=0,w=0,S=0,x=0;for(f>2&&(m[x=i.F._hash(e,0)]=0),l=0;l<f;l++){if(S=x,l+1<f-2){x=i.F._hash(e,l+1);var E=l+1&32767;g[E]=m[x],m[x]=E}if(d<=l){(y>14e3||v>26697)&&f-l>100&&(d<l&&(p[y]=l-d,y+=2,d=l),h=i.F._writeBlock(+(l==f-1||d==f),p,y,w,e,b,l-b,r,h),y=v=w=0,b=l);var I=0;l<f-2&&(I=i.F._bestMatch(e,l,g,S,Math.min(a[2],f-l),a[3]));var T=I>>>16,k=65535&I;if(0!=I){k=65535&I;var _=u(T=I>>>16,s.of0);s.lhst[257+_]++;var A=u(k,s.df0);s.dhst[A]++,w+=s.exb[_]+s.dxb[A],p[y]=T<<23|l-d,p[y+1]=k<<16|_<<8|A,y+=2,d=l+T}else s.lhst[e[l]]++;v++}}for(b==l&&0!=e.length||(d<l&&(p[y]=l-d,y+=2,d=l),h=i.F._writeBlock(1,p,y,w,e,b,l-b,r,h),y=0,v=0,y=v=w=0,b=l);0!=(7&h);)h++;return h>>>3},i.F._bestMatch=function(e,r,n,o,a,s){var u=32767&r,c=n[u],l=u-c+32768&32767;if(c==u||o!=i.F._hash(e,r-l))return 0;for(var h=0,d=0,f=Math.min(32767,r);l<=f&&0!=--s&&c!=u;){if(0==h||e[r+h]==e[r+h-l]){var p=i.F._howLong(e,r,l);if(p>h){if(d=l,(h=p)>=a)break;l+2<p&&(p=l+2);for(var m=0,g=0;g<p-2;g++){var y=r-l+g+32768&32767,v=y-n[y]+32768&32767;v>m&&(m=v,c=y)}}}l+=(u=c)-(c=n[u])+32768&32767}return h<<16|d},i.F._howLong=function(e,r,n){if(e[r]!=e[r-n]||e[r+1]!=e[r+1-n]||e[r+2]!=e[r+2-n])return 0;var i=r,o=Math.min(e.length,r+258);for(r+=3;r<o&&e[r]==e[r-n];)r++;return r-i},i.F._hash=function(e,r){return(e[r]<<8|e[r+1])+(e[r+2]<<4)&65535},i.saved=0,i.F._writeBlock=function(e,r,n,o,a,s,u,c,l){var h,d,f,p,m,g,y,v,b,w,S,x=i.F.U,E=i.F._putsF,I=i.F._putsE;x.lhst[256]++,p=(f=i.F.getTrees())[0],m=f[1],g=f[2],y=f[3],v=f[4],b=f[5],w=f[6],S=f[7];var T=32+(0==(l+3&7)?0:8-(l+3&7))+(u<<3),k=o+i.F.contSize(x.fltree,x.lhst)+i.F.contSize(x.fdtree,x.dhst),_=o+i.F.contSize(x.ltree,x.lhst)+i.F.contSize(x.dtree,x.dhst);_+=14+3*b+i.F.contSize(x.itree,x.ihst)+(2*x.ihst[16]+3*x.ihst[17]+7*x.ihst[18]);for(var A=0;A<286;A++)x.lhst[A]=0;for(A=0;A<30;A++)x.dhst[A]=0;for(A=0;A<19;A++)x.ihst[A]=0;var P=T<k&&T<_?0:k<_?1:2;if(E(c,l,e),E(c,l+1,P),l+=3,0==P){for(;0!=(7&l);)l++;l=i.F._copyExact(a,s,u,c,l)}else{if(1==P&&(h=x.fltree,d=x.fdtree),2==P){i.F.makeCodes(x.ltree,p),i.F.revCodes(x.ltree,p),i.F.makeCodes(x.dtree,m),i.F.revCodes(x.dtree,m),i.F.makeCodes(x.itree,g),i.F.revCodes(x.itree,g),h=x.ltree,d=x.dtree,I(c,l,y-257),I(c,l+=5,v-1),I(c,l+=5,b-4),l+=4;for(var O=0;O<b;O++)I(c,l+3*O,x.itree[1+(x.ordr[O]<<1)]);l+=3*b,l=i.F._codeTiny(w,x.itree,c,l),l=i.F._codeTiny(S,x.itree,c,l)}for(var C=s,N=0;N<n;N+=2){for(var L=r[N],D=L>>>23,R=C+(8388607&L);C<R;)l=i.F._writeLit(a[C++],h,c,l);if(0!=D){var j=r[N+1],F=j>>16,U=j>>8&255,M=255&j;I(c,l=i.F._writeLit(257+U,h,c,l),D-x.of0[U]),l+=x.exb[U],E(c,l=i.F._writeLit(M,d,c,l),F-x.df0[M]),l+=x.dxb[M],C+=D}}l=i.F._writeLit(256,h,c,l)}return l},i.F._copyExact=function(e,r,n,i,o){var a=o>>>3;return i[a]=n,i[a+1]=n>>>8,i[a+2]=255-i[a],i[a+3]=255-i[a+1],a+=4,i.set(new Uint8Array(e.buffer,r,n),a),o+(n+4<<3)},i.F.getTrees=function(){for(var e=i.F.U,r=i.F._hufTree(e.lhst,e.ltree,15),n=i.F._hufTree(e.dhst,e.dtree,15),o=[],a=i.F._lenCodes(e.ltree,o),s=[],u=i.F._lenCodes(e.dtree,s),c=0;c<o.length;c+=2)e.ihst[o[c]]++;for(c=0;c<s.length;c+=2)e.ihst[s[c]]++;for(var l=i.F._hufTree(e.ihst,e.itree,7),h=19;h>4&&0==e.itree[1+(e.ordr[h-1]<<1)];)h--;return[r,n,l,a,u,h,o,s]},i.F.getSecond=function(e){for(var r=[],n=0;n<e.length;n+=2)r.push(e[n+1]);return r},i.F.nonZero=function(e){for(var r="",n=0;n<e.length;n+=2)0!=e[n+1]&&(r+=(n>>1)+",");return r},i.F.contSize=function(e,r){for(var n=0,i=0;i<r.length;i++)n+=r[i]*e[1+(i<<1)];return n},i.F._codeTiny=function(e,r,n,o){for(var a=0;a<e.length;a+=2){var s=e[a],u=e[a+1];o=i.F._writeLit(s,r,n,o);var c=16==s?2:17==s?3:7;s>15&&(i.F._putsE(n,o,u,c),o+=c)}return o},i.F._lenCodes=function(e,r){for(var n=e.length;2!=n&&0==e[n-1];)n-=2;for(var i=0;i<n;i+=2){var o=e[i+1],a=i+3<n?e[i+3]:-1,s=i+5<n?e[i+5]:-1,u=0==i?-1:e[i-1];if(0==o&&a==o&&s==o){for(var c=i+5;c+2<n&&e[c+2]==o;)c+=2;(l=Math.min(c+1-i>>>1,138))<11?r.push(17,l-3):r.push(18,l-11),i+=2*l-2}else if(o==u&&a==o&&s==o){for(c=i+5;c+2<n&&e[c+2]==o;)c+=2;var l=Math.min(c+1-i>>>1,6);r.push(16,l-3),i+=2*l-2}else r.push(o,0)}return n>>>1},i.F._hufTree=function(e,r,n){var o=[],a=e.length,s=r.length,u=0;for(u=0;u<s;u+=2)r[u]=0,r[u+1]=0;for(u=0;u<a;u++)0!=e[u]&&o.push({lit:u,f:e[u]});var c=o.length,l=o.slice(0);if(0==c)return 0;if(1==c){var h=o[0].lit;return l=+(0==h),r[1+(h<<1)]=1,r[1+(l<<1)]=1,1}o.sort(function(e,r){return e.f-r.f});var d=o[0],f=o[1],p=0,m=1,g=2;for(o[0]={lit:-1,f:d.f+f.f,l:d,r:f,d:0};m!=c-1;)d=p!=m&&(g==c||o[p].f<o[g].f)?o[p++]:o[g++],f=p!=m&&(g==c||o[p].f<o[g].f)?o[p++]:o[g++],o[m++]={lit:-1,f:d.f+f.f,l:d,r:f};var y=i.F.setDepth(o[m-1],0);for(y>n&&(i.F.restrictDepth(l,n,y),y=n),u=0;u<c;u++)r[1+(l[u].lit<<1)]=l[u].d;return y},i.F.setDepth=function(e,r){return -1!=e.lit?(e.d=r,r):Math.max(i.F.setDepth(e.l,r+1),i.F.setDepth(e.r,r+1))},i.F.restrictDepth=function(e,r,n){var i=0,o=1<<n-r,a=0;for(e.sort(function(e,r){return r.d==e.d?e.f-r.f:r.d-e.d}),i=0;i<e.length&&e[i].d>r;i++){var s=e[i].d;e[i].d=r,a+=o-(1<<n-s)}for(a>>>=n-r;a>0;)(s=e[i].d)<r?(e[i].d++,a-=1<<r-s-1):i++;for(;i>=0;i--)e[i].d==r&&a<0&&(e[i].d--,a++);0!=a&&console.log("debt left")},i.F._goodIndex=function(e,r){var n=0;return r[16]<=e&&(n|=16),r[8|n]<=e&&(n|=8),r[4|n]<=e&&(n|=4),r[2|n]<=e&&(n|=2),r[1|n]<=e&&(n|=1),n},i.F._writeLit=function(e,r,n,o){return i.F._putsF(n,o,r[e<<1]),o+r[1+(e<<1)]},i.F.inflate=function(e,r){var n=Uint8Array;if(3==e[0]&&0==e[1])return r||new n(0);var o=i.F,a=o._bitsF,s=o._bitsE,u=o._decodeTiny,c=o.makeCodes,l=o.codes2map,h=o._get17,d=o.U,f=null==r;f&&(r=new n(e.length>>>2<<3));for(var p,m,g=0,y=0,v=0,b=0,w=0,S=0,x=0,E=0,I=0;0==g;)if(g=a(e,I,1),y=a(e,I+1,2),I+=3,0!=y){if(f&&(r=i.F._check(r,E+131072)),1==y&&(p=d.flmap,m=d.fdmap,S=511,x=31),2==y){v=s(e,I,5)+257,b=s(e,I+5,5)+1,w=s(e,I+10,4)+4,I+=14;for(var T=0;T<38;T+=2)d.itree[T]=0,d.itree[T+1]=0;var k=1;for(T=0;T<w;T++){var _=s(e,I+3*T,3);d.itree[1+(d.ordr[T]<<1)]=_,_>k&&(k=_)}I+=3*w,c(d.itree,k),l(d.itree,k,d.imap),p=d.lmap,m=d.dmap,I=u(d.imap,(1<<k)-1,v+b,e,I,d.ttree);var A=o._copyOut(d.ttree,0,v,d.ltree);S=(1<<A)-1;var P=o._copyOut(d.ttree,v,b,d.dtree);x=(1<<P)-1,c(d.ltree,A),l(d.ltree,A,p),c(d.dtree,P),l(d.dtree,P,m)}for(;;){var O=p[h(e,I)&S];I+=15&O;var C=O>>>4;if(C>>>8==0)r[E++]=C;else{if(256==C)break;var N=E+C-254;if(C>264){var L=d.ldef[C-257];N=E+(L>>>3)+s(e,I,7&L),I+=7&L}var D=m[h(e,I)&x];I+=15&D;var R=D>>>4,j=d.ddef[R],F=(j>>>4)+a(e,I,15&j);for(I+=15&j,f&&(r=i.F._check(r,E+131072));E<N;)r[E]=r[E++-F],r[E]=r[E++-F],r[E]=r[E++-F],r[E]=r[E++-F];E=N}}}else{0!=(7&I)&&(I+=8-(7&I));var U=4+(I>>>3),M=e[U-4]|e[U-3]<<8;f&&(r=i.F._check(r,E+M)),r.set(new n(e.buffer,e.byteOffset+U,M),E),I=U+M<<3,E+=M}return r.length==E?r:r.slice(0,E)},i.F._check=function(e,r){var n=e.length;if(r<=n)return e;var i=new Uint8Array(Math.max(n<<1,r));return i.set(e,0),i},i.F._decodeTiny=function(e,r,n,o,a,s){for(var u=i.F._bitsE,c=i.F._get17,l=0;l<n;){var h=e[c(o,a)&r];a+=15&h;var d=h>>>4;if(d<=15)s[l]=d,l++;else{var f=0,p=0;16==d?(p=3+u(o,a,2),a+=2,f=s[l-1]):17==d?(p=3+u(o,a,3),a+=3):18==d&&(p=11+u(o,a,7),a+=7);for(var m=l+p;l<m;)s[l]=f,l++}}return a},i.F._copyOut=function(e,r,n,i){for(var o=0,a=0,s=i.length>>>1;a<n;){var u=e[a+r];i[a<<1]=0,i[1+(a<<1)]=u,u>o&&(o=u),a++}for(;a<s;)i[a<<1]=0,i[1+(a<<1)]=0,a++;return o},i.F.makeCodes=function(e,r){for(var n,o,a,s,u=i.F.U,c=e.length,l=u.bl_count,h=0;h<=r;h++)l[h]=0;for(h=1;h<c;h+=2)l[e[h]]++;var d=u.next_code;for(n=0,l[0]=0,o=1;o<=r;o++)n=n+l[o-1]<<1,d[o]=n;for(a=0;a<c;a+=2)0!=(s=e[a+1])&&(e[a]=d[s],d[s]++)},i.F.codes2map=function(e,r,n){for(var o=e.length,a=i.F.U.rev15,s=0;s<o;s+=2)if(0!=e[s+1])for(var u=s>>1,c=e[s+1],l=u<<4|c,h=r-c,d=e[s]<<h,f=d+(1<<h);d!=f;)n[a[d]>>>15-r]=l,d++},i.F.revCodes=function(e,r){for(var n=i.F.U.rev15,o=15-r,a=0;a<e.length;a+=2){var s=e[a]<<r-e[a+1];e[a]=n[s]>>>o}},i.F._putsE=function(e,r,n){n<<=7&r;var i=r>>>3;e[i]|=n,e[i+1]|=n>>>8},i.F._putsF=function(e,r,n){n<<=7&r;var i=r>>>3;e[i]|=n,e[i+1]|=n>>>8,e[i+2]|=n>>>16},i.F._bitsE=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<n)-1},i.F._bitsF=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<n)-1},i.F._get17=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},i.F._get25=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},i.F.U=(r=Uint16Array,n=Uint32Array,{next_code:new r(16),bl_count:new r(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new r(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new n(32),flmap:new r(512),fltree:[],fdmap:new r(32),fdtree:[],lmap:new r(32768),ltree:[],ttree:[],dmap:new r(32768),dtree:[],imap:new r(512),itree:[],rev15:new r(32768),lhst:new n(286),dhst:new n(30),ihst:new n(19),lits:new n(15e3),strt:new r(65536),prev:new r(32768)}),function(){for(var e=i.F.U,r=0;r<32768;r++){var n=r;n=(0xff00ff00&(n=(0xf0f0f0f0&(n=(0xcccccccc&(n=(0xaaaaaaaa&n)>>>1|(0x55555555&n)<<1))>>>2|(0x33333333&n)<<2))>>>4|(0xf0f0f0f&n)<<4))>>>8|(0xff00ff&n)<<8,e.rev15[r]=(n>>>16|n<<16)>>>17}function o(e,r,n){for(;0!=r--;)e.push(0,n)}for(r=0;r<32;r++)e.ldef[r]=e.of0[r]<<3|e.exb[r],e.ddef[r]=e.df0[r]<<4|e.dxb[r];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),i.F.makeCodes(e.fltree,9),i.F.codes2map(e.fltree,9,e.flmap),i.F.revCodes(e.fltree,9),o(e.fdtree,32,5),i.F.makeCodes(e.fdtree,5),i.F.codes2map(e.fdtree,5,e.fdmap),i.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)}()}();var c=function(e,r){return r.forEach(function(r){r&&"string"!=typeof r&&!Array.isArray(r)&&Object.keys(r).forEach(function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}})}),Object.freeze(e)}({__proto__:null,default:s},[s]);let l=function(){var e={nextZero(e,r){for(;0!=e[r];)r++;return r},readUshort:(e,r)=>e[r]<<8|e[r+1],writeUshort(e,r,n){e[r]=n>>8&255,e[r+1]=255&n},readUint:(e,r)=>0x1000000*e[r]+(e[r+1]<<16|e[r+2]<<8|e[r+3]),writeUint(e,r,n){e[r]=n>>24&255,e[r+1]=n>>16&255,e[r+2]=n>>8&255,e[r+3]=255&n},readASCII(e,r,n){let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(e[r+o]);return i},writeASCII(e,r,n){for(let i=0;i<n.length;i++)e[r+i]=n.charCodeAt(i)},readBytes(e,r,n){let i=[];for(let o=0;o<n;o++)i.push(e[r+o]);return i},pad:e=>e.length<2?`0${e}`:e,readUTF8(r,n,i){let o,a="";for(let o=0;o<i;o++)a+=`%${e.pad(r[n+o].toString(16))}`;try{o=decodeURIComponent(a)}catch(o){return e.readASCII(r,n,i)}return o}};function r(r,n,i,o){let s=n*i,u=Math.ceil(n*a(o)/8),c=new Uint8Array(4*s),l=new Uint32Array(c.buffer),{ctype:h}=o,{depth:d}=o,f=e.readUshort;if(6==h){let e=s<<2;if(8==d)for(var p=0;p<e;p+=4)c[p]=r[p],c[p+1]=r[p+1],c[p+2]=r[p+2],c[p+3]=r[p+3];if(16==d)for(p=0;p<e;p++)c[p]=r[p<<1]}else if(2==h){let e=o.tabs.tRNS;if(null==e){if(8==d)for(p=0;p<s;p++){var m=3*p;l[p]=-0x1000000|r[m+2]<<16|r[m+1]<<8|r[m]}if(16==d)for(p=0;p<s;p++)m=6*p,l[p]=-0x1000000|r[m+4]<<16|r[m+2]<<8|r[m]}else{var g=e[0];let n=e[1],i=e[2];if(8==d)for(p=0;p<s;p++){var y=p<<2;m=3*p,l[p]=-0x1000000|r[m+2]<<16|r[m+1]<<8|r[m],r[m]==g&&r[m+1]==n&&r[m+2]==i&&(c[y+3]=0)}if(16==d)for(p=0;p<s;p++)y=p<<2,m=6*p,l[p]=-0x1000000|r[m+4]<<16|r[m+2]<<8|r[m],f(r,m)==g&&f(r,m+2)==n&&f(r,m+4)==i&&(c[y+3]=0)}}else if(3==h){let e=o.tabs.PLTE,a=o.tabs.tRNS,l=a?a.length:0;if(1==d)for(var v,b=0;b<i;b++){var w=b*u,S=b*n;for(p=0;p<n;p++){y=S+p<<2;var x=3*(v=r[w+(p>>3)]>>7-(7&p)&1);c[y]=e[x],c[y+1]=e[x+1],c[y+2]=e[x+2],c[y+3]=v<l?a[v]:255}}if(2==d)for(b=0;b<i;b++)for(w=b*u,S=b*n,p=0;p<n;p++)y=S+p<<2,x=3*(v=r[w+(p>>2)]>>6-((3&p)<<1)&3),c[y]=e[x],c[y+1]=e[x+1],c[y+2]=e[x+2],c[y+3]=v<l?a[v]:255;if(4==d)for(b=0;b<i;b++)for(w=b*u,S=b*n,p=0;p<n;p++)y=S+p<<2,x=3*(v=r[w+(p>>1)]>>4-((1&p)<<2)&15),c[y]=e[x],c[y+1]=e[x+1],c[y+2]=e[x+2],c[y+3]=v<l?a[v]:255;if(8==d)for(p=0;p<s;p++)y=p<<2,x=3*(v=r[p]),c[y]=e[x],c[y+1]=e[x+1],c[y+2]=e[x+2],c[y+3]=v<l?a[v]:255}else if(4==h){if(8==d)for(p=0;p<s;p++){y=p<<2;var E,I=r[E=p<<1];c[y]=I,c[y+1]=I,c[y+2]=I,c[y+3]=r[E+1]}if(16==d)for(p=0;p<s;p++)y=p<<2,I=r[E=p<<2],c[y]=I,c[y+1]=I,c[y+2]=I,c[y+3]=r[E+2]}else if(0==h)for(g=o.tabs.tRNS?o.tabs.tRNS:-1,b=0;b<i;b++){let e=b*u,i=b*n;if(1==d)for(var T=0;T<n;T++){var k=255*((I=255*(r[e+(T>>>3)]>>>7-(7&T)&1))!=255*g);l[i+T]=k<<24|I<<16|I<<8|I}else if(2==d)for(T=0;T<n;T++)k=255*((I=85*(r[e+(T>>>2)]>>>6-((3&T)<<1)&3))!=85*g),l[i+T]=k<<24|I<<16|I<<8|I;else if(4==d)for(T=0;T<n;T++)k=255*((I=17*(r[e+(T>>>1)]>>>4-((1&T)<<2)&15))!=17*g),l[i+T]=k<<24|I<<16|I<<8|I;else if(8==d)for(T=0;T<n;T++)k=255*((I=r[e+T])!=g),l[i+T]=k<<24|I<<16|I<<8|I;else if(16==d)for(T=0;T<n;T++)I=r[e+(T<<1)],k=255*(f(r,e+(T<<1))!=g),l[i+T]=k<<24|I<<16|I<<8|I}return c}function n(e,r,n,u){let c=new Uint8Array((Math.ceil(n*a(e)/8)+1+e.interlace)*u);return r=e.tabs.CgBI?o(r,c):i(r,c),0==e.interlace?r=s(r,e,0,n,u):1==e.interlace&&(r=function(e,r){let n=r.width,i=r.height,o=a(r),u=o>>3,c=Math.ceil(n*o/8),l=new Uint8Array(i*c),h=0,d=[0,0,4,0,2,0,1],f=[0,4,0,2,0,1,0],p=[8,8,8,4,4,2,2],m=[8,8,4,4,2,2,1],g=0;for(;g<7;){let a=p[g],v=m[g],b=0,w=0,S=d[g];for(;S<i;)S+=a,w++;let x=f[g];for(;x<n;)x+=v,b++;let E=Math.ceil(b*o/8);s(e,r,h,b,w);let I=0,T=d[g];for(;T<i;){let r=f[g],i=h+I*E<<3;for(;r<n;){var y;if(1==o&&(y=(y=e[i>>3])>>7-(7&i)&1,l[T*c+(r>>3)]|=y<<7-(7&r)),2==o&&(y=(y=e[i>>3])>>6-(7&i)&3,l[T*c+(r>>2)]|=y<<6-((3&r)<<1)),4==o&&(y=(y=e[i>>3])>>4-(7&i)&15,l[T*c+(r>>1)]|=y<<4-((1&r)<<2)),o>=8){let n=T*c+r*u;for(let r=0;r<u;r++)l[n+r]=e[(i>>3)+r]}i+=o,r+=v}I++,T+=a}b*w!=0&&(h+=w*(1+E)),g+=1}return l}(r,e)),r}function i(e,r){return o(new Uint8Array(e.buffer,2,e.length-6),r)}var o=function(){let e={};return e.N=function(r,n){let i=Uint8Array,o,a,s=0,u=0,c=0,l=0,h=0,d=0,f=0,p=0,m=0;if(3==r[0]&&0==r[1])return n||new i(0);let g=e.b,y=e.e,v=e.R,b=e.n,w=e.A,S=e.Z,x=e.m,E=null==n;for(E&&(n=new i(r.length>>>2<<5));0==s;)if(s=g(r,m,1),u=g(r,m+1,2),m+=3,0!=u){if(E&&(n=e.W(n,p+131072)),1==u&&(o=x.J,a=x.h,d=511,f=31),2==u){c=y(r,m,5)+257,l=y(r,m+5,5)+1,h=y(r,m+10,4)+4,m+=14;let n=1;for(var I=0;I<38;I+=2)x.Q[I]=0,x.Q[I+1]=0;for(I=0;I<h;I++){let e=y(r,m+3*I,3);x.Q[1+(x.X[I]<<1)]=e,e>n&&(n=e)}m+=3*h,b(x.Q,n),w(x.Q,n,x.u),o=x.w,a=x.d,m=v(x.u,(1<<n)-1,c+l,r,m,x.v);let i=e.V(x.v,0,c,x.C);d=(1<<i)-1;let s=e.V(x.v,c,l,x.D);f=(1<<s)-1,b(x.C,i),w(x.C,i,o),b(x.D,s),w(x.D,s,a)}for(;;){let e=o[S(r,m)&d];m+=15&e;let i=e>>>4;if(i>>>8==0)n[p++]=i;else{if(256==i)break;{let e=p+i-254;if(i>264){let n=x.q[i-257];e=p+(n>>>3)+y(r,m,7&n),m+=7&n}let o=a[S(r,m)&f];m+=15&o;let s=o>>>4,u=x.c[s],c=(u>>>4)+g(r,m,15&u);for(m+=15&u;p<e;)n[p]=n[p++-c],n[p]=n[p++-c],n[p]=n[p++-c],n[p]=n[p++-c];p=e}}}}else{0!=(7&m)&&(m+=8-(7&m));let o=4+(m>>>3),a=r[o-4]|r[o-3]<<8;E&&(n=e.W(n,p+a)),n.set(new i(r.buffer,r.byteOffset+o,a),p),m=o+a<<3,p+=a}return n.length==p?n:n.slice(0,p)},e.W=function(e,r){let n=e.length;if(r<=n)return e;let i=new Uint8Array(n<<1);return i.set(e,0),i},e.R=function(r,n,i,o,a,s){let u=e.e,c=e.Z,l=0;for(;l<i;){let e=r[c(o,a)&n];a+=15&e;let i=e>>>4;if(i<=15)s[l]=i,l++;else{let e=0,r=0;16==i?(r=3+u(o,a,2),a+=2,e=s[l-1]):17==i?(r=3+u(o,a,3),a+=3):18==i&&(r=11+u(o,a,7),a+=7);let n=l+r;for(;l<n;)s[l]=e,l++}}return a},e.V=function(e,r,n,i){let o=0,a=0,s=i.length>>>1;for(;a<n;){let n=e[a+r];i[a<<1]=0,i[1+(a<<1)]=n,n>o&&(o=n),a++}for(;a<s;)i[a<<1]=0,i[1+(a<<1)]=0,a++;return o},e.n=function(r,n){let i,o,a,s,u=e.m,c=r.length,l=u.j;for(var h=0;h<=n;h++)l[h]=0;for(h=1;h<c;h+=2)l[r[h]]++;let d=u.K;for(i=0,l[0]=0,o=1;o<=n;o++)i=i+l[o-1]<<1,d[o]=i;for(a=0;a<c;a+=2)0!=(s=r[a+1])&&(r[a]=d[s],d[s]++)},e.A=function(r,n,i){let o=r.length,a=e.m.r;for(let e=0;e<o;e+=2)if(0!=r[e+1]){let o=e>>1,s=r[e+1],u=o<<4|s,c=n-s,l=r[e]<<c,h=l+(1<<c);for(;l!=h;)i[a[l]>>>15-n]=u,l++}},e.l=function(r,n){let i=e.m.r,o=15-n;for(let e=0;e<r.length;e+=2){let a=r[e]<<n-r[e+1];r[e]=i[a]>>>o}},e.M=function(e,r,n){n<<=7&r;let i=r>>>3;e[i]|=n,e[i+1]|=n>>>8},e.I=function(e,r,n){n<<=7&r;let i=r>>>3;e[i]|=n,e[i+1]|=n>>>8,e[i+2]|=n>>>16},e.e=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<n)-1},e.b=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<n)-1},e.Z=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},e.i=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},e.m=function(){let e=Uint16Array,r=Uint32Array;return{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new e(65536),g:new e(32768)}}(),function(){let r=e.m;for(var n=0;n<32768;n++){let e=n;e=(0xff00ff00&(e=(0xf0f0f0f0&(e=(0xcccccccc&(e=(0xaaaaaaaa&e)>>>1|(0x55555555&e)<<1))>>>2|(0x33333333&e)<<2))>>>4|(0xf0f0f0f&e)<<4))>>>8|(0xff00ff&e)<<8,r.r[n]=(e>>>16|e<<16)>>>17}function i(e,r,n){for(;0!=r--;)e.push(0,n)}for(n=0;n<32;n++)r.q[n]=r.S[n]<<3|r.T[n],r.c[n]=r.p[n]<<4|r.z[n];i(r._,144,8),i(r._,112,9),i(r._,24,7),i(r._,8,8),e.n(r._,9),e.A(r._,9,r.J),e.l(r._,9),i(r.$,32,5),e.n(r.$,5),e.A(r.$,5,r.h),e.l(r.$,5),i(r.Q,19,0),i(r.C,286,0),i(r.D,30,0),i(r.v,320,0)}(),e.N}();function a(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth}function s(e,r,n,i,o){let s,c,l=a(r),h=Math.ceil(i*l/8);l=Math.ceil(l/8);let d=e[n],f=0;if(d>1&&(e[n]=[0,0,1][d-2]),3==d)for(f=l;f<h;f++)e[f+1]=e[f+1]+(e[f+1-l]>>>1)&255;for(let r=0;r<o;r++)if(d=e[(c=(s=n+r*h)+r+1)-1],f=0,0==d)for(;f<h;f++)e[s+f]=e[c+f];else if(1==d){for(;f<l;f++)e[s+f]=e[c+f];for(;f<h;f++)e[s+f]=e[c+f]+e[s+f-l]}else if(2==d)for(;f<h;f++)e[s+f]=e[c+f]+e[s+f-h];else if(3==d){for(;f<l;f++)e[s+f]=e[c+f]+(e[s+f-h]>>>1);for(;f<h;f++)e[s+f]=e[c+f]+(e[s+f-h]+e[s+f-l]>>>1)}else{for(;f<l;f++)e[s+f]=e[c+f]+u(0,e[s+f-h],0);for(;f<h;f++)e[s+f]=e[c+f]+u(e[s+f-l],e[s+f-h],e[s+f-l-h])}return e}function u(e,r,n){let i=e+r-n,o=i-e,a=i-r,s=i-n;return o*o<=a*a&&o*o<=s*s?e:a*a<=s*s?r:n}function c(e,r,n,i,o,a,s,u,c){let l=Math.min(r,o),h=Math.min(n,a),d=0,f=0;for(let n=0;n<h;n++)for(let a=0;a<l;a++)if(s>=0&&u>=0?(d=n*r+a<<2,f=(u+n)*o+s+a<<2):(d=(-u+n)*r-s+a<<2,f=n*o+a<<2),0==c)i[f]=e[d],i[f+1]=e[d+1],i[f+2]=e[d+2],i[f+3]=e[d+3];else if(1==c){var p=e[d+3]*(1/255),m=e[d]*p,g=e[d+1]*p,y=e[d+2]*p,v=i[f+3]*(1/255),b=i[f]*v,w=i[f+1]*v,S=i[f+2]*v;let r=1-p,n=p+v*r,o=0==n?0:1/n;i[f+3]=255*n,i[f+0]=(m+b*r)*o,i[f+1]=(g+w*r)*o,i[f+2]=(y+S*r)*o}else if(2==c)p=e[d+3],m=e[d],g=e[d+1],y=e[d+2],v=i[f+3],b=i[f],w=i[f+1],S=i[f+2],p==v&&m==b&&g==w&&y==S?(i[f]=0,i[f+1]=0,i[f+2]=0,i[f+3]=0):(i[f]=m,i[f+1]=g,i[f+2]=y,i[f+3]=p);else if(3==c){if(p=e[d+3],m=e[d],g=e[d+1],y=e[d+2],v=i[f+3],b=i[f],w=i[f+1],S=i[f+2],p==v&&m==b&&g==w&&y==S)continue;if(p<220&&v>20)return!1}return!0}return{decode:function(r){let a=new Uint8Array(r),s=8,u=e.readUshort,c=e.readUint,l={tabs:{},frames:[]},h=new Uint8Array(a.length),d,f=0,p=0,m=[137,80,78,71,13,10,26,10];for(var g,y=0;y<8;y++)if(a[y]!=m[y])throw"The input is not a PNG file!";for(;s<a.length;){let r=e.readUint(a,s);s+=4;let m=e.readASCII(a,s,4);if(s+=4,"IHDR"==m)v=s,l.width=e.readUint(a,v),v+=4,l.height=e.readUint(a,v),l.depth=a[v+=4],l.ctype=a[++v],l.compress=a[++v],l.filter=a[++v],l.interlace=a[++v],v++;else if("iCCP"==m){for(var v,b,w=s;0!=a[w];)w++;e.readASCII(a,s,w-s),a[w+1];let n=a.slice(w+2,s+r),u=null;try{u=i(n)}catch(e){u=o(n)}l.tabs[m]=u}else if("CgBI"==m)l.tabs[m]=a.slice(s,s+4);else if("IDAT"==m){for(y=0;y<r;y++)h[f+y]=a[s+y];f+=r}else if("acTL"==m)l.tabs[m]={num_frames:c(a,s),num_plays:c(a,s+4)},d=new Uint8Array(a.length);else if("fcTL"==m){0!=p&&((g=l.frames[l.frames.length-1]).data=n(l,d.slice(0,p),g.rect.width,g.rect.height),p=0);let e={x:c(a,s+12),y:c(a,s+16),width:c(a,s+4),height:c(a,s+8)},r=u(a,s+22),i={rect:e,delay:Math.round(1e3*(r=u(a,s+20)/(0==r?100:r))),dispose:a[s+24],blend:a[s+25]};l.frames.push(i)}else if("fdAT"==m){for(y=0;y<r-4;y++)d[p+y]=a[s+y+4];p+=r-4}else if("pHYs"==m)l.tabs[m]=[e.readUint(a,s),e.readUint(a,s+4),a[s+8]];else if("cHRM"==m)for(y=0,l.tabs[m]=[];y<8;y++)l.tabs[m].push(e.readUint(a,s+4*y));else if("tEXt"==m||"zTXt"==m){null==l.tabs[m]&&(l.tabs[m]={});var S=e.nextZero(a,s),x=e.readASCII(a,s,S-s),E=s+r-S-1;if("tEXt"==m)b=e.readASCII(a,S+1,E);else{var I=i(a.slice(S+2,S+2+E));b=e.readUTF8(I,0,I.length)}l.tabs[m][x]=b}else if("iTXt"==m){null==l.tabs[m]&&(l.tabs[m]={}),S=0,w=s,S=e.nextZero(a,w),x=e.readASCII(a,w,S-w);let n=a[w=S+1];a[w+1],w+=2,S=e.nextZero(a,w),e.readASCII(a,w,S-w),w=S+1,S=e.nextZero(a,w),e.readUTF8(a,w,S-w),E=r-((w=S+1)-s),0==n?b=e.readUTF8(a,w,E):(I=i(a.slice(w,w+E)),b=e.readUTF8(I,0,I.length)),l.tabs[m][x]=b}else if("PLTE"==m)l.tabs[m]=e.readBytes(a,s,r);else if("hIST"==m){let e=l.tabs.PLTE.length/3;for(y=0,l.tabs[m]=[];y<e;y++)l.tabs[m].push(u(a,s+2*y))}else if("tRNS"==m)3==l.ctype?l.tabs[m]=e.readBytes(a,s,r):0==l.ctype?l.tabs[m]=u(a,s):2==l.ctype&&(l.tabs[m]=[u(a,s),u(a,s+2),u(a,s+4)]);else if("gAMA"==m)l.tabs[m]=e.readUint(a,s)/1e5;else if("sRGB"==m)l.tabs[m]=a[s];else if("bKGD"==m)0==l.ctype||4==l.ctype?l.tabs[m]=[u(a,s)]:2==l.ctype||6==l.ctype?l.tabs[m]=[u(a,s),u(a,s+2),u(a,s+4)]:3==l.ctype&&(l.tabs[m]=a[s]);else if("IEND"==m)break;s+=r,e.readUint(a,s),s+=4}return 0!=p&&((g=l.frames[l.frames.length-1]).data=n(l,d.slice(0,p),g.rect.width,g.rect.height)),l.data=n(l,h,l.width,l.height),delete l.compress,delete l.interlace,delete l.filter,l},toRGBA8:function(e){let n=e.width,i=e.height;if(null==e.tabs.acTL)return[r(e.data,n,i,e).buffer];let o=[];null==e.frames[0].data&&(e.frames[0].data=e.data);let a=n*i*4,s=new Uint8Array(a),u=new Uint8Array(a),l=new Uint8Array(a);for(let d=0;d<e.frames.length;d++){let f=e.frames[d],p=f.rect.x,m=f.rect.y,g=f.rect.width,y=f.rect.height,v=r(f.data,g,y,e);if(0!=d)for(var h=0;h<a;h++)l[h]=s[h];if(0==f.blend?c(v,g,y,s,n,i,p,m,0):1==f.blend&&c(v,g,y,s,n,i,p,m,1),o.push(s.buffer.slice(0)),0==f.dispose);else if(1==f.dispose)c(u,g,y,s,n,i,p,m,0);else if(2==f.dispose)for(h=0;h<a;h++)s[h]=l[h]}return o},_paeth:u,_copyTile:c,_bin:e}}();!function(){let{_copyTile:e}=l,{_bin:r}=l,n=l._paeth;var i={table:function(){let e=new Uint32Array(256);for(let r=0;r<256;r++){let n=r;for(let e=0;e<8;e++)1&n?n=0xedb88320^n>>>1:n>>>=1;e[r]=n}return e}(),update(e,r,n,o){for(let a=0;a<o;a++)e=i.table[255&(e^r[n+a])]^e>>>8;return e},crc:(e,r,n)=>0xffffffff^i.update(0xffffffff,e,r,n)};function o(e,r,n,i){r[n]+=e[0]*i>>4,r[n+1]+=e[1]*i>>4,r[n+2]+=e[2]*i>>4,r[n+3]+=e[3]*i>>4}function a(e){return Math.max(0,Math.min(255,e))}function s(e,r){let n=e[0]-r[0],i=e[1]-r[1],o=e[2]-r[2],a=e[3]-r[3];return n*n+i*i+o*o+a*a}function u(e,r,n,i,u,c,l){null==l&&(l=1);let h=i.length,d=[];for(var f,p=0;p<h;p++){let e=i[p];d.push([e>>>0&255,e>>>8&255,e>>>16&255,e>>>24&255])}for(p=0;p<h;p++){let e=0xffffffff;for(var m=0,g=0;g<h;g++){var y=s(d[p],d[g]);g!=p&&y<e&&(e=y,m=g)}}let v=new Uint32Array(u.buffer),b=new Int16Array(r*n*4),w=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(p=0;p<w.length;p++)w[p]=255*((w[p]+.5)/16-.5);for(let u=0;u<n;u++)for(let S=0;S<r;S++){p=4*(u*r+S),2!=l?f=[a(e[p]+b[p]),a(e[p+1]+b[p+1]),a(e[p+2]+b[p+2]),a(e[p+3]+b[p+3])]:(y=w[4*(3&u)+(3&S)],f=[a(e[p]+y),a(e[p+1]+y),a(e[p+2]+y),a(e[p+3]+y)]),m=0;let x=0xffffff;for(g=0;g<h;g++){let e=s(f,d[g]);e<x&&(x=e,m=g)}let E=d[m],I=[f[0]-E[0],f[1]-E[1],f[2]-E[2],f[3]-E[3]];1==l&&(S!=r-1&&o(I,b,p+4,7),u!=n-1&&(0!=S&&o(I,b,p+4*r-4,3),o(I,b,p+4*r,5),S!=r-1&&o(I,b,p+4*r+4,1))),c[p>>2]=m,v[p>>2]=i[m]}}function h(e,n,o,a,s){null==s&&(s={});let{crc:u}=i,c=r.writeUint,l=r.writeUshort,h=r.writeASCII,d=8,f=e.frames.length>1,p,m=!1,g=33+20*!!f;if(null!=s.sRGB&&(g+=13),null!=s.pHYs&&(g+=21),null!=s.iCCP&&(g+=21+(p=pako.deflate(s.iCCP)).length+4),3==e.ctype){for(var y=e.plte.length,v=0;v<y;v++)e.plte[v]>>>24!=255&&(m=!0);g+=8+3*y+4+(m?8+ +y+4:0)}for(var b=0;b<e.frames.length;b++)f&&(g+=38),g+=(E=e.frames[b]).cimg.length+12,0!=b&&(g+=4);let w=new Uint8Array(g+=12),S=[137,80,78,71,13,10,26,10];for(v=0;v<8;v++)w[v]=S[v];if(c(w,d,13),h(w,d+=4,"IHDR"),c(w,d+=4,n),c(w,d+=4,o),w[d+=4]=e.depth,w[++d]=e.ctype,w[++d]=0,w[++d]=0,w[++d]=0,c(w,++d,u(w,d-17,17)),d+=4,null!=s.sRGB&&(c(w,d,1),h(w,d+=4,"sRGB"),w[d+=4]=s.sRGB,c(w,++d,u(w,d-5,5)),d+=4),null!=s.iCCP){let e=13+p.length;c(w,d,e),h(w,d+=4,"iCCP"),h(w,d+=4,"ICC profile"),d+=11,d+=2,w.set(p,d),c(w,d+=p.length,u(w,d-(e+4),e+4)),d+=4}if(null!=s.pHYs&&(c(w,d,9),h(w,d+=4,"pHYs"),c(w,d+=4,s.pHYs[0]),c(w,d+=4,s.pHYs[1]),w[d+=4]=s.pHYs[2],c(w,++d,u(w,d-13,13)),d+=4),f&&(c(w,d,8),h(w,d+=4,"acTL"),c(w,d+=4,e.frames.length),c(w,d+=4,null!=s.loop?s.loop:0),c(w,d+=4,u(w,d-12,12)),d+=4),3==e.ctype){for(c(w,d,3*(y=e.plte.length)),h(w,d+=4,"PLTE"),d+=4,v=0;v<y;v++){let r=3*v,n=e.plte[v],i=255&n,o=n>>>8&255,a=n>>>16&255;w[d+r+0]=i,w[d+r+1]=o,w[d+r+2]=a}if(c(w,d+=3*y,u(w,d-3*y-4,3*y+4)),d+=4,m){for(c(w,d,y),h(w,d+=4,"tRNS"),d+=4,v=0;v<y;v++)w[d+v]=e.plte[v]>>>24&255;c(w,d+=y,u(w,d-y-4,y+4)),d+=4}}let x=0;for(b=0;b<e.frames.length;b++){var E=e.frames[b];f&&(c(w,d,26),h(w,d+=4,"fcTL"),c(w,d+=4,x++),c(w,d+=4,E.rect.width),c(w,d+=4,E.rect.height),c(w,d+=4,E.rect.x),c(w,d+=4,E.rect.y),l(w,d+=4,a[b]),l(w,d+=2,1e3),w[d+=2]=E.dispose,w[++d]=E.blend,c(w,++d,u(w,d-30,30)),d+=4);let r=E.cimg;c(w,d,(y=r.length)+4*(0!=b));let n=d+=4;h(w,d,0==b?"IDAT":"fdAT"),d+=4,0!=b&&(c(w,d,x++),d+=4),w.set(r,d),c(w,d+=y,u(w,n,d-n)),d+=4}return c(w,d,0),h(w,d+=4,"IEND"),c(w,d+=4,u(w,d-4,4)),d+=4,w.buffer}function d(e,r,i){for(let o=0;o<e.frames.length;o++){let a=e.frames[o];a.rect.width;let s=a.rect.height,u=new Uint8Array(s*a.bpl+s);a.cimg=function(e,r,i,o,a,s,u){let l=[],h,d=[0,1,2,3,4];-1!=s?d=[s]:(r*o>5e5||1==i)&&(d=[0]),u&&(h={level:0});for(var f=0;f<d.length;f++){for(let s=0;s<r;s++)!function(e,r,i,o,a,s){let u=i*o,c=u+i;if(e[c]=s,c++,0==s)if(o<500)for(var l=0;l<o;l++)e[c+l]=r[u+l];else e.set(new Uint8Array(r.buffer,u,o),c);else if(1==s){for(l=0;l<a;l++)e[c+l]=r[u+l];for(l=a;l<o;l++)e[c+l]=r[u+l]-r[u+l-a]+256&255}else if(0==i){for(l=0;l<a;l++)e[c+l]=r[u+l];if(2==s)for(l=a;l<o;l++)e[c+l]=r[u+l];if(3==s)for(l=a;l<o;l++)e[c+l]=r[u+l]-(r[u+l-a]>>1)+256&255;if(4==s)for(l=a;l<o;l++)e[c+l]=r[u+l]-n(r[u+l-a],0,0)+256&255}else{if(2==s)for(l=0;l<o;l++)e[c+l]=r[u+l]+256-r[u+l-o]&255;if(3==s){for(l=0;l<a;l++)e[c+l]=r[u+l]+256-(r[u+l-o]>>1)&255;for(l=a;l<o;l++)e[c+l]=r[u+l]+256-(r[u+l-o]+r[u+l-a]>>1)&255}if(4==s){for(l=0;l<a;l++)e[c+l]=r[u+l]+256-n(0,r[u+l-o],0)&255;for(l=a;l<o;l++)e[c+l]=r[u+l]+256-n(r[u+l-a],r[u+l-o],r[u+l-a-o])&255}}}(a,e,s,o,i,d[f]);l.push(c.deflate(a,h))}let p,m=1e9;for(f=0;f<l.length;f++)l[f].length<m&&(p=f,m=l[f].length);return l[p]}(a.img,s,a.bpp,a.bpl,u,r,i)}}function f(r,n,i,o,a){let s=a[0],c=a[1],l=a[2],h=a[3],d=a[4],f=a[5],y=6,v=8,b=255;for(var w=0;w<r.length;w++){let e=new Uint8Array(r[w]);for(var S=e.length,x=0;x<S;x+=4)b&=e[x+3]}let E=255!=b,I=function(r,n,i,o,a,s){let u=[];for(var c,l=0;l<r.length;l++){let c=new Uint8Array(r[l]),p=new Uint32Array(c.buffer),g=0,y=0,v=n,b=i,w=+!!o;if(0!=l){let S=s||o||1==l||0!=u[l-2].dispose?1:2,x=0,E=1e9;for(let e=0;e<S;e++){var h,d=new Uint8Array(r[l-1-e]);let o=new Uint32Array(r[l-1-e]),s=n,u=i,c=-1,m=-1;for(let e=0;e<i;e++)for(let r=0;r<n;r++)p[f=e*n+r]!=o[f]&&(r<s&&(s=r),r>c&&(c=r),e<u&&(u=e),e>m&&(m=e));-1==c&&(s=u=c=m=0),a&&(1==(1&s)&&s--,1==(1&u)&&u--);let w=(c-s+1)*(m-u+1);w<E&&(E=w,x=e,g=s,y=u,v=c-s+1,b=m-u+1)}d=new Uint8Array(r[l-1-x]),1==x&&(u[l-1].dispose=2),e(d,n,i,h=new Uint8Array(v*b*4),v,b,-g,-y,0),1==(w=+!!e(c,n,i,h,v,b,-g,-y,3))?m(c,n,i,h,{x:g,y:y,width:v,height:b}):e(c,n,i,h,v,b,-g,-y,0)}else h=c.slice(0);u.push({rect:{x:g,y:y,width:v,height:b},img:h,blend:w,dispose:0})}if(o)for(l=0;l<u.length;l++){if(1==(c=u[l]).blend)continue;let e=c.rect,o=u[l-1].rect,s=Math.min(e.x,o.x),h=Math.min(e.y,o.y),d={x:s,y:h,width:Math.max(e.x+e.width,o.x+o.width)-s,height:Math.max(e.y+e.height,o.y+o.height)-h};u[l-1].dispose=1,l-1!=0&&p(r,n,i,u,l-1,d,a),p(r,n,i,u,l,d,a)}if(1!=r.length)for(var f=0;f<u.length;f++)(c=u[f]).rect.width,c.rect.height;return u}(r,n,i,s,c,l),T={},k=[],_=[];if(0!=o){let e=[];for(x=0;x<I.length;x++)e.push(I[x].img.buffer);let r=g(function(e){let r=0;for(var n=0;n<e.length;n++)r+=e[n].byteLength;let i=new Uint8Array(r),o=0;for(n=0;n<e.length;n++){let r=new Uint8Array(e[n]),a=r.length;for(let e=0;e<a;e+=4){let n=r[e],a=r[e+1],s=r[e+2],u=r[e+3];0==u&&(n=a=s=0),i[o+e]=n,i[o+e+1]=a,i[o+e+2]=s,i[o+e+3]=u}o+=a}return i.buffer}(e),o);for(x=0;x<r.plte.length;x++)k.push(r.plte[x].est.rgba);let n=0;for(x=0;x<I.length;x++){let e=(P=I[x]).img.length;var A=new Uint8Array(r.inds.buffer,n>>2,e>>2);_.push(A);let i=new Uint8Array(r.abuf,n,e);f&&u(P.img,P.rect.width,P.rect.height,k,i,A),P.img.set(i),n+=e}}else for(w=0;w<I.length;w++){var P=I[w];let e=new Uint32Array(P.img.buffer);var O=P.rect.width;for(A=new Uint8Array(S=e.length),_.push(A),x=0;x<S;x++){let r=e[x];if(0!=x&&r==e[x-1])A[x]=A[x-1];else if(x>O&&r==e[x-O])A[x]=A[x-O];else{let e=T[r];if(null==e&&(T[r]=e=k.length,k.push(r),k.length>=300))break;A[x]=e}}}let C=k.length;for(C<=256&&0==d&&(v=Math.max(v=C<=2?1:C<=4?2:C<=16?4:8,h)),w=0;w<I.length;w++){(P=I[w]).rect.x,P.rect.y,O=P.rect.width;let e=P.rect.height,r=P.img;new Uint32Array(r.buffer);let n=4*O,i=4;if(C<=256&&0==d){var N=new Uint8Array((n=Math.ceil(v*O/8))*e);let o=_[w];for(let r=0;r<e;r++){x=r*n;let e=r*O;if(8==v)for(var L=0;L<O;L++)N[x+L]=o[e+L];else if(4==v)for(L=0;L<O;L++)N[x+(L>>1)]|=o[e+L]<<4-4*(1&L);else if(2==v)for(L=0;L<O;L++)N[x+(L>>2)]|=o[e+L]<<6-2*(3&L);else if(1==v)for(L=0;L<O;L++)N[x+(L>>3)]|=o[e+L]<<7-(7&L)}r=N,y=3,i=1}else if(0==E&&1==I.length){N=new Uint8Array(O*e*3);let o=O*e;for(x=0;x<o;x++){let e=3*x,n=4*x;N[e]=r[n],N[e+1]=r[n+1],N[e+2]=r[n+2]}r=N,y=2,i=3,n=3*O}P.img=r,P.bpl=n,P.bpp=i}return{ctype:y,depth:v,plte:k,frames:I}}function p(r,n,i,o,a,s,u){let c=Uint8Array,l=Uint32Array,h=new c(r[a-1]),d=new l(r[a-1]),f=a+1<r.length?new c(r[a+1]):null,p=new c(r[a]),g=new l(p.buffer),y=n,v=i,b=-1,w=-1;for(let e=0;e<s.height;e++)for(let r=0;r<s.width;r++){let i=s.x+r,u=s.y+e,c=u*n+i,l=g[c];0==l||0==o[a-1].dispose&&d[c]==l&&(null==f||0!=f[4*c+3])||(i<y&&(y=i),i>b&&(b=i),u<v&&(v=u),u>w&&(w=u))}-1==b&&(y=v=b=w=0),u&&(1==(1&y)&&y--,1==(1&v)&&v--),s={x:y,y:v,width:b-y+1,height:w-v+1};let S=o[a];S.rect=s,S.blend=1,S.img=new Uint8Array(s.width*s.height*4),0==o[a-1].dispose?(e(h,n,i,S.img,s.width,s.height,-s.x,-s.y,0),m(p,n,i,S.img,s)):e(p,n,i,S.img,s.width,s.height,-s.x,-s.y,0)}function m(r,n,i,o,a){e(r,n,i,o,a.width,a.height,-a.x,-a.y,2)}function g(e,r){let n,i=new Uint8Array(e),o=i.slice(0),a=new Uint32Array(o.buffer),s=y(o,r),u=s[0],c=s[1],l=i.length,h=new Uint8Array(l>>2);if(i.length<2e7)for(var d=0;d<l;d+=4)n=v(u,f=i[d]*(1/255),p=i[d+1]*(1/255),m=i[d+2]*(1/255),g=i[d+3]*(1/255)),h[d>>2]=n.ind,a[d>>2]=n.est.rgba;else for(d=0;d<l;d+=4){var f=i[d]*(1/255),p=i[d+1]*(1/255),m=i[d+2]*(1/255),g=i[d+3]*(1/255);for(n=u;n.left;)n=0>=b(n.est,f,p,m,g)?n.left:n.right;h[d>>2]=n.ind,a[d>>2]=n.est.rgba}return{abuf:o.buffer,inds:h,plte:c}}function y(e,r,n){null==n&&(n=1e-4);let i=new Uint32Array(e.buffer),o={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};o.bst=S(e,o.i0,o.i1),o.est=x(o.bst);let a=[o];for(;a.length<r;){let r=0,o=0;for(var s=0;s<a.length;s++)a[s].est.L>r&&(r=a[s].est.L,o=s);if(r<n)break;let u=a[o],c=function(e,r,n,i,o,a){for(i-=4;n<i;){for(;w(e,n,o)<=a;)n+=4;for(;w(e,i,o)>a;)i-=4;if(n>=i)break;let s=r[n>>2];r[n>>2]=r[i>>2],r[i>>2]=s,n+=4,i-=4}for(;w(e,n,o)>a;)n-=4;return n+4}(e,i,u.i0,u.i1,u.est.e,u.est.eMq255);if(u.i0>=c||u.i1<=c){u.est.L=0;continue}let l={i0:u.i0,i1:c,bst:null,est:null,tdst:0,left:null,right:null};l.bst=S(e,l.i0,l.i1),l.est=x(l.bst);let h={i0:c,i1:u.i1,bst:null,est:null,tdst:0,left:null,right:null};for(s=0,h.bst={R:[],m:[],N:u.bst.N-l.bst.N};s<16;s++)h.bst.R[s]=u.bst.R[s]-l.bst.R[s];for(s=0;s<4;s++)h.bst.m[s]=u.bst.m[s]-l.bst.m[s];h.est=x(h.bst),u.left=l,u.right=h,a[o]=l,a.push(h)}for(a.sort((e,r)=>r.bst.N-e.bst.N),s=0;s<a.length;s++)a[s].ind=s;return[o,a]}function v(e,r,n,i,o){if(null==e.left)return e.tdst=function(e,r,n,i,o){let a=r-e[0],s=n-e[1],u=i-e[2],c=o-e[3];return a*a+s*s+u*u+c*c}(e.est.q,r,n,i,o),e;let a=b(e.est,r,n,i,o),s=e.left,u=e.right;a>0&&(s=e.right,u=e.left);let c=v(s,r,n,i,o);if(c.tdst<=a*a)return c;let l=v(u,r,n,i,o);return l.tdst<c.tdst?l:c}function b(e,r,n,i,o){let{e:a}=e;return a[0]*r+a[1]*n+a[2]*i+a[3]*o-e.eMq}function w(e,r,n){return e[r]*n[0]+e[r+1]*n[1]+e[r+2]*n[2]+e[r+3]*n[3]}function S(e,r,n){let i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=[0,0,0,0];for(let a=r;a<n;a+=4){let r=e[a]*(1/255),n=e[a+1]*(1/255),s=e[a+2]*(1/255),u=e[a+3]*(1/255);o[0]+=r,o[1]+=n,o[2]+=s,o[3]+=u,i[0]+=r*r,i[1]+=r*n,i[2]+=r*s,i[3]+=r*u,i[5]+=n*n,i[6]+=n*s,i[7]+=n*u,i[10]+=s*s,i[11]+=s*u,i[15]+=u*u}return i[4]=i[1],i[8]=i[2],i[9]=i[6],i[12]=i[3],i[13]=i[7],i[14]=i[11],{R:i,m:o,N:n-r>>2}}function x(e){let{R:r}=e,{m:n}=e,{N:i}=e,o=n[0],a=n[1],s=n[2],u=n[3],c=0==i?0:1/i,l=[r[0]-o*o*c,r[1]-o*a*c,r[2]-o*s*c,r[3]-o*u*c,r[4]-a*o*c,r[5]-a*a*c,r[6]-a*s*c,r[7]-a*u*c,r[8]-s*o*c,r[9]-s*a*c,r[10]-s*s*c,r[11]-s*u*c,r[12]-u*o*c,r[13]-u*a*c,r[14]-u*s*c,r[15]-u*u*c],h=[Math.random(),Math.random(),Math.random(),Math.random()],d=0,f=0;if(0!=i)for(let e=0;e<16&&(h=E.multVec(l,h),f=Math.sqrt(E.dot(h,h)),h=E.sml(1/f,h),!(0!=e&&1e-9>Math.abs(f-d)));e++)d=f;let p=[o*c,a*c,s*c,u*c];return{Cov:l,q:p,e:h,L:d,eMq255:E.dot(E.sml(255,p),h),eMq:E.dot(h,p),rgba:(Math.round(255*p[3])<<24|Math.round(255*p[2])<<16|Math.round(255*p[1])<<8|(0|Math.round(255*p[0])))>>>0}}var E={multVec:(e,r)=>[e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3],e[4]*r[0]+e[5]*r[1]+e[6]*r[2]+e[7]*r[3],e[8]*r[0]+e[9]*r[1]+e[10]*r[2]+e[11]*r[3],e[12]*r[0]+e[13]*r[1]+e[14]*r[2]+e[15]*r[3]],dot:(e,r)=>e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3],sml:(e,r)=>[e*r[0],e*r[1],e*r[2],e*r[3]]};l.encode=function(e,r,n,i,o,a,s){null==i&&(i=0),null==s&&(s=!1);let u=f(e,r,n,i,[!1,!1,!1,0,s,!1]);return d(u,-1),h(u,r,n,o,a)},l.encodeLL=function(e,r,n,i,o,a,s,u){let c={ctype:0+2*(1!=i)+4*(0!=o),depth:a,frames:[]},l=(i+o)*a,f=l*r;for(let i=0;i<e.length;i++)c.frames.push({rect:{x:0,y:0,width:r,height:n},img:new Uint8Array(e[i]),blend:0,dispose:1,bpp:Math.ceil(l/8),bpl:Math.ceil(f/8)});return d(c,0,!0),h(c,r,n,s,u)},l.encode.compress=f,l.encode.dither=u,l.quantize=g,l.quantize.getKDtree=y,l.quantize.getNearest=v}();let h={toArrayBuffer(e,r){let n=e.width,i=e.height,o=n<<2,a=new Uint32Array(e.getContext("2d").getImageData(0,0,n,i).data.buffer),s=(32*n+31)/32<<2,u=s*i,c=122+u,l=new ArrayBuffer(c),d=new DataView(l),f,p,m,g,y=1048576,v=0,b=0,w=0;function S(e){d.setUint16(b,e,!0),b+=2}function x(e){d.setUint32(b,e,!0),b+=4}S(19778),x(c),b+=4,x(122),x(108),x(n),x(-i>>>0),S(1),S(32),x(3),x(u),x(2835),x(2835),b+=8,x(0xff0000),x(65280),x(255),x(0xff000000),x(0x57696e20),function e(){for(;v<i&&y>0;){for(g=122+v*s,f=0;f<o;)y--,m=(p=a[w++])>>>24,d.setUint32(g+f,p<<8|m),f+=4;v++}w<a.length?(y=1048576,setTimeout(e,h._dly)):r(l)}()},toBlob(e,r){this.toArrayBuffer(e,e=>{r(new Blob([e],{type:"image/bmp"}))})},_dly:9};var d={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},f={[d.CHROME]:16384,[d.FIREFOX]:11180,[d.DESKTOP_SAFARI]:16384,[d.IE]:8192,[d.IOS]:4096,[d.ETC]:8192};let p="undefined"!=typeof window,m="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,g=p&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),y=(p||m)&&(g&&g.getOriginalSymbol(window,"File")||"undefined"!=typeof File&&File),v=(p||m)&&(g&&g.getOriginalSymbol(window,"FileReader")||"undefined"!=typeof FileReader&&FileReader);function b(e,r,n=Date.now()){return new Promise(i=>{let o=e.split(","),a=o[0].match(/:(.*?);/)[1],s=globalThis.atob(o[1]),u=s.length,c=new Uint8Array(u);for(;u--;)c[u]=s.charCodeAt(u);let l=new Blob([c],{type:a});l.name=r,l.lastModified=n,i(l)})}function w(e){return new Promise((r,n)=>{let i=new v;i.onload=()=>r(i.result),i.onerror=e=>n(e),i.readAsDataURL(e)})}function S(e){return new Promise((r,n)=>{let i=new Image;i.onload=()=>r(i),i.onerror=e=>n(e),i.src=e})}function x(){if(void 0!==x.cachedResult)return x.cachedResult;let e=d.ETC,{userAgent:r}=navigator;return/Chrom(e|ium)/i.test(r)?e=d.CHROME:/iP(ad|od|hone)/i.test(r)&&/WebKit/i.test(r)?e=d.IOS:/Safari/i.test(r)?e=d.DESKTOP_SAFARI:/Firefox/i.test(r)?e=d.FIREFOX:(/MSIE/i.test(r)||!0==!!document.documentMode)&&(e=d.IE),x.cachedResult=e,x.cachedResult}function E(e,r){let n=f[x()],i=e,o=r,a=i*o,s=i>o?o/i:i/o;for(;a>n*n;){let e=(n+i)/2,r=(n+o)/2;e<r?(o=r,i=r*s):(o=e*s,i=e),a=i*o}return{width:i,height:o}}function I(e,r){let n,i;try{if(i=(n=new OffscreenCanvas(e,r)).getContext("2d"),null===i)throw Error("getContext of OffscreenCanvas returns null")}catch(e){i=(n=document.createElement("canvas")).getContext("2d")}return n.width=e,n.height=r,[n,i]}function T(e,r){let{width:n,height:i}=E(e.width,e.height),[o,a]=I(n,i);return r&&/jpe?g/.test(r)&&(a.fillStyle="white",a.fillRect(0,0,o.width,o.height)),a.drawImage(e,0,0,o.width,o.height),o}function k(){return void 0!==k.cachedResult||(k.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"undefined"!=typeof document&&"ontouchend"in document),k.cachedResult}function _(e,r={}){return new Promise(function(n,i){let o,a;var s=function(){try{return a=T(o,r.fileType||e.type),n([o,a])}catch(e){return i(e)}},u=function(r){try{var n=function(e){try{throw e}catch(e){return i(e)}};try{let r;return w(e).then(function(e){try{return r=e,S(r).then(function(e){try{return o=e,function(){try{return s()}catch(e){return i(e)}}()}catch(e){return n(e)}},n)}catch(e){return n(e)}},n)}catch(e){n(e)}}catch(e){return i(e)}};try{if(k()||[d.DESKTOP_SAFARI,d.MOBILE_SAFARI].includes(x()))throw Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(e).then(function(e){try{return o=e,s()}catch(e){return u()}},u)}catch(e){u()}})}function A(e,r,n,i,o=1){return new Promise(function(a,s){let u;if("image/png"===r){let a,s;return a=e.getContext("2d"),{data:s}=a.getImageData(0,0,e.width,e.height),(u=new Blob([l.encode([s.buffer],e.width,e.height,4096*o)],{type:r})).name=n,u.lastModified=i,f.call(this)}if("image/bmp"===r)return new Promise(r=>h.toBlob(e,r)).then((function(e){try{return(u=e).name=n,u.lastModified=i,d.call(this)}catch(e){return s(e)}}).bind(this),s);if("function"==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return e.convertToBlob({type:r,quality:o}).then((function(e){try{return(u=e).name=n,u.lastModified=i,c.call(this)}catch(e){return s(e)}}).bind(this),s);return b(e.toDataURL(r,o),n,i).then((function(e){try{return u=e,c.call(this)}catch(e){return s(e)}}).bind(this),s);function c(){return d.call(this)}function d(){return f.call(this)}function f(){return a(u)}})}function P(e){e.width=0,e.height=0}function O(){return new Promise(function(e,r){let n,i,o,a;return void 0!==O.cachedResult?e(O.cachedResult):b("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(s){try{return n=s,_(n).then(function(s){try{return i=s[1],A(i,n.type,n.name,n.lastModified).then(function(n){try{return o=n,P(i),_(o).then(function(n){try{return a=n[0],O.cachedResult=1===a.width&&2===a.height,e(O.cachedResult)}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)})}function C(e){return new Promise((r,n)=>{let i=new v;i.onload=e=>{let n=new DataView(e.target.result);if(65496!=n.getUint16(0,!1))return r(-2);let i=n.byteLength,o=2;for(;o<i&&!(8>=n.getUint16(o+2,!1));){let e=n.getUint16(o,!1);if(o+=2,65505==e){if(0x45786966!=n.getUint32(o+=2,!1))return r(-1);let e=18761==n.getUint16(o+=6,!1);o+=n.getUint32(o+4,e);let i=n.getUint16(o,e);o+=2;for(let a=0;a<i;a++)if(274==n.getUint16(o+12*a,e))return r(n.getUint16(o+12*a+8,e))}else{if(65280!=(65280&e))break;o+=n.getUint16(o,!1)}}return r(-1)},i.onerror=e=>n(e),i.readAsArrayBuffer(e)})}function N(e,r){let{width:n}=e,{height:i}=e,{maxWidthOrHeight:o}=r,a,s=e;return isFinite(o)&&(n>o||i>o)&&([s,a]=I(n,i),n>i?(s.width=o,s.height=i/n*o):(s.width=n/i*o,s.height=o),a.drawImage(e,0,0,s.width,s.height),P(e)),s}function L(e,r){let{width:n}=e,{height:i}=e,[o,a]=I(n,i);switch(r>4&&r<9?(o.width=i,o.height=n):(o.width=n,o.height=i),r){case 2:a.transform(-1,0,0,1,n,0);break;case 3:a.transform(-1,0,0,-1,n,i);break;case 4:a.transform(1,0,0,-1,0,i);break;case 5:a.transform(0,1,1,0,0,0);break;case 6:a.transform(0,1,-1,0,i,0);break;case 7:a.transform(0,-1,-1,0,i,n);break;case 8:a.transform(0,-1,1,0,0,n)}return a.drawImage(e,0,0,n,i),P(e),o}function D(e,r,n=0){return new Promise(function(i,o){let a,s,u,c,l,h,d,f,p,m,g,y,v,b,w,S,x,E,T,k;function D(e=5){if(r.signal&&r.signal.aborted)throw r.signal.reason;a+=e,r.onProgress(Math.min(a,100))}function R(e){if(r.signal&&r.signal.aborted)throw r.signal.reason;a=Math.min(Math.max(e,a),100),r.onProgress(a)}return a=n,s=r.maxIteration||10,u=1024*r.maxSizeMB*1024,D(),_(e,r).then((function(n){try{return[,c]=n,D(),l=N(c,r),D(),new Promise(function(n,i){var o;if(!(o=r.exifOrientation))return C(e).then((function(e){try{return o=e,a.call(this)}catch(e){return i(e)}}).bind(this),i);function a(){return n(o)}return a.call(this)}).then((function(n){try{return h=n,D(),O().then((function(n){try{return d=n?l:L(l,h),D(),f=r.initialQuality||1,p=r.fileType||e.type,A(d,p,e.name,e.lastModified,f).then((function(n){try{var a;if(m=n,D(),g=m.size>u,y=m.size>e.size,!g&&!y)return R(100),i(m);function h(){if(s--&&(w>u||w>v)){let r,n;return r=k?.95*T.width:T.width,n=k?.95*T.height:T.height,[x,E]=I(r,n),E.drawImage(T,0,0,r,n),f*="image/png"===p?.85:.95,A(x,p,e.name,e.lastModified,f).then(function(e){try{return S=e,P(T),T=x,w=S.size,R(Math.min(99,Math.floor((b-w)/(b-u)*100))),h}catch(e){return o(e)}},o)}return[1]}return v=e.size,w=b=m.size,T=d,k=!r.alwaysKeepResolution&&g,(a=(function(e){for(;e;){if(e.then)return void e.then(a,o);try{if(e.pop){if(e.length)return e.pop()?_.call(this):e;e=h}else e=e.call(this)}catch(e){return o(e)}}}).bind(this))(h);function _(){return P(T),P(x),P(l),P(d),P(c),R(100),i(S)}}catch(e){return o(e)}}).bind(this),o)}catch(e){return o(e)}}).bind(this),o)}catch(e){return o(e)}}).bind(this),o)}catch(e){return o(e)}}).bind(this),o)})}function R(e,r){return new Promise(function(n,a){let s,u,c,l,h,d;if(s={...r},c=0,{onProgress:l}=s,s.maxSizeMB=s.maxSizeMB||1/0,h="boolean"!=typeof s.useWebWorker||s.useWebWorker,delete s.useWebWorker,s.onProgress=e=>{c=e,"function"==typeof l&&l(c)},!(e instanceof Blob||e instanceof y))return a(Error("The file given is not an instance of Blob or File"));if(!/^image/.test(e.type))return a(Error("The file given is not an image"));if(d="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,!h||"function"!=typeof Worker||d)return D(e,s).then((function(e){try{return u=e,m.call(this)}catch(e){return a(e)}}).bind(this),a);var f=(function(){try{return m.call(this)}catch(e){return a(e)}}).bind(this),p=function(r){try{return D(e,s).then(function(e){try{return u=e,f()}catch(e){return a(e)}},a)}catch(e){return a(e)}};try{return s.libURL=s.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",new Promise((r,n)=>{i||(i=function(e){let r=[];return"function"==typeof e?r.push(`(${e})()`):r.push(e),URL.createObjectURL(new Blob(r))}("\nlet scriptImported = false\nself.addEventListener('message', async (e) => {\n  const { file, id, imageCompressionLibUrl, options } = e.data\n  options.onProgress = (progress) => self.postMessage({ progress, id })\n  try {\n    if (!scriptImported) {\n      // console.log('[worker] importScripts', imageCompressionLibUrl)\n      self.importScripts(imageCompressionLibUrl)\n      scriptImported = true\n    }\n    // console.log('[worker] self', self)\n    const compressedFile = await imageCompression(file, options)\n    self.postMessage({ file: compressedFile, id })\n  } catch (e) {\n    // console.error('[worker] error', e)\n    self.postMessage({ error: e.message + '\\n' + e.stack, id })\n  }\n})\n"));let o=new Worker(i);o.addEventListener("message",function(e){if(s.signal&&s.signal.aborted)o.terminate();else if(void 0===e.data.progress){if(e.data.error)return n(Error(e.data.error)),void o.terminate();r(e.data.file),o.terminate()}else s.onProgress(e.data.progress)}),o.addEventListener("error",n),s.signal&&s.signal.addEventListener("abort",()=>{n(s.signal.reason),o.terminate()}),o.postMessage({file:e,imageCompressionLibUrl:s.libURL,options:{...s,onProgress:void 0,signal:void 0}})}).then(function(e){try{return u=e,f()}catch(e){return p()}},p)}catch(e){p()}function m(){try{u.name=e.name,u.lastModified=e.lastModified}catch(e){}try{s.preserveExif&&"image/jpeg"===e.type&&(!s.fileType||s.fileType&&s.fileType===e.type)&&(u=o(e,u))}catch(e){}return n(u)}})}R.getDataUrlFromFile=w,R.getFilefromDataUrl=b,R.loadImage=S,R.drawImageInCanvas=T,R.drawFileInCanvas=_,R.canvasToFile=A,R.getExifOrientation=C,R.handleMaxWidthOrHeight=N,R.followExifOrientation=L,R.cleanupCanvasMemory=P,R.isAutoOrientationInBrowser=O,R.approximateBelowMaximumCanvasSizeOfBrowser=E,R.copyExifWithoutOrientation=o,R.getBrowserName=x,R.version="2.0.2"},83872:(e,r,n)=>{"use strict";n.r(r),n.d(r,{createInitialTeamStand:()=>N,useJassStore:()=>R});var i=n(8106),o=n(4319),a=n(28742);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){u=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",h=a.toStringTag||"@@toStringTag";function d(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{d({},"")}catch(e){d=function(e,r,n){return e[r]=n}}function f(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=p(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=p(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function p(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};d(x,c,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,c)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){d(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function u(){return new r(function(n,u){!function n(o,a,u,c){var l=p(e[o],e,a);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==s(d)&&i.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,u,c)},function(e){n("throw",e,u,c)}):r.resolve(d).then(function(e){h.value=e,u(h)},function(e){return n("throw",e,u,c)})}c(l.arg)}(o,a,n,u)})}return n=n?n.then(u,u):u()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[c];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(s(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=d(S,h,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,d(e,h,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),d(_.prototype,l,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(f(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),d(T,h,"Generator"),d(T,c,function(){return this}),d(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function c(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function l(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){c(a,i,o,s,u,"next",e)}function u(e){c(a,i,o,s,u,"throw",e)}s(void 0)})}}function h(e){var r=function(e,r){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=s(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==s(r)?r:r+""}var d=new(function(){var e,r,n,i,o;return i=function e(){var r;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");(r=h(r="STORAGE_KEY"))in this?Object.defineProperty(this,r,{value:"jass_sessions",enumerable:!0,configurable:!0,writable:!0}):this[r]="jass_sessions"},o=[{key:"getStorageKey",value:function(e){return"".concat(this.STORAGE_KEY,"_").concat(e)}},{key:"saveSession",value:(e=l(u().mark(function e(r){var n,i,o;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=this.getStorageKey(r.id),e.next=1,localStorage.setItem(n,JSON.stringify(r));case 1:return e.next=2,this.listSessions();case 2:if((i=e.sent).find(function(e){return e.id===r.id})){e.next=3;break}return i.push(r),e.next=3,localStorage.setItem(this.STORAGE_KEY,JSON.stringify(i));case 3:e.next=5;break;case 4:throw e.prev=4,console.error("Fehler beim Speichern der Session:",o=e.catch(0)),o;case 5:case"end":return e.stop()}},e,this,[[0,4]])})),function(r){return e.apply(this,arguments)})},{key:"loadSession",value:(r=l(u().mark(function e(r){var n;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem(this.getStorageKey(r))){e.next=1;break}throw Error("Session ".concat(r," nicht gefunden"));case 1:return e.abrupt("return",JSON.parse(n));case 2:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"listSessions",value:(n=l(u().mark(function e(){var r;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=localStorage.getItem(this.STORAGE_KEY),e.abrupt("return",r?JSON.parse(r):[]);case 1:return e.prev=1,console.error("Fehler beim Laden der Sessions:",e.catch(0)),e.abrupt("return",[]);case 2:case"end":return e.stop()}},e,this,[[0,1]])})),function(){return n.apply(this,arguments)})}],function(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,h(i.key),i)}}(i.prototype,o),Object.defineProperty(i,"prototype",{writable:!1}),i}()),f=n(10637),p=n(16871),m=n(88813),g=n(42009),y=n(13848),v=n(21297),b=n(85253),w=n(38791),S=n(42471),x=n(94566),E=n(99407);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return k(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,r):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function _(){_=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof y?n:y).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===p)throw Error("Generator is already running");if(l===m){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,g)}(i,c);if(o){if(o===g)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=m,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?m:"suspendedYield",a.arg===g)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=m,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",p="executing",m="completed",g={};function y(){}function v(){}function b(){}var w={};l(w,s,function(){return this});var S=Object.getPrototypeOf,x=S&&S(S(C([])));x&&x!==n&&i.call(x,s)&&(w=x);var E=b.prototype=y.prototype=Object.create(w);function T(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function k(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==I(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(I(r)+" is not iterable")}return v.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},T(k.prototype),l(k.prototype,u,function(){return this}),r.AsyncIterator=k,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new k(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},T(E),l(E,c,"Generator"),l(E,s,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},r}function A(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function P(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){A(a,i,o,s,u,"next",e)}function u(e){A(a,i,o,s,u,"throw",e)}s(void 0)})}}function O(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function C(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?O(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=I(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==I(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var N=function(){return{bergActive:!1,bedankenActive:!1,isSigned:!1,striche:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},total:0,jassPoints:0,weisPoints:0,playerStats:{1:{striche:0,points:0,weisPoints:0},2:{striche:0,points:0,weisPoints:0},3:{striche:0,points:0,weisPoints:0},4:{striche:0,points:0,weisPoints:0}}}},L=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return{id:e,activeGameId:i,timestamp:Date.now(),teams:{top:N(),bottom:N()},sessionId:n,currentRound:1,startingPlayer:r,initialStartingPlayer:null!=o?o:r,currentPlayer:r,roundHistory:[],currentHistoryIndex:-1,historyState:{lastNavigationTimestamp:Date.now()},isGameStarted:!1,isRoundCompleted:!1,isGameCompleted:!1}},D={isJassStarted:!1,currentSession:{id:"initial",gruppeId:"default",startedAt:Date.now(),playerNames:{1:"",2:"",3:"",4:""},games:[],metadata:{},statistics:{gamesPlayed:0,scores:{top:0,bottom:0},weisCount:0,stricheCount:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},currentScoreLimit:2500,completedGamesCount:0},currentRound:1,currentGameId:1,activeGameId:null,isJassCompleted:!1,jassSessionId:null,sessionUnsubscribe:null,teams:{top:N(),bottom:N()},games:[],onlineCompletedGames:[],currentGameCache:null,completedGamesUnsubscribe:null},R=(0,i.v)()((0,o.Zr)(function(e,r){var i,o,s,u,c;return C(C({},D),{},{saveSession:(i=P(_().mark(function e(){var n,i,o,s,u,c,l,h,f;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=r(),c=a.useGameStore.getState(),l=(0,p.GH)(u.games,"top"),h=(0,p.GH)(u.games,"bottom"),f={id:"session_".concat(Date.now()),gruppeId:"default",startedAt:(null==(n=u.games[0])?void 0:n.timestamp)||Date.now(),endedAt:Date.now(),playerNames:c.playerNames,games:u.games.map(function(e){var r=e.id,n="string"==typeof r?parseInt(r,10):r;return"number"!=typeof n||isNaN(n)?null:n}).filter(function(e){return null!==e}),currentScoreLimit:null!=(i=null==(o=u.currentSession)?void 0:o.currentScoreLimit)?i:2500,completedGamesCount:u.games.length,metadata:{location:"Standard Location",notes:""},statistics:{gamesPlayed:u.games.length,totalDuration:Date.now()-((null==(s=u.games[0])?void 0:s.timestamp)||Date.now()),scores:{top:u.teams.top.total,bottom:u.teams.bottom.total},weisCount:u.games.reduce(function(e,r){return e+(r.teams.top.weisPoints+r.teams.bottom.weisPoints)},0),stricheCount:{berg:l.berg+h.berg,sieg:l.sieg+h.sieg,matsch:l.matsch+h.matsch,schneider:l.schneider+h.schneider,kontermatsch:l.kontermatsch+h.kontermatsch}}},e.prev=1,e.next=2,d.saveSession(f);case 2:return e.abrupt("return",f.id);case 3:throw e.prev=3,e.catch(1);case 4:case"end":return e.stop()}},e,null,[[1,3]])})),function(){return i.apply(this,arguments)}),loadSession:(o=P(_().mark(function e(r){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,d.loadSession(r);case 1:e.sent,e.next=3;break;case 2:throw e.prev=2,e.catch(0);case 3:case"end":return e.stop()}},e,null,[[0,2]])})),function(e){return o.apply(this,arguments)}),startJass:(s=P(_().mark(function n(i){var o,s,u,c,l,h,d,p,m,v,x,E,I,T,k,A,P,O,D,R,j,F,U,M,G,V,B,z,q,H,$,K;return _().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(c=i.playerNames,l=i.initialStartingPlayer,h=i.activeGameId,d=i.sessionId,p=i.groupId,m=i.participantUids,v=i.participantPlayerIds,I=C({},E={farbeSettings:null!=(o=null==(x=i.initialSettings)?void 0:x.farbeSettings)?o:b.FT,scoreSettings:null!=(s=null==x?void 0:x.scoreSettings)?s:w.$d,strokeSettings:null!=(u=null==x?void 0:x.strokeSettings)?u:S.zh}),!p){n.next=5;break}return n.prev=1,T=(0,g.getFirestore)(y.firebaseApp),k=(0,g.doc)(T,"groups",p),n.next=2,(0,g.getDoc)(k);case 2:(A=n.sent).exists()?(D=(O=A.data()).farbeSettings,R=O.scoreSettings,j=O.strokeSettings,I={farbeSettings:C(C(C({},E.farbeSettings),D||{}),{},{cardStyle:null!=(P=null==D?void 0:D.cardStyle)?P:E.farbeSettings.cardStyle}),scoreSettings:null!=R?R:E.scoreSettings,strokeSettings:null!=j?j:E.strokeSettings}):console.warn("[JassStore.startJass] Gruppe ".concat(p," nicht gefunden. Basis-Einstellungen (UI/Turnier/Default) werden verwendet.")),n.next=4;break;case 3:n.prev=3,K=n.catch(1),console.error("[JassStore.startJass] Fehler beim Laden der Gruppe ".concat(p,":"),K),console.warn("[JassStore.startJass] Basis-Einstellungen (UI/Turnier/Default) bleiben nach Fehler erhalten.");case 4:n.next=5;break;case 5:if(d){n.next=6;break}return console.error("[JassStore.startJass] ❌ sessionId ist undefined/null."),n.abrupt("return");case 6:case 7:return F=L(1,l,d,h,l),U=(0,g.getFirestore)(y.firebaseApp),M=Date.now(),n.prev=8,G=(0,g.doc)(U,"sessions",d),n.next=9,(0,g.getDoc)(G);case 9:(V=n.sent).exists()&&(B=V.data()).startedAt&&("function"==typeof B.startedAt.toMillis?M=B.startedAt.toMillis():"number"==typeof B.startedAt&&(M=B.startedAt)),n.next=11;break;case 10:n.prev=10,console.warn("[JassStore.startJass] ⚠️ Konnte Session-Dokument nicht lesen, verwende lokalen Timestamp:",n.catch(8));case 11:return z={currentFarbeSettings:I.farbeSettings,currentScoreSettings:I.scoreSettings,currentStrokeSettings:I.strokeSettings,playerNames:c,participantUids:null!=m?m:[],participantPlayerIds:null!=v?v:[],groupId:null!=p?p:null,startedAt:(0,g.serverTimestamp)()},n.prev=12,q=(0,g.doc)(U,"sessions",d),n.next=13,(0,g.setDoc)(q,C(C({},z),{},{currentActiveGameId:null!=h?h:null,lastUpdated:(0,g.serverTimestamp)()}),{merge:!0});case 13:n.next=15;break;case 14:n.prev=14,console.error("[JassStore.startJass] ❌ ERSTE SICHERHEIT FEHLGESCHLAGEN:",n.catch(12));case 15:if(!h){n.next=19;break}return n.prev=16,H=(0,g.doc)(U,"activeGames",h),n.next=17,(0,g.setDoc)(H,{activeFarbeSettings:I.farbeSettings,activeScoreSettings:I.scoreSettings,activeStrokeSettings:I.strokeSettings},{merge:!0});case 17:n.next=19;break;case 18:n.prev=18,console.error("[JassStore.startJass] ❌ ZWEITE SICHERHEIT FEHLGESCHLAGEN:",n.catch(16));case 19:e({isJassStarted:!0,currentSession:{id:d,gruppeId:null!=p?p:"",startedAt:M,playerNames:c,games:[1],currentScoreLimit:5e3,completedGamesCount:0,participantUids:null!=m?m:[],participantPlayerIds:null!=v?v:[],metadata:{},statistics:{gamesPlayed:0,scores:{top:0,bottom:0},weisCount:0,stricheCount:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},currentFarbeSettings:I.farbeSettings,currentScoreSettings:I.scoreSettings,currentStrokeSettings:I.strokeSettings},currentRound:1,currentGameId:1,activeGameId:null!=h?h:null,isJassCompleted:!1,jassSessionId:d,teams:{top:N(),bottom:N()},games:[F],onlineCompletedGames:[],currentGameCache:F}),a.useGameStore.getState().resetGame(l,h,I),a.useGameStore.setState({playerNames:c}),($=f.useTimerStore.getState()).startJassTimer(),$.activateGameTimer(1),setTimeout(function(){r().subscribeToSession(d,p)},100);case 20:case"end":return n.stop()}},n,null,[[1,3],[8,10],[12,14],[16,18]])})),function(e){return s.apply(this,arguments)}),startNextGame:function(n,i){var o,s,u,c,l,h,d=r(),p=a.useGameStore.getState(),m=f.useTimerStore.getState();if(!d.isJassStarted||!d.currentSession)return void console.log("[JassStore.startNextGame] Jass not started or no current session.");var g=d.currentSession.id,y=d.currentGameId+1,v=L(y,n,g,i,null!=(o=null==(s=d.games[0])?void 0:s.initialStartingPlayer)?o:n);e(function(e){if(!e.currentSession)return{};var r,n,o,a=e.currentSession.statistics,s={gamesPlayed:y,totalDuration:null==a?void 0:a.totalDuration,scores:null!=(r=null==a?void 0:a.scores)?r:{top:0,bottom:0},weisCount:null!=(n=null==a?void 0:a.weisCount)?n:0,stricheCount:null!=(o=null==a?void 0:a.stricheCount)?o:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}};return{currentGameId:y,games:[].concat(T(e.games),[v]),currentSession:C(C({},e.currentSession),{},{games:[].concat(T(e.currentSession.games),[y]),statistics:s}),currentRound:1,isJassCompleted:!1,activeGameId:null!=i?i:null}}),m.reactivateGameTimer(y);var x=r();if(!x.currentSession)return void console.error("[JassStore.startNextGame] Kritischer Fehler: Keine currentSession gefunden. Breche ab.");var E={farbeSettings:null!=(u=x.currentSession.currentFarbeSettings)?u:b.FT,scoreSettings:null!=(c=x.currentSession.currentScoreSettings)?c:w.$d,strokeSettings:null!=(l=x.currentSession.currentStrokeSettings)?l:S.zh};p.resetGame(n,i,E),a.useGameStore.setState({playerNames:x.currentSession.playerNames}),null!=(h=d.currentSession)&&h.id&&r().syncCompletedGamesForSession(d.currentSession.id)},finalizeGame:(u=P(_().mark(function n(){var i,o,s,u,c,l,h,d,p,b,w,S,E,T,k,A,P,O,N,L,D,R,j,F,U;return _().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(u=r(),c=a.useGameStore.getState(),l=u.games.find(function(e){return e.id===u.currentGameId})){n.next=1;break}return n.abrupt("return");case 1:if(d=(h=f.useTimerStore.getState()).getGameDuration(u.currentGameId),p=C(C({},l),{},{teams:{top:C(C({},l.teams.top),{},{jassPoints:c.scores.top,total:c.scores.top,striche:C({},c.striche.top)}),bottom:C(C({},l.teams.bottom),{},{jassPoints:c.scores.bottom,total:c.scores.bottom,striche:C({},c.striche.bottom)})},roundHistory:l.roundHistory||[],currentRound:c.currentRound,currentPlayer:c.currentPlayer,currentHistoryIndex:c.currentHistoryIndex,historyState:c.historyState,isGameStarted:c.isGameStarted,isRoundCompleted:c.isRoundCompleted,isGameCompleted:!0,metadata:{duration:"number"==typeof d?d:0,completedAt:Date.now(),roundStats:null!=(i=null==(o=l.metadata)?void 0:o.roundStats)?i:{weisCount:0,colorStats:{}}}}),!(l.activeGameId&&null!=(s=u.currentSession)&&s.id)){n.next=19;break}return b=x.useUIStore.getState(),n.prev=2,w=(0,g.getFirestore)(y.firebaseApp),n.prev=3,S=(0,g.doc)(w,"activeGames",l.activeGameId),n.next=4,(0,g.setDoc)(S,{status:"completed",lastUpdated:(0,g.serverTimestamp)()},{merge:!0});case 4:n.next=8;break;case 5:if(n.prev=5,"permission-denied"!==(R=n.catch(3)).code){n.next=6;break}console.warn("[JassStore.finalizeGame] ⚠️ Permission-denied beim ActiveGame Update - m\xf6glicherweise bereits gel\xf6scht oder User nicht berechtigt. Fahre fort ohne Fehler."),n.next=8;break;case 6:if("not-found"!==R.code){n.next=7;break}console.warn("[JassStore.finalizeGame] ⚠️ ActiveGame nicht gefunden - bereits gel\xf6scht. Fahre fort ohne Fehler."),n.next=8;break;case 7:throw console.error("[JassStore.finalizeGame] ❌ Unerwarteter Fehler beim ActiveGame Update:",R),R;case 8:if(n.prev=8,E=null,l&&"number"==typeof l.id&&1===l.id&&(T=p.roundHistory.find(function(e){return"jass"===e.actionType&&"farbe"in e&&e.farbe}))&&"currentPlayer"in T&&(A=T.currentPlayer-1,(P=(null==(k=u.currentSession)?void 0:k.participantPlayerIds)||[])[A]&&(E=P[A])),(O={gameNumber:"number"==typeof l.id?l.id:parseInt(String(l.id),10),activeGameId:l.activeGameId,timestampCompleted:(0,g.serverTimestamp)(),durationMillis:"number"==typeof d?d:0,finalScores:c.scores,finalStriche:c.striche,eventCounts:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},weisPoints:c.weisPoints,startingPlayer:l.startingPlayer,initialStartingPlayer:l.initialStartingPlayer,playerNames:c.playerNames,trumpColorsPlayed:[],roundHistory:p.roundHistory,participantUids:u.currentSession.participantUids||[],groupId:u.currentSession.gruppeId||null,Rosen10player:E}).eventCounts=(0,m.pK)(O),!u.currentSession.gruppeId){n.next=10;break}return N=(0,g.doc)(w,"groups",u.currentSession.gruppeId,"jassGameSummaries",u.currentSession.id,"completedGames",String(l.id)),n.next=9,(0,g.setDoc)(N,(0,v.g)(O));case 9:n.next=11;break;case 10:return L=(0,g.doc)(w,"jassGameSummaries",u.currentSession.id,"completedGames",String(l.id)),n.next=11,(0,g.setDoc)(L,(0,v.g)(O));case 11:n.next=13;break;case 12:n.prev=12,"permission-denied"===(j=n.catch(8)).code?console.warn("[JassStore.finalizeGame] ⚠️ Permission-denied beim jassGameSummaries Schreibzugriff. User m\xf6glicherweise nicht in participantUids."):console.error("[JassStore.finalizeGame] ❌ Fehler beim Speichern der Game Summary:",j);case 13:return n.prev=13,D=(0,g.doc)(w,"sessions",u.currentSession.id),n.next=14,(0,g.setDoc)(D,{currentActiveGameId:null,lastUpdated:(0,g.serverTimestamp)()},{merge:!0});case 14:n.next=17;break;case 15:if(n.prev=15,"permission-denied"!==(F=n.catch(13)).code){n.next=16;break}console.warn("[JassStore.finalizeGame] ⚠️ Permission-denied beim Session Update - User m\xf6glicherweise nicht berechtigt. Fahre fort ohne Fehler."),n.next=17;break;case 16:throw console.error("[JassStore.finalizeGame] ❌ Fehler beim Session Update:",F),F;case 17:n.next=19;break;case 18:n.prev=18,console.error("[JassStore.finalizeGame] ❌ Firestore-Update fehlgeschlagen:",U=n.catch(2)),U&&"object"===I(U)&&"code"in U?"permission-denied"===U.code?(console.warn("[JassStore.finalizeGame] ⚠️ Permission-Problem erkannt. Spiel wird lokal finalisiert, aber Firestore-Sync fehlgeschlagen."),b.showNotification({type:"warning",message:"Spiel wurde lokal abgeschlossen, aber die Online-Synchronisation schlug fehl. Ihre Daten sind trotzdem sicher."})):b.showNotification({type:"error",message:"Fehler beim Abschlie\xdfen des Spiels. Bitte versuchen Sie es erneut."}):b.showNotification({type:"error",message:"Unerwarteter Fehler beim Abschlie\xdfen des Spiels."});case 19:e(function(e){return{games:e.games.map(function(e){return e.id===l.id?p:e})}}),h.completeGame();case 20:case"end":return n.stop()}},n,null,[[2,18],[3,5],[8,12],[13,15]])})),function(){return u.apply(this,arguments)}),resetJass:function(){var n,i;null==(n=(i=r()).sessionUnsubscribe)||n.call(i),e(C({},D))},subscribeToSession:(c=P(_().mark(function n(i,o){var s,u,c,l;return _().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(s=r().sessionUnsubscribe)&&s(),u=(0,g.getFirestore)(y.firebaseApp),c=(0,g.doc)(u,"sessions",i),l=(0,g.onSnapshot)(c,function(n){if(n.exists()){var o,s,u,c=n.data();c.currentFarbeSettings&&c.currentScoreSettings&&c.currentStrokeSettings&&a.useGameStore.getState().setGameSettings({farbeSettings:c.currentFarbeSettings,scoreSettings:c.currentScoreSettings,strokeSettings:c.currentStrokeSettings});var l=r(),h=null!=(o=null!=(s=c.participantPlayerIds)?s:null==(u=l.currentSession)?void 0:u.participantPlayerIds)?o:[];e(function(e){var r,n,i,o;return C(C({},e),{},{activeGameId:null!=(r=c.currentActiveGameId)?r:null,jassSessionId:null!=(n=c.id)?n:e.jassSessionId,currentSession:C(C(C({},e.currentSession),c),{},{id:null!=(i=c.id)?i:null==(o=e.currentSession)?void 0:o.id,participantPlayerIds:h,currentFarbeSettings:c.currentFarbeSettings,currentScoreSettings:c.currentScoreSettings,currentStrokeSettings:c.currentStrokeSettings})})})}else console.warn("[jassStore] Session-Dokument ".concat(i," nicht gefunden."))},function(e){console.error("[jassStore] Fehler im Session-Listener f\xfcr ".concat(i,":"),e)}),e({sessionUnsubscribe:l}),r().syncCompletedGamesForSession(i);case 1:case"end":return n.stop()}},n)})),function(e,r){return c.apply(this,arguments)}),syncCompletedGamesForSession:function(n){var i=r().completedGamesUnsubscribe;i&&i();var o=(0,E.loadCompletedGamesFromFirestore)(n,function(r){e({onlineCompletedGames:r})});e({completedGamesUnsubscribe:o})},clearActiveGameForSession:function(r){e(function(e){var n;return e.currentSession&&e.currentSession.id===r?C(C({},e),{},{activeGameId:null,currentSession:C(C({},e.currentSession),{},{currentActiveGameId:null})}):(console.warn("[JassStore] Attempted to clear activeGameId for session ".concat(r,", but current session is different (").concat(null==(n=e.currentSession)?void 0:n.id,") or null.")),e)})},undoNewGame:function(){var n=r();if(!(n.games.length<=1)){var i=n.games.slice(0,-1),o=i[i.length-1];if(o){var s=a.useGameStore.getState();s.resetGamePoints(),s.setScore("top",o.teams.top.jassPoints),s.setScore("bottom",o.teams.bottom.jassPoints);var u=n.games[n.games.length-1],c=C({},n.teams);c.top=C(C({},c.top),{},{jassPoints:c.top.jassPoints-u.teams.top.jassPoints,total:c.top.total-u.teams.top.jassPoints}),c.bottom=C(C({},c.bottom),{},{jassPoints:c.bottom.jassPoints-u.teams.bottom.jassPoints,total:c.bottom.total-u.teams.bottom.jassPoints}),e({games:i,currentGameId:"string"==typeof o.id?parseInt(o.id,10):o.id,teams:c})}}},navigateToGame:function(i){var o,s=r(),u=s.games.find(function(e){return e.id===i});if(u){s.games.length,null==(o=u.roundHistory)||o.length;var c=f.useTimerStore.getState();if(c.activateGameTimer(i),c.startGameTimer(),c.startRoundTimer(),e(function(e){return C(C({},e),{},{currentGameId:i,teams:u.teams})}),u.activeGameId){var l=u.activeGameId;Promise.resolve().then(n.bind(n,99407)).then(function(r){(0,r.loadRoundsFromFirestore)(l).then(function(r){var n=r.length-1;e(function(e){var n=C(C({},u),{},{roundHistory:r});return C(C({},e),{},{games:e.games.map(function(e){return e.id===u.id?n:e})})}),a.useGameStore.setState(function(e){return C(C({},e),{},{roundHistory:r,currentHistoryIndex:n,historyState:{lastNavigationTimestamp:Date.now()}})})}).catch(function(e){console.error("[JassStore] Error loading rounds from Firestore for game ".concat(l,":"),e),a.useGameStore.setState(function(e){return C(C({},e),{},{currentHistoryIndex:-1,historyState:{lastNavigationTimestamp:Date.now()}})})})}),a.useGameStore.setState(function(e){return C(C({},e),{},{activeGameId:u.activeGameId,isGameStarted:!0,isRoundCompleted:!1,isGameCompleted:!1,currentRound:u.currentRound||1,currentPlayer:u.currentPlayer,scores:{top:u.teams.top.jassPoints,bottom:u.teams.bottom.jassPoints},weisPoints:{top:u.teams.top.weisPoints||0,bottom:u.teams.bottom.weisPoints||0},striche:{top:C({},u.teams.top.striche),bottom:C({},u.teams.bottom.striche)},roundHistory:[],currentHistoryIndex:-1,historyState:{lastNavigationTimestamp:Date.now()},playerNames:e.playerNames})})}else{var h=u.roundHistory||[],d=h.length-1;a.useGameStore.setState(function(e){return C(C({},e),{},{activeGameId:void 0,isGameStarted:!0,isRoundCompleted:!1,isGameCompleted:!1,currentRound:u.currentRound||1,currentPlayer:u.currentPlayer,scores:{top:u.teams.top.jassPoints,bottom:u.teams.bottom.jassPoints},weisPoints:{top:u.teams.top.weisPoints||0,bottom:u.teams.bottom.weisPoints||0},striche:{top:C({},u.teams.top.striche),bottom:C({},u.teams.bottom.striche)},roundHistory:h,currentHistoryIndex:d,historyState:{lastNavigationTimestamp:Date.now()},playerNames:e.playerNames})})}console.log("\uD83C\uDFAE Game Navigation Complete:",{gameId:i,timersStarted:!0,gameStarted:!0,roundStarted:!0,activeGameId:u.activeGameId||"none"})}},navigateToPreviousGame:function(){var e=r();return e.currentGameId>1&&(r().navigateToGame(e.currentGameId-1),!0)},navigateToNextGame:function(){var e=r();if(e.currentGameId<e.games.length){var n=f.useTimerStore.getState();return e.currentGameId,r().navigateToGame(e.currentGameId+1),n.startGameTimer(),n.startRoundTimer(),!0}return!1},canNavigateBack:function(){return r().currentGameId>1},canNavigateForward:function(){var e=r();return e.currentGameId<e.games.length},calculateTotalPoints:function(){var e=r();return{top:e.teams.top.total,bottom:e.teams.bottom.total}},calculateTotalJassPoints:function(){var e=r();return{top:e.teams.top.jassPoints,bottom:e.teams.bottom.jassPoints}},getGameHistory:function(){return r().games},getCurrentGame:function(){var e=r();return e.games.find(function(r){return r.id===e.currentGameId})},getVisibleGames:function(){var e=r();return e.games.filter(function(r){var n=r.id,i="string"==typeof n?parseInt(n,10):n;return"number"==typeof i&&!isNaN(i)&&i<=e.currentGameId})},updateCurrentGame:function(r){e(function(e){var n=e.games.find(function(r){return r.id===e.currentGameId});if(!n)return e;var i=r.teams?{top:C(C({},n.teams.top),r.teams.top),bottom:C(C({},n.teams.bottom),r.teams.bottom)}:n.teams,o=C(C(C({},n),r),{},{teams:i});return C(C({},e),{},{games:e.games.map(function(e){return e.id===o.id?o:e})})})},updateWeisPoints:function(r,n){e(function(e){var i=C({},e.teams);return i[r].weisPoints+=n,i[r].total+=n,{teams:i}})},getTotalsUpToGame:function(e){return r().games.filter(function(r){var n="string"==typeof r.id?parseInt(r.id,10):r.id;return"number"==typeof n&&!isNaN(n)&&n<=e}).reduce(function(e,r){return{striche:{top:{berg:e.striche.top.berg+r.teams.top.striche.berg,sieg:e.striche.top.sieg+r.teams.top.striche.sieg,matsch:e.striche.top.matsch+r.teams.top.striche.matsch,schneider:e.striche.top.schneider+r.teams.top.striche.schneider,kontermatsch:e.striche.top.kontermatsch+r.teams.top.striche.kontermatsch},bottom:{berg:e.striche.bottom.berg+r.teams.bottom.striche.berg,sieg:e.striche.bottom.sieg+r.teams.bottom.striche.sieg,matsch:e.striche.bottom.matsch+r.teams.bottom.striche.matsch,schneider:e.striche.bottom.schneider+r.teams.bottom.striche.schneider,kontermatsch:e.striche.bottom.kontermatsch+r.teams.bottom.striche.kontermatsch}},punkte:{top:e.punkte.top+r.teams.top.total,bottom:e.punkte.bottom+r.teams.bottom.total}}},{striche:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},punkte:{top:0,bottom:0}})},startGame:function(){console.warn("startGame Action not implemented yet.")}})},{name:"jass-storage",version:1,migrate:function(e,r){if(0===r){var n;null!=e&&null!=(n=e.currentSession)&&n.currentScoreSettings&&void 0===e.currentSession.currentScoreSettings.matschBonus&&(console.log("\uD83D\uDD04 Migrating jassStore state v0 to v1: Adding matschBonus to currentSession"),e.currentSession.currentScoreSettings.matschBonus=!0)}return e},partialize:function(e){return{games:e.games,currentSession:e.currentSession,currentGameId:e.currentGameId,jassSessionId:e.jassSessionId,isJassStarted:e.isJassStarted}}}))},83885:(e,r,n)=>{"use strict";n.d(r,{xQ:()=>a});var i=n(14232),o=n(3866);function a(e=!0){let r=(0,i.useContext)(o.t);if(null===r)return[!0,null];let{isPresent:n,onExitComplete:s,register:u}=r,c=(0,i.useId)();(0,i.useEffect)(()=>{if(e)return u(c)},[e]);let l=(0,i.useCallback)(()=>e&&s&&s(c),[c,s,e]);return!n&&s?[!1,l]:[!0]}},85253:(e,r,n)=>{"use strict";n.d(r,{FT:()=>a,mG:()=>s,u4:()=>o});var i={backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"},o=[{id:"mis\xe8re",name:"Mis\xe8re",multiplier:1,order:1,emojiStyle:{backgroundColor:"bg-[#f87171] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#f87171]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"eicheln",name:"Eicheln",multiplier:7,order:7,emojiStyle:{backgroundColor:"bg-[#65a30d] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#65a30d]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"rosen",name:"Rosen",multiplier:4,order:3,emojiStyle:{backgroundColor:"bg-[#fde047] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#fde047]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"schellen",name:"Schellen",multiplier:2,order:4,emojiStyle:{backgroundColor:"bg-[#fbbf24] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#fbbf24]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"schilten",name:"Schilten",multiplier:3,order:5,emojiStyle:{backgroundColor:"bg-[#64748b] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#6b7280]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"obe",name:"Obe",multiplier:5,order:6,emojiStyle:{backgroundColor:"bg-[#0891b2] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#0284c7]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"une",name:"Une",multiplier:6,order:7,emojiStyle:{backgroundColor:"bg-[#0369a1] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#854d0e]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"dreimal",name:"3x3",multiplier:4,order:8,emojiStyle:{backgroundColor:"bg-[#f0abfc] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#f0abfc]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"quer",name:"Quer",multiplier:7,order:9,emojiStyle:{backgroundColor:"bg-[#f87171] group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-[#0891b2]"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}},{id:"slalom",name:"Slalom",multiplier:7,order:10,emojiStyle:{backgroundColor:"bg-white group-[.has-active]:bg-gray-600/75 group-[.active]:!bg-white"},standardStyle:i,frStyle:{backgroundColor:"bg-gradient-to-b from-gray-600 to-gray-700 shadow-inner border border-gray-500/30 hover:from-gray-500 hover:to-gray-600 group-[.has-active]:bg-gray-600/75 group-[.active]:!from-gray-500 group-[.active]:!to-gray-600"}}],a={values:{eicheln:1,rosen:1,schellen:2,schilten:2,obe:3,une:3,misère:0,dreimal:0,quer:0,slalom:0},cardStyle:"DE"},s=function(e){return!e.values||Object.values(e.values).every(function(e){return"number"==typeof e&&e>=0&&e<=8})}},87247:(e,r)=>{r.read=function(e,r,n,i,o){var a,s,u=8*o-i-1,c=(1<<u)-1,l=c>>1,h=-7,d=n?o-1:0,f=n?-1:1,p=e[r+d];for(d+=f,a=p&(1<<-h)-1,p>>=-h,h+=u;h>0;a=256*a+e[r+d],d+=f,h-=8);for(s=a&(1<<-h)-1,a>>=-h,h+=i;h>0;s=256*s+e[r+d],d+=f,h-=8);if(0===a)a=1-l;else{if(a===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),a-=l}return(p?-1:1)*s*Math.pow(2,a-i)},r.write=function(e,r,n,i,o,a){var s,u,c,l=8*a-o-1,h=(1<<l)-1,d=h>>1,f=5960464477539062e-23*(23===o),p=i?0:a-1,m=i?1:-1,g=+(r<0||0===r&&1/r<0);for(isNaN(r=Math.abs(r))||r===1/0?(u=+!!isNaN(r),s=h):(s=Math.floor(Math.log(r)/Math.LN2),r*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?r+=f/c:r+=f*Math.pow(2,1-d),r*c>=2&&(s++,c/=2),s+d>=h?(u=0,s=h):s+d>=1?(u=(r*c-1)*Math.pow(2,o),s+=d):(u=r*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&u,p+=m,u/=256,o-=8);for(s=s<<o|u,l+=o;l>0;e[n+p]=255&s,p+=m,s/=256,l-=8);e[n+p-m]|=128*g}},88112:(e,r,n)=>{"use strict";n.d(r,{D:()=>o});var i=n(64609);let o=e=>(r,n,o)=>(o.setState=(e,n,...o)=>r("function"==typeof e?(0,i.jM)(e):e,n,...o),e(o.setState,n,o))},88308:(e,r,n)=>{"use strict";n.d(r,{h1:()=>u,uA:()=>o});var i=n(51139);class o{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let a="[DEFAULT]";class s{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){let e=new i.cY;if(this.instancesDeferred.set(r,e),this.isInitialized(r)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:r});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;let n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!=(r=null==e?void 0:e.optional)&&r;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}if(i)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:a})}catch(e){}for(let[e,r]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});r.resolve(e)}catch(e){}}}}clearInstance(e=a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=a){return this.instances.has(e)}getOptions(e=a){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(let[e,r]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&r.resolve(i);return i}onInit(e,r){var n;let i=this.normalizeInstanceIdentifier(r),o=null!=(n=this.onInitCallbacks.get(i))?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){let n=this.onInitCallbacks.get(r);if(n)for(let i of n)try{i(e,r)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:r={}}){var n;let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(n=e)===a?void 0:n,options:r}),this.instances.set(e,i),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch(e){}return i||null}normalizeInstanceIdentifier(e=a){return this.component?this.component.multipleInstances?e:a:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class u{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let r=this.getProvider(e.name);if(r.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let r=new s(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}},88813:(e,r,n)=>{"use strict";n.d(r,{PW:()=>a,m$:()=>u,pK:()=>s});var i=n(15424);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=function(e,r){if(!e||!r)return console.warn("generatePairingId: Eine oder beide PlayerIDs fehlen.",{playerId1:e,playerId2:r}),"invalid_pairing_missing_ids";var n=[e,r].sort();return"".concat(n[0],"_").concat(n[1])},s=function(e){var r=e.finalStriche,n=(e.finalScores,e.roundHistory),i={sieg:0,berg:0,matsch:0,kontermatsch:0,schneider:0},a={sieg:0,berg:0,matsch:0,kontermatsch:0,schneider:0};return n&&Array.isArray(n)&&n.forEach(function(e,r){var n,s=null;if(e&&"object"===o(e)&&"strichInfo"in e&&e.strichInfo)s=e.strichInfo;else if(e&&"object"===o(e)&&null!=(n=e.roundState)&&n.strichInfo)s=e.roundState.strichInfo;else if(e&&"object"===o(e)){for(var u in e)if(u.includes("strich")&&e[u]&&"object"===o(e[u])&&e[u].team&&e[u].type){s=e[u];break}}if(s&&s.type&&s.team){var c=s.team;"matsch"===s.type?"bottom"===c?i.matsch++:"top"===c&&a.matsch++:"kontermatsch"===s.type&&("bottom"===c?i.kontermatsch++:"top"===c&&a.kontermatsch++)}}),r.bottom.sieg>0?i.sieg=1:r.top.sieg>0&&(a.sieg=1),r.bottom.berg>0?i.berg=1:r.top.berg>0&&(a.berg=1),r.bottom.schneider>0?i.schneider=1:r.top.schneider>0&&(a.schneider=1),{bottom:i,top:a}},u=function(e){var r=0,n={},o={},a=null,s=0;return e.forEach(function(e){if((0,i.Aw)(e)){var u=e.durationMillis;if(u&&"number"==typeof u&&(r+=u),e.currentPlayer&&u&&"number"==typeof u){var c=e.currentPlayer.toString();o[c]||(o[c]={totalDuration:0,roundCount:0}),o[c].totalDuration+=u,o[c].roundCount+=1}if(e.farbe&&e.currentPlayer){var l=e.currentPlayer.toString(),h=e.farbe.toLowerCase();n[l]||(n[l]={}),n[l][h]||(n[l][h]=0),n[l][h]+=1}0===s&&e.currentPlayer&&e.farbe&&(a=e.currentPlayer.toString()),s++}}),{totalRoundDurationMillis:r,trumpfCountsByPlayer:n,roundDurationsByPlayer:o,Rosen10player:a}}},88880:(e,r,n)=>{"use strict";n.d(r,{S:()=>i});var i={Misère:{DE:"Mis\xe8re",FR:"Mis\xe8re"},Eicheln:{DE:"Eichel",FR:"Schaufel"},Rosen:{DE:"Rosen",FR:"Kreuz"},Schellen:{DE:"Schellen",FR:"Herz"},Schilten:{DE:"Schilten",FR:"Ecke"},Obe:{DE:"Obe",FR:"Obe"},Une:{DE:"Unde",FR:"Unde"},"3x3":{DE:"3x3",FR:"3x3"},Quer:{DE:"Quer",FR:"Quer"},Slalom:{DE:"Slalom",FR:"Slalom"}}},89099:(e,r,n)=>{e.exports=n(75181)},91200:(e,r,n)=>{"use strict";n.d(r,{M:()=>o});var i=n(14232);function o(e){let r=(0,i.useRef)(null);return null===r.current&&(r.current=e()),r.current}},93504:(e,r,n)=>{"use strict";n.r(r),n.d(r,{activateTournamentService:()=>W,addParticipantToTournament:()=>_,addParticipantsToTournamentBatch:()=>A,addTournamentAdmin:()=>O,clearActivePasseInTournament:()=>Q,completeAndRecordTournamentPasse:()=>H,completeTournamentPasse:()=>j,createTournamentInstance:()=>x,fetchActivePasseForUser:()=>R,fetchActiveTournamentForUser:()=>T,fetchPasseRounds:()=>U,fetchTournamentGames:()=>F,fetchTournamentInstanceDetails:()=>I,fetchTournamentInstancesForGroup:()=>E,fetchTournamentParticipants:()=>L,fetchTournamentsForUser:()=>B,generateTournamentInviteToken:()=>z,leaveTournament:()=>N,markTournamentAsCompletedService:()=>$,redeemTournamentInvite:()=>q,removeParticipantFromTournament:()=>P,removeTournamentAdmin:()=>C,startTournamentPasseService:()=>D,updateActiveTournamentPasse:()=>M,updateTournamentBaseDetails:()=>K,updateTournamentInstanceData:()=>k,updateTournamentSettings:()=>G,uploadTournamentLogoFirebase:()=>V});var i=n(42009),o=n(13848),a=n(66534),s=n(40673),u=n(15424),c=n(37746),l=n(95226),h=n(38791),d=n(42471),f=n(85253);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function g(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?m(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=p(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==p(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function y(){y=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=f,function(r,n){if(l===m)throw Error("Generator is already running");if(l===g){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===f)throw l=g,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=m;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?g:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=g,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var f="suspendedStart",m="executing",g="completed",v={};function b(){}function w(){}function S(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==p(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(p(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=l(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function v(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return b(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,r):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function w(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function S(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){w(a,i,o,s,u,"next",e)}function u(e){w(a,i,o,s,u,"throw",e)}s(void 0)})}}var x=function(){var e=S(y().mark(function e(r,n,a,s,u){var c,l,h,d,f,p,m,g=arguments;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=g.length>5&&void 0!==g[5]?g[5]:"upcoming",e.prev=1,l=(0,i.collection)(o.db,"tournaments"),h=Array.isArray(s)?v(new Set([n].concat(v(s)))):[n],d=[n],!(!(f={groupId:r,name:a.trim(),description:"",logoUrl:null,instanceDate:null,status:c,createdBy:n,adminIds:d,participantUids:h,settings:u,createdAt:(0,i.serverTimestamp)(),updatedAt:(0,i.serverTimestamp)(),completedPasseCount:0,currentActiveGameId:null,lastActivity:(0,i.serverTimestamp)()}).name||f.name.length<3)){e.next=2;break}throw Error("Der Turniername muss mindestens 3 Zeichen lang sein.");case 2:return f.settings&&f.settings.minParticipants&&h.length<f.settings.minParticipants,e.next=3,(0,i.addDoc)(l,f);case 3:return p=e.sent,e.abrupt("return",p.id);case 4:throw e.prev=4,console.error("[tournamentService] Error creating tournament instance:",m=e.catch(1)),Error(m instanceof Error?m.message:"Turnier konnte nicht erstellt werden.");case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r,n,i,o,a){return e.apply(this,arguments)}}(),E=function(){var e=S(y().mark(function e(r){var n,a,s,u,c,l;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,i.collection)(o.db,"tournaments"),a=(0,i.query)(n,(0,i.where)("groupId","==",r)),e.next=1,(0,i.getDocs)(a);case 1:return s=e.sent,u=[],s.forEach(function(e){u.push(g({id:e.id},e.data()))}),u.sort(function(e,r){var n=e.createdAt&&"object"===p(e.createdAt)&&"toMillis"in e.createdAt?e.createdAt.toMillis():0;return(r.createdAt&&"object"===p(r.createdAt)&&"toMillis"in r.createdAt?r.createdAt.toMillis():0)-n}),e.abrupt("return",u);case 2:if(e.prev=2,l=e.catch(0),console.error("[tournamentService] Error fetching tournaments for group ".concat(r,":"),l),!(l&&"object"===p(l)&&"code"in l)||"failed-precondition"!==(c=l).code&&"permission-denied"!==c.code&&"not-found"!==c.code){e.next=3;break}return console.log("[tournamentService] Normal state: No tournaments accessible for group ".concat(r," (").concat(c.code,")")),e.abrupt("return",[]);case 3:throw Error("Turniere konnten nicht geladen werden.");case 4:case"end":return e.stop()}},e,null,[[0,2]])}));return function(r){return e.apply(this,arguments)}}(),I=function(){var e=S(y().mark(function e(r){var n,a,s,u;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,i.doc)(o.db,"tournaments",r),e.next=1,(0,i.getDoc)(n);case 1:if(!(a=e.sent).exists()){e.next=2;break}return s=a.data(),e.abrupt("return",g({id:a.id},s));case 2:return console.warn("[tournamentService] Tournament instance with ID ".concat(r," not found.")),e.abrupt("return",null);case 3:e.next=5;break;case 4:return e.prev=4,u=e.catch(0),console.error("[tournamentService] Error fetching tournament details for ".concat(r,":"),u),e.abrupt("return",null);case 5:case"end":return e.stop()}},e,null,[[0,4]])}));return function(r){return e.apply(this,arguments)}}(),T=function(){var e=S(y().mark(function e(r){var n,a,s,u,c;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return e.abrupt("return",null);case 1:return e.prev=1,n=(0,i.collection)(o.db,"tournaments"),a=(0,i.query)(n,(0,i.where)("participantUids","array-contains",r),(0,i.where)("status","==","active")),e.next=2,(0,i.getDocs)(a);case 2:if((s=e.sent).empty){e.next=3;break}return(u=s.docs.map(function(e){return g({id:e.id},e.data())})).sort(function(e,r){var n=e.createdAt&&"object"===p(e.createdAt)&&"toMillis"in e.createdAt?e.createdAt.toMillis():0;return(r.createdAt&&"object"===p(r.createdAt)&&"toMillis"in r.createdAt?r.createdAt.toMillis():0)-n}),c=u[0],e.abrupt("return",c);case 3:return e.abrupt("return",null);case 4:return e.prev=4,console.error("Error fetching active tournament:",e.catch(1)),e.abrupt("return",null);case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r){return e.apply(this,arguments)}}(),k=function(){var e=S(y().mark(function e(r,n){var a,s;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Updating data for tournament instance ".concat(r),n),a=(0,i.doc)(o.db,"tournaments",r),s=g(g({},n),{},{updatedAt:(0,i.serverTimestamp)()}),e.next=1,(0,i.updateDoc)(a,s);case 1:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),_=function(){var e=S(y().mark(function e(r,n){var a,s;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tournamentService] Adding participant ".concat(n," to tournament instance ").concat(r)),a=(0,i.doc)(o.db,"tournaments",r),e.prev=1,e.next=2,(0,i.updateDoc)(a,{participantUids:(0,i.arrayUnion)(n),updatedAt:(0,i.serverTimestamp)()});case 2:console.log("[tournamentService] Participant ".concat(n," successfully added to tournament ").concat(r,".")),e.next=4;break;case 3:throw e.prev=3,s=e.catch(1),console.error("[tournamentService] Error adding participant ".concat(n," to tournament ").concat(r,":"),s),Error("Teilnehmer konnte nicht zum Turnier hinzugef\xfcgt werden.");case 4:case"end":return e.stop()}},e,null,[[1,3]])}));return function(r,n){return e.apply(this,arguments)}}(),A=function(){var e=S(y().mark(function e(r,n){var a,s;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!n||0===n.length)){e.next=1;break}return console.log("[tournamentService] No user IDs provided to addParticipantsToTournamentBatch."),e.abrupt("return");case 1:return console.log("[tournamentService] Adding batch of ".concat(n.length," participants to tournament instance ").concat(r)),a=(0,i.doc)(o.db,"tournaments",r),e.prev=2,e.next=3,(0,i.updateDoc)(a,{participantUids:i.arrayUnion.apply(void 0,v(n)),updatedAt:(0,i.serverTimestamp)()});case 3:console.log("[tournamentService] Batch of participants successfully added to tournament ".concat(r,".")),e.next=5;break;case 4:throw e.prev=4,s=e.catch(2),console.error("[tournamentService] Error adding batch of participants to tournament ".concat(r,":"),s),Error("Teilnehmer-Batch konnte nicht zum Turnier hinzugef\xfcgt werden.");case 5:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r,n){return e.apply(this,arguments)}}(),P=function(){var e=S(y().mark(function e(r,n){var a,s,u,c,l,h,d,f,p,m,g,v,b;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tournamentService] Removing participant ".concat(n," from tournament instance ").concat(r)),a=(0,i.doc)(o.db,"tournaments",r),e.prev=1,e.next=2,(0,i.getDoc)(a);case 2:if((f=e.sent).exists()){e.next=3;break}throw Error("Turnier nicht gefunden.");case 3:if("completed"!==(p=f.data()).status&&"archived"!==p.status){e.next=4;break}throw console.warn("[tournamentService] Cannot remove participant from completed/archived tournament ".concat(r,".")),Error("Teilnehmer k\xf6nnen nicht aus einem abgeschlossenen oder archivierten Turnier entfernt werden.");case 4:if(!((m=null==(s=p.adminIds)?void 0:s.includes(n))&&(null==(u=p.adminIds)?void 0:u.length)===1)){e.next=6;break}if((null==(g=p.participantUids)?void 0:g.length)!==1||p.participantUids[0]!==n){e.next=5;break}throw console.warn("[tournamentService] Cannot remove participant ".concat(n," as they are the last participant and last admin.")),Error("Der letzte Teilnehmer kann nicht entfernt werden, wenn er auch der einzige Admin ist.");case 5:console.warn("[tournamentService] Participant ".concat(n," is an admin. Consider admin role transfer before removal if they are the last admin and other participants exist."));case 6:return v={participantUids:(0,i.arrayRemove)(n),updatedAt:(0,i.serverTimestamp)()},m&&(null!=(c=null==(l=p.adminIds)?void 0:l.length)?c:0)>1?(v.adminIds=(0,i.arrayRemove)(n),console.log("[tournamentService] Also removing ".concat(n," from adminIds."))):m&&(null!=(h=null==(d=p.adminIds)?void 0:d.length)?h:0)===1&&console.warn("[tournamentService] Participant ".concat(n," is the last admin. Not removing from adminIds via this function directly. Use removeTournamentAdmin with caution or ensure new admin is appointed first.")),e.next=7,(0,i.updateDoc)(a,v);case 7:console.log("[tournamentService] Participant ".concat(n," successfully removed from tournament ").concat(r,".")),e.next=10;break;case 8:if(e.prev=8,b=e.catch(1),console.error("[tournamentService] Error removing participant ".concat(n," from tournament ").concat(r,":"),b),!(b instanceof Error&&(b.message.includes("letzte Teilnehmer")||b.message.includes("Turnier nicht gefunden")||b.message.includes("abgeschlossenen oder archivierten")))){e.next=9;break}throw b;case 9:throw Error("Teilnehmer konnte nicht aus dem Turnier entfernt werden.");case 10:case"end":return e.stop()}},e,null,[[1,8]])}));return function(r,n){return e.apply(this,arguments)}}(),O=function(){var e=S(y().mark(function e(r,n){var a,s,u,c,l;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tournamentService] Making user ".concat(n," admin for tournament instance ").concat(r)),a=(0,i.doc)(o.db,"tournaments",r),e.prev=1,e.next=2,(0,i.getDoc)(a);case 2:if((u=e.sent).exists()){e.next=3;break}throw Error("Turnier nicht gefunden.");case 3:if("completed"!==(c=u.data()).status&&"archived"!==c.status){e.next=4;break}throw console.warn("[tournamentService] Cannot add admin to completed/archived tournament ".concat(r,".")),Error("Admins k\xf6nnen nicht zu einem abgeschlossenen oder archivierten Turnier hinzugef\xfcgt werden.");case 4:if(null!=(s=c.participantUids)&&s.includes(n)){e.next=5;break}throw console.warn("[tournamentService] User ".concat(n," is not a participant of tournament ").concat(r,". Cannot make admin.")),Error("Nur Turnierteilnehmer k\xf6nnen zu Admins ernannt werden.");case 5:return e.next=6,(0,i.updateDoc)(a,{adminIds:(0,i.arrayUnion)(n),participantUids:(0,i.arrayUnion)(n),updatedAt:(0,i.serverTimestamp)()});case 6:console.log("[tournamentService] User ".concat(n," successfully made admin in tournament ").concat(r,".")),e.next=9;break;case 7:if(e.prev=7,l=e.catch(1),console.error("[tournamentService] Error making user ".concat(n," admin for tournament ").concat(r,":"),l),!(l instanceof Error&&(l.message.includes("Nur Turnierteilnehmer")||l.message.includes("Turnier nicht gefunden")||l.message.includes("abgeschlossenen oder archivierten")))){e.next=8;break}throw l;case 8:throw Error("Admin-Status konnte nicht zugewiesen werden.");case 9:case"end":return e.stop()}},e,null,[[1,7]])}));return function(r,n){return e.apply(this,arguments)}}(),C=function(){var e=S(y().mark(function e(r,n){var a,s,u,c,l,h;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tournamentService] Removing admin rights for user ".concat(n," from tournament instance ").concat(r)),a=(0,i.doc)(o.db,"tournaments",r),e.prev=1,e.next=2,(0,i.getDoc)(a);case 2:if((c=e.sent).exists()){e.next=3;break}throw Error("Turnier nicht gefunden.");case 3:if("completed"!==(l=c.data()).status&&"archived"!==l.status){e.next=4;break}throw console.warn("[tournamentService] Cannot remove admin from completed/archived tournament ".concat(r,".")),Error("Admin-Status kann bei einem abgeschlossenen oder archivierten Turnier nicht entfernt werden.");case 4:if(n!==l.createdBy){e.next=5;break}throw console.warn("[tournamentService] Cannot remove founder ".concat(n," as admin.")),Error("Der Gr\xfcnder des Turniers kann nicht als Admin entfernt werden.");case 5:if(!(null!=(s=l.adminIds)&&s.includes(n)&&(null==(u=l.adminIds)?void 0:u.length)===1)){e.next=6;break}throw console.warn("[tournamentService] Cannot remove user ".concat(n," as they are the last admin.")),Error("Der letzte Admin kann nicht entfernt werden. Bitte ernenne zuerst einen neuen Admin.");case 6:return e.next=7,(0,i.updateDoc)(a,{adminIds:(0,i.arrayRemove)(n),updatedAt:(0,i.serverTimestamp)()});case 7:console.log("[tournamentService] Admin status for user ".concat(n," successfully removed in tournament ").concat(r,".")),e.next=10;break;case 8:if(e.prev=8,h=e.catch(1),console.error("[tournamentService] Error removing admin rights for user ".concat(n," from tournament ").concat(r,":"),h),!(h instanceof Error&&(h.message.includes("letzte Admin")||h.message.includes("Turnier nicht gefunden")||h.message.includes("Gr\xfcnder")||h.message.includes("abgeschlossenen oder archivierten")))){e.next=9;break}throw h;case 9:throw Error("Admin-Status konnte nicht entfernt werden.");case 10:case"end":return e.stop()}},e,null,[[1,8]])}));return function(r,n){return e.apply(this,arguments)}}(),N=function(){var e=S(y().mark(function e(r,n){var a,s,u,c,l,h,d,f,p,m;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tournamentService] User ".concat(n," attempting to leave tournament instance ").concat(r)),a=(0,i.doc)(o.db,"tournaments",r),e.prev=1,e.next=2,(0,i.getDoc)(a);case 2:if((h=e.sent).exists()){e.next=3;break}throw Error("Turnier nicht gefunden.");case 3:if("active"===(d=h.data()).status){e.next=4;break}throw console.warn("[tournamentService] Cannot leave a tournament that is not active (status: ".concat(d.status,"). Instance: ").concat(r,".")),Error("Du kannst nur aus einem laufenden Turnier austreten.");case 4:if(null!=(s=d.participantUids)&&s.includes(n)){e.next=5;break}return console.warn("[tournamentService] User ".concat(n," is not a participant of tournament ").concat(r,". Cannot leave.")),e.abrupt("return");case 5:if(f=(null==(u=d.participantUids)?void 0:u.length)===1&&d.participantUids[0]===n,!(null!=(c=d.adminIds)&&c.includes(n)&&!f)){e.next=6;break}throw Error("Der letzte Admin kann das Turnier nicht verlassen, wenn noch andere Teilnehmer vorhanden sind. Bitte ernennen Sie zuerst einen neuen Admin.");case 6:return p={participantUids:(0,i.arrayRemove)(n)},null!=(l=d.adminIds)&&l.includes(n)&&!f&&(p.adminIds=(0,i.arrayRemove)(n)),p.updatedAt=(0,i.serverTimestamp)(),e.next=7,(0,i.updateDoc)(a,p);case 7:console.log("[tournamentService] User ".concat(n," successfully left tournament ").concat(r," (removed from participants).")),e.next=10;break;case 8:if(e.prev=8,m=e.catch(1),console.error("[tournamentService] Error allowing user ".concat(n," to leave tournament ").concat(r,":"),m),!(m instanceof Error&&(m.message.includes("laufenden Turnier")||m.message.includes("Turnier nicht gefunden")))){e.next=9;break}throw m;case 9:throw Error("Austreten aus dem Turnier fehlgeschlagen.");case 10:case"end":return e.stop()}},e,null,[[1,8]])}));return function(r,n){return e.apply(this,arguments)}}(),L=function(){var e=S(y().mark(function e(r){var n,i,o,s;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,I(r);case 1:if(!(!(n=e.sent)||!n.participantUids||0===n.participantUids.length)){e.next=2;break}return console.log("[tournamentService] No participants found or tournament ".concat(r," not found.")),e.abrupt("return",[]);case 2:return i=n.participantUids,console.log("[tournamentService] Found ".concat(i.length," participant UIDs for tournament ").concat(r,":"),i),e.next=3,(0,a.getPublicPlayerProfilesByUserIds)(i);case 3:return(o=e.sent).sort(function(e,r){return(e.displayName||"").localeCompare(r.displayName||"")}),console.log("[tournamentService] Fetched ".concat(o.length," detailed participant profiles for tournament ").concat(r,".")),e.abrupt("return",o);case 4:return e.prev=4,s=e.catch(0),console.error("[tournamentService] Error fetching participants for tournament ".concat(r,":"),s),e.abrupt("return",[]);case 5:case"end":return e.stop()}},e,null,[[0,4]])}));return function(r){return e.apply(this,arguments)}}(),D=function(){var e=S(y().mark(function e(r,n,a,s){var u,c,l,p,m,v,b,w,S,x,E,I,T,k,_,A,P,O,C,N,L,D,R,j,F,U,M,G,V,B,z,q,H,$;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,i.getFirestore)(o.firebaseApp),c=(0,i.doc)(u,"tournaments",r),e.prev=1,e.next=2,(0,i.getDoc)(c);case 2:if((T=e.sent).exists()){e.next=3;break}throw Error("Tournament instance ".concat(r," not found."));case 3:if(k=T.data(),_=a.filter(function(e){return 1===e.playerNumber||3===e.playerNumber}).map(function(e){return e.playerNumber}),A=a.filter(function(e){return 2===e.playerNumber||4===e.playerNumber}).map(function(e){return e.playerNumber}),2===_.length&&2===A.length){e.next=4;break}throw Error("Ung\xfcltige Spielerzuweisung zu Teams. Es m\xfcssen 2 Spieler pro Team sein.");case 4:return P={1:(null==(l=a.find(function(e){return 1===e.playerNumber}))?void 0:l.name)||"Spieler 1",2:(null==(p=a.find(function(e){return 2===e.playerNumber}))?void 0:p.name)||"Spieler 2",3:(null==(m=a.find(function(e){return 3===e.playerNumber}))?void 0:m.name)||"Spieler 3",4:(null==(v=a.find(function(e){return 4===e.playerNumber}))?void 0:v.name)||"Spieler 4"},O=a.map(function(e){return e.uid}),C={1:a.find(function(e){return 1===e.playerNumber})?{type:"member",uid:a.find(function(e){return 1===e.playerNumber}).uid,name:a.find(function(e){return 1===e.playerNumber}).name}:null,2:a.find(function(e){return 2===e.playerNumber})?{type:"member",uid:a.find(function(e){return 2===e.playerNumber}).uid,name:a.find(function(e){return 2===e.playerNumber}).name}:null,3:a.find(function(e){return 3===e.playerNumber})?{type:"member",uid:a.find(function(e){return 3===e.playerNumber}).uid,name:a.find(function(e){return 3===e.playerNumber}).name}:null,4:a.find(function(e){return 4===e.playerNumber})?{type:"member",uid:a.find(function(e){return 4===e.playerNumber}).uid,name:a.find(function(e){return 4===e.playerNumber}).name}:null},N=null!=(b=null==(w=k.settings)?void 0:w.scoreSettings)?b:h.$d,L=null!=(S=null==(x=k.settings)?void 0:x.strokeSettings)?S:d.zh,D=null!=(E=null==(I=k.settings)?void 0:I.farbeSettings)?E:f.FT,R=Number(s),j={groupId:k.groupId,sessionId:r,tournamentInstanceId:r,status:"live",participantUids:O,playerNames:P,gamePlayers:C,teams:{top:A,bottom:_},scores:{top:0,bottom:0},striche:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},weisPoints:{top:0,bottom:0},currentRound:1,currentGameNumber:n,startingPlayer:R,initialStartingPlayer:R,currentPlayer:R,isRoundCompleted:!1,isGameCompleted:!1,activeScoreSettings:N,activeStrokeSettings:L,activeFarbeSettings:D},F=(0,i.collection)(u,"activeGames"),e.prev=5,e.next=6,(0,i.addDoc)(F,j);case 6:return M=e.sent,e.next=7,(0,i.updateDoc)(M,{activeGameId:M.id,createdAt:(0,i.serverTimestamp)(),lastUpdated:(0,i.serverTimestamp)(),gameStartTime:(0,i.serverTimestamp)(),jassStartTime:(0,i.serverTimestamp)()});case 7:return G=(0,i.doc)(u,"sessions",r),V={gruppeId:k.groupId,startedAt:null!=(U=k.createdAt)?U:(0,i.serverTimestamp)(),playerNames:P,participantUids:k.participantUids,status:"active",isTournamentSession:!0,currentActiveGameId:M.id,tournamentInstanceId:r,lastActivity:(0,i.serverTimestamp)()},e.prev=8,e.next=9,(0,i.setDoc)(G,V,{merge:!0});case 9:e.next=11;break;case 10:e.prev=10,H=e.catch(8),console.error("[tournamentService] Error creating/updating session document ".concat(r,":"),H);case 11:return B=(0,i.doc)(u,"tournaments",r),e.prev=12,e.next=13,(0,i.updateDoc)(B,{currentActiveGameId:M.id,updatedAt:(0,i.serverTimestamp)(),lastActivity:(0,i.serverTimestamp)()});case 13:e.next=15;break;case 14:e.prev=14,$=e.catch(12),console.error("[tournamentService] Error updating tournament document ".concat(r," with active game ID:"),$);case 15:return e.prev=15,e.next=16,(0,i.getDoc)(M);case 16:if(!(z=e.sent).exists()){e.next=17;break}return q=g({activeGameId:z.id},z.data()),e.abrupt("return",q);case 17:return console.error("[tournamentService ERROR] Failed to fetch newly created passe document."),e.abrupt("return",null);case 18:e.next=20;break;case 19:return e.prev=19,console.error("[tournamentService ERROR] Error fetching newly created passe:",e.catch(15)),e.abrupt("return",null);case 20:e.next=22;break;case 21:return e.prev=21,console.error("[tournamentService ERROR] Error in inner try-block of startTournamentPasseService:",e.catch(5)),e.abrupt("return",null);case 22:e.next=24;break;case 23:return e.prev=23,console.error("[tournamentService ERROR] Error in outer try-block of startTournamentPasseService:",e.catch(1)),e.abrupt("return",null);case 24:case"end":return e.stop()}},e,null,[[1,23],[5,21],[8,10],[12,14],[15,19]])}));return function(r,n,i,o){return e.apply(this,arguments)}}(),R=function(){var e=S(y().mark(function e(r,n){var a,s,u,c,l,h,d,f;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Fetching active passe for user ".concat(n," in instance ").concat(r)),a=(0,i.query)((0,i.collection)(o.db,"activeGames"),(0,i.where)("tournamentInstanceId","==",r),(0,i.where)("participantUids","array-contains",n),(0,i.where)("status","==","live"),(0,i.limit)(1)),e.next=1,(0,i.getDocs)(a);case 1:if(!(s=e.sent).empty){e.next=2;break}return e.abrupt("return",null);case 2:for(l=0,c=(u=s.docs[0]).data(),h=["groupId","sessionId","currentGameNumber","participantUids","status","playerNames","teams","scores","striche","weisPoints","currentPlayer","currentRound","startingPlayer","initialStartingPlayer","createdAt","lastUpdated"];l<h.length;l++)void 0===c[d=h[l]]&&console.error("[tournamentService] Fetched active game ".concat(u.id," is missing required field: ").concat(d,". Data:"),c);return f={activeGameId:u.id,groupId:c.groupId,sessionId:c.sessionId,tournamentInstanceId:c.tournamentInstanceId,currentGameNumber:c.currentGameNumber||0,participantUids:c.participantUids||[],status:c.status||"aborted",playerNames:c.playerNames||{1:"",2:"",3:"",4:""},teams:c.teams||{top:[],bottom:[]},scores:c.scores||{top:0,bottom:0},striche:c.striche||{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},weisPoints:c.weisPoints||{top:0,bottom:0},currentPlayer:c.currentPlayer,currentRound:c.currentRound||1,startingPlayer:c.startingPlayer,initialStartingPlayer:c.initialStartingPlayer,currentJassPoints:c.currentJassPoints,isRoundCompleted:c.isRoundCompleted,gamePlayers:c.gamePlayers,gameStartTime:c.gameStartTime,jassStartTime:c.jassStartTime,createdAt:c.createdAt||i.Timestamp.now(),lastUpdated:c.lastUpdated||i.Timestamp.now()},e.abrupt("return",f);case 3:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),j=function(){var e=S(y().mark(function e(r,n){var a,s,u;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("[tournamentService] completeTournamentPasse (ID: ".concat(r,") called. \n                 Implementation requires a Cloud Function with Transaction.")),console.log("[tournamentService] Final Passe Data:",n),a=(0,i.doc)(o.db,"tournaments",n.tournamentInstanceId),e.prev=1,s=(0,i.doc)(o.db,"activeGames",r),e.next=2,(0,i.updateDoc)(s,g(g({},n),{},{status:"completed",completedAt:(0,i.serverTimestamp)()}));case 2:return e.next=3,(0,i.updateDoc)(a,{completedPasseCount:(0,i.increment)(1),updatedAt:(0,i.serverTimestamp)()});case 3:console.log("[tournamentService] Passe ".concat(r," completed and tournament ").concat(n.tournamentInstanceId," updated.")),e.next=5;break;case 4:throw e.prev=4,u=e.catch(1),console.error("[tournamentService] Error completing tournament passe ".concat(r,":"),u),Error("Completion logic should be server-side.");case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r,n){return e.apply(this,arguments)}}(),F=function(){var e=S(y().mark(function e(r){var n,a,s,u,c;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,i.collection)(o.db,"tournaments",r,"games"),a=(0,i.query)(n,(0,i.orderBy)("passeNumber","asc")),e.next=1,(0,i.getDocs)(a);case 1:return s=e.sent,u=[],s.forEach(function(e){u.push(g({passeId:e.id},e.data()))}),console.log("[tournamentService] Fetched ".concat(u.length," completed games/passen for tournament ").concat(r,".")),e.abrupt("return",u);case 2:throw e.prev=2,c=e.catch(0),console.error("[tournamentService] Error fetching completed games for tournament ".concat(r,":"),c),Error("Abgeschlossene Turnierspiele konnten nicht geladen werden.");case 3:case"end":return e.stop()}},e,null,[[0,2]])}));return function(r){return e.apply(this,arguments)}}(),U=function(){var e=S(y().mark(function e(r,n){var a,s,u,c,l;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=(0,i.collection)(o.db,"tournaments",r,"games",n,"rounds"),s=(0,i.query)(a,(0,i.orderBy)("roundState.roundNumber","asc")),e.next=1,(0,i.getDocs)(s);case 1:return u=e.sent,c=[],u.forEach(function(e){var r=g({roundId:e.id},e.data());c.push(r)}),console.log("[tournamentService] Fetched ".concat(c.length," rounds for passe ").concat(n," in tournament ").concat(r,".")),e.abrupt("return",c);case 2:throw e.prev=2,l=e.catch(0),console.error("[tournamentService] Error fetching rounds for passe ".concat(n," in tournament ").concat(r,":"),l),Error("Runden f\xfcr Passe ".concat(n," konnten nicht geladen werden."));case 3:case"end":return e.stop()}},e,null,[[0,2]])}));return function(r,n){return e.apply(this,arguments)}}(),M=function(){var e=S(y().mark(function e(r,n){var a;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Updating active passe ".concat(r),n),a=(0,i.doc)(o.db,"activeGames",r),e.next=1,(0,i.updateDoc)(a,g(g({},n),{},{lastUpdated:(0,i.serverTimestamp)()}));case 1:case"end":return e.stop()}},e)}));return function(r,n){return e.apply(this,arguments)}}(),G=function(){var e=S(y().mark(function e(r,n){var a,s,u,c,l,h;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(c in console.log("Updating settings for tournament instance ".concat(r,":"),n),a=(0,i.doc)(o.db,"tournaments",r),e.prev=1,s={updatedAt:(0,i.serverTimestamp)()},n.hasOwnProperty("logoUrl")&&(s.logoUrl=n.logoUrl),u={},n)n.hasOwnProperty(c)&&"logoUrl"!==c&&(l=c,u["settings.".concat(l)]=n[l]);if(Object.keys(u).length>0&&Object.assign(s,u),!(Object.keys(s).length>1)){e.next=3;break}return e.next=2,(0,i.updateDoc)(a,s);case 2:console.log("[tournamentService] Successfully updated settings for tournament ".concat(r," with data:"),s),e.next=4;break;case 3:console.log("[tournamentService] No specific settings (besides logo or updatedAt) to update for tournament ".concat(r,".")),s.updatedAt&&1===Object.keys(s).length&&console.log("[tournamentService] Only updatedAt was present, no other settings changed.");case 4:e.next=6;break;case 5:throw e.prev=5,h=e.catch(1),console.error("[tournamentService] Error updating settings for tournament ".concat(r,":"),h),Error("Turniereinstellungen konnten nicht aktualisiert werden.");case 6:case"end":return e.stop()}},e,null,[[1,5]])}));return function(r,n){return e.apply(this,arguments)}}(),V=function(){var e=S(y().mark(function e(r,n,i){var a,u,c,h,d,f,p,m,g,v,b;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=1;break}throw Error("Keine Datei f\xfcr den Upload ausgew\xe4hlt.");case 1:if(r){e.next=2;break}throw Error("Keine Turnier-ID f\xfcr den Logo-Upload angegeben.");case 2:if(i){e.next=3;break}throw Error("Keine User-ID f\xfcr den Logo-Upload angegeben.");case 3:return a=(0,l.c7)(o.firebaseApp),u=n.name.split(".").pop()||"jpg",c="logo.".concat(u),h="tournamentLogos/".concat(i,"/").concat(r,"/").concat(c),d=(0,l.KR)(a,h),e.prev=4,console.log("[tournamentService] Komprimiere Turnierlogo: ".concat(n.size," bytes")),e.next=5,(0,s.w)(n,512,.85);case 5:return(f=e.sent)||console.warn("[tournamentService] Bildkomprimierung fehlgeschlagen, verwende Original"),p=f||n,console.log("[tournamentService] Upload-Dateigr\xf6\xdfe: ".concat(p.size," bytes (").concat((p.size/n.size*100).toFixed(1),"% des Originals)")),console.log("[tournamentService] Uploading tournament logo to: ".concat(h)),e.next=6,(0,l.D)(d,p);case 6:return m=e.sent,e.next=7,(0,l.qk)(m.ref);case 7:return console.log("[tournamentService] Tournament logo uploaded successfully. Download URL:",g=e.sent),e.abrupt("return",g);case 8:if(e.prev=8,console.error("[tournamentService] Error uploading tournament logo:",b=e.catch(4)),!(b instanceof Error&&"code"in b)){e.next=10;break}if("storage/unauthorized"!==(v=b).code){e.next=9;break}throw Error("Fehlende Berechtigung f\xfcr den Logo-Upload. \xdcberpr\xfcfe die Storage-Regeln.");case 9:if("storage/canceled"!==v.code){e.next=10;break}throw Error("Logo-Upload wurde abgebrochen.");case 10:throw Error("Turnierlogo konnte nicht hochgeladen werden.");case 11:case"end":return e.stop()}},e,null,[[4,8]])}));return function(r,n,i){return e.apply(this,arguments)}}(),B=function(){var e=S(y().mark(function e(r){var n,a,s,u,c,l;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[tournamentService] fetchTournamentsForUser called without userId."),e.abrupt("return",[]);case 1:return e.prev=1,n=(0,i.collection)(o.db,"tournaments"),a=(0,i.query)(n,(0,i.where)("participantUids","array-contains",r)),e.next=2,(0,i.getDocs)(a);case 2:return s=e.sent,u=[],s.forEach(function(e){u.push(g({id:e.id},e.data()))}),e.abrupt("return",u);case 3:if(e.prev=3,l=e.catch(1),console.error("[tournamentService] Error fetching tournaments for user ".concat(r,":"),l),!(l&&"object"===p(l)&&"code"in l)||"permission-denied"!==(c=l).code&&"not-found"!==c.code&&"failed-precondition"!==c.code){e.next=4;break}return console.log("[tournamentService] Normal state: No tournaments accessible for user ".concat(r," (").concat(c.code,")")),e.abrupt("return",[]);case 4:throw Error("Turniere f\xfcr den Benutzer konnten nicht geladen werden.");case 5:case"end":return e.stop()}},e,null,[[1,3]])}));return function(r){return e.apply(this,arguments)}}(),z=function(){var e=S(y().mark(function e(r){var n,i,a,s,u;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}throw Error("Tournament ID is required to generate an invite token.");case 1:return e.prev=1,i=(0,c.Uz)(o.firebaseApp,"europe-west1"),a=(0,c.Qg)(i,"generateTournamentInviteToken"),console.log("[tournamentService] Calling cloud function 'generateTournamentInviteToken' for tournament: ".concat(r)),e.next=2,a({tournamentId:r});case 2:if(s=null==(n=e.sent.data)?void 0:n.token){e.next=3;break}throw Error("No token received from cloud function.");case 3:return console.log("[tournamentService] Received invite token for tournament ".concat(r)),e.abrupt("return",s);case 4:throw e.prev=4,console.error("[tournamentService] Error calling 'generateTournamentInviteToken' cloud function:",u=e.catch(1)),Error(u instanceof Error?u.message:"Failed to generate tournament invite token.");case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r){return e.apply(this,arguments)}}(),q=function(){var e=S(y().mark(function e(r){var n,i,a,s,u;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return e.abrupt("return",{success:!1,message:"Kein Token angegeben."});case 1:return e.prev=1,n=(0,c.Uz)(o.firebaseApp,"europe-west1"),i=(0,c.Qg)(n,"acceptTournamentInviteFunction"),console.log("[tournamentService] Calling cloud function 'acceptTournamentInviteFunction' with token."),e.next=2,i({token:r});case 2:if(!(!(a=e.sent.data)||"boolean"!=typeof a.success)){e.next=3;break}return console.error("[tournamentService] Invalid response from 'acceptTournamentInviteFunction'",a),e.abrupt("return",{success:!1,message:"Ung\xfcltige Antwort vom Server."});case 3:return a.success?console.log("[tournamentService] Successfully redeemed invite token for tournament: ".concat(a.tournamentId)):console.warn("[tournamentService] Failed to redeem invite token: ".concat(a.message)),e.abrupt("return",a);case 4:return e.prev=4,console.error("[tournamentService] Error calling 'acceptTournamentInviteFunction' cloud function:",u=e.catch(1)),s=u instanceof Error?u.message:"Beitritt zum Turnier fehlgeschlagen.",e.abrupt("return",{success:!1,message:s});case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r){return e.apply(this,arguments)}}(),H=function(){var e=S(y().mark(function e(r,n){var a,s,c,l,m,g,b,w,S,x,E,I,T,k,_,A,P,O,C,N,L,D,R,j,F,U,M,G,V,B,z,q,H,$,K,W;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,i.getFirestore)(o.firebaseApp),s=(0,i.doc)(a,"activeGames",r),c=(0,i.doc)(a,"tournaments",n),l=(0,i.doc)(a,"tournaments",n,"games",r),m=(0,i.collection)(a,"activeGames",r,"rounds"),e.prev=1,e.next=2,(0,i.getDoc)(s);case 2:if((x=e.sent).exists()){e.next=3;break}throw console.error("[tournamentService] Active passe document ".concat(r," not found.")),Error("Aktive Passe nicht gefunden.");case 3:return E=x.data(),I=(0,i.query)(m,(0,i.orderBy)("roundId")),e.next=4,(0,i.getDocs)(I);case 4:T=e.sent.docs.map(function(e){return e.data()}),k=E.currentGameNumber,_=n,A=[],O=null!=(g=null==(P=v(T).reverse().find(u.Aw))?void 0:P.weisPoints)?g:{top:0,bottom:0},C=0,N=[1,2,3,4];case 5:if(!(C<N.length)){e.next=9;break}if(R=N[C],j=null==(L=E.gamePlayers)?void 0:L[R]){e.next=6;break}return console.warn("[tournamentService] Missing gamePlayer entry for seat ".concat(R," in activeGame ").concat(r)),e.abrupt("continue",8);case 6:if("member"===j.type){e.next=7;break}return console.warn("[tournamentService] Skipping player at seat ".concat(R," because they are not a 'member' type.")),e.abrupt("continue",8);case 7:F=j.uid,U=j.name,M=E.teams.top.includes(R)?"top":"bottom",G=E.scores[M],V=E.striche[M],B=null!=(D=O[M])?D:0,A.push({playerId:F,playerName:U,seat:R,team:M,scoreInPasse:G,stricheInPasse:V,weisInPasse:B});case 8:C++,e.next=5;break;case 9:return z=A.map(function(e){return e.playerId}),q=void 0,H=void 0,E.createdAt&&E.createdAt instanceof i.Timestamp?(H=E.createdAt,q=i.Timestamp.now().toMillis()-E.createdAt.toMillis()):"object"===p(E.createdAt)&&E.createdAt&&(H=(0,i.serverTimestamp)()),$="number"==typeof q?q:0,K={passeId:r,tournamentInstanceId:_,passeNumber:k,completedAt:(0,i.serverTimestamp)(),startedAt:H,durationMillis:$,startingPlayer:E.initialStartingPlayer,participantUidsForPasse:z,playerDetails:A,teamScoresPasse:E.scores,teamStrichePasse:E.striche,activeScoreSettings:null!=(b=E.activeScoreSettings)?b:h.$d,activeStrokeSettings:null!=(w=E.activeStrokeSettings)?w:d.zh,activeFarbeSettings:null!=(S=E.activeFarbeSettings)?S:f.FT,roundHistory:T},e.next=10,(0,i.setDoc)(l,K);case 10:return e.next=11,(0,i.updateDoc)(s,{status:"completed",completedAt:(0,i.serverTimestamp)()});case 11:return e.next=12,(0,i.updateDoc)(c,{completedPasseCount:(0,i.increment)(1),currentActiveGameId:null,updatedAt:(0,i.serverTimestamp)(),lastActivity:(0,i.serverTimestamp)()});case 12:return e.abrupt("return",!0);case 13:return e.prev=13,W=e.catch(1),console.error("[tournamentService] Error completing and recording passe ".concat(r,":"),W),e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,null,[[1,13]])}));return function(r,n){return e.apply(this,arguments)}}(),$=function(){var e=S(y().mark(function e(r){var n,a;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tournamentService] Marking tournament instance ".concat(r," as completed.")),n=(0,i.doc)(o.db,"tournaments",r),e.prev=1,e.next=2,(0,i.updateDoc)(n,{status:"completed",completedAt:(0,i.serverTimestamp)(),updatedAt:(0,i.serverTimestamp)()});case 2:console.log("[tournamentService] Tournament instance ".concat(r," successfully marked as completed.")),e.next=4;break;case 3:throw e.prev=3,a=e.catch(1),console.error("[tournamentService] Error marking tournament ".concat(r," as completed:"),a),Error("Turnier konnte nicht als abgeschlossen markiert werden.");case 4:case"end":return e.stop()}},e,null,[[1,3]])}));return function(r){return e.apply(this,arguments)}}(),K=function(){var e=S(y().mark(function e(r,n){var a,s,u;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}throw Error("Eine Turnier-Instanz-ID ist erforderlich.");case 1:if(!(!n||void 0===n.name&&void 0===n.description)){e.next=2;break}throw Error("Keine Details zum Aktualisieren \xfcbergeben (Name oder Beschreibung erforderlich).");case 2:if(a=(0,i.doc)(o.db,"tournaments",r),s={updatedAt:(0,i.serverTimestamp)()},void 0===n.name){e.next=4;break}if(!("string"!=typeof n.name||n.name.trim().length<3)){e.next=3;break}throw Error("Turniername muss mindestens 3 Zeichen lang sein.");case 3:s.name=n.name.trim();case 4:return void 0!==n.description&&(s.description="string"==typeof n.description?n.description.trim():""),e.prev=5,e.next=6,(0,i.updateDoc)(a,s);case 6:console.log("[TournamentService] Basinformationen f\xfcr Turnier ".concat(r," erfolgreich aktualisiert.")),e.next=8;break;case 7:throw e.prev=7,u=e.catch(5),console.error("[TournamentService] Fehler beim Aktualisieren der Basinformationen f\xfcr Turnier ".concat(r,":"),u),u;case 8:case"end":return e.stop()}},e,null,[[5,7]])}));return function(r,n){return e.apply(this,arguments)}}(),W=function(){var e=S(y().mark(function e(r){var n,a,s;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tournamentService] Activating tournament instance ".concat(r,".")),n=(0,i.doc)(o.db,"tournaments",r),e.prev=1,e.next=2,(0,i.getDoc)(n);case 2:if(!((a=e.sent).exists()&&"upcoming"!==a.data().status)){e.next=3;break}throw Error("Turnier kann nur aktiviert werden, wenn es den Status 'anstehend' hat.");case 3:return e.next=4,(0,i.updateDoc)(n,{status:"active",updatedAt:(0,i.serverTimestamp)()});case 4:console.log("[tournamentService] Tournament instance ".concat(r," successfully activated.")),e.next=6;break;case 5:throw e.prev=5,s=e.catch(1),console.error("[tournamentService] Error activating tournament ".concat(r,":"),s),Error(s instanceof Error?s.message:"Turnier konnte nicht aktiviert werden.");case 6:case"end":return e.stop()}},e,null,[[1,5]])}));return function(r){return e.apply(this,arguments)}}(),Q=function(){var e=S(y().mark(function e(r){var n,a,s,u,c,l,h,d,f,p,m,g,v,b;return y().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[tournamentService] clearActivePasseInTournament called without instanceId."),e.abrupt("return");case 1:return console.log("[tournamentService] Clearing currentActiveGameId for tournament instance ".concat(r)),n=(0,i.doc)(o.db,"tournaments",r),e.prev=2,e.next=3,(0,i.getDoc)(n);case 3:if((a=e.sent).exists()){e.next=4;break}throw Error("Turnier ".concat(r," nicht gefunden."));case 4:return s=a.data().currentActiveGameId,u=[],c=!1,s?(console.log("[tournamentService] Found active passe ".concat(s," in tournament document")),u.push(s)):console.log("[tournamentService] No active passe found in tournament document, searching all active passes for tournament ".concat(r)),l=(0,i.query)((0,i.collection)(o.db,"activeGames"),(0,i.where)("tournamentInstanceId","==",r),(0,i.where)("status","==","live")),e.next=5,(0,i.getDocs)(l);case 5:(h=e.sent).empty?0===u.length&&console.log("[tournamentService] No active passes found for tournament ".concat(r," through any method")):(console.log("[tournamentService] Found ".concat(h.size," active passes in tournament ").concat(r," from direct query")),h.forEach(function(e){var r=e.id;u.includes(r)||(console.log("[tournamentService] Adding passe ".concat(r," to abort list from query results")),u.push(r))})),d=0,f=u;case 6:if(!(d<f.length)){e.next=14;break}return p=f[d],e.prev=7,console.log("[tournamentService] Setting status to 'aborted' for passe ".concat(p)),m=(0,i.doc)(o.db,"activeGames",p),e.next=8,(0,i.getDoc)(m);case 8:if((g=e.sent).exists()){e.next=9;break}return console.warn("[tournamentService] Active game document ".concat(p," not found, skipping abort.")),e.abrupt("continue",13);case 9:if("aborted"!==g.data().status){e.next=10;break}return console.log("[tournamentService] Passe ".concat(p," is already in 'aborted' state, skipping.")),e.abrupt("continue",13);case 10:return e.next=11,(0,i.updateDoc)(m,{status:"aborted",completedAt:(0,i.serverTimestamp)()});case 11:console.log("[tournamentService] Successfully set status to 'aborted' for passe ".concat(p)),c=!0,e.next=13;break;case 12:e.prev=12,v=e.catch(7),console.error("[tournamentService] Error aborting passe ".concat(p,":"),v);case 13:d++,e.next=6;break;case 14:return console.log("[tournamentService] Resetting currentActiveGameId to null in tournament document ".concat(r)),e.next=15,(0,i.updateDoc)(n,{currentActiveGameId:null,updatedAt:(0,i.serverTimestamp)(),lastActivity:(0,i.serverTimestamp)()});case 15:console.log("[tournamentService] Successfully cleared currentActiveGameId for tournament ".concat(r,".")),c?console.log("[tournamentService] Successfully aborted ".concat(u.length," active passes and reset currentActiveGameId in tournament ").concat(r,".")):console.log("[tournamentService] Reset currentActiveGameId in tournament ".concat(r,", but no active passes were found or needed to be aborted.")),e.next=17;break;case 16:throw e.prev=16,b=e.catch(2),console.error("[tournamentService] Error clearing active passe in tournament ".concat(r,":"),b),Error("Die aktive Passe im Turnier konnte serverseitig nicht korrekt bereinigt werden.");case 17:case"end":return e.stop()}},e,null,[[2,16],[7,12]])}));return function(r){return e.apply(this,arguments)}}()},93786:(e,r,n)=>{"use strict";n.d(r,{HF:()=>e4,F0:()=>tk,eJ:()=>td,Wm:()=>tm,xI:()=>rD,hg:()=>tw,gA:()=>tg,J1:()=>th,oM:()=>tb,x9:()=>tf,df:()=>t5,CI:()=>tS,r7:()=>tv});var i=n(96796),o=n(51139),a=n(36525),s=n(4902),u=n(88308);function c(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let l=new o.FA("auth","Firebase",c()),h=new a.Vy("@firebase/auth");function d(e,...r){h.logLevel<=a.$b.ERROR&&h.error(`Auth (${i.MF}): ${e}`,...r)}function f(e,...r){throw y(e,...r)}function p(e,...r){return y(e,...r)}function m(e,r,n){let i=Object.assign(Object.assign({},c()),{[r]:n});return new o.FA("auth","Firebase",i).create(r,{appName:e.name})}function g(e){return m(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y(e,...r){if("string"!=typeof e){let n=r[0],i=[...r.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return l.create(e,...r)}function v(e,r,...n){if(!e)throw y(r,...n)}function b(e){let r="INTERNAL ASSERTION FAILED: "+e;throw d(r),Error(r)}function w(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.href)||""}function S(){return"http:"===x()||"https:"===x()}function x(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.protocol)||null}class E{constructor(e,r){var n;this.shortDelay=e,this.longDelay=r,n="Short delay should be less than long delay!",r>e||b(n),this.isMobile=(0,o.jZ)()||(0,o.lV)()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(S()||(0,o.sr)()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function I(e,r){var n,i;n=e.emulator,i="Emulator should always be set here",n||b(i);let{url:o}=e.emulator;return r?`${o}${r.startsWith("/")?r.slice(1):r}`:o}class T{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void b("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void b("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void b("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let k={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},_=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],A=new E(3e4,6e4);function P(e,r){return e.tenantId&&!r.tenantId?Object.assign(Object.assign({},r),{tenantId:e.tenantId}):r}async function O(e,r,n,i,a={}){return C(e,a,async()=>{let a={},s={};i&&("GET"===r?s=i:a={body:JSON.stringify(i)});let u=(0,o.Am)(Object.assign({key:e.config.apiKey},s)).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);let l=Object.assign({method:r,headers:c},a);return(0,o.c1)()||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,o.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),T.fetch()(await L(e,e.config.apiHost,n,u),l)})}async function C(e,r,n){e._canInitEmulator=!1;let i=Object.assign(Object.assign({},k),r);try{let r=new D(e),o=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();let a=await o.json();if("needConfirmation"in a)throw R(e,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let[r,n]=(o.ok?a.errorMessage:a.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===r)throw R(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===r)throw R(e,"email-already-in-use",a);if("USER_DISABLED"===r)throw R(e,"user-disabled",a);let s=i[r]||r.toLowerCase().replace(/[_\s]+/g,"-");if(n)throw m(e,s,n);f(e,s)}}catch(r){if(r instanceof o.g)throw r;f(e,"network-request-failed",{message:String(r)})}}async function N(e,r,n,i,o={}){let a=await O(e,r,n,i,o);return"mfaPendingCredential"in a&&f(e,"multi-factor-auth-required",{_serverResponse:a}),a}async function L(e,r,n,i){let o=`${r}${n}?${i}`,a=e.config.emulator?I(e.config,o):`${e.config.apiScheme}://${o}`;return _.includes(n)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())?e._getPersistence()._getFinalTarget(a).toString():a}class D{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(p(this.auth,"network-request-failed")),A.get())})}}function R(e,r,n){let i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);let o=p(e,r,i);return o.customData._tokenResponse=n,o}function j(e){return void 0!==e&&void 0!==e.enterprise}class F{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)switch(r.enforcementState){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function U(e,r){return O(e,"GET","/v2/recaptchaConfig",P(e,r))}async function M(e,r){return O(e,"POST","/v1/accounts:delete",r)}async function G(e,r){return O(e,"POST","/v1/accounts:lookup",r)}function V(e){if(e)try{let r=new Date(Number(e));if(!isNaN(r.getTime()))return r.toUTCString()}catch(e){}}async function B(e,r=!1){let n=(0,o.Ku)(e),i=await n.getIdToken(r),a=q(i);v(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");let s="object"==typeof a.firebase?a.firebase:void 0,u=null==s?void 0:s.sign_in_provider;return{claims:a,token:i,authTime:V(z(a.auth_time)),issuedAtTime:V(z(a.iat)),expirationTime:V(z(a.exp)),signInProvider:u||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}function z(e){return 1e3*Number(e)}function q(e){let[r,n,i]=e.split(".");if(void 0===r||void 0===n||void 0===i)return d("JWT malformed, contained fewer than 3 sections"),null;try{let e=(0,o.u)(n);if(!e)return d("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return d("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function H(e){let r=q(e);return v(r,"internal-error"),v(void 0!==r.exp,"internal-error"),v(void 0!==r.iat,"internal-error"),Number(r.exp)-Number(r.iat)}async function $(e,r,n=!1){if(n)return r;try{return await r}catch(r){throw r instanceof o.g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}class K{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var r;if(!e)return this.errorBackoff=3e4,Math.max(0,(null!=(r=this.user.stsTokenManager.expirationTime)?r:0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(null==e?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class W{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=V(this.lastLoginAt),this.creationTime=V(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Q(e){var r,n,i;let o=e.auth,a=await e.getIdToken(),s=await $(e,G(o,{idToken:a}));v(null==s?void 0:s.users.length,o,"internal-error");let u=s.users[0];e._notifyReloadListener(u);let c=(null==(r=u.providerUserInfo)?void 0:r.length)?Y(u.providerUserInfo):[],l=(n=e.providerData,i=c,[...n.filter(e=>!i.some(r=>r.providerId===e.providerId)),...i]),h=e.isAnonymous,d=!(e.email&&u.passwordHash)&&!(null==l?void 0:l.length);Object.assign(e,{uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:l,metadata:new W(u.createdAt,u.lastLoginAt),isAnonymous:!!h&&d})}async function J(e){let r=(0,o.Ku)(e);await Q(r),await r.auth._persistUserIfCurrent(r),r.auth._notifyListenersIfCurrent(r)}function Y(e){return e.map(e=>{var{providerId:r}=e,n=(0,s.Tt)(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}async function X(e,r){let n=await C(e,{},async()=>{let n=(0,o.Am)({grant_type:"refresh_token",refresh_token:r}).slice(1),{tokenApiHost:i,apiKey:a}=e.config,s=await L(e,i,"/v1/token",`key=${a}`),u=await e._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:u,body:n};return e.emulatorConfig&&(0,o.zJ)(e.emulatorConfig.host)&&(c.credentials="include"),T.fetch()(s,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Z(e,r){return O(e,"POST","/v2/accounts:revokeToken",P(e,r))}class ee{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){v(e.idToken,"internal-error"),v(void 0!==e.idToken,"internal-error"),v(void 0!==e.refreshToken,"internal-error");let r="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):H(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){v(0!==e.length,"internal-error");let r=H(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return r||!this.accessToken||this.isExpired?(v(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){let{accessToken:n,refreshToken:i,expiresIn:o}=await X(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,r){let{refreshToken:n,accessToken:i,expirationTime:o}=r,a=new ee;return n&&(v("string"==typeof n,"internal-error",{appName:e}),a.refreshToken=n),i&&(v("string"==typeof i,"internal-error",{appName:e}),a.accessToken=i),o&&(v("number"==typeof o,"internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ee,this.toJSON())}_performRefresh(){return b("not implemented")}}function et(e,r){v("string"==typeof e||void 0===e,"internal-error",{appName:r})}class er{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,o=(0,s.Tt)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new K(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new W(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){let r=await $(this,this.stsTokenManager.getToken(this.auth,e));return v(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return B(this,e)}reload(){return J(this)}_assign(e){this!==e&&(v(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let r=new er(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){v(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Q(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,i.xZ)(this.auth.app))return Promise.reject(g(this.auth));let e=await this.getIdToken();return await $(this,M(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,o,a,s,u,c,l;let h=null!=(n=r.displayName)?n:void 0,d=null!=(i=r.email)?i:void 0,f=null!=(o=r.phoneNumber)?o:void 0,p=null!=(a=r.photoURL)?a:void 0,m=null!=(s=r.tenantId)?s:void 0,g=null!=(u=r._redirectEventId)?u:void 0,y=null!=(c=r.createdAt)?c:void 0,b=null!=(l=r.lastLoginAt)?l:void 0,{uid:w,emailVerified:S,isAnonymous:x,providerData:E,stsTokenManager:I}=r;v(w&&I,e,"internal-error");let T=ee.fromJSON(this.name,I);v("string"==typeof w,e,"internal-error"),et(h,e.name),et(d,e.name),v("boolean"==typeof S,e,"internal-error"),v("boolean"==typeof x,e,"internal-error"),et(f,e.name),et(p,e.name),et(m,e.name),et(g,e.name),et(y,e.name),et(b,e.name);let k=new er({uid:w,auth:e,email:d,emailVerified:S,displayName:h,isAnonymous:x,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:T,createdAt:y,lastLoginAt:b});return E&&Array.isArray(E)&&(k.providerData=E.map(e=>Object.assign({},e))),g&&(k._redirectEventId=g),k}static async _fromIdTokenResponse(e,r,n=!1){let i=new ee;i.updateFromServerResponse(r);let o=new er({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Q(o),o}static async _fromGetAccountInfoResponse(e,r,n){let i=r.users[0];v(void 0!==i.localId,"internal-error");let o=void 0!==i.providerUserInfo?Y(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(null==o?void 0:o.length),s=new ee;s.updateFromIdToken(n);let u=new er({uid:i.localId,auth:e,stsTokenManager:s,isAnonymous:a});return Object.assign(u,{uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new W(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(null==o?void 0:o.length)}),u}}let en=new Map;function ei(e){var r,n;r="Expected a class definition",e instanceof Function||b(r);let i=en.get(e);return i?(n="Instance stored in cache mismatched with class",i instanceof e||b(n)):(i=new e,en.set(e,i)),i}class eo{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){let r=this.storage[e];return void 0===r?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}function ea(e,r,n){return`firebase:${e}:${r}:${n}`}eo.type="NONE";class es{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;let{config:i,name:o}=this.auth;this.fullUserKey=ea(this.userKey,i.apiKey,o),this.fullPersistenceKey=ea("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let r=await G(this.auth,{idToken:e}).catch(()=>void 0);return r?er._fromGetAccountInfoResponse(this.auth,r,e):null}return er._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new es(ei(eo),e,n);let i=(await Promise.all(r.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),o=i[0]||ei(eo),a=ea(n,e.config.apiKey,e.name),s=null;for(let n of r)try{let r=await n._get(a);if(r){let i;if("string"==typeof r){let n=await G(e,{idToken:r}).catch(()=>void 0);if(!n)break;i=await er._fromGetAccountInfoResponse(e,n,r)}else i=er._fromJSON(e,r);n!==o&&(s=i),o=n;break}}catch(e){}let u=i.filter(e=>e._shouldAllowMigration);return o._shouldAllowMigration&&u.length&&(o=u[0],s&&await o._set(a,s.toJSON()),await Promise.all(r.map(async e=>{if(e!==o)try{await e._remove(a)}catch(e){}}))),new es(o,e,n)}}function eu(e){let r=e.toLowerCase();if(r.includes("opera/")||r.includes("opr/")||r.includes("opios/"))return"Opera";{if(ed(r))return"IEMobile";if(r.includes("msie")||r.includes("trident/"))return"IE";if(r.includes("edge/"))return"Edge";if(ec(r))return"Firefox";if(r.includes("silk/"))return"Silk";if(ep(r))return"Blackberry";if(em(r))return"Webos";if(el(r))return"Safari";if((r.includes("chrome/")||eh(r))&&!r.includes("edge/"))return"Chrome";if(ef(r))return"Android";let n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if((null==n?void 0:n.length)===2)return n[1]}return"Other"}function ec(e=(0,o.ZQ)()){return/firefox\//i.test(e)}function el(e=(0,o.ZQ)()){let r=e.toLowerCase();return r.includes("safari/")&&!r.includes("chrome/")&&!r.includes("crios/")&&!r.includes("android")}function eh(e=(0,o.ZQ)()){return/crios\//i.test(e)}function ed(e=(0,o.ZQ)()){return/iemobile/i.test(e)}function ef(e=(0,o.ZQ)()){return/android/i.test(e)}function ep(e=(0,o.ZQ)()){return/blackberry/i.test(e)}function em(e=(0,o.ZQ)()){return/webos/i.test(e)}function eg(e=(0,o.ZQ)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ey(e=(0,o.ZQ)()){return eg(e)||ef(e)||em(e)||ep(e)||/windows phone/i.test(e)||ed(e)}function ev(e,r=[]){let n;switch(e){case"Browser":n=eu((0,o.ZQ)());break;case"Worker":n=`${eu((0,o.ZQ)())}-${e}`;break;default:n=e}let a=r.length?r.join(","):"FirebaseCore-web";return`${n}/JsCore/${i.MF}/${a}`}class eb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){let n=r=>new Promise((n,i)=>{try{let i=e(r);n(i)}catch(e){i(e)}});n.onAbort=r,this.queue.push(n);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let r=[];try{for(let n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(e){for(let e of(r.reverse(),r))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}async function ew(e,r={}){return O(e,"GET","/v2/passwordPolicy",P(e,r))}class eS{constructor(e){var r,n,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(r=a.minPasswordLength)?r:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(i=null==(n=e.allowedNonAlphanumericCharacters)?void 0:n.join(""))?i:"",this.forceUpgradeOnSignin=null!=(o=e.forceUpgradeOnSignin)&&o,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,o,a,s;let u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=null==(r=u.meetsMinPasswordLength)||r),u.isValid&&(u.isValid=null==(n=u.meetsMaxPasswordLength)||n),u.isValid&&(u.isValid=null==(i=u.containsLowercaseLetter)||i),u.isValid&&(u.isValid=null==(o=u.containsUppercaseLetter)||o),u.isValid&&(u.isValid=null==(a=u.containsNumericCharacter)||a),u.isValid&&(u.isValid=null==(s=u.containsNonAlphanumericCharacter)||s),u}validatePasswordLengthOptions(e,r){let n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){let n;this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class ex{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eI(this),this.idTokenSubscription=new eI(this),this.beforeStateQueue=new eb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=l,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ei(r)),this._initializationPromise=this.queue(async()=>{var n,i,o;if(!this._deleted){if(this.persistenceManager=await es.create(this,e),null==(n=this._resolvePersistenceManagerAvailable)||n.call(this),!this._deleted){if(null==(i=this._popupRedirectResolver)?void 0:i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(r),this.lastNotifiedUid=(null==(o=this.currentUser)?void 0:o.uid)||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let r=await G(this,{idToken:e}),n=await er._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if((0,i.xZ)(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(r=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(r,r))}):this.directlySetCurrentUser(null)}let n=await this.assertedPersistence.getCurrentUser(),o=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let n=null==(r=this.redirectUser)?void 0:r._redirectEventId,i=null==o?void 0:o._redirectEventId,s=await this.tryRedirectSignIn(e);(!n||n===i)&&(null==s?void 0:s.user)&&(o=s.user,a=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(o)}catch(e){o=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return(v(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId)?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Q(e)}catch(e){if((null==e?void 0:e.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,i.xZ)(this.app))return Promise.reject(g(this));let r=e?(0,o.Ku)(e):null;return r&&v(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&v(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,i.xZ)(this.app)?Promise.reject(g(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,i.xZ)(this.app)?Promise.reject(g(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ei(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new eS(await ew(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new o.FA("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{let n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){let r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(r.tenantId=this.tenantId),await Z(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(e=this._currentUser)?void 0:e.toJSON()}}async _setRedirectUser(e,r){let n=await this.getOrInitRedirectPersistenceManager(r);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let r=e&&ei(e)||this._popupRedirectResolver;v(r,this,"argument-error"),this.redirectPersistenceManager=await es.create(this,[ei(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return(this._isInitialized&&await this.queue(async()=>{}),(null==(r=this._currentUser)?void 0:r._redirectEventId)===e)?this._currentUser:(null==(n=this.redirectUser)?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let n=null!=(r=null==(e=this.currentUser)?void 0:e.uid)?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};let o="function"==typeof r?r:r.next.bind(r),a=!1,s=this._isInitialized?Promise.resolve():this._initializationPromise;if(v(s,this,"internal-error"),s.then(()=>{a||o(this.currentUser)}),"function"==typeof r){let o=e.addObserver(r,n,i);return()=>{a=!0,o()}}{let n=e.addObserver(r);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return v(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ev(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);let n=await (null==(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);let i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;if((0,i.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let r=await (null==(e=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:e.getToken());return(null==r?void 0:r.error)&&function(e,...r){h.logLevel<=a.$b.WARN&&h.warn(`Auth (${i.MF}): ${e}`,...r)}(`Error while retrieving App Check token: ${r.error}`),null==r?void 0:r.token}}function eE(e){return(0,o.Ku)(e)}class eI{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,o.tD)(e=>this.observer=e)}get next(){return v(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let eT={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ek(e){return`__${e}${Math.floor(1e6*Math.random())}`}class e_{constructor(){this.enterprise=new eA}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class eA{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}let eP="NO_RECAPTCHA";class eO{constructor(e){this.type="recaptcha-enterprise",this.auth=eE(e)}async verify(e="verify",r=!1){async function n(e){if(!r){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(r,n)=>{U(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(i=>{if(void 0===i.recaptchaKey)n(Error("recaptcha Enterprise site key undefined"));else{let n=new F(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,r(n.siteKey)}}).catch(e=>{n(e)})})}function i(r,n,i){let o=window.grecaptcha;j(o)?o.enterprise.ready(()=>{o.enterprise.execute(r,{action:e}).then(e=>{n(e)}).catch(()=>{n(eP)})}):i(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new e_().execute("siteKey",{action:"verify"}):new Promise((e,o)=>{n(this.auth).then(n=>{if(!r&&j(window.grecaptcha))i(n,e,o);else{var a;if("undefined"==typeof window)return void o(Error("RecaptchaVerifier is only supported in browser"));let r=eT.recaptchaEnterpriseScript;0!==r.length&&(r+=n),(a=r,eT.loadJS(a)).then(()=>{i(n,e,o)}).catch(e=>{o(e)})}}).catch(e=>{o(e)})})}}async function eC(e,r,n,i=!1,o=!1){let a,s=new eO(e);if(o)a=eP;else try{a=await s.verify(n)}catch(e){a=await s.verify(n,!0)}let u=Object.assign({},r);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in u){let e=u.phoneEnrollmentInfo.phoneNumber,r=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){let e=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return i?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function eN(e,r,n,i,o){var a,s;if("EMAIL_PASSWORD_PROVIDER"===o)if(null==(a=e._getRecaptchaConfig())||!a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return i(e,r).catch(async o=>{if("auth/missing-recaptcha-token"!==o.code)return Promise.reject(o);{console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=await eC(e,r,n,"getOobCode"===n);return i(e,o)}});else{let o=await eC(e,r,n,"getOobCode"===n);return i(e,o)}if("PHONE_PROVIDER"!==o)return Promise.reject(o+" provider is not supported.");if(null==(s=e._getRecaptchaConfig())?void 0:s.isProviderEnabled("PHONE_PROVIDER")){let o=await eC(e,r,n);return i(e,o).catch(async o=>{var a;if((null==(a=e._getRecaptchaConfig())?void 0:a.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&("auth/missing-recaptcha-token"===o.code||"auth/invalid-app-credential"===o.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);let o=await eC(e,r,n,!1,!0);return i(e,o)}return Promise.reject(o)})}{let o=await eC(e,r,n,!1,!0);return i(e,o)}}async function eL(e){let r=eE(e),n=new F(await U(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}));null==r.tenantId?r._agentRecaptchaConfig=n:r._tenantRecaptchaConfigs[r.tenantId]=n,n.isAnyProviderEnabled()&&new eO(r).verify()}function eD(e){let r=e.indexOf(":");return r<0?"":e.substr(0,r+1)}function eR(e){if(!e)return null;let r=Number(e);return isNaN(r)?null:r}class ej{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return b("not implemented")}_getIdTokenResponse(e){return b("not implemented")}_linkToIdToken(e,r){return b("not implemented")}_getReauthenticationResolver(e){return b("not implemented")}}async function eF(e,r){return O(e,"POST","/v1/accounts:signUp",r)}async function eU(e,r){return N(e,"POST","/v1/accounts:signInWithPassword",P(e,r))}async function eM(e,r){return O(e,"POST","/v1/accounts:sendOobCode",P(e,r))}async function eG(e,r){return eM(e,r)}async function eV(e,r){return eM(e,r)}async function eB(e,r){return N(e,"POST","/v1/accounts:signInWithEmailLink",P(e,r))}async function ez(e,r){return N(e,"POST","/v1/accounts:signInWithEmailLink",P(e,r))}class eq extends ej{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new eq(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new eq(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let r="string"==typeof e?JSON.parse(e):e;if((null==r?void 0:r.email)&&(null==r?void 0:r.password)){if("password"===r.signInMethod)return this._fromEmailAndPassword(r.email,r.password);else if("emailLink"===r.signInMethod)return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return eN(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",eU,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return eB(e,{email:this._email,oobCode:this._password});default:f(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":return eN(e,{idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eF,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return ez(e,{idToken:r,email:this._email,oobCode:this._password});default:f(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function eH(e,r){return N(e,"POST","/v1/accounts:signInWithIdp",P(e,r))}class e$ extends ej{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let r=new e$(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):f("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let r="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,o=(0,s.Tt)(r,["providerId","signInMethod"]);if(!n||!i)return null;let a=new e$(n,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){return eH(e,this.buildRequest())}_linkToIdToken(e,r){let n=this.buildRequest();return n.idToken=r,eH(e,n)}_getReauthenticationResolver(e){let r=this.buildRequest();return r.autoCreate=!1,eH(e,r)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=(0,o.Am)(r)}return e}}async function eK(e,r){return O(e,"POST","/v1/accounts:sendVerificationCode",P(e,r))}async function eW(e,r){return N(e,"POST","/v1/accounts:signInWithPhoneNumber",P(e,r))}async function eQ(e,r){let n=await N(e,"POST","/v1/accounts:signInWithPhoneNumber",P(e,r));if(n.temporaryProof)throw R(e,"account-exists-with-different-credential",n);return n}let eJ={USER_NOT_FOUND:"user-not-found"};async function eY(e,r){return N(e,"POST","/v1/accounts:signInWithPhoneNumber",P(e,Object.assign(Object.assign({},r),{operation:"REAUTH"})),eJ)}class eX extends ej{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,r){return new eX({verificationId:e,verificationCode:r})}static _fromTokenResponse(e,r){return new eX({phoneNumber:e,temporaryProof:r})}_getIdTokenResponse(e){return eW(e,this._makeVerificationRequest())}_linkToIdToken(e,r){return eQ(e,Object.assign({idToken:r},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return eY(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:r,verificationId:n,verificationCode:i}=this.params;return e&&r?{temporaryProof:e,phoneNumber:r}:{sessionInfo:n,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:r,verificationCode:n,phoneNumber:i,temporaryProof:o}=e;return n||r||i||o?new eX({verificationId:r,verificationCode:n,phoneNumber:i,temporaryProof:o}):null}}class eZ{constructor(e){var r,n,i,a,s,u;let c=(0,o.I9)((0,o.hp)(e)),l=null!=(r=c.apiKey)?r:null,h=null!=(n=c.oobCode)?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!=(i=c.mode)?i:null);v(l&&h&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=h,this.continueUrl=null!=(a=c.continueUrl)?a:null,this.languageCode=null!=(s=c.lang)?s:null,this.tenantId=null!=(u=c.tenantId)?u:null}static parseLink(e){let r=function(e){let r=(0,o.I9)((0,o.hp)(e)).link,n=r?(0,o.I9)((0,o.hp)(r)).deep_link_id:null,i=(0,o.I9)((0,o.hp)(e)).deep_link_id;return(i?(0,o.I9)((0,o.hp)(i)).link:null)||i||n||r||e}(e);try{return new eZ(r)}catch(e){return null}}}class e0{constructor(){this.providerId=e0.PROVIDER_ID}static credential(e,r){return eq._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){let n=eZ.parseLink(r);return v(n,"argument-error"),eq._fromEmailAndCode(e,n.code,n.tenantId)}}e0.PROVIDER_ID="password",e0.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e0.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class e1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class e2 extends e1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class e3 extends e2{constructor(){super("facebook.com")}static credential(e){return e$._fromParams({providerId:e3.PROVIDER_ID,signInMethod:e3.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return e3.credentialFromTaggedObject(e)}static credentialFromError(e){return e3.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return e3.credential(e.oauthAccessToken)}catch(e){return null}}}e3.FACEBOOK_SIGN_IN_METHOD="facebook.com",e3.PROVIDER_ID="facebook.com";class e4 extends e2{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return e$._fromParams({providerId:e4.PROVIDER_ID,signInMethod:e4.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return e4.credentialFromTaggedObject(e)}static credentialFromError(e){return e4.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return e4.credential(r,n)}catch(e){return null}}}e4.GOOGLE_SIGN_IN_METHOD="google.com",e4.PROVIDER_ID="google.com";class e5 extends e2{constructor(){super("github.com")}static credential(e){return e$._fromParams({providerId:e5.PROVIDER_ID,signInMethod:e5.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return e5.credentialFromTaggedObject(e)}static credentialFromError(e){return e5.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return e5.credential(e.oauthAccessToken)}catch(e){return null}}}e5.GITHUB_SIGN_IN_METHOD="github.com",e5.PROVIDER_ID="github.com";class e6 extends e2{constructor(){super("twitter.com")}static credential(e,r){return e$._fromParams({providerId:e6.PROVIDER_ID,signInMethod:e6.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return e6.credentialFromTaggedObject(e)}static credentialFromError(e){return e6.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return e6.credential(r,n)}catch(e){return null}}}async function e8(e,r){return N(e,"POST","/v1/accounts:signUp",P(e,r))}e6.TWITTER_SIGN_IN_METHOD="twitter.com",e6.PROVIDER_ID="twitter.com";class e7{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){return new e7({user:await er._fromIdTokenResponse(e,n,i),providerId:e9(n),_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){return await e._updateTokensIfNecessary(n,!0),new e7({user:e,providerId:e9(n),_tokenResponse:n,operationType:r})}}function e9(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class te extends o.g{constructor(e,r,n,i){var o;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,te.prototype),this.customData={appName:e.name,tenantId:null!=(o=e.tenantId)?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new te(e,r,n,i)}}function tt(e,r,n,i){return("reauthenticate"===r?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw te._fromErrorAndOperation(e,n,r,i);throw n})}async function tr(e,r,n=!1){let i=await $(e,r._linkToIdToken(e.auth,await e.getIdToken()),n);return e7._forOperation(e,"link",i)}async function tn(e,r,n=!1){let{auth:o}=e;if((0,i.xZ)(o.app))return Promise.reject(g(o));let a="reauthenticate";try{let i=await $(e,tt(o,a,r,e),n);v(i.idToken,o,"internal-error");let s=q(i.idToken);v(s,o,"internal-error");let{sub:u}=s;return v(e.uid===u,o,"user-mismatch"),e7._forOperation(e,a,i)}catch(e){throw(null==e?void 0:e.code)==="auth/user-not-found"&&f(o,"user-mismatch"),e}}async function ti(e,r,n=!1){if((0,i.xZ)(e.app))return Promise.reject(g(e));let o="signIn",a=await tt(e,o,r),s=await e7._fromIdTokenResponse(e,o,a);return n||await e._updateCurrentUser(s.user),s}async function to(e,r){return ti(eE(e),r)}class ta{constructor(e,r){this.factorId=e,this.uid=r.mfaEnrollmentId,this.enrollmentTime=new Date(r.enrolledAt).toUTCString(),this.displayName=r.displayName}static _fromServerResponse(e,r){return"phoneInfo"in r?ts._fromServerResponse(e,r):"totpInfo"in r?tu._fromServerResponse(e,r):f(e,"internal-error")}}class ts extends ta{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,r){return new ts(r)}}class tu extends ta{constructor(e){super("totp",e)}static _fromServerResponse(e,r){return new tu(r)}}function tc(e,r,n){var i;v((null==(i=n.url)?void 0:i.length)>0,e,"invalid-continue-uri"),v(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),v(void 0===n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),r.continueUrl=n.url,r.dynamicLinkDomain=n.dynamicLinkDomain,r.linkDomain=n.linkDomain,r.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(v(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),r.iOSBundleId=n.iOS.bundleId),n.android&&(v(n.android.packageName.length>0,e,"missing-android-pkg-name"),r.androidInstallApp=n.android.installApp,r.androidMinimumVersionCode=n.android.minimumVersion,r.androidPackageName=n.android.packageName)}async function tl(e){let r=eE(e);r._getPasswordPolicyInternal()&&await r._updatePasswordPolicy()}async function th(e,r,n){let i=eE(e),o={requestType:"PASSWORD_RESET",email:r,clientType:"CLIENT_TYPE_WEB"};n&&tc(i,o,n),await eN(i,o,"getOobCode",eV,"EMAIL_PASSWORD_PROVIDER")}async function td(e,r,n){if((0,i.xZ)(e.app))return Promise.reject(g(e));let o=eE(e),a=eN(o,{returnSecureToken:!0,email:r,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",e8,"EMAIL_PASSWORD_PROVIDER"),s=await a.catch(r=>{throw"auth/password-does-not-meet-requirements"===r.code&&tl(e),r}),u=await e7._fromIdTokenResponse(o,"signIn",s);return await o._updateCurrentUser(u.user),u}function tf(e,r,n){return(0,i.xZ)(e.app)?Promise.reject(g(e)):to((0,o.Ku)(e),e0.credential(r,n)).catch(async r=>{throw"auth/password-does-not-meet-requirements"===r.code&&tl(e),r})}async function tp(e,r){return O(e,"POST","/v1/accounts:createAuthUri",P(e,r))}async function tm(e,r){let n=S()?w():"http://localhost",{signinMethods:i}=await tp((0,o.Ku)(e),{identifier:r,continueUri:n});return i||[]}async function tg(e,r){let n=(0,o.Ku)(e),i={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};r&&tc(n.auth,i,r);let{email:a}=await eG(n.auth,i);a!==e.email&&await e.reload()}async function ty(e,r){return O(e,"POST","/v1/accounts:update",r)}async function tv(e,{displayName:r,photoURL:n}){if(void 0===r&&void 0===n)return;let i=(0,o.Ku)(e),a=await i.getIdToken(),s=await $(i,ty(i.auth,{idToken:a,displayName:r,photoUrl:n,returnSecureToken:!0}));i.displayName=s.displayName||null,i.photoURL=s.photoUrl||null;let u=i.providerData.find(({providerId:e})=>"password"===e);u&&(u.displayName=i.displayName,u.photoURL=i.photoURL),await i._updateTokensIfNecessary(s)}function tb(e,r){return(0,o.Ku)(e).setPersistence(r)}function tw(e,r,n,i){return(0,o.Ku)(e).onAuthStateChanged(r,n,i)}function tS(e){return(0,o.Ku)(e).signOut()}function tx(e,r){return O(e,"POST","/v2/accounts/mfaEnrollment:start",P(e,r))}new WeakMap;let tE="__sak";class tI{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(tE,"1"),this.storage.removeItem(tE),Promise.resolve(!0)}catch(e){return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){let r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class tT extends tI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ey(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let r of Object.keys(this.listeners)){let n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((e,r,n)=>{this.notifyListeners(e,n)});let n=e.key;r?this.detachListener():this.stopPolling();let i=()=>{let e=this.storage.getItem(n);(r||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);(0,o.lT)()&&10===document.documentMode&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,r){this.localCache[e]=r;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(r?JSON.parse(r):r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){let r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}tT.type="LOCAL";let tk=tT;function t_(e){var r,n;let i=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),o=RegExp(`${i}=([^;]+)`);return null!=(n=null==(r=document.cookie.match(o))?void 0:r[1])?n:null}function tA(e){let r="http:"===window.location.protocol;return`${r?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class tP{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){let r=new URL(`${window.location.origin}/__cookies__`);return r.searchParams.set("finalTarget",e),r}async _isAvailable(){var e;return("boolean"!=typeof isSecureContext||!!isSecureContext)&&"undefined"!=typeof navigator&&"undefined"!=typeof document&&(null==(e=navigator.cookieEnabled)||e)}async _set(e,r){}async _get(e){if(!this._isAvailable())return null;let r=tA(e);if(window.cookieStore){let e=await window.cookieStore.get(r);return null==e?void 0:e.value}return t_(r)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;let r=tA(e);document.cookie=`${r}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>void 0)}_addListener(e,r){if(!this._isAvailable())return;let n=tA(e);if(window.cookieStore){let e=e=>{let i=e.changed.find(e=>e.name===n);i&&r(i.value),e.deleted.find(e=>e.name===n)&&r(null)};return this.listenerUnsubscribes.set(r,()=>window.cookieStore.removeEventListener("change",e)),window.cookieStore.addEventListener("change",e)}let i=t_(n),o=setInterval(()=>{let e=t_(n);e!==i&&(r(e),i=e)},1e3);this.listenerUnsubscribes.set(r,()=>clearInterval(o))}_removeListener(e,r){let n=this.listenerUnsubscribes.get(r);n&&(n(),this.listenerUnsubscribes.delete(r))}}tP.type="COOKIE";class tO extends tI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}tO.type="SESSION";class tC{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let r=this.receivers.find(r=>r.isListeningto(e));if(r)return r;let n=new tC(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:r,eventType:n,data:i}=e.data,o=this.handlersMap[n];if(!(null==o?void 0:o.size))return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:n});let a=Array.from(o).map(async r=>r(e.origin,i)),s=await Promise.all(a.map(async e=>{try{let r=await e;return{fulfilled:!0,value:r}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:r,eventType:n,response:s})}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),r&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function tN(e="",r=10){let n="";for(let e=0;e<r;e++)n+=Math.floor(10*Math.random());return e+n}tC.receivers=[];class tL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){let i,o,a="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!a)throw Error("connection_unavailable");return new Promise((s,u)=>{let c=tN("",20);a.port1.start();let l=setTimeout(()=>{u(Error("unsupported_event"))},n);o={messageChannel:a,onMessage(e){if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),i=setTimeout(()=>{u(Error("timeout"))},3e3);break;case"done":clearTimeout(i),s(e.data.response);break;default:clearTimeout(l),clearTimeout(i),u(Error("invalid_response"))}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function tD(){return window}function tR(){return void 0!==tD().WorkerGlobalScope&&"function"==typeof tD().importScripts}async function tj(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}let tF="firebaseLocalStorageDb",tU="firebaseLocalStorage",tM="fbase_key";class tG{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function tV(e,r){return e.transaction([tU],r?"readwrite":"readonly").objectStore(tU)}function tB(){let e=indexedDB.open(tF,1);return new Promise((r,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{let r=e.result;try{r.createObjectStore(tU,{keyPath:tM})}catch(e){n(e)}}),e.addEventListener("success",async()=>{let n=e.result;n.objectStoreNames.contains(tU)?r(n):(n.close(),await new tG(indexedDB.deleteDatabase(tF)).toPromise(),r(await tB()))})})}async function tz(e,r,n){return new tG(tV(e,!0).put({[tM]:r,value:n})).toPromise()}async function tq(e,r){let n=tV(e,!1).get(r),i=await new tG(n).toPromise();return void 0===i?null:i.value}function tH(e,r){return new tG(tV(e,!0).delete(r)).toPromise()}class t${constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await tB()),this.db}async _withRetries(e){let r=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(e){if(r++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return tR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tC._getInstance(tR()?self:null),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await tj(),!this.activeServiceWorker)return;this.sender=new tL(this.activeServiceWorker);let n=await this.sender._send("ping",{},800);n&&(null==(e=n[0])?void 0:e.fulfilled)&&(null==(r=n[0])?void 0:r.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var r;if(this.sender&&this.activeServiceWorker&&((null==(r=null==navigator?void 0:navigator.serviceWorker)?void 0:r.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await tB();return await tz(e,tE,"1"),await tH(e,tE),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>tz(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){let r=await this._withRetries(r=>tq(r,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>tH(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>new tG(tV(e,!1).getAll()).toPromise());if(!e||0!==this.pendingWrites)return[];let r=[],n=new Set;if(0!==e.length)for(let{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(let e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),r.push(e));return r}notifyListeners(e,r){this.localCache[e]=r;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}function tK(e,r){return O(e,"POST","/v2/accounts/mfaSignIn:start",P(e,r))}t$.type="LOCAL",ek("rcb"),new E(3e4,6e4);let tW="recaptcha";async function tQ(e,r,n){var i;if(!e._getRecaptchaConfig())try{await eL(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let o;if(o="string"==typeof r?{phoneNumber:r}:r,"session"in o){let r=o.session;if("phoneNumber"in o){v("enroll"===r.type,e,"internal-error");let i={idToken:r.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},a=async(e,r)=>{if(r.phoneEnrollmentInfo.captchaResponse===eP){v((null==n?void 0:n.type)===tW,e,"argument-error");let i=await tJ(e,r,n);return tx(e,i)}return tx(e,r)},s=eN(e,i,"mfaSmsEnrollment",a,"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{v("signin"===r.type,e,"internal-error");let a=(null==(i=o.multiFactorHint)?void 0:i.uid)||o.multiFactorUid;v(a,e,"missing-multi-factor-info");let s={mfaPendingCredential:r.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},u=async(e,r)=>{if(r.phoneSignInInfo.captchaResponse===eP){v((null==n?void 0:n.type)===tW,e,"argument-error");let i=await tJ(e,r,n);return tK(e,i)}return tK(e,r)},c=eN(e,s,"mfaSmsSignIn",u,"PHONE_PROVIDER");return(await c.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{let r={phoneNumber:o.phoneNumber,clientType:"CLIENT_TYPE_WEB"},i=async(e,r)=>{if(r.captchaResponse===eP){v((null==n?void 0:n.type)===tW,e,"argument-error");let i=await tJ(e,r,n);return eK(e,i)}return eK(e,r)},a=eN(e,r,"sendVerificationCode",i,"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).sessionInfo}}finally{null==n||n._reset()}}async function tJ(e,r,n){v(n.type===tW,e,"argument-error");let i=await n.verify();v("string"==typeof i,e,"argument-error");let o=Object.assign({},r);if("phoneEnrollmentInfo"in o){let e=o.phoneEnrollmentInfo.phoneNumber,r=o.phoneEnrollmentInfo.captchaResponse,n=o.phoneEnrollmentInfo.clientType,a=o.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:i,captchaResponse:r,clientType:n,recaptchaVersion:a}}),o}if(!("phoneSignInInfo"in o))return Object.assign(o,{recaptchaToken:i}),o;{let e=o.phoneSignInInfo.captchaResponse,r=o.phoneSignInInfo.clientType,n=o.phoneSignInInfo.recaptchaVersion;return Object.assign(o,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:e,clientType:r,recaptchaVersion:n}}),o}}class tY{constructor(e){this.providerId=tY.PROVIDER_ID,this.auth=eE(e)}verifyPhoneNumber(e,r){return tQ(this.auth,e,(0,o.Ku)(r))}static credential(e,r){return eX._fromVerification(e,r)}static credentialFromResult(e){return tY.credentialFromTaggedObject(e)}static credentialFromError(e){return tY.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:r,temporaryProof:n}=e;return r&&n?eX._fromTokenResponse(r,n):null}}function tX(e,r){return r?ei(r):(v(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}tY.PROVIDER_ID="phone",tY.PHONE_SIGN_IN_METHOD="phone";class tZ extends ej{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eH(e,this._buildIdpRequest())}_linkToIdToken(e,r){return eH(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return eH(e,this._buildIdpRequest())}_buildIdpRequest(e){let r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function t0(e){return ti(e.auth,new tZ(e),e.bypassAuthState)}function t1(e){let{auth:r,user:n}=e;return v(n,r,"internal-error"),tn(n,new tZ(e),e.bypassAuthState)}async function t2(e){let{auth:r,user:n}=e;return v(n,r,"internal-error"),tr(n,new tZ(e),e.bypassAuthState)}class t3{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:a,type:s}=e;if(a)return void this.reject(a);let u={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(u))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return t0;case"linkViaPopup":case"linkViaRedirect":return t2;case"reauthViaPopup":case"reauthViaRedirect":return t1;default:f(this.auth,"internal-error")}}resolve(e){var r,n;r=this.pendingPromise,n="Pending promise was never set",r||b(n),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){var r,n;r=this.pendingPromise,n="Pending promise was never set",r||b(n),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}let t4=new E(2e3,1e4);async function t5(e,r,n){if((0,i.xZ)(e.app))return Promise.reject(p(e,"operation-not-supported-in-this-environment"));let o=eE(e);if(!(r instanceof e1))throw e1.name!==r.constructor.name&&f(e,"argument-error"),m(e,"argument-error",`Type of ${r.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`);let a=tX(o,n);return new t6(o,"signInViaPopup",r,a).executeNotNull()}class t6 extends t3{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,t6.currentPopupAction&&t6.currentPopupAction.cancel(),t6.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return v(e,this.auth,"internal-error"),e}async onExecution(){var e,r;e=1===this.filter.length,r="Popup operations only handle one event",e||b(r);let n=tN();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],n),this.authWindow.associatedEvent=n,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(p(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null==(e=this.authWindow)?void 0:e.associatedEvent)||null}cancel(){this.reject(p(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,t6.currentPopupAction=null}pollUserCancellation(){let e=()=>{var r,n;if(null==(n=null==(r=this.authWindow)?void 0:r.window)?void 0:n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(p(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t4.get())};e()}}t6.currentPopupAction=null;let t8=new Map;class t7 extends t3{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=t8.get(this.auth._key());if(!e){try{let r=await t9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(r){e=()=>Promise.reject(r)}t8.set(this.auth._key(),e)}return this.bypassAuthState||t8.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type)return void this.resolve(null);if(e.eventId){let r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function t9(e,r){var n;let i=ea("pendingRedirect",(n=r).config.apiKey,n.name),o=ei(e._redirectPersistence);if(!await o._isAvailable())return!1;let a=await o._get(i)==="true";return await o._remove(i),a}function re(e,r){t8.set(e._key(),r)}async function rt(e,r,n=!1){if((0,i.xZ)(e.app))return Promise.reject(g(e));let o=eE(e),a=tX(o,r),s=new t7(o,a,n),u=await s.execute();return u&&!n&&(delete u.user._redirectEventId,await o._persistUserIfCurrent(u.user),await o._setRedirectUser(null,r)),u}class rr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ri(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!ri(e)){let i=(null==(n=e.error.code)?void 0:n.split("auth/")[1])||"internal-error";r.onError(p(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){let n=null===r.eventId||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rn(e))}saveEventToCache(e){this.cachedEventUids.add(rn(e)),this.lastProcessedEventTime=Date.now()}}function rn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function ri({type:e,error:r}){return"unknown"===e&&(null==r?void 0:r.code)==="auth/no-auth-event"}async function ro(e,r={}){return O(e,"GET","/v1/projects",r)}let ra=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rs=/^https?/;async function ru(e){if(e.config.emulator)return;let{authorizedDomains:r}=await ro(e);for(let e of r)try{if(function(e){let r=w(),{protocol:n,hostname:i}=new URL(r);if(e.startsWith("chrome-extension://")){let o=new URL(e);return""===o.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===r.replace("chrome-extension://",""):"chrome-extension:"===n&&o.hostname===i}if(!rs.test(n))return!1;if(ra.test(e))return i===e;let o=e.replace(/\./g,"\\.");return RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}(e))return}catch(e){}f(e,"unauthorized-domain")}let rc=new E(3e4,6e4);function rl(){let e=tD().___jsl;if(null==e?void 0:e.H){for(let r of Object.keys(e.H))if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=[...e.H[r].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}let rh=null,rd=new E(5e3,15e3),rf={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rp=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function rm(e){let r=await (rh=rh||new Promise((r,n)=>{var i,o,a,s;function u(){rl(),gapi.load("gapi.iframes",{callback:()=>{r(gapi.iframes.getContext())},ontimeout:()=>{rl(),n(p(e,"network-request-failed"))},timeout:rc.get()})}if(null==(o=null==(i=tD().gapi)?void 0:i.iframes)?void 0:o.Iframe)r(gapi.iframes.getContext());else if(null==(a=tD().gapi)?void 0:a.load)u();else{let r=ek("iframefcb");return tD()[r]=()=>{gapi.load?u():n(p(e,"network-request-failed"))},(s=`${eT.gapiScript}?onload=${r}`,eT.loadJS(s)).catch(e=>n(e))}}).catch(e=>{throw rh=null,e})),n=tD().gapi;return v(n,e,"internal-error"),r.open({where:document.body,url:function(e){let r=e.config;v(r.authDomain,e,"auth-domain-config-required");let n=r.emulator?I(r,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,a={apiKey:r.apiKey,appName:e.name,v:i.MF},s=rp.get(e.config.apiHost);s&&(a.eid=s);let u=e._getFrameworks();return u.length&&(a.fw=u.join(",")),`${n}?${(0,o.Am)(a).slice(1)}`}(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rf,dontclear:!0},r=>new Promise(async(n,i)=>{await r.restyle({setHideOnLeave:!1});let o=p(e,"network-request-failed"),a=tD().setTimeout(()=>{i(o)},rd.get());function s(){tD().clearTimeout(a),n(r)}r.ping(s).then(s,()=>{i(o)})}))}let rg={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ry{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let rv=encodeURIComponent("fac");async function rb(e,r,n,a,s,u){v(e.config.authDomain,e,"auth-domain-config-required"),v(e.config.apiKey,e,"invalid-api-key");let c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:a,v:i.MF,eventId:s};if(r instanceof e1)for(let[n,i]of(r.setDefaultLanguage(e.languageCode),c.providerId=r.providerId||"",(0,o.Im)(r.getCustomParameters())||(c.customParameters=JSON.stringify(r.getCustomParameters())),Object.entries(u||{})))c[n]=i;if(r instanceof e2){let e=r.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}for(let r of(e.tenantId&&(c.tid=e.tenantId),Object.keys(c)))void 0===c[r]&&delete c[r];let l=await e._getAppCheckToken(),h=l?`#${rv}=${encodeURIComponent(l)}`:"";return`${function({config:e}){return e.emulator?I(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${(0,o.Am)(c).slice(1)}${h}`}let rw="webStorageSupport";class rS{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tO,this._completeRedirectFn=rt,this._overrideRedirectResult=re}async _openPopup(e,r,n,i){var a,s,u;s=null==(a=this.eventManagers[e._key()])?void 0:a.manager,u="_initialize() not called before _openPopup()",s||b(u);let c=await rb(e,r,n,w(),i);return function(e,r,n,i=500,a=600){let s=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString(),c="",l=Object.assign(Object.assign({},rg),{width:i.toString(),height:a.toString(),top:s,left:u}),h=(0,o.ZQ)().toLowerCase();n&&(c=eh(h)?"_blank":n),ec(h)&&(r=r||"http://localhost",l.scrollbars="yes");let d=Object.entries(l).reduce((e,[r,n])=>`${e}${r}=${n},`,"");if(function(e=(0,o.ZQ)()){var r;return eg(e)&&!!(null==(r=window.navigator)?void 0:r.standalone)}(h)&&"_self"!==c)return function(e,r){let n=document.createElement("a");n.href=e,n.target=r;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(r||"",c),new ry(null);let f=window.open(r||"",c,d);v(f,e,"popup-blocked");try{f.focus()}catch(e){}return new ry(f)}(e,c,tN())}async _openRedirect(e,r,n,i){var o;return await this._originValidation(e),o=await rb(e,r,n,w(),i),tD().location.href=o,new Promise(()=>{})}_initialize(e){let r=e._key();if(this.eventManagers[r]){var n;let{manager:e,promise:i}=this.eventManagers[r];return e?Promise.resolve(e):(n="If manager is not set, promise should be",i||b(n),i)}let i=this.initAndGetManager(e);return this.eventManagers[r]={promise:i},i.catch(()=>{delete this.eventManagers[r]}),i}async initAndGetManager(e){let r=await rm(e),n=new rr(e);return r.register("authEvent",r=>(v(null==r?void 0:r.authEvent,e,"invalid-auth-event"),{status:n.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(rw,{type:rw},n=>{var i;let o=null==(i=null==n?void 0:n[0])?void 0:i[rw];void 0!==o&&r(!!o),f(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=ru(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return ey()||el()||eg()}}class rx{constructor(e){this.factorId=e}_process(e,r,n){switch(r.type){case"enroll":return this._finalizeEnroll(e,r.credential,n);case"signin":return this._finalizeSignIn(e,r.credential);default:return b("unexpected MultiFactorSessionType")}}}class rE extends rx{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new rE(e)}_finalizeEnroll(e,r,n){return O(e,"POST","/v2/accounts/mfaEnrollment:finalize",P(e,{idToken:r,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}_finalizeSignIn(e,r){return O(e,"POST","/v2/accounts/mfaSignIn:finalize",P(e,{mfaPendingCredential:r,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}}class rI{constructor(){}static assertion(e){return rE._fromCredential(e)}}rI.FACTOR_ID="phone";class rT{static assertionForEnrollment(e,r){return rk._fromSecret(e,r)}static assertionForSignIn(e,r){return rk._fromEnrollmentId(e,r)}static async generateSecret(e){var r,n;v(void 0!==(null==(r=e.user)?void 0:r.auth),"internal-error");let i=await O(n=e.user.auth,"POST","/v2/accounts/mfaEnrollment:start",P(n,{idToken:e.credential,totpEnrollmentInfo:{}}));return r_._fromStartTotpMfaEnrollmentResponse(i,e.user.auth)}}rT.FACTOR_ID="totp";class rk extends rx{constructor(e,r,n){super("totp"),this.otp=e,this.enrollmentId=r,this.secret=n}static _fromSecret(e,r){return new rk(r,void 0,e)}static _fromEnrollmentId(e,r){return new rk(r,e)}async _finalizeEnroll(e,r,n){return v(void 0!==this.secret,e,"argument-error"),O(e,"POST","/v2/accounts/mfaEnrollment:finalize",P(e,{idToken:r,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}))}async _finalizeSignIn(e,r){v(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let n={verificationCode:this.otp};return O(e,"POST","/v2/accounts/mfaSignIn:finalize",P(e,{mfaPendingCredential:r,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n}))}}class r_{constructor(e,r,n,i,o,a,s){this.sessionInfo=a,this.auth=s,this.secretKey=e,this.hashingAlgorithm=r,this.codeLength=n,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=o}static _fromStartTotpMfaEnrollmentResponse(e,r){return new r_(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,r)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,r){var n;let i=!1;return(rA(e)||rA(r))&&(i=!0),i&&(rA(e)&&(e=(null==(n=this.auth.currentUser)?void 0:n.email)||"unknownuser"),rA(r)&&(r=this.auth.name)),`otpauth://totp/${r}:${e}?secret=${this.secretKey}&issuer=${r}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function rA(e){return void 0===e||(null==e?void 0:e.length)===0}var rP="@firebase/auth",rO="1.10.8";class rC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null==(e=this.auth.currentUser)?void 0:e.uid)||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let r=this.auth.onIdTokenChanged(r=>{e((null==r?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){v(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let rN=(0,o.XA)("authIdTokenMaxAge")||300,rL=null;function rD(e=(0,i.Sx)()){let r=(0,i.j6)(e,"auth");if(r.isInitialized())return r.getImmediate();let n=function(e,r){let n=(0,i.j6)(e,"auth");if(n.isInitialized()){let e=n.getImmediate(),i=n.getOptions();if((0,o.bD)(i,null!=r?r:{}))return e;f(e,"already-initialized")}return n.initialize({options:r})}(e,{popupRedirectResolver:rS,persistence:[t$,tk,tO]}),a=(0,o.XA)("authTokenSyncURL");if(a&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(a,location.origin);if(location.origin===e.origin){let r,i=(r=e.toString(),async e=>{let n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>rN)return;let o=null==n?void 0:n.token;rL!==o&&(rL=o,await fetch(r,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});(0,o.Ku)(n).beforeAuthStateChanged(i,()=>i(n.currentUser)),(0,o.Ku)(n).onIdTokenChanged(e=>i(e),void 0,void 0)}}let s=(0,o.Tj)("auth");return s&&function(e,r,n){let i=eE(e);v(/^https?:\/\//.test(r),i,"invalid-emulator-scheme");let a=eD(r),{host:s,port:u}=function(e){let r=eD(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(r.length));if(!n)return{host:"",port:null};let i=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){let e=o[1];return{host:e,port:eR(i.substr(e.length+1))}}{let[e,r]=i.split(":");return{host:e,port:eR(r)}}}(r),c=null===u?"":`:${u}`,l={url:`${a}//${s}${c}/`},h=Object.freeze({host:s,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!i._canInitEmulator){v(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),v((0,o.bD)(l,i.config.emulator)&&(0,o.bD)(h,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=l,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,(0,o.zJ)(s)?((0,o.gE)(`${a}//${s}${c}`),(0,o.P1)("Auth",!0)):function(){function e(){let e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}eT={loadJS:e=>new Promise((r,n)=>{let i=document.createElement("script");i.setAttribute("src",e),i.onload=r,i.onerror=e=>{let r=p("internal-error");r.customData=e,n(r)},i.type="text/javascript",i.charset="UTF-8",(function(){var e,r;return null!=(r=null==(e=document.getElementsByTagName("head"))?void 0:e[0])?r:document})().appendChild(i)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},function(e){(0,i.om)(new u.uA("auth",(r,{options:n})=>{let i=r.getProvider("app").getImmediate(),o=r.getProvider("heartbeat"),a=r.getProvider("app-check-internal"),{apiKey:s,authDomain:u}=i.options;v(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let c=new ex(i,o,a,{apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ev(e)}),l=(null==n?void 0:n.persistence)||[],h=(Array.isArray(l)?l:[l]).map(ei);return(null==n?void 0:n.errorMap)&&c._updateErrorMap(n.errorMap),c._initializeWithPersistence(h,null==n?void 0:n.popupRedirectResolver),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),(0,i.om)(new u.uA("auth-internal",e=>new rC(eE(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.KO)(rP,rO,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(e)),(0,i.KO)(rP,rO,"esm2017")}("Browser")},94566:(e,r,n)=>{"use strict";n.r(r),n.d(r,{OnboardingStep:()=>y,defaultStrichStyle:()=>S,useUIStore:()=>T});var i=n(8106),o=n(4319),a=n(38791),s=n(42471),u=n(85253),c=n(88112);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function d(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?h(Object(n),!0).forEach(function(r){f(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function f(e,r,n){var i;return(i=function(e,r){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=l(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(r,"string"),(r="symbol"==l(i)?i:i+"")in e)?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function p(){p=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function h(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{h({},"")}catch(e){h=function(e,r,n){return e[r]=n}}function d(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=m,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=f(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=f(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function f(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=d;var m="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};h(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){h(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=f(e[o],e,a);if("throw"!==c.type){var h=c.arg,d=h.value;return d&&"object"==l(d)&&i.call(d,"__await")?r.resolve(d.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(d).then(function(e){h.value=e,s(h)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(l(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=h(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,h(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),h(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(d(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),h(T,c,"Generator"),h(T,s,function(){return this}),h(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function m(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function g(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){m(a,i,o,s,u,"next",e)}function u(e){m(a,i,o,s,u,"throw",e)}s(void 0)})}}var y=function(e){return e.INSTALL="INSTALL",e.WELCOME="WELCOME",e.GROUP_CHOICE="GROUP_CHOICE",e.GROUP_CREATE="GROUP_CREATE",e.GROUP_JOIN="GROUP_JOIN",e.GAME_START="GAME_START",e.PROFILE="PROFILE",e.SETTINGS="SETTINGS",e.COMPLETE="COMPLETE",e}({}),v={farbe:"jass-farbe-settings",score:"jass-score-settings",pictogram:"jass-pictogram-settings",strokes:"jass-stroke-settings"},b=function(e,r){try{localStorage.setItem(v[e],JSON.stringify(r))}catch(e){}},w=function(){return{isActive:!1,pressStartTime:null,chargeAmount:0}},S={baseStrich:{length:20,width:1.5,color:"rgba(255, 255, 255, 0.9)",opacity:.9},diagonalStrich:{length:28,width:1.5,angle:45,offset:{x:-1,y:0}},container:{spacing:4,groupSpacing:8,scale:1}},x=u.FT,E={values:Object.fromEntries(a.C3.map(function(e){return[e.id,e.defaultValue]})),isFlipped:!1,enabled:Object.fromEntries(a.C3.map(function(e){return[e.id,!0]})),matschBonus:!0},I={calculator:{isOpen:!1,value:0,isFlipped:!1},startScreen:{transitionState:"initial",names:{1:"",2:"",3:"",4:""},isOpen:!0},history:{warning:null},chargeEffects:{berg:{top:w(),bottom:w()},bedanken:{top:w(),bottom:w()},matsch:{top:w(),bottom:w()}},menu:{isOpen:!1,activeButton:null,showIntroduction:!1,showResetWarning:!1,props:null},resultatKreidetafel:{isOpen:!1,swipePosition:null,currentStatistic:"striche",animationComplete:!0},settings:{isOpen:!1,activeTab:"farben",cardStyle:"DE",pictogramConfig:{isEnabled:!0,mode:"svg"}},farbeSettings:x,scoreSettings:E,strokeSettings:s.zh,isGameInfoOpen:!1,isHistoryWarningOpen:!1,historyWarningCallback:null,lastDoubleClickPosition:null,historyWarning:{show:!1,message:"",onConfirm:function(){},onCancel:function(){},type:"warning"},isPaused:!1,strichStyle:S,overlayPosition:null,jassFinishNotification:{isOpen:!1,mode:"share",message:void 0,onShare:function(){var e=g(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),onBack:function(){},onBackLabel:void 0,onContinue:function(){},onRegenerate:function(){var e=g(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},onboarding:{currentStep:y.INSTALL,hasCompletedOnboarding:!0,show:!1,canBeDismissed:!0,isPWA:!1},isTutorialInfoOpen:!1,splitContainer:{isOpen:!1,position:"top"},tutorialBlockedUI:{settingsClose:!1,calculatorClose:!1,gameInfoClose:!1,resultatKreidetafelClose:!1},topSwipeAnimation:!1,bottomSwipeAnimation:!1,notifications:[],isSettingsOpen:!1,isCalculatorOpen:!1,isMenuOpen:!1,activeModal:null,isNotificationCenterOpen:!1,isLoading:!1,isFinalizingSession:!1,startScreenState:"idle",pageCta:{isVisible:!1,text:"",onClick:null,loading:!1,disabled:!1,variant:"default"},isFarbeSettingsModalOpen:!1,resumableGameId:null,signingState:"idle",team1Signed:!1,team2Signed:!1,justAbortedGame:!1,isNavigatingHistory:!1,isReadOnlyMode:!1,headerConfig:null,hasBeenRedirectedToActiveTournament:!1,isGlobalClickDisabled:!1,iosNotification:{dontShowAgain:!1,hasBeenShownThisSession:!1},isUpdateAvailable:!1,setUpdateAvailable:function(e){},triggerUpdate:null,setTriggerUpdate:function(e){}},T=(0,i.v)()((0,o.Zr)((0,c.D)(function(e,r){return d(d({},I),{},{resetStartScreen:function(){return e(function(e){return d(d({},e),{},{startScreen:{transitionState:"initial",names:{1:"",2:"",3:"",4:""},isOpen:!0}})})},startCharge:function(r,n){return e(function(e){return{chargeEffects:d(d({},e.chargeEffects),{},f({},n,d(d({},e.chargeEffects[n]),{},f({},r,{isActive:!0,pressStartTime:Date.now(),chargeAmount:0}))))}})},updateCharge:function(n,i){var o=r().chargeEffects[i][n];if(o.isActive&&o.pressStartTime){var a=Date.now()-o.pressStartTime;e(function(e){return{chargeEffects:d(d({},e.chargeEffects),{},f({},i,d(d({},e.chargeEffects[i]),{},f({},n,d(d({},o),{},{chargeAmount:Math.min(a/1e3,1)})))))}})}},endCharge:function(r,n){return e(function(e){return{chargeEffects:d(d({},e.chargeEffects),{},f({},n,d(d({},e.chargeEffects[n]),{},f({},r,w()))))}})},resetChargeEffects:function(){return e(function(){return{chargeEffects:{berg:{top:w(),bottom:w()},bedanken:{top:w(),bottom:w()},matsch:{top:w(),bottom:w()}}}})},openCalculator:function(){var n=r();n.tutorialBlockedUI.calculatorClose||(n.isMenuOpen&&e({isMenuOpen:!1}),e({calculator:d(d({},n.calculator),{},{isOpen:!0})}))},closeCalculator:function(){return e(function(e){return{calculator:d(d({},e.calculator),{},{isOpen:!1})}})},setCalculatorFlipped:function(r){return e(function(e){return{calculator:d(d({},e.calculator),{},{isFlipped:r})}})},setStartScreenState:function(r){return e(function(e){return{startScreen:d(d({},e.startScreen),{},{transitionState:r,isOpen:"complete"!==r})}})},setStartScreenNames:function(r){return e(function(e){return{startScreen:d(d({},e.startScreen),{},{names:r})}})},setMenuActiveButton:function(r){return e(function(e){return{menu:d(d({},e.menu),{},{activeButton:r})}})},setShowIntroduction:function(r){return e(function(e){return{menu:d(d({},e.menu),{},{showIntroduction:r})}})},setShowResetWarning:function(r){return e(function(e){return{menu:d(d({},e.menu),{},{showResetWarning:r})}})},resetAll:function(){return e(function(){return{calculator:{isOpen:!1,value:0,isFlipped:!1},startScreen:{transitionState:"initial",names:{1:"",2:"",3:"",4:""},isOpen:!0},history:{warning:null},chargeEffects:{berg:{top:w(),bottom:w()},bedanken:{top:w(),bottom:w()},matsch:{top:w(),bottom:w()}},menu:{isOpen:!1,activeButton:null,showIntroduction:!1,showResetWarning:!1,props:null},resultatKreidetafel:{isOpen:!1,swipePosition:null,currentStatistic:"striche",animationComplete:!0},historyWarning:{show:!1,message:"",onConfirm:function(){},onCancel:function(){},type:"warning"},isMenuOpen:!1}})},setMenuOpen:function(r){return e(function(e){return r&&e.calculator.isOpen?{menu:d(d({},e.menu),{},{isOpen:r}),calculator:d(d({},e.calculator),{},{isOpen:!1}),overlayPosition:r?e.overlayPosition:null}:{menu:d(d({},e.menu),{},{isOpen:r}),overlayPosition:r?e.overlayPosition:null}})},openResultatKreidetafel:function(r){return e({resultatKreidetafel:{isOpen:!0,swipePosition:r,currentStatistic:"striche",animationComplete:!1},overlayPosition:r})},closeResultatKreidetafel:function(){return e({resultatKreidetafel:{isOpen:!1,swipePosition:null,currentStatistic:"striche",animationComplete:!0}})},setGameInfoOpen:function(r){return e({isGameInfoOpen:r})},setHistoryWarningOpen:function(r){return e({isHistoryWarningOpen:r})},setHistoryWarningCallback:function(r){return e({historyWarningCallback:r})},setLastDoubleClickPosition:function(r){return e({lastDoubleClickPosition:r})},showHistoryWarning:function(r){return e(function(e){return{historyWarning:{show:!0,message:r.message,onConfirm:r.onConfirm,onCancel:r.onCancel||function(){},type:r.type||"warning"}}})},closeHistoryWarning:function(){return e(function(e){return{historyWarning:d(d({},e.historyWarning),{},{show:!1})}})},pauseGame:function(){return e({isPaused:!0})},resumeGame:function(){return e({isPaused:!1})},setKreidetafelPosition:function(r){return e(function(e){return{resultatKreidetafel:d(d({},e.resultatKreidetafel),{},{swipePosition:r})}})},setKreidetafelStatistic:function(r){return e(function(e){return{resultatKreidetafel:d(d({},e.resultatKreidetafel),{},{currentStatistic:r})}})},setStrichStyle:function(r){return e(function(e){return{strichStyle:d(d({},e.strichStyle),r)}})},openFarbeSettings:function(){return e(function(e){return{settings:d(d({},e.settings),{},{isOpen:!0,activeTab:"farben"})}})},closeFarbeSettings:function(){return e(function(e){return{settings:d(d({},e.settings),{},{isOpen:!1})}})},setFarbeFlipped:function(n){var i=d(d({},r().farbeSettings),{},{isFlipped:n});b("farbe",i),e({farbeSettings:i})},updateFarbeSettings:function(r){return e(function(e){var n=d(d({},e.farbeSettings),r);return(0,u.mG)(n)?(b("farbe",n),{farbeSettings:n}):e})},openScoreSettings:function(){return e(function(e){return{settings:d(d({},e.settings),{},{isOpen:!0,activeTab:"scores"})}})},closeScoreSettings:function(){return e(function(e){return{settings:d(d({},e.settings),{},{isOpen:!1})}})},updateScoreSettings:function(r){return e(function(e){return{scoreSettings:d(d({},e.scoreSettings),r)}})},setScoreValue:function(r,n){(0,a.IZ)(r,n)&&e(function(e){return{scoreSettings:d(d({},e.scoreSettings),{},{values:d(d({},e.scoreSettings.values),{},f({},r,n))})}})},toggleScoreEnabled:function(r){return e(function(e){return{scoreSettings:d(d({},e.scoreSettings),{},{enabled:d(d({},e.scoreSettings.enabled),{},f({},r,!e.scoreSettings.enabled[r]))})}})},setSettingsTab:function(r){return e(function(e){return{settings:d(d({},e.settings),{},{activeTab:r})}})},openSettings:function(){return e(function(e){return{settings:d(d({},e.settings),{},{isOpen:!0})}})},closeSettings:function(){return e(function(e){return{settings:d(d({},e.settings),{},{isOpen:!1})}})},cyclePictogramMode:function(){return e(function(e){var r,n=e.settings.pictogramConfig;return b("pictogram",r=n.isEnabled?"svg"===n.mode?{isEnabled:!0,mode:"emoji"}:{isEnabled:!1,mode:"svg"}:{isEnabled:!0,mode:"svg"}),{settings:d(d({},e.settings),{},{pictogramConfig:r})}})},updateScoreValue:function(r,n){return e(function(e){if(!(0,a.IZ)(r,n))return e;var i=d({},e.scoreSettings.values);if(i[r]=n,"sieg"===r){var o=Math.floor(n/2);i.berg=Math.min(i.berg,o),i.schneider=Math.min(i.schneider,o)}var s=d(d({},e.scoreSettings),{},{values:i});return b("score",s),{scoreSettings:s}})},updateSettings:function(r,n){e(function(e){var i=d(d({},"farbe"===r?e.farbeSettings:e.scoreSettings),n);return b(r,i),f({},"".concat(r,"Settings"),i)})},setOverlayPosition:function(r){return e({overlayPosition:r})},showJassFinishNotification:function(r){return e(function(e){var n,i;e.jassFinishNotification={isOpen:!0,mode:null!=(n=r.mode)?n:"share",message:null!=(i=r.message)?i:{text:"Jass beendet!",icon:"\uD83C\uDF89"},onShare:r.onShare,onBack:r.onBack,onBackLabel:r.onBackLabel,onContinue:r.onContinue}})},closeJassFinishNotification:function(){return e(function(e){e.jassFinishNotification.isOpen=!1})},setOnboardingStep:function(r){return e(function(e){return{onboarding:d(d({},e.onboarding),{},{currentStep:r})}})},completeOnboarding:function(){return e(function(e){return{onboarding:d(d({},e.onboarding),{},{hasCompletedOnboarding:!0})}})},showOnboarding:function(r){return e(function(e){return{onboarding:d(d({},e.onboarding),{},{show:!0,canBeDismissed:r})}})},hideOnboarding:function(){return e(function(e){return{onboarding:d(d({},e.onboarding),{},{show:!1,hasCompletedOnboarding:!0})}})},setCardStyle:function(r){return e(function(e){e.settings.cardStyle=r,e.farbeSettings.cardStyle=r})},updateStrokeSettings:function(r){(0,s.yB)(r)&&e(function(e){var n=d(d({},e.strokeSettings),r);return b("strokes",n),{strokeSettings:n}})},setStrokeValue:function(r,n){(0,s.yB)(f({},r,n))&&e(function(e){return{strokeSettings:d(d({},e.strokeSettings),{},f({},r,n))}})},openTutorialInfo:function(){return e({isTutorialInfoOpen:!0})},closeTutorialInfo:function(){return e({isTutorialInfoOpen:!1})},closeAllOverlays:function(){return e(function(e){return d(d({},e),{},{menu:d(d({},e.menu),{},{isOpen:!1}),isGameInfoOpen:!1})})},openMenu:function(){return e(function(e){return e.calculator.isOpen?d(d({},e),{},{isMenuOpen:!0,calculator:d(d({},e.calculator),{},{isOpen:!1})}):d(d({},e),{},{isMenuOpen:!0})})},setSplitContainer:function(r,n){return e(function(e){return{splitContainer:{isOpen:r,position:n}}})},closeGameInfo:function(){return e({isGameInfoOpen:!1})},tutorialBlockedUI:{settingsClose:!1,calculatorClose:!1,gameInfoClose:!1,resultatKreidetafelClose:!1},openGameInfo:function(){return e({isGameInfoOpen:!0})},setTopSwipeAnimation:function(r){return e({topSwipeAnimation:r})},setBottomSwipeAnimation:function(r){return e({bottomSwipeAnimation:r})},showNotification:function(n){var i,o=d(d({},n),{},{id:crypto.randomUUID(),timestamp:Date.now()});return e(function(e){e.notifications.some(function(e){return e.id===o.id})||(e.notifications.length>=5&&e.notifications.shift(),e.notifications.push(o))}),o.duration&&o.duration>0&&!(null!=(i=o.actions)&&i.length)&&setTimeout(function(){r().removeNotification(o.id)},o.duration),o.id},removeNotification:function(r){e(function(e){var n=e.notifications.length;e.notifications=e.notifications.filter(function(e){return e.id!==r}),n===e.notifications.length&&console.warn("[UIStore] Attempted to remove notification ".concat(r," but it was not found in the list"))})},setResultatPosition:function(r){return e(function(e){return{resultatKreidetafel:d(d({},e.resultatKreidetafel),{},{swipePosition:r})}})},setResultatAnimationComplete:function(r){return e(function(e){return{resultatKreidetafel:d(d({},e.resultatKreidetafel),{},{animationComplete:r})}})},canOpenGameInfo:function(){var e=r();return!(e.startScreen.isOpen||e.settings.isOpen||e.calculator.isOpen||e.menu.isOpen||e.resultatKreidetafel.isOpen||e.jassFinishNotification.isOpen||e.isTutorialInfoOpen||e.splitContainer.isOpen)},setStartScreenOpen:function(r){return e(function(e){return{startScreen:d(d({},e.startScreen),{},{isOpen:r})}})},toggleMenu:function(){return e(function(e){var r=!e.isMenuOpen;return r&&e.calculator.isOpen?{isMenuOpen:r,calculator:d(d({},e.calculator),{},{isOpen:!1})}:{isMenuOpen:r}})},closeMenu:function(){return e({isMenuOpen:!1})},toggleNotificationCenter:function(){return e(function(e){e.isNotificationCenterOpen=!e.isNotificationCenterOpen})},openNotificationCenter:function(){return e({isNotificationCenterOpen:!0})},closeNotificationCenter:function(){return e({isNotificationCenterOpen:!1})},setLoading:function(r){return e({isLoading:r})},setFinalizingSession:function(r){return e({isFinalizingSession:r})},setPageCta:function(r){return e(function(e){if(r.isVisible&&r.text&&r.onClick){var n,i,o;e.pageCta={isVisible:!0,text:r.text,onClick:r.onClick,loading:null!=(n=r.loading)&&n,disabled:null!=(i=r.disabled)&&i,variant:null!=(o=r.variant)?o:"default"}}else e.pageCta=d({},I.pageCta)})},resetPageCta:function(){return e(function(e){e.pageCta=d({},I.pageCta)})},setPageCtaLoading:function(r){return e(function(e){e.pageCta.isVisible&&(e.pageCta.loading=r)})},setPageCtaDisabled:function(r){return e(function(e){e.pageCta.isVisible&&(e.pageCta.disabled=r)})},resetUI:function(){e(function(e){var r=e.farbeSettings,n=e.scoreSettings,i=e.strokeSettings,o=e.settings;Object.assign(e,I),e.farbeSettings=r,e.scoreSettings=n,e.strokeSettings=i,e.settings=o},!1)},openFarbeSettingsModal:function(){return e({isFarbeSettingsModalOpen:!0})},closeFarbeSettingsModal:function(){return e({isFarbeSettingsModalOpen:!1})},setResumableGameId:function(r){e({resumableGameId:r})},clearResumableGameId:function(){e({resumableGameId:null})},startSigningProcess:function(){e({signingState:"top"===r().resultatKreidetafel.swipePosition?"waitingTeam2":"waitingTeam1",team1Signed:!1,team2Signed:!1})},recordSignature:function(r){e(function(e){var n=e.signingState,i=e.team1Signed,o=e.team2Signed;"bottom"===r?(i=!0,n=e.team2Signed?"completed":"waitingTeam2"):(o=!0,n=e.team1Signed?"completed":"waitingTeam1"),e.signingState=n,e.team1Signed=i,e.team2Signed=o})},resetSigningProcess:function(){e({signingState:"idle",team1Signed:!1,team2Signed:!1})},setJustAborted:function(r){return e({justAbortedGame:r})},setIsNavigatingHistory:function(r){return e({isNavigatingHistory:r})},setReadOnlyMode:function(r){return e({isReadOnlyMode:r})},setJassFinishNotificationOpen:function(r){return e(function(e){return{jassFinishNotification:d(d({},e.jassFinishNotification),{},{isOpen:r})}})},setHeaderConfig:function(r){return e({headerConfig:r})},setHasBeenRedirectedToActiveTournament:function(r){return e({hasBeenRedirectedToActiveTournament:r})},setGlobalClickDisabled:function(r,n){e({isGlobalClickDisabled:r}),r&&n&&setTimeout(function(){e({isGlobalClickDisabled:!1})},n)},setIOSNotificationDontShowAgain:function(r){return e(function(e){return{iosNotification:d(d({},e.iosNotification),{},{dontShowAgain:r})}})},markIOSNotificationAsShown:function(){return e(function(e){return{iosNotification:d(d({},e.iosNotification),{},{hasBeenShownThisSession:!0})}})},resetIOSNotificationForSession:function(){return e(function(e){return{iosNotification:d(d({},e.iosNotification),{},{hasBeenShownThisSession:!1})}})},shouldShowIOSNotification:function(){var e=r();return!e.iosNotification.dontShowAgain&&!e.iosNotification.hasBeenShownThisSession},setUpdateAvailable:function(r){return e({isUpdateAvailable:r})},triggerUpdate:null,setTriggerUpdate:function(r){return e({triggerUpdate:r})}})}),{name:"jass-ui-storage",version:1,migrate:function(e,r){return 0===r&&e.scoreSettings&&void 0===e.scoreSettings.matschBonus&&(console.log("\uD83D\uDD04 Migrating uiStore state v0 to v1: Adding matschBonus"),e.scoreSettings.matschBonus=!0),e},partialize:function(e){return{farbeSettings:e.farbeSettings,scoreSettings:e.scoreSettings,strokeSettings:e.strokeSettings,settings:d(d({},e.settings),{},{cardStyle:e.settings.cardStyle,pictogramConfig:e.settings.pictogramConfig})}}}));T.persist.rehydrate()},95014:(e,r,n)=>{"use strict";n.d(r,{A:()=>i});var i=(0,n(11037).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},95226:(e,r,n)=>{"use strict";n.d(r,{XR:()=>en,qk:()=>er,c7:()=>eo,KR:()=>ei,D:()=>et});var i,o,a=n(96796),s=n(51139),u=n(88308);let c="firebasestorage.googleapis.com",l="storageBucket";class h extends s.g{constructor(e,r,n=0){super(d(e),`Firebase Storage: ${r} (${d(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,h.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return d(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function d(e){return"storage/"+e}function f(){return new h(i.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function p(e){return new h(i.INVALID_ARGUMENT,e)}function m(){return new h(i.APP_DELETED,"The Firebase app was deleted.")}function g(e,r){return new h(i.INVALID_FORMAT,"String does not match format '"+e+"': "+r)}function y(e){throw new h(i.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(i||(i={}));class v{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=v.makeFromUrl(e,r)}catch(r){return new v(e,"")}if(""===n.path)return n;throw new h(i.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,r){let n=null,o="([A-Za-z0-9.\\-_]+)",a=RegExp("^gs://"+o+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}let u=r.replace(/[.]/g,"\\."),l=RegExp(`^https?://${u}/v[A-Za-z0-9_]+/b/${o}/o(/([^?#]*).*)?$`,"i"),d=r===c?"(?:storage.googleapis.com|storage.cloud.google.com)":r,f=[{regex:a,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:l,indices:{bucket:1,path:3},postModify:s},{regex:RegExp(`^https?://${d}/${o}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let r=0;r<f.length;r++){let i=f[r],o=i.regex.exec(e);if(o){let e=o[i.indices.bucket],r=o[i.indices.path];r||(r=""),n=new v(e,r),i.postModify(n);break}}if(null==n)throw new h(i.INVALID_URL,"Invalid URL '"+e+"'.");return n}}class b{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function w(e){return"string"==typeof e||e instanceof String}function S(e){return x()&&e instanceof Blob}function x(){return"undefined"!=typeof Blob}function E(e,r,n,i){if(i<r)throw p(`Invalid value for '${e}'. Expected ${r} or greater.`);if(i>n)throw p(`Invalid value for '${e}'. Expected ${n} or less.`)}function I(e,r,n){let i=r;return null==n&&(i=`https://${r}`),`${n}://${i}/v0${e}`}function T(e){let r=encodeURIComponent,n="?";for(let i in e)e.hasOwnProperty(i)&&(n=n+(r(i)+"=")+r(e[i])+"&");return n.slice(0,-1)}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(o||(o={}));class k{constructor(e,r,n,i,o,a,s,u,c,l,h,d=!0,f=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=s,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=h,this.retry=d,this.isUsingEmulator=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,r)=>{this.resolve_=e,this.reject_=r,this.start_()})}start_(){let e=(e,r)=>{if(r)return void e(!1,new _(!1,null,!0));let n=this.connectionFactory_();this.pendingConnection_=n;let i=e=>{let r=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(r,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;let r=n.getErrorCode()===o.NO_ERROR,a=n.getStatus();if(!r||function(e,r){let n=e>=500&&e<600,i=-1!==[408,429].indexOf(e),o=-1!==r.indexOf(e);return n||i||o}(a,this.additionalRetryCodes_)&&this.retry)return void e(!1,new _(!1,null,n.getErrorCode()===o.ABORT));e(!0,new _(-1!==this.successCodes_.indexOf(a),n))})},r=(e,r)=>{let n=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{let e=this.callback_(a,a.getResponse());void 0!==e?n(e):n()}catch(e){o(e)}else if(null!==a){let e=f();e.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,e):e)}else o(r.canceled?this.appDelete_?m():new h(i.CANCELED,"User canceled the upload/download."):new h(i.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?r(!1,new _(!1,null,!0)):this.backoffId_=function(e,r,n){let i=1,o=null,a=null,s=!1,u=0,c=!1;function l(...e){c||(c=!0,r.apply(null,e))}function h(r){o=setTimeout(()=>{o=null,e(f,2===u)},r)}function d(){a&&clearTimeout(a)}function f(e,...r){let n;if(c)return void d();if(e||2===u||s){d(),l.call(null,e,...r);return}i<64&&(i*=2),1===u?(u=2,n=0):n=(i+Math.random())*1e3,h(n)}let p=!1;function m(e){p||(p=!0,d(),!c&&(null!==o?(e||(u=2),clearTimeout(o),h(0)):e||(u=1)))}return h(0),a=setTimeout(()=>{s=!0,m(!0)},n),m}(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class _{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function A(...e){let r="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==r){let n=new r;for(let r=0;r<e.length;r++)n.append(e[r]);return n.getBlob()}if(x())return new Blob(e);throw new h(i.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}let P={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class O{constructor(e,r){this.data=e,this.contentType=r||null}}function C(e){let r=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<=127?r.push(i):i<=2047?r.push(192|i>>6,128|63&i):(64512&i)==55296?n<e.length-1&&(64512&e.charCodeAt(n+1))==56320?(i=65536|(1023&i)<<10|1023&e.charCodeAt(++n),r.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):r.push(239,191,189):(64512&i)==56320?r.push(239,191,189):r.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(r)}function N(e,r){let n;switch(e){case P.BASE64:{let n=-1!==r.indexOf("-"),i=-1!==r.indexOf("_");if(n||i)throw g(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case P.BASE64URL:{let n=-1!==r.indexOf("+"),i=-1!==r.indexOf("/");if(n||i)throw g(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");r=r.replace(/-/g,"+").replace(/_/g,"/")}}try{n=function(e){if("undefined"==typeof atob)throw new h(i.UNSUPPORTED_ENVIRONMENT,"base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(e)}(r)}catch(r){if(r.message.includes("polyfill"))throw r;throw g(e,"Invalid character found")}let o=new Uint8Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);return o}class L{constructor(e){this.base64=!1,this.contentType=null;let r=e.match(/^data:([^,]+)?,/);if(null===r)throw g(P.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let n=r[1]||null;null!=n&&(this.base64=function(e,r){return e.length>=r.length&&e.substring(e.length-r.length)===r}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class D{constructor(e,r){let n=0,i="";S(e)?(this.data_=e,n=e.size,i=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,r){if(!S(this.data_))return new D(new Uint8Array(this.data_.buffer,e,r-e),!0);{var n,i,o;let a=(n=this.data_,i=e,o=r,n.webkitSlice?n.webkitSlice(i,o):n.mozSlice?n.mozSlice(i,o):n.slice?n.slice(i,o):null);return null===a?null:new D(a)}}static getBlob(...e){if(x()){let r=e.map(e=>e instanceof D?e.data_:e);return new D(A.apply(null,r))}{let r=e.map(e=>w(e)?function(e,r){switch(e){case P.RAW:return new O(C(r));case P.BASE64:case P.BASE64URL:return new O(N(e,r));case P.DATA_URL:return new O(function(e){let r,n=new L(e);if(n.base64)return N(P.BASE64,n.rest);var i=n.rest;try{r=decodeURIComponent(i)}catch(e){throw g(P.DATA_URL,"Malformed data URL.")}return C(r)}(r),new L(r).contentType)}throw f()}(P.RAW,e).data:e.data_),n=0;r.forEach(e=>{n+=e.byteLength});let i=new Uint8Array(n),o=0;return r.forEach(e=>{for(let r=0;r<e.length;r++)i[o++]=e[r]}),new D(i,!0)}}uploadData(){return this.data_}}function R(e){var r;let n;try{n=JSON.parse(e)}catch(e){return null}return"object"!=typeof(r=n)||Array.isArray(r)?null:n}function j(e){let r=e.lastIndexOf("/",e.length-2);return -1===r?e:e.slice(r+1)}function F(e,r){return r}class U{constructor(e,r,n,i){this.server=e,this.local=r||e,this.writable=!!n,this.xform=i||F}}let M=null;function G(){if(M)return M;let e=[];e.push(new U("bucket")),e.push(new U("generation")),e.push(new U("metageneration")),e.push(new U("name","fullPath",!0));let r=new U("name");r.xform=function(e,r){return!w(r)||r.length<2?r:j(r)},e.push(r);let n=new U("size");return n.xform=function(e,r){return void 0!==r?Number(r):r},e.push(n),e.push(new U("timeCreated")),e.push(new U("updated")),e.push(new U("md5Hash",null,!0)),e.push(new U("cacheControl",null,!0)),e.push(new U("contentDisposition",null,!0)),e.push(new U("contentEncoding",null,!0)),e.push(new U("contentLanguage",null,!0)),e.push(new U("contentType",null,!0)),e.push(new U("metadata","customMetadata",!0)),M=e}function V(e,r,n){let i=R(r);return null===i?null:function(e,r,n){let i={};i.type="file";let o=n.length;for(let e=0;e<o;e++){let o=n[e];i[o.local]=o.xform(i,r[o.server])}return Object.defineProperty(i,"ref",{get:function(){let r=new v(i.bucket,i.fullPath);return e._makeStorageReference(r)}}),i}(e,i,n)}class B{constructor(e,r,n,i){this.url=e,this.method=r,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function z(e){if(!e)throw f()}function q(e){return function(r,n){var o,a;let s;return 401===r.getStatus()?s=r.getErrorText().includes("Firebase App Check token is invalid")?new h(i.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new h(i.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===r.getStatus()?(o=e.bucket,s=new h(i.QUOTA_EXCEEDED,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===r.getStatus()?(a=e.path,s=new h(i.UNAUTHORIZED,"User does not have permission to access '"+a+"'.")):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}}function H(e){let r=q(e);return function(n,o){var a;let s=r(n,o);return 404===n.getStatus()&&(a=e.path,s=new h(i.OBJECT_NOT_FOUND,"Object '"+a+"' does not exist.")),s.serverResponse=o.serverResponse,s}}class ${constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=o.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=o.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=o.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,i,o){if(this.sent_)throw y("cannot .send() more than once");if((0,s.zJ)(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(r,e,!0),void 0!==o)for(let e in o)o.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,o[e].toString());return void 0!==i?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw y("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw y("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return -1}}getResponse(){if(!this.sent_)throw y("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw y("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class K extends ${initXhr(){this.xhr_.responseType="text"}}function W(){return new K}class Q{constructor(e,r){this._service=e,r instanceof v?this._location=r:this._location=v.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Q(e,r)}get root(){let e=new v(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return j(this._location.path)}get storage(){return this._service}get parent(){let e=function(e){if(0===e.length)return null;let r=e.lastIndexOf("/");return -1===r?"":e.slice(0,r)}(this._location.path);if(null===e)return null;let r=new v(this._location.bucket,e);return new Q(this._service,r)}_throwIfRoot(e){if(""===this._location.path)throw new h(i.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}}function J(e,r){let n=null==r?void 0:r[l];return null==n?null:v.makeFromBucketSpec(n,e)}class Y{constructor(e,r,n,i,o,a=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=o,this._isUsingEmulator=a,this._bucket=null,this._host=c,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=i?this._bucket=v.makeFromBucketSpec(i,this._host):this._bucket=J(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=v.makeFromBucketSpec(this._url,e):this._bucket=J(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){E("time",0,1/0,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){E("time",0,1/0,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let r=await e.getToken();if(null!==r)return r.accessToken}return null}async _getAppCheckToken(){if((0,a.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Q(this,e)}_makeRequest(e,r,n,i,o=!0){if(this._deleted)return new b(m());{let a=function(e,r,n,i,o,a,s=!0,u=!1){let c=T(e.urlParams),l=e.url+c,h=Object.assign({},e.headers);return r&&(h["X-Firebase-GMPID"]=r),null!==n&&n.length>0&&(h.Authorization="Firebase "+n),h["X-Firebase-Storage-Version"]="webjs/"+(null!=a?a:"AppManager"),null!==i&&(h["X-Firebase-AppCheck"]=i),new k(l,e.method,h,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,o,s,u)}(e,this._appId,n,i,r,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){let[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}let X="@firebase/storage",Z="0.13.14",ee="storage";function et(e,r,n){var o=e=(0,s.Ku)(e);o._throwIfRoot("uploadBytes");let a=function(e,r,n,o,a){let s=r.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"},c=function(){let e="";for(let r=0;r<2;r++)e+=Math.random().toString().slice(2);return e}();u["Content-Type"]="multipart/related; boundary="+c;let l=function(e,r,n){let i=Object.assign({},n);return i.fullPath=e.path,i.size=r.size(),i.contentType||(i.contentType=r&&r.type()||"application/octet-stream"),i}(r,o,a),d="--"+c+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(e,r){let n={},i=r.length;for(let o=0;o<i;o++){let i=r[o];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}(l,n)+"\r\n--"+c+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",f=D.getBlob(d,o,"\r\n--"+c+"--");if(null===f)throw new h(i.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.");let p={name:l.fullPath},m=I(s,e.host,e._protocol),g=e.maxUploadRetryTime,y=new B(m,"POST",function(r,i){let o=V(e,i,n);return z(null!==o),o},g);return y.urlParams=p,y.headers=u,y.body=f.uploadData(),y.errorHandler=q(r),y}(o.storage,o._location,G(),new D(r,!0),n);return o.storage.makeRequestWithTokens(a,W).then(e=>({metadata:e,ref:o}))}function er(e){var r=e=(0,s.Ku)(e);r._throwIfRoot("getDownloadURL");let n=function(e,r,n){let i=I(r.fullServerUrl(),e.host,e._protocol),o=e.maxOperationRetryTime,a=new B(i,"GET",function(r,i){let o=V(e,i,n);return z(null!==o),function(e,r,n,i){let o=R(r);if(null===o||!w(o.downloadTokens))return null;let a=o.downloadTokens;if(0===a.length)return null;let s=encodeURIComponent;return a.split(",").map(r=>{let o=e.bucket,a=e.fullPath;return I("/b/"+s(o)+"/o/"+s(a),n,i)+T({alt:"media",token:r})})[0]}(o,i,e.host,e._protocol)},o);return a.errorHandler=H(r),a}(r.storage,r._location,G());return r.storage.makeRequestWithTokens(n,W).then(e=>{if(null===e)throw new h(i.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function en(e){var r=e=(0,s.Ku)(e);r._throwIfRoot("deleteObject");let n=function(e,r){let n=I(r.fullServerUrl(),e.host,e._protocol),i=new B(n,"DELETE",function(e,r){},e.maxOperationRetryTime);return i.successCodes=[200,204],i.errorHandler=H(r),i}(r.storage,r._location);return r.storage.makeRequestWithTokens(n,W)}function ei(e,r){var n=e=(0,s.Ku)(e);if(!(r&&/^[A-Za-z]+:\/\//.test(r)))return function e(r,n){if(r instanceof Y){if(null==r._bucket)throw new h(i.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+l+"' property when initializing the app?");let o=new Q(r,r._bucket);return null!=n?e(o,n):o}if(void 0===n)return r;let o=function(e,r){let n=r.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(r._location.path,n),a=new v(r._location.bucket,o);return new Q(r.storage,a)}(n,r);if(n instanceof Y)return new Q(n,r);throw p("To use ref(service, url), the first argument must be a Storage instance.")}function eo(e=(0,a.Sx)(),r){e=(0,s.Ku)(e);let n=(0,a.j6)(e,ee).getImmediate({identifier:r}),i=(0,s.yU)("storage");return i&&function(e,r,n,i={}){!function(e,r,n,i={}){e.host=`${r}:${n}`;let o=(0,s.zJ)(r);o&&((0,s.gE)(`https://${e.host}/b`),(0,s.P1)("Storage",!0)),e._isUsingEmulator=!0,e._protocol=o?"https":"http";let{mockUserToken:a}=i;a&&(e._overrideAuthToken="string"==typeof a?a:(0,s.Fy)(a,e.app.options.projectId))}(e,r,n,i)}(n,...i),n}(0,a.om)(new u.uA(ee,function(e,{instanceIdentifier:r}){let n=e.getProvider("app").getImmediate();return new Y(n,e.getProvider("auth-internal"),e.getProvider("app-check-internal"),r,a.MF)},"PUBLIC").setMultipleInstances(!0)),(0,a.KO)(X,Z,""),(0,a.KO)(X,Z,"esm2017")},96796:(e,r,n)=>{"use strict";n.d(r,{KO:()=>_,MF:()=>I,Sx:()=>k,Us:()=>w,Wp:()=>T,g:()=>a.g,j6:()=>b,om:()=>v,xZ:()=>S});var i=n(88308),o=n(36525),a=n(51139),s=n(62704);class u{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(!function(e){let r=e.getComponent();return(null==r?void 0:r.type)==="VERSION"}(e))return null;{let r=e.getImmediate();return`${r.library}/${r.version}`}}).filter(e=>e).join(" ")}}let c="@firebase/app",l="0.13.2",h=new o.Vy("@firebase/app"),d="[DEFAULT]",f={[c]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},p=new Map,m=new Map,g=new Map;function y(e,r){try{e.container.addComponent(r)}catch(n){h.debug(`Component ${r.name} failed to register with FirebaseApp ${e.name}`,n)}}function v(e){let r=e.name;if(g.has(r))return h.debug(`There were multiple attempts to register component ${r}.`),!1;for(let n of(g.set(r,e),p.values()))y(n,e);for(let r of m.values())y(r,e);return!0}function b(e,r){let n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(r)}function w(e,r,n=d){b(e,r).clearInstance(n)}function S(e){return null!=e&&void 0!==e.settings}let x=new a.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class E{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw x.create("app-deleted",{appName:this._name})}}let I="11.10.0";function T(e,r={}){let n=e;"object"!=typeof r&&(r={name:r});let o=Object.assign({name:d,automaticDataCollectionEnabled:!0},r),s=o.name;if("string"!=typeof s||!s)throw x.create("bad-app-name",{appName:String(s)});if(n||(n=(0,a.T9)()),!n)throw x.create("no-options");let u=p.get(s);if(u)if((0,a.bD)(n,u.options)&&(0,a.bD)(o,u.config))return u;else throw x.create("duplicate-app",{appName:s});let c=new i.h1(s);for(let e of g.values())c.addComponent(e);let l=new E(n,o,c);return p.set(s,l),l}function k(e=d){let r=p.get(e);if(!r&&e===d&&(0,a.T9)())return T();if(!r)throw x.create("no-app",{appName:e});return r}function _(e,r,n){var o;let a=null!=(o=f[e])?o:e;n&&(a+=`-${n}`);let s=a.match(/\s|\//),u=r.match(/\s|\//);if(s||u){let e=[`Unable to register library "${a}" with version "${r}":`];s&&e.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&u&&e.push("and"),u&&e.push(`version name "${r}" contains illegal characters (whitespace or "/")`),h.warn(e.join(" "));return}v(new i.uA(`${a}-version`,()=>({library:a,version:r}),"VERSION"))}let A="firebase-heartbeat-store",P=null;function O(){return P||(P=(0,s.P2)("firebase-heartbeat-database",1,{upgrade:(e,r)=>{if(0===r)try{e.createObjectStore(A)}catch(e){console.warn(e)}}}).catch(e=>{throw x.create("idb-open",{originalErrorMessage:e.message})})),P}async function C(e){try{let r=(await O()).transaction(A),n=await r.objectStore(A).get(L(e));return await r.done,n}catch(e){if(e instanceof a.g)h.warn(e.message);else{let r=x.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});h.warn(r.message)}}}async function N(e,r){try{let n=(await O()).transaction(A,"readwrite"),i=n.objectStore(A);await i.put(r,L(e)),await n.done}catch(e){if(e instanceof a.g)h.warn(e.message);else{let r=x.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});h.warn(r.message)}}}function L(e){return`${e.name}!${e.options.appId}`}class D{constructor(e){this.container=e,this._heartbeatsCache=null;let r=this.container.getProvider("app").getImmediate();this._storage=new j(r),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,r;try{let n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=R();if((null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null==(r=this._heartbeatsCache)?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(e=>e.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let r=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,r=i);return r}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){h.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let r=R(),{heartbeatsToSend:n,unsentEntries:i}=function(e,r=1024){let n=[],i=e.slice();for(let o of e){let e=n.find(e=>e.agent===o.agent);if(e){if(e.dates.push(o.date),F(n)>r){e.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),F(n)>r){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),o=(0,a.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return h.warn(e),""}}}function R(){return new Date().toISOString().substring(0,10)}class j{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.zW)()&&(0,a.eX)().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await C(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){let n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!=(r=e.lastSentHeartbeatDate)?r:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var r;if(await this._canUseIndexedDBPromise){let n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!=(r=e.lastSentHeartbeatDate)?r:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function F(e){return(0,a.Uj)(JSON.stringify({version:2,heartbeats:e})).length}v(new i.uA("platform-logger",e=>new u(e),"PRIVATE")),v(new i.uA("heartbeat",e=>new D(e),"PRIVATE")),_(c,l,""),_(c,l,"esm2017"),_("fire-js","")},97594:(e,r,n)=>{"use strict";function i(e){return"object"==typeof e&&null!==e}n.d(r,{G:()=>i})},99407:(e,r,n)=>{"use strict";n.r(r),n.d(r,{abortActiveGame:()=>V,cleanupAbortedSession:()=>B,cleanupDuplicateCompletedGames:()=>R,createActiveGame:()=>x,createNewActiveGame:()=>j,createSessionDocument:()=>U,fetchCompletedGamesFromFirestore:()=>P,findLatestActiveGameForUserInGroup:()=>I,loadCompletedGamesFromFirestore:()=>O,loadRoundsFromFirestore:()=>_,markAllFollowingRoundsAsInactive:()=>D,markRoundsAsActive:()=>L,markRoundsAsInactive:()=>N,saveCompletedGameToFirestore:()=>A,saveRoundToFirestore:()=>k,subscribeToCompletedGames:()=>C,updateActiveGame:()=>E,updateGameStatus:()=>T,updateSessionActiveGameId:()=>F,updateSessionParticipantPlayerIds:()=>G});var i=n(42009),o=n(13848),a=n(94566),s=n(10637),u=n(88880),c=n(21297),l=n(83872),h=n(28742),d=n(37746);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,i=Array(r);n<r;n++)i[n]=e[n];return i}function m(){m=function(){return r};var e,r={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,r,n){e[r]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,r,n){return Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,n){return e[r]=n}}function h(r,n,i,a){var s,u,c,l,h=Object.create((n&&n.prototype instanceof b?n:b).prototype);return o(h,"_invoke",{value:(s=r,u=i,c=new O(a||[]),l=p,function(r,n){if(l===g)throw Error("Generator is already running");if(l===y){if("throw"===r)throw n;return{value:e,done:!0}}for(c.method=r,c.arg=n;;){var i=c.delegate;if(i){var o=function r(n,i){var o=i.method,a=n.iterator[o];if(a===e)return i.delegate=null,"throw"===o&&n.iterator.return&&(i.method="return",i.arg=e,r(n,i),"throw"===i.method)||"return"!==o&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+o+"' method")),v;var s=d(a,n.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var u=s.arg;return u?u.done?(i[n.resultName]=u.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):u:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,v)}(i,c);if(o){if(o===v)continue;return o}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===p)throw l=y,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=g;var a=d(s,u,c);if("normal"===a.type){if(l=c.done?y:"suspendedYield",a.arg===v)continue;return{value:a.arg,done:c.done}}"throw"===a.type&&(l=y,c.method="throw",c.arg=a.arg)}})}),h}function d(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var p="suspendedStart",g="executing",y="completed",v={};function b(){}function w(){}function S(){}var x={};l(x,s,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(C([])));I&&I!==n&&i.call(I,s)&&(x=I);var T=S.prototype=b.prototype=Object.create(x);function k(e){["next","throw","return"].forEach(function(r){l(e,r,function(e){return this._invoke(r,e)})})}function _(e,r){var n;o(this,"_invoke",{value:function(o,a){function s(){return new r(function(n,s){!function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==f(h)&&i.call(h,"__await")?r.resolve(h.__await).then(function(e){n("next",e,s,u)},function(e){n("throw",e,s,u)}):r.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,u)})}u(c.arg)}(o,a,n,s)})}return n=n?n.then(s,s):s()}})}function A(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function P(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function n(){for(;++o<r.length;)if(i.call(r,o))return n.value=r[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(f(r)+" is not iterable")}return w.prototype=S,o(T,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=l(S,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},r.awrap=function(e){return{__await:e}},k(_.prototype),l(_.prototype,u,function(){return this}),r.AsyncIterator=_,r.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var s=new _(h(e,n,i,o),a);return r.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),r.keys=function(e){var r=Object(e),n=[];for(var i in r)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in r)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=C,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!r)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function o(i,o){return u.type="throw",u.arg=r,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],u=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;P(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,n,i){return this.delegate={iterator:C(r),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},r}function g(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function y(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?g(Object(n),!0).forEach(function(r){var i,o,a;i=e,o=r,a=n[r],(o=function(e){var r=function(e,r){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=f(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==f(r)?r:r+""}(o))in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function v(e,r,n,i,o,a,s){try{var u=e[a](s),c=u.value}catch(e){return void n(e)}u.done?r(c):Promise.resolve(c).then(i,o)}function b(e){return function(){var r=this,n=arguments;return new Promise(function(i,o){var a=e.apply(r,n);function s(e){v(a,i,o,s,u,"next",e)}function u(e){v(a,i,o,s,u,"throw",e)}s(void 0)})}}var w=(0,i.getFirestore)(o.firebaseApp),S=0,x=function(){var e=b(m().mark(function e(r){var n,o,u,c,l,h;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,i.collection)(w,"activeGames"),u=(o=(0,i.doc)(n)).id,c=s.useTimerStore.getState().jassStartTime,l=y(y({},r),{},{activeGameId:u,status:"live",createdAt:(0,i.serverTimestamp)(),lastUpdated:(0,i.serverTimestamp)(),jassStartTime:c?i.Timestamp.fromMillis(c):(0,i.serverTimestamp)(),gameStartTime:c?i.Timestamp.fromMillis(c):(0,i.serverTimestamp)()}),e.prev=1,e.next=2,(0,i.setDoc)(o,l);case 2:return e.abrupt("return",u);case 3:throw e.prev=3,console.error("[GameService] Error creating active game: ",h=e.catch(1)),a.useUIStore.getState().showNotification({type:"error",message:"Fehler beim Erstellen des Online-Spiels."}),h;case 4:case"end":return e.stop()}},e,null,[[1,3]])}));return function(r){return e.apply(this,arguments)}}(),E=function(){var e=b(m().mark(function e(r,n){var o,s,u;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] updateActiveGame called without activeGameId."),e.abrupt("return");case 1:return o=(0,i.doc)(w,"activeGames",r),s=y(y({},n),{},{lastUpdated:(0,i.serverTimestamp)()}),e.prev=2,e.next=3,(0,i.updateDoc)(o,s);case 3:e.next=5;break;case 4:e.prev=4,u=e.catch(2),console.error("[GameService] Error updating active game ".concat(r,": "),u),a.useUIStore.getState().showNotification({type:"error",message:"Fehler beim Synchronisieren des Spielstands."});case 5:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r,n){return e.apply(this,arguments)}}(),I=function(){var e=b(m().mark(function e(r,n){var o,a,s,u;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!r||!n)){e.next=1;break}return e.abrupt("return",null);case 1:return o=(0,i.collection)(w,"activeGames"),a=(0,i.query)(o,(0,i.where)("groupId","==",n),(0,i.where)("status","==","live"),(0,i.where)("participantUids","array-contains",r),(0,i.orderBy)("lastUpdated","desc"),(0,i.limit)(1)),e.prev=2,e.next=3,(0,i.getDocs)(a);case 3:if((s=e.sent).empty){e.next=4;break}return u=s.docs[0],e.abrupt("return",u.id);case 4:return e.abrupt("return",null);case 5:e.next=7;break;case 6:return e.prev=6,console.error("[GameService] Error finding active game: ",e.catch(2)),e.abrupt("return",null);case 7:case"end":return e.stop()}},e,null,[[2,6]])}));return function(r,n){return e.apply(this,arguments)}}(),T=function(){var e=b(m().mark(function e(r,n){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] updateGameStatus called without activeGameId."),e.abrupt("return");case 1:if("completed"===n||"aborted"===n){e.next=2;break}return console.warn("[GameService] updateGameStatus called with invalid status: ".concat(n)),e.abrupt("return");case 2:return e.prev=2,e.next=3,E(r,{status:n});case 3:e.next=5;break;case 4:e.prev=4,e.catch(2),console.error("[GameService] Failed to update status for game ".concat(r," via updateActiveGame."));case 5:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r,n){return e.apply(this,arguments)}}(),k=function(){var e=b(m().mark(function e(r,n){var o,s,l,d,f,p,g,v,x,I,T,k,_,A,P,O=arguments;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=O.length>2&&void 0!==O[2]&&O[2],r){e.next=1;break}return console.warn("[GameService] saveRoundToFirestore called without activeGameId."),e.abrupt("return");case 1:if(!((s=Date.now())-S<1e3)){e.next=2;break}return e.abrupt("return");case 2:return S=s,l=(0,i.collection)(w,"activeGames",r,"rounds"),e.prev=3,n.startTime||(n.startTime=n.timestamp),n.endTime=s,d=y({},{id:n.id,roundId:n.roundId,timestamp:i.Timestamp.fromMillis(n.timestamp),actionType:n.actionType,startingPlayer:n.startingPlayer,startingPlayerName:n.startingPlayerName,currentPlayer:n.currentPlayer,isRoundFinalized:n.isRoundFinalized,weisPoints:n.weisPoints,jassPoints:n.jassPoints,scores:n.scores,striche:n.striche,weisActions:n.weisActions||[],roundState:n.roundState,isActive:!0,savedAt:(0,i.serverTimestamp)()}),"jass"===n.actionType&&(g=(p=n).farbe?null==(f=u.S[p.farbe])?void 0:f[p.cardStyle]:void 0,d=y(y({},d),{},{cardStyle:p.cardStyle}),void 0!==g&&(d.farbe=g),void 0!==p.strichInfo&&(d.strichInfo=p.strichInfo)),v=(0,c.g)(d),x=(0,i.doc)(l),e.prev=4,e.next=5,(0,i.runTransaction)(w,function(){var e=b(m().mark(function e(r){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.set(x,v);case 1:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}());case 5:e.next=7;break;case 6:return e.prev=6,_=e.catch(4),console.error("[GameService] Transaktionsfehler bei Rundspeicherung (roundId: ".concat(n.roundId,"):"),_),a.useUIStore.getState().showNotification({type:"error",message:"Fehler bei der Datenspeicherung. Bitte \xfcberpr\xfcfe deine Internetverbindung und versuche es erneut!"}),e.abrupt("return");case 7:return I={top:n.scores.top,bottom:n.scores.bottom},e.next=8,E(r,{scores:I});case 8:return T=h.useGameStore.getState(),k=(0,c.g)({scores:I,striche:n.striche,weisPoints:n.weisPoints,currentPlayer:n.roundState.nextPlayer,startingPlayer:n.roundState.nextPlayer,currentRound:n.roundState.roundNumber,lastUpdated:(0,i.serverTimestamp)(),currentRoundWeis:[],currentJassPoints:n.jassPoints,isRoundCompleted:n.isRoundFinalized,gamePlayers:T.gamePlayers,roundHistory:T.roundHistory}),e.prev=9,e.next=10,(0,i.updateDoc)((0,i.doc)(w,"activeGames",r),k);case 10:e.next=12;break;case 11:e.prev=11,A=e.catch(9),console.error("[GameService] Error updating main game document ".concat(r,":"),A),a.useUIStore.getState().showNotification({type:"warning",message:"Die Runde wurde gespeichert, aber es gab ein Problem bei der Aktualisierung der Spiel\xfcbersicht."});case 12:if(!o){e.next=13;break}return e.next=13,E(r,{lastUpdated:(0,i.serverTimestamp)()});case 13:e.next=15;break;case 14:e.prev=14,P=e.catch(3),console.error("[GameService] Error saving round to Firestore for game ".concat(r,":"),P),a.useUIStore.getState().showNotification({type:"error",message:"Fehler beim Speichern der Runde. Bitte \xfcberpr\xfcfe deine Internetverbindung!"});case 15:case"end":return e.stop()}},e,null,[[3,14],[4,6],[9,11]])}));return function(r,n){return e.apply(this,arguments)}}(),_=function(){var e=b(m().mark(function e(r){var n,o,s,u,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] loadRoundsFromFirestore called without activeGameId."),e.abrupt("return",[]);case 1:return e.prev=1,n=(0,i.collection)(w,"activeGames",r,"rounds"),o=(0,i.query)(n,(0,i.where)("isActive","==",!0)),e.next=2,(0,i.getDocs)(o);case 2:if(!(s=e.sent).empty){e.next=3;break}return e.abrupt("return",[]);case 3:return u=[],s.forEach(function(e){var r,n=e.data(),i=(null==(r=n.timestamp)?void 0:r.toMillis())||Date.now(),o={id:n.id,roundId:n.roundId,timestamp:i,actionType:n.actionType,startingPlayer:n.startingPlayer,startingPlayerName:n.startingPlayerName,currentPlayer:n.currentPlayer,isRoundFinalized:n.isRoundFinalized,weisPoints:n.weisPoints,jassPoints:n.jassPoints,scores:n.scores,striche:n.striche,weisActions:n.weisActions||[],roundState:n.roundState,isCompleted:n.isRoundFinalized,isActive:n.isActive};if("jass"===n.actionType){var a=y(y({},o),{},{actionType:"jass",farbe:n.farbe,cardStyle:n.cardStyle,strichInfo:n.strichInfo,isRoundFinalized:!0,isCompleted:!0});u.push(a)}else u.push(o)}),u.sort(function(e,r){return(e.roundId||0)-(r.roundId||0)}),e.abrupt("return",u);case 4:return e.prev=4,c=e.catch(1),console.error("[GameService] Error loading rounds for game ".concat(r,":"),c),a.useUIStore.getState().showNotification({type:"error",message:"Fehler beim Laden der Spielrunden."}),e.abrupt("return",[]);case 5:case"end":return e.stop()}},e,null,[[1,4]])}));return function(r){return e.apply(this,arguments)}}(),A=function(){var e=b(m().mark(function e(r,n,o){var s,u,h,d,f,p,g,v,b,S,x,E=arguments;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=!(E.length>3)||void 0===E[3]||E[3],!(!r||"number"!=typeof n||n<=0)){e.next=1;break}return console.error("[saveCompletedGameToFirestore] Ung\xfcltige sessionId oder gameNumber.",{sessionId:r,gameNumber:n}),e.abrupt("return",!1);case 1:if(o){e.next=2;break}return console.error("[saveCompletedGameToFirestore] Keine summaryData \xfcbergeben."),e.abrupt("return",!1);case 2:if(u=l.useJassStore.getState().jassSessionId||r,h=l.useJassStore.getState().currentSession,u){e.next=3;break}return console.error("[saveCompletedGameToFirestore] Keine g\xfcltige Session-ID gefunden."),e.abrupt("return",!1);case 3:if(d=String(n),null!=h&&h.gruppeId){e.next=4;break}return console.error("[saveCompletedGameToFirestore] No groupId found for session ".concat(u)),e.abrupt("return",!1);case 4:return f=(0,i.doc)(w,"groups",h.gruppeId,"jassGameSummaries",u,"completedGames",d),e.prev=5,e.next=6,(0,i.getDoc)(f);case 6:if(!(p=e.sent).exists()){e.next=9;break}if(!((!(g=p.data()).roundHistory||0===g.roundHistory.length)&&o.roundHistory&&o.roundHistory.length>0)){e.next=8;break}return e.next=7,(0,i.updateDoc)(f,{roundHistory:o.roundHistory,trumpColorsPlayed:o.trumpColorsPlayed||[]});case 7:return s&&a.useUIStore.getState().showNotification({type:"success",message:"Spielhistorie erfolgreich aktualisiert.",duration:3e3}),e.abrupt("return",!0);case 8:return e.abrupt("return",!0);case 9:return v=[],o.roundHistory&&Array.isArray(o.roundHistory)?v=o.roundHistory.map(function(e,r){var n=y({},e);return n.roundState?n.roundState=y(y({},n.roundState),{},{roundNumber:r+1}):n.roundState={roundNumber:r+1,nextPlayer:e.currentPlayer||1},n}):console.warn("[saveCompletedGameToFirestore] Keine g\xfcltige Rundenhistorie zum Neunummerieren in Spiel ".concat(n," gefunden.")),b=y(y({},o),{},{roundHistory:v}),S=(0,c.g)(b),e.next=10,(0,i.setDoc)(f,S);case 10:return s&&a.useUIStore.getState().showNotification({type:"success",message:"Jass-Partie wurde erfolgreich gespeichert & alle Statistiken aktualisiert.",duration:3e3}),e.abrupt("return",!0);case 11:return e.prev=11,x=e.catch(5),console.error("[saveCompletedGameToFirestore] Fehler beim Speichern von Spiel ".concat(n," f\xfcr Session ").concat(u,":"),x),a.useUIStore.getState().showNotification({type:"error",message:"Fehler: Zusammenfassung f\xfcr Spiel ".concat(n," konnte nicht gespeichert werden."),duration:5e3}),e.abrupt("return",!1);case 12:case"end":return e.stop()}},e,null,[[5,11]])}));return function(r,n,i){return e.apply(this,arguments)}}(),P=function(){var e=b(m().mark(function e(r,n){var s,u,c,l,h,d,f,p,g;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] fetchCompletedGamesFromFirestore called without sessionId."),e.abrupt("return",[]);case 1:return s=(0,i.getFirestore)(o.firebaseApp),e.prev=2,e.next=3,(0,i.getDoc)((0,i.doc)(s,"sessions",r));case 3:if(u=e.sent,c=null,u.exists()&&(c=(null==(l=u.data())?void 0:l.groupId)||(null==l?void 0:l.gruppeId)||null),c){e.next=4;break}return console.error("[fetchCompletedGamesFromFirestore] No groupId found for session ".concat(r)),e.abrupt("return",[]);case 4:return h=(0,i.collection)(s,"groups",c,"jassGameSummaries",r,"completedGames"),d=(0,i.query)(h,(0,i.orderBy)("gameNumber","asc")),e.next=5,(0,i.getDocs)(d);case 5:if(!(f=e.sent).empty){e.next=6;break}return e.abrupt("return",[]);case 6:return p=[],f.forEach(function(e){p.push(e.data())}),e.abrupt("return",p);case 7:return e.prev=7,g=e.catch(2),console.error("[GameService] Error fetching completed games for session ".concat(r,":"),g),a.useUIStore.getState().showNotification({type:"error",message:"Fehler beim Laden der abgeschlossenen Spiele."}),e.abrupt("return",[]);case 8:case"end":return e.stop()}},e,null,[[2,7]])}));return function(r,n){return e.apply(this,arguments)}}(),O=function(e,r){if(!e)return console.error("[GameService] loadCompletedGamesFromFirestore aufgerufen ohne sessionId."),function(){};var n,a=(0,i.getFirestore)(o.firebaseApp),s=function(){};return(n=b(m().mark(function n(){var o,u,c,l,h,d;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=1,(0,i.getDoc)((0,i.doc)(a,"sessions",e));case 1:if(o=n.sent,u=null,o.exists()&&(u=(null==(c=o.data())?void 0:c.groupId)||(null==c?void 0:c.gruppeId)||null),u){n.next=2;break}return console.error("[loadCompletedGamesFromFirestore] No groupId found for session ".concat(e)),r([]),n.abrupt("return");case 2:l=(0,i.collection)(a,"groups",u,"jassGameSummaries",e,"completedGames"),h=(0,i.query)(l,(0,i.orderBy)("gameNumber","asc")),s=(0,i.onSnapshot)(h,function(e){var n=[];e.forEach(function(e){var r=e.data();r&&n.push(r)}),r(n)},function(n){console.error("[GameService] Fehler beim Laden der abgeschlossenen Spiele f\xfcr Session ".concat(e,":"),n),r([])}),n.next=4;break;case 3:n.prev=3,d=n.catch(0),console.error("[GameService] Fehler beim Setup des CompletedGames Listeners f\xfcr Session ".concat(e,":"),d),r([]);case 4:case"end":return n.stop()}},n,null,[[0,3]])})),function(){return n.apply(this,arguments)})(),function(){return s()}},C=function(e,r){if(!e)return console.warn("[GameService] subscribeToCompletedGames called without sessionId."),function(){};var n,s=(0,i.getFirestore)(o.firebaseApp),u=function(){};return(n=b(m().mark(function n(){var o,c,l,h,d,f;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=1,(0,i.getDoc)((0,i.doc)(s,"sessions",e));case 1:if(o=n.sent,c=null,o.exists()&&(c=(null==(l=o.data())?void 0:l.groupId)||(null==l?void 0:l.gruppeId)||null),c){n.next=2;break}return console.error("[subscribeToCompletedGames] No groupId found for session ".concat(e)),r([]),n.abrupt("return");case 2:h=(0,i.collection)(s,"groups",c,"jassGameSummaries",e,"completedGames"),d=(0,i.query)(h,(0,i.orderBy)("gameNumber","asc")),u=(0,i.onSnapshot)(d,function(n){var i=[];n.forEach(function(e){var r=e.data();i.push(r)}),console.log("[GameService] Snapshot update: ".concat(i.length," completed games for session ").concat(e)),r(i)},function(r){console.error("[GameService] Error in completed games snapshot listener for session ".concat(e,":"),r),a.useUIStore.getState().showNotification({type:"error",message:"Fehler bei der Echtzeitaktualisierung der abgeschlossenen Spiele."})}),n.next=4;break;case 3:n.prev=3,f=n.catch(0),console.error("[GameService] Error setting up completed games listener for session ".concat(e,":"),f),a.useUIStore.getState().showNotification({type:"error",message:"Fehler beim Einrichten des Listeners f\xfcr abgeschlossene Spiele."});case 4:case"end":return n.stop()}},n,null,[[0,3]])})),function(){return n.apply(this,arguments)})(),function(){return u()}},N=function(){var e=b(m().mark(function e(r,n){var o,a,s,u,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!r||!n.length)){e.next=1;break}return console.log("[GameService] markRoundsAsInactive: Keine activeGameId oder keine zu deaktivierenden Runden."),e.abrupt("return");case 1:return e.prev=1,o=(0,i.collection)(w,"activeGames",r,"rounds"),a=(0,i.query)(o,(0,i.where)("isActive","==",!0),(0,i.where)("roundId","in",n)),e.next=2,(0,i.getDocs)(a);case 2:if(!(s=e.sent).empty){e.next=3;break}return console.log("[GameService] Keine zu deaktivierenden Runden gefunden f\xfcr IDs: ".concat(n.join(", "))),e.abrupt("return");case 3:return u=(0,i.writeBatch)(w),s.forEach(function(e){u.update(e.ref,{isActive:!1,deactivatedAt:(0,i.serverTimestamp)(),deactivationReason:"history_navigation_overwrite"}),console.log("[GameService] Markiere Runde ".concat(e.id," (roundId: ").concat(e.data().roundId,") als inaktiv"))}),e.next=4,u.commit();case 4:console.log("[GameService] ".concat(s.size," Runden erfolgreich als inaktiv markiert")),e.next=6;break;case 5:throw e.prev=5,console.error("[GameService] Fehler beim Deaktivieren der Runden:",c=e.catch(1)),c;case 6:case"end":return e.stop()}},e,null,[[1,5]])}));return function(r,n){return e.apply(this,arguments)}}(),L=function(){var e=b(m().mark(function e(r,n){var o,a,s,u,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!r||!n.length)){e.next=1;break}return console.log("[GameService] markRoundsAsActive: Keine activeGameId oder keine zu aktivierenden Runden."),e.abrupt("return");case 1:return console.log("[GameService] Aktiviere ".concat(n.length," Runden f\xfcr Spiel ").concat(r,": ").concat(n.join(", "))),e.prev=2,o=(0,i.collection)(w,"activeGames",r,"rounds"),a=(0,i.query)(o,(0,i.where)("roundId","in",n)),e.next=3,(0,i.getDocs)(a);case 3:if(!(s=e.sent).empty){e.next=4;break}return console.log("[GameService] Keine zu aktivierenden Runden gefunden f\xfcr IDs: ".concat(n.join(", "))),e.abrupt("return");case 4:return u=(0,i.writeBatch)(w),s.forEach(function(e){u.update(e.ref,{isActive:!0,reactivatedAt:(0,i.serverTimestamp)(),deactivationReason:null}),console.log("[GameService] Markiere Runde ".concat(e.id," (roundId: ").concat(e.data().roundId,") als aktiv"))}),e.next=5,u.commit();case 5:console.log("[GameService] ".concat(s.size," Runden erfolgreich als aktiv markiert")),e.next=7;break;case 6:throw e.prev=6,console.error("[GameService] Fehler beim Aktivieren der Runden:",c=e.catch(2)),c;case 7:case"end":return e.stop()}},e,null,[[2,6]])}));return function(r,n){return e.apply(this,arguments)}}(),D=function(){var e=b(m().mark(function e(r,n){var o,a,s,u,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.log("[GameService] markAllFollowingRoundsAsInactive: Keine activeGameId."),e.abrupt("return");case 1:return e.prev=1,o=(0,i.collection)(w,"activeGames",r,"rounds"),a=(0,i.query)(o,(0,i.where)("isActive","==",!0),(0,i.where)("roundId",">",n)),e.next=2,(0,i.getDocs)(a);case 2:if(!(s=e.sent).empty){e.next=3;break}return console.log("[GameService] Keine aktiven zu deaktivierenden Runden mit h\xf6herer ID als ".concat(n," gefunden.")),e.abrupt("return");case 3:return u=(0,i.writeBatch)(w),s.forEach(function(e){u.update(e.ref,{isActive:!1,deactivatedAt:(0,i.serverTimestamp)(),deactivationReason:"history_overwrite"}),console.log("[GameService] Markiere Runde ".concat(e.id," (roundId: ").concat(e.data().roundId,") als inaktiv durch History-\xdcberschreibung"))}),e.next=4,u.commit();case 4:console.log("[GameService] ".concat(s.size," Runden mit h\xf6herer ID erfolgreich als inaktiv markiert")),e.next=6;break;case 5:throw e.prev=5,console.error("[GameService] Fehler beim Deaktivieren der Runden mit h\xf6herer ID:",c=e.catch(1)),c;case 6:case"end":return e.stop()}},e,null,[[1,5]])}));return function(r,n){return e.apply(this,arguments)}}(),R=function(){var e=b(m().mark(function e(r){var n,s,u,c,l,h,d,f,p;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[Cleanup] cleanupDuplicateCompletedGames ohne sessionId aufgerufen."),e.abrupt("return");case 1:return console.log("[Cleanup] Starte Bereinigung f\xfcr Session ".concat(r,"...")),n=(0,i.getFirestore)(o.firebaseApp),e.prev=2,e.next=3,(0,i.getDoc)((0,i.doc)(n,"sessions",r));case 3:if(s=e.sent,u=null,s.exists()&&(u=(null==(c=s.data())?void 0:c.groupId)||(null==c?void 0:c.gruppeId)||null),u){e.next=4;break}return console.error("[cleanupDuplicateCompletedGames] No groupId found for session ".concat(r)),e.abrupt("return");case 4:return l=(0,i.collection)(n,"groups",u,"jassGameSummaries",r,"completedGames"),e.next=5,(0,i.getDocs)(l);case 5:if(!(h=e.sent).empty){e.next=6;break}return console.log("[Cleanup] Keine abgeschlossenen Spiele in Session ".concat(r," gefunden.")),e.abrupt("return");case 6:if(d=(0,i.writeBatch)(n),f=0,h.forEach(function(e){var n=e.id;n.startsWith("game_")&&!isNaN(parseInt(n.substring(5)))&&(console.log("[Cleanup] Markiere fehlerhaftes Dokument zur L\xf6schung: ".concat(r,"/completedGames/").concat(n)),d.delete(e.ref),f++)}),!(f>0)){e.next=8;break}return e.next=7,d.commit();case 7:e.next=8;break;case 8:e.next=10;break;case 9:e.prev=9,p=e.catch(2),console.error("[Cleanup] Fehler beim Bereinigen der Session ".concat(r,":"),p),a.useUIStore.getState().showNotification({type:"error",message:"Fehler bei der Bereinigung alter Spieldaten.",duration:5e3});case 10:case"end":return e.stop()}},e,null,[[2,9]])}));return function(r){return e.apply(this,arguments)}}(),j=function(){var e=b(m().mark(function e(r){var n,o,u,l,h,d,f,p,g,v,b,S;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d=(0,i.collection)(w,"activeGames"),p=(f=(0,i.doc)(d)).id,g=s.useTimerStore.getState().jassStartTime,v=y(y({},r),{},{activeGameId:p,status:"live",createdAt:(0,i.serverTimestamp)(),lastUpdated:(0,i.serverTimestamp)(),jassStartTime:g?i.Timestamp.fromMillis(g):(0,i.serverTimestamp)(),gameStartTime:g?i.Timestamp.fromMillis(g):(0,i.serverTimestamp)(),scores:null!=(n=r.scores)?n:{top:0,bottom:0},striche:null!=(o=r.striche)?o:{top:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},bottom:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},weisPoints:null!=(u=r.weisPoints)?u:{top:0,bottom:0},currentRound:null!=(l=r.currentRound)?l:1,currentRoundWeis:null!=(h=r.currentRoundWeis)?h:[]}),e.prev=1,b=(0,c.g)(v),e.next=2,(0,i.setDoc)(f,b);case 2:return e.abrupt("return",p);case 3:throw e.prev=3,console.error("[GameService] Error creating NEW active game document: ",S=e.catch(1)),a.useUIStore.getState().showNotification({type:"error",message:"Fehler beim Erstellen des neuen Online-Spiels."}),S;case 4:case"end":return e.stop()}},e,null,[[1,3]])}));return function(r){return e.apply(this,arguments)}}(),F=function(){var e=b(m().mark(function e(r,n){var o,a,s;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] updateSessionActiveGameId called without sessionId."),e.abrupt("return");case 1:return o=(0,i.doc)(w,"sessions",r),e.prev=2,a=(0,c.g)({currentActiveGameId:n,lastUpdated:(0,i.serverTimestamp)()}),e.next=3,(0,i.updateDoc)(o,a);case 3:e.next=5;break;case 4:throw e.prev=4,s=e.catch(2),console.error("[GameService] Error updating session ".concat(r," with activeGameId ").concat(n,": "),s),s;case 5:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r,n){return e.apply(this,arguments)}}(),U=function(){var e=b(m().mark(function e(r,n){var o,a,s,u,l,h,d;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] createSessionDocument called without sessionId."),e.abrupt("return");case 1:if(o=(0,i.doc)(w,"sessions",r),e.prev=2,!(null!=(a=n.participantPlayerIds)&&a.length)){e.next=3;break}h=n.participantPlayerIds,e.next=5;break;case 3:return e.next=4,function(e){return M.apply(this,arguments)}(n.participantUids);case 4:h=e.sent;case 5:return u=h,l=(0,c.g)(y(y({},n),{},{participantUids:n.participantUids||[],participantPlayerIds:u||[],startedAt:(0,i.serverTimestamp)(),lastUpdated:(0,i.serverTimestamp)(),currentActiveGameId:null,notes:"",createdBy:(null==(s=n.participantUids)?void 0:s[0])||null})),e.next=6,(0,i.setDoc)(o,l);case 6:e.next=8;break;case 7:throw e.prev=7,d=e.catch(2),console.error("[GameService] Error creating session document ".concat(r,":"),d),d;case 8:case"end":return e.stop()}},e,null,[[2,7]])}));return function(r,n){return e.apply(this,arguments)}}();function M(){return(M=b(m().mark(function e(r){var n,o,a,s,u,c,l,h;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return p(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,r):void 0}}(e))){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(r),e.prev=1,o.s();case 2:if((a=o.n()).done){e.next=7;break}return s=a.value,e.prev=3,e.next=4,(0,i.getDoc)((0,i.doc)(w,"users",s));case 4:(c=e.sent).exists()&&null!=(u=c.data())&&u.playerId&&n.push(c.data().playerId),e.next=6;break;case 5:e.prev=5,l=e.catch(3),console.warn("[GameService] Could not resolve playerId for uid ".concat(s,":"),l);case 6:e.next=2;break;case 7:e.next=9;break;case 8:e.prev=8,h=e.catch(1),o.e(h);case 9:return e.prev=9,o.f(),e.finish(9);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}},e,null,[[1,8,9,10],[3,5]])}))).apply(this,arguments)}var G=function(){var e=b(m().mark(function e(r,n){var o,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] updateSessionParticipantPlayerIds called without sessionId."),e.abrupt("return");case 1:return o=(0,i.doc)(w,"sessions",r),e.prev=2,e.next=3,(0,i.updateDoc)(o,{participantPlayerIds:n,lastUpdated:(0,i.serverTimestamp)()});case 3:e.next=5;break;case 4:throw e.prev=4,a=e.catch(2),console.error("[GameService] Error updating participantPlayerIds for session ".concat(r,":"),a),a;case 5:case"end":return e.stop()}},e,null,[[2,4]])}));return function(r,n){return e.apply(this,arguments)}}(),V=function(){var e=b(m().mark(function e(r,n){var o,s,u,c,l,h,d,f,p,g,y;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] abortActiveGame called without activeGameId."),e.abrupt("return");case 1:return e.prev=1,o=(0,i.doc)(w,"activeGames",r),e.next=2,(0,i.getDoc)(o);case 2:if((s=e.sent).exists()){e.next=3;break}return console.log("[GameService] Game ".concat(r," does not exist, cleanup not needed.")),e.abrupt("return");case 3:return c=(u=s.data()).sessionId,l=u.tournamentInstanceId||(null==n?void 0:n.tournamentInstanceId),e.next=4,(0,i.updateDoc)(o,{status:"aborted",lastUpdated:(0,i.serverTimestamp)()});case 4:if(!(!(null!=n&&n.skipSessionCleanup)&&c)){e.next=12;break}if(e.prev=5,!l){e.next=7;break}return h=(0,i.doc)(w,"sessions",l),e.next=6,(0,i.updateDoc)(h,{currentActiveGameId:null,lastUpdated:(0,i.serverTimestamp)()});case 6:console.log("[GameService] Tournament session ".concat(l," cleared of activeGameId")),e.next=10;break;case 7:return d=(0,i.doc)(w,"sessions",c),e.next=8,(0,i.getDoc)(d);case 8:if(!e.sent.exists()){e.next=10;break}return e.next=9,(0,i.updateDoc)(d,{currentActiveGameId:null,lastUpdated:(0,i.serverTimestamp)()});case 9:e.next=10;break;case 10:e.next=12;break;case 11:e.prev=11,console.error("[GameService] Error clearing session reference:",e.catch(5));case 12:if(!l){e.next=18;break}return e.prev=13,f=(0,i.doc)(w,"tournaments",l),e.next=14,(0,i.getDoc)(f);case 14:if(!(p=e.sent).exists()||p.data().currentActiveGameId!==r){e.next=16;break}return e.next=15,(0,i.updateDoc)(f,{currentActiveGameId:null,updatedAt:(0,i.serverTimestamp)(),lastActivity:(0,i.serverTimestamp)()});case 15:console.log("[GameService] Tournament ".concat(l," cleared of activeGameId"));case 16:e.next=18;break;case 17:e.prev=17,console.error("[GameService] Error clearing tournament reference:",e.catch(13));case 18:if(!(c&&!l)){e.next=22;break}return e.prev=19,e.next=20,B(c);case 20:e.next=22;break;case 21:e.prev=21,g=e.catch(19),console.error("[GameService] Error during session cleanup for ".concat(c,":"),g),console.log("[GameService] Continuing with game document deletion despite session cleanup error");case 22:setTimeout(b(m().mark(function e(){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,(0,i.getDoc)(o);case 1:if(e.sent.exists()){e.next=2;break}return e.abrupt("return");case 2:return e.next=3,(0,i.deleteDoc)(o);case 3:e.next=6;break;case 4:if(e.prev=4,n=e.catch(0),console.error("[GameService] CRITICAL ERROR: Failed to delete game document ".concat(r,":"),n),!(n instanceof Error&&(n.message.includes("Missing or insufficient permissions")||n.message.includes("No document to update")))){e.next=5;break}return console.log("[GameService] Document ".concat(r," was likely already cleaned up. This is expected.")),e.abrupt("return");case 5:a.useUIStore.getState().showNotification({type:"warning",message:"Spiel wurde erfolgreich abgebrochen, aber Bereinigung ist unvollst\xe4ndig.",duration:5e3});case 6:case"end":return e.stop()}},e,null,[[0,4]])})),2e3),e.next=24;break;case 23:throw e.prev=23,y=e.catch(1),console.error("[GameService] Error aborting game ".concat(r,":"),y),Error("Fehler beim Abbrechen des Spiels: ".concat(y instanceof Error?y.message:"Unbekannter Fehler"));case 24:case"end":return e.stop()}},e,null,[[1,23],[5,11],[13,17],[19,21]])}));return function(r,n){return e.apply(this,arguments)}}(),B=function(){var e=b(m().mark(function e(r){var n,i,s,u,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=1;break}return console.warn("[GameService] cleanupAbortedSession ohne sessionId aufgerufen."),e.abrupt("return");case 1:return e.prev=1,n=(0,d.Uz)(o.firebaseApp,"europe-west1"),i=(0,d.Qg)(n,"cleanupAbortedSession"),e.next=2,i({sessionId:r});case 2:if(!(s=e.sent.data).success){e.next=3;break}a.useUIStore.getState().showNotification({type:"success",message:s.message}),e.next=4;break;case 3:throw Error("Cloud Function gab Fehler zur\xfcck");case 4:e.next=6;break;case 5:throw e.prev=5,c=e.catch(1),console.error("[GameService] Fehler beim Bereinigen der Session ".concat(r,":"),c),u="Fehler beim L\xf6schen der Session.",c instanceof Error&&(u=c.message.includes("permission-denied")?"Keine Berechtigung zum L\xf6schen dieser Session.":c.message.includes("not-found")?"Session nicht gefunden.":"Fehler beim L\xf6schen: ".concat(c.message)),a.useUIStore.getState().showNotification({type:"error",message:u,duration:5e3}),c;case 6:case"end":return e.stop()}},e,null,[[1,5]])}));return function(r){return e.apply(this,arguments)}}()}},e=>{var r=r=>e(e.s=r);e.O(0,[6593,8792],()=>(r(92),r(75181))),_N_E=e.O()}]);