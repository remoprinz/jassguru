(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8124],{900:(e,t,r)=>{"use strict";r.d(t,{j:()=>c});var n=r(88880),a=r(54573),i=["Eicheln","Rosen","Schellen","Schilten"],s={Misère:"\uD83E\uDD2E",Eicheln:"\uD83C\uDF33",Rosen:"\uD83C\uDF39",Schellen:"\uD83D\uDD14",Schilten:"\uD83D\uDEE1️",Obe:"\uD83D\uDC47",Une:"\uD83D\uDC47","3x3":"3️⃣",Quer:"↕️",Slalom:"⛷️"},o={Misère:"\uD83E\uDD2E",Eicheln:"♠️",Rosen:"♣️",Schellen:"♥️",Schilten:"♦️",Obe:"\uD83D\uDC46",Une:"\uD83D\uDC47","3x3":"3️⃣",Quer:"↕️",Slalom:"⛷️"},l={},c=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"DE",c=(0,a.Sn)(e),u="".concat(c,"-").concat(t,"-").concat(r);if(l[u])return l[u];if("emoji"===t){var d="DE"===r?s:o;return l[u]=d[e],l[u]}var f=n.S[c];if(void 0===f||void 0===f[r])return console.warn("getPictogram: Mapping f\xfcr Farbe '".concat(c,"' (Original: '").concat(e,"') oder Stil '").concat(r,"' nicht gefunden. Gebe leeren Pfad zur\xfcck.")),l[u]="","";var m=f[r].toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),p="FR"===r?"standardFR":"standardDE",h="/assets/pictograms/".concat(p,"/").concat(m,".").concat(i.includes(c)?"png":"svg");return l[u]=h,h}},6284:(e,t,r)=>{"use strict";r.d(t,{h:()=>o}),r(14232);var n=r(900),a=r(54573),i=r(88880),s=r(37876),o=function(e){var t,r,o=e.farbe,l=e.mode,c=void 0===l?"svg":l,u=e.cardStyle,d=void 0===u?"DE":u,f=e.className,m=(0,n.j)(o,c,d),p=(0,a.Sn)(o),h=null!=(t=null==(r=i.S[p])?void 0:r[d])?t:p;return m?(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 ".concat(null!=f?f:""),children:"emoji"===c?(0,s.jsx)("span",{className:"text-2xl",children:m}):(0,s.jsx)("img",{src:m,alt:h,className:"w-6 h-6 object-contain"})}):null}},8365:(e,t,r)=>{"use strict";r.d(t,{Xi:()=>y,av:()=>g,j7:()=>h,tU:()=>p});var n=r(14232),a=r(90491),i=r(53551),s=r(37876);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=["className"],c=["className"],u=["className"];function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function m(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=a.bL,h=n.forwardRef(function(e,t){var r=e.className,n=m(e,l);return(0,s.jsx)(a.B8,f({ref:t,className:(0,i.cn)("inline-flex items-center justify-center rounded-md bg-gray-800 p-1 text-gray-400",r)},n))});h.displayName=a.B8.displayName;var y=n.forwardRef(function(e,t){var r=e.className,n=m(e,c);return(0,s.jsx)(a.l9,f({ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-gray-700 data-[state=active]:text-white data-[state=active]:shadow-sm",r)},n))});y.displayName=a.l9.displayName;var g=n.forwardRef(function(e,t){var r=e.className,n=m(e,u);return(0,s.jsx)(a.UC,f({ref:t,className:(0,i.cn)("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2",r)},n))});g.displayName=a.UC.displayName},54573:(e,t,r)=>{"use strict";r.d(t,{SS:()=>l,Sn:()=>a,Yq:()=>s,Yz:()=>c,a3:()=>o,xW:()=>i});var n=r(42009);function a(e){return e?e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")}function s(e){var t;if(!e)return"-";if(e instanceof Date)t=e;else{if(!e||"number"!=typeof e.seconds)return"-";t=new n.Timestamp(e.seconds,e.nanoseconds).toDate()}return t.toLocaleDateString("de-CH")}function o(e){if(e<60)return"".concat(e,"s");var t=Math.floor(e/60),r=e%60;if(t<60)return r>0?"".concat(t,"m ").concat(r,"s"):"".concat(t,"m");var n=Math.floor(t/60),a=t%60;if(n<24)return a>0?"".concat(n,"h ").concat(a,"m"):"".concat(n,"h");var i=Math.floor(n/24),s=n%24;return s>0?"".concat(i,"d ").concat(s,"h"):"".concat(i,"d")}function l(e){return o(Math.floor(e/1e3))}function c(e){var t=e/60;return t<30?"blitz_schnell":t<75?"schnell":t<150?"normal":t<240?"gem\xfctlich":"marathon"}},66343:(e,t,r)=>{"use strict";r.d(t,{BT:()=>v,Wu:()=>b,ZB:()=>x,Zp:()=>y,aR:()=>g});var n=r(14232),a=r(53551),i=r(37876);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=["className"],l=["className"],c=["className"],u=["className"],d=["className"],f=["className"];function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var y=n.forwardRef(function(e,t){var r=e.className,n=h(e,o);return(0,i.jsx)("div",p({ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r)},n))});y.displayName="Card";var g=n.forwardRef(function(e,t){var r=e.className,n=h(e,l);return(0,i.jsx)("div",p({ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r)},n))});g.displayName="CardHeader";var x=n.forwardRef(function(e,t){var r=e.className,n=h(e,c);return(0,i.jsx)("h3",p({ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r)},n))});x.displayName="CardTitle";var v=n.forwardRef(function(e,t){var r=e.className,n=h(e,u);return(0,i.jsx)("p",p({ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r)},n))});v.displayName="CardDescription";var b=n.forwardRef(function(e,t){var r=e.className,n=h(e,d);return(0,i.jsx)("div",p({ref:t,className:(0,a.cn)("p-6 pt-0",r)},n))});b.displayName="CardContent",n.forwardRef(function(e,t){var r=e.className,n=h(e,f);return(0,i.jsx)("div",p({ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r)},n))}).displayName="CardFooter"},76520:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/view/tournament/[instanceId]",function(){return r(83656)}])},83656:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eZ});var n=r(14232),a=r(89099),i=r(54587),s=r.n(i),o=r(48101),l=r(31931),c=r(27788),u=r(94566),d=r(83872),f=r(74231),m=r(37537),p=r(95014),h=r(23803),y=r(32123),g=r(93153),x=r(52896),v=r(43050),b=r(51689),j=r(74473),w=r(46114),N=r(27284),S=r(81445),O=r(19732),P=r(42009),k=r(13848),A=r(8365),E=r(65201),T=r(89143),L=r(50582),D=r(42471),C=r(85253),U=r(53551),I=r(37876),_=function(e,t){var r,n=null==(r=e.playerDetails)?void 0:r.find(function(e){return e.playerId===t});return(null==n?void 0:n.team)||null},M=function(e){var t=e.label,r=e.value,n=e.highlight;return(0,I.jsxs)("div",{className:(0,U.cn)("text-xs px-2 py-1 rounded",n?"bg-purple-600/30 text-purple-200":"bg-gray-700/50 text-gray-300"),children:[(0,I.jsxs)("span",{className:"font-medium",children:[t,":"]})," ",r]})};let R=function(e){var t=e.playerGames,r=e.playerUid,n=e.playerName;return(void 0===e.strokeSettings&&D.zh,t&&0!==t.length)?(0,I.jsx)("div",{className:"space-y-4",children:t.map(function(e){var t,a,i=_(e,r);if(!i)return null;var s=null==(t=e.teamStrichePasse)?void 0:t[i],o=null==(a=e.teamStrichePasse)?void 0:a["top"===i?"bottom":"top"];return(0,I.jsxs)("div",{className:"bg-gray-800/60 p-3 rounded-lg shadow",children:[(0,I.jsxs)("h4",{className:"text-sm font-semibold text-purple-300 mb-2",children:["Passe ",e.passeNumber]}),(0,I.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,I.jsxs)("div",{children:[(0,I.jsxs)("p",{className:"text-xs text-gray-400 mb-1",children:["Striche f\xfcr ",n," (Team ","top"===i?"Oben":"Unten",")"]}),s?(0,I.jsxs)("div",{className:"space-y-1",children:[(0,I.jsx)(M,{label:"Berg",value:s.berg,highlight:s.berg>0}),(0,I.jsx)(M,{label:"Sieg",value:s.sieg,highlight:s.sieg>0}),(0,I.jsx)(M,{label:"Matsch",value:s.matsch,highlight:s.matsch>0}),(0,I.jsx)(M,{label:"Schneider",value:s.schneider,highlight:s.schneider>0}),(0,I.jsx)(M,{label:"Konterm.",value:s.kontermatsch,highlight:s.kontermatsch>0})]}):(0,I.jsx)("p",{className:"text-xs text-gray-500",children:"Keine Strichdaten."})]}),(0,I.jsxs)("div",{children:[(0,I.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Striche Gegnerteam"}),o?(0,I.jsxs)("div",{className:"space-y-1",children:[(0,I.jsx)(M,{label:"Berg",value:o.berg,highlight:!1}),(0,I.jsx)(M,{label:"Sieg",value:o.sieg,highlight:!1}),(0,I.jsx)(M,{label:"Matsch",value:o.matsch,highlight:!1}),(0,I.jsx)(M,{label:"Schneider",value:o.schneider,highlight:!1}),(0,I.jsx)(M,{label:"Konterm.",value:o.kontermatsch,highlight:!1})]}):(0,I.jsx)("p",{className:"text-xs text-gray-500",children:"Keine Strichdaten."})]})]})]},e.passeId)})}):(0,I.jsx)("div",{className:"text-center text-gray-400 py-8",children:"Keine Passen-Daten f\xfcr die Strich-Details verf\xfcgbar."})};var z=r(6284),G=function(e){if(e){var t=e.toLowerCase();if("mis\xe8re"===t)return"Mis\xe8re";if("eicheln"===t||"eichel"===t)return"Eicheln";if("rosen"===t||"rose"===t)return"Rosen";if("schellen"===t||"schelle"===t)return"Schellen";if("schilten"===t||"schilte"===t)return"Schilten";if("obe"===t)return"Obe";if("une"===t||"unde"===t)return"Une";if("3x3"===t)return"3x3";if("quer"===t)return"Quer";if("slalom"===t)return"Slalom";if("trumpf"===t)return"Obe";console.warn("[mapDbValueToJassColorType] Unbekannter DB-Wert: '".concat(e,"' in TournamentRoundHistoryDisplay, konnte nicht zu JassColor gemappt werden."))}},F=function(e,t){var r,n,a,i,s,o,l,c,u=null!=(r=null==(n=e.scores)?void 0:n.top)?r:0,d=null!=(a=null==(i=e.scores)?void 0:i.bottom)?a:0;return{top:u-(null!=(s=null==t||null==(o=t.scores)?void 0:o.top)?s:0),bottom:d-(null!=(l=null==t||null==(c=t.scores)?void 0:c.bottom)?l:0)}},B=function(e){return"jass"===e.actionType&&!0===e.isRoundFinalized&&"number"==typeof e.startingPlayer&&("string"==typeof e.farbe&&e.farbe.length>0||void 0===e.farbe)&&(void 0===e.isActive||!0===e.isActive)},K=function(e){var t,r=e.passe,a=(e.globalPlayerNames,e.cardStyle),i=(e.playerPhotoUrlMapping,e.focusedPlayerId),s=null!=(t=r.roundHistory)?t:[],o=(0,n.useMemo)(function(){var e="Team Oben",t="Team Unten",n=null;if(r.playerDetails&&r.playerDetails.length>0){var a=[],s=[];r.playerDetails.forEach(function(e){e.playerId===i&&(n=e.team),"top"===e.team&&e.playerName?a.push(e.playerName):"bottom"===e.team&&e.playerName&&s.push(e.playerName)}),a.length>0&&(e=a.join(" & ")),s.length>0&&(t=s.join(" & "))}return{teamTopDisplay:e,teamBottomDisplay:t,playerTeam:n}},[r.playerDetails,i]),l=o.teamTopDisplay,c=o.teamBottomDisplay,u=o.playerTeam,d=s.filter(B);return d.sort(function(e,t){var r,n;return((null==(r=e.roundState)?void 0:r.roundNumber)||0)-((null==(n=t.roundState)?void 0:n.roundNumber)||0)}),(0,I.jsxs)("div",{className:"pt-3 pb-2 bg-gray-800/50 rounded-lg mb-3",children:[(0,I.jsxs)("div",{className:"px-3 mb-2 border-b border-gray-700 pb-2",children:[(0,I.jsxs)("h3",{className:"text-md font-semibold text-purple-300",children:["Passe ",r.passeNumber]}),(0,I.jsxs)("div",{className:"text-xs text-gray-400",children:[(0,I.jsxs)("span",{className:i&&"top"===u?"font-bold text-white":"",children:["Team Oben: ",l]}),(0,I.jsx)("br",{}),(0,I.jsxs)("span",{className:i&&"bottom"===u?"font-bold text-white":"",children:["Team Unten: ",c]})]})]}),d.length>0?(0,I.jsx)("div",{className:"space-y-0 px-2",children:d.map(function(e,t){var r,n,s,o,l,c=F(e,t>0?d[t-1]:void 0),f=null!=(r=e.jassPoints)?r:c,m=null!=(n=e.weisPoints)?n:{top:0,bottom:0};m.top>0||m.bottom;var p=void 0===(l=e.startingPlayer)?null:1===l||3===l?"bottom":2===l||4===l?"top":null,h=G(e.farbe),y=(null==(s=e.strichInfo)?void 0:s.type)==="matsch",g=(null==(o=e.strichInfo)?void 0:o.type)==="kontermatsch",x=i&&u===p;return(0,I.jsxs)("div",{className:"grid grid-cols-[auto_1fr_1fr] gap-x-2 items-center text-xs py-0.5 hover:bg-gray-700/30 rounded px-1",children:[(0,I.jsxs)("div",{className:"text-center font-medium text-gray-400 w-6",children:["R",t+1]}),(0,I.jsx)("div",{className:"text-left ".concat("bottom"===p?"font-bold text-white":"text-gray-400"," ").concat(x&&"bottom"===p?"ring-1 ring-purple-400 rounded px-0.5":""," truncate"),children:(0,I.jsxs)("span",{className:"inline-flex items-center",children:["bottom"===p&&h&&(0,I.jsx)(z.h,{farbe:h,cardStyle:a,className:"w-3 h-3 mr-1"}),(0,I.jsx)("span",{className:y?"text-purple-400":g?"text-red-400":"",children:f.bottom})]})}),(0,I.jsx)("div",{className:"text-right ".concat("top"===p?"font-bold text-white":"text-gray-400"," ").concat(x&&"top"===p?"ring-1 ring-purple-400 rounded px-0.5":""," truncate"),children:(0,I.jsxs)("span",{className:"inline-flex items-center justify-end",children:[(0,I.jsx)("span",{className:y?"text-purple-400":g?"text-red-400":"",children:f.top}),"top"===p&&h&&(0,I.jsx)(z.h,{farbe:h,cardStyle:a,className:"w-3 h-3 ml-1"})]})})]},"runde-".concat(e.roundId||t))})}):(0,I.jsx)("p",{className:"text-xs text-gray-500 text-center px-3 py-2",children:"Keine abgeschlossenen Runden f\xfcr diese Passe."})]})},$=function(e){var t=e.tournamentGames,r=e.playerNames,n=e.cardStyle,a=e.playerPhotoUrlMapping,i=e.focusedPlayerId;return t&&0!==t.length?(0,I.jsx)("div",{className:"flex flex-col w-full space-y-4 min-w-max",children:t.map(function(e,t){return(0,I.jsx)(K,{passe:e,globalPlayerNames:r,cardStyle:n,playerPhotoUrlMapping:a,focusedPlayerId:i},"passe-details-".concat(e.passeId||t))})}):(0,I.jsx)("div",{className:"text-center text-gray-400 py-8",children:"Keine Passen-Daten f\xfcr die Rundenhistorie verf\xfcgbar."})},H=r(85490),V=r(31715),W=r(33615);function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach(function(t){Y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Y(e,t,r){var n;return(n=function(e,t){if("object"!=X(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=X(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==X(n)?n:n+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Q=[{id:"player_passe_details",displayName:"Passen-Details",component:$,icon:H.A},{id:"player_striche_history",displayName:"Striche-Verlauf",component:R,icon:V.A}];let ee=function(e){var t,r,a=e.tournamentGames,i=e.playerUid,s=e.playerName,o=e.playerPhotoUrl,l=e.strokeSettings,c=(e.scoreSettings,e.cardStyle),u=void 0===c?C.FT.cardStyle:c,d=function(e){if(Array.isArray(e))return e}(t=(0,n.useState)(null==(r=Q[0])?void 0:r.id))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{i=(r=r.call(e)).next,!1;for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(t,2)||function(e,t){if(e){if("string"==typeof e)return J(e,2);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(e,t):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),f=d[0],m=d[1],p=(0,n.useMemo)(function(){return a.filter(function(e){var t;return null==(t=e.participantUidsForPasse)?void 0:t.includes(i)})},[a,i]),h=(0,n.useMemo)(function(){return p.length>0?p[p.length-1]:null},[p]);(0,n.useMemo)(function(){return h&&"number"==typeof h.passeNumber?h.passeNumber:p.length},[h,p.length]);var y=(0,n.useMemo)(function(){h&&h.completedAt&&(e=h.completedAt);var e,t=e instanceof P.Timestamp?e.toMillis():e instanceof Date?e.getTime():"number"==typeof e?e:Date.now();return(0,O.GP)(new Date(t),"d.M.yyyy")},[h]),g=null!=l?l:D.zh,x=(0,n.useCallback)(function(e){var t,r=Q.findIndex(function(e){return e.id===f});t="right"===e?(r+1)%Q.length:(r-1+Q.length)%Q.length,m(Q[t].id)},[f]),v=(0,L.uh)({onSwipedLeft:function(){return x("right")},onSwipedRight:function(){return x("left")},preventScrollOnSwipe:!0,trackMouse:!0,touchEventOptions:{passive:!1}}),b=(0,T.zh)({from:{opacity:0,transform:"translateX(20px)"},to:{opacity:1,transform:"translateX(0px)"},key:f,config:{tension:280,friction:25}}),j=Q.find(function(e){return e.id===f}),w=null==j?void 0:j.component,N=null==j?void 0:j.displayName,S=(0,n.useMemo)(function(){if(!h||!h.playerDetails)return null;var e={};h.playerDetails.forEach(function(t){t.seat&&t.playerName&&(e[t.seat]=t.playerName)});for(var t=1;t<=4;t++)e[t]||(e[t]="Spieler ".concat(t));return e},[h]);return(0,I.jsxs)("div",{className:"bg-gray-800 text-white shadow-xl rounded-lg overflow-hidden w-full mx-auto my-4",children:[(0,I.jsxs)("div",{className:"p-3 bg-gray-750",children:[(0,I.jsxs)("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[(0,I.jsx)("span",{children:p.length>0?"".concat(p.length," ").concat(1===p.length?"Passe":"Passen"," gespielt"):"Keine Passen gespielt"}),h&&(0,I.jsxs)("span",{children:["Letzte am: ",y]})]}),(0,I.jsx)("div",{className:"mt-1 text-center",children:(0,I.jsxs)("h2",{className:"text-lg font-semibold text-white flex items-center justify-center",children:[(0,I.jsx)(W.A,{size:20,className:"mr-2 text-purple-400"})," Passen\xfcbersicht f\xfcr ",s]})})]}),(0,I.jsxs)("div",{className:"flex justify-between items-center px-2 py-1 bg-gray-750",children:[(0,I.jsx)("button",{onClick:function(){return x("left")},className:"p-1 text-gray-400 hover:text-white transition-colors rounded-md","aria-label":"Vorherige Statistik",disabled:Q.length<=1,children:"<"}),(0,I.jsx)("span",{className:"text-sm font-medium text-gray-300",children:null!=N?N:"Statistik"}),(0,I.jsx)("button",{onClick:function(){return x("right")},className:"p-1 text-gray-400 hover:text-white transition-colors rounded-md","aria-label":"N\xe4chste Statistik",disabled:Q.length<=1,children:">"})]}),(0,I.jsx)("div",q(q({},v),{},{className:"overflow-hidden relative min-h-[200px]",children:w&&j&&p.length>0?(0,I.jsx)(T.CS.div,{style:b,className:"p-3",children:"player_striche_history"===j.id?(0,I.jsx)(R,{playerGames:p,playerUid:i,playerName:s,strokeSettings:g}):"player_passe_details"===j.id&&S?(0,I.jsx)($,{tournamentGames:p,playerNames:S,playerPhotoUrlMapping:o?Y({},i,o):{},cardStyle:u,focusedPlayerId:i}):(0,I.jsx)("div",{className:"p-3 text-center text-gray-500",children:"Statistik-Modul nicht anwendbar oder Daten fehlen."})}):0===p.length?(0,I.jsx)("div",{className:"p-3 text-center text-gray-500",children:"Dieser Spieler hat noch an keiner Passe teilgenommen."}):(0,I.jsx)("div",{className:"p-3 text-center text-gray-500",children:"Statistik-Modul nicht gefunden oder nicht konfiguriert."})}))]})};var et=r(35593),er=r(66343),en=r(73246),ea=r(57346);function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function es(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?es(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!=ei(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ei(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ei(t)?t:t+""}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):es(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let el=function(e){var t=e.participants,r=e.tournamentAdminId,a=e.onParticipantClick,i=e.tournamentGames;if(!t||0===t.length)return(0,I.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Keine Teilnehmer f\xfcr dieses Turnier gefunden oder Teilnehmerdaten werden noch geladen."});var o=(0,n.useMemo)(function(){return i&&0!==i.length?t.map(function(e){var t=i.filter(function(t){var r;return t.completedAt&&(null==(r=t.playerDetails)?void 0:r.some(function(t){return t.playerId===e.uid||t.playerName===e.displayName}))}).length;return eo(eo({},e),{},{completedPassesCount:t})}):t},[t,i]),l=function(e){a?a(e):console.log("Participant clicked, but no onParticipantClick handler provided. UID:",e.uid)};return(0,I.jsx)("div",{className:"p-0 md:p-4",children:(0,I.jsxs)(er.Zp,{className:"bg-gray-800/70 border-gray-700/50 shadow-lg",children:[(0,I.jsx)(er.aR,{className:"pb-3 pt-4 px-4 md:px-5",children:(0,I.jsxs)(er.ZB,{className:"text-lg text-white",children:["Teilnehmer (",o.length,")"]})}),(0,I.jsx)(er.Wu,{className:"space-y-3 px-2 py-2 md:px-4 md:pb-4 max-h-[400px] overflow-y-auto",children:o.map(function(e){var t,n=e.uid;return(0,I.jsx)("div",{onClick:function(){return l(e)},className:"block rounded-md ".concat(n?"cursor-pointer":"cursor-default"," bg-gray-700/40 hover:bg-gray-700/70 transition-colors duration-150 relative"),children:(0,I.jsxs)("div",{className:"flex items-center justify-between p-2.5",children:[(0,I.jsxs)("div",{className:"flex items-center space-x-3 min-w-0",children:[(0,I.jsx)(en.eu,{className:"h-10 w-10 mr-3",children:e.photoURL?(0,I.jsx)(s(),{src:e.photoURL,alt:e.displayName||"Teilnehmer",width:40,height:40,className:"rounded-full object-cover"}):(0,I.jsx)(en.q5,{className:"bg-gray-700 text-gray-300",children:(null==(t=e.displayName)?void 0:t.charAt(0).toUpperCase())||"?"})}),(0,I.jsxs)("div",{className:"min-w-0",children:[(0,I.jsx)("p",{className:"text-sm font-medium text-white truncate",title:e.displayName||"Unbekannter Spieler",children:e.displayName||"Unbekannter Spieler"}),e.uid===r&&(0,I.jsxs)("span",{className:"text-xs text-purple-400 flex items-center",children:[(0,I.jsx)(ea.A,{className:"w-3 h-3 mr-1"}),"Turnier-Admin"]}),(0,I.jsxs)("span",{className:"text-sm text-gray-400",children:[e.completedPassesCount," ",1===e.completedPassesCount?"Passe":"Passen"," abgeschlossen"]})]})]}),n&&(0,I.jsx)("div",{className:"text-gray-400 group-hover:text-white flex items-center text-xs pr-1"})]})},n||"player-".concat(e.displayName))})})]})})};var ec=r(27212),eu=r(23355),ed=r(79388),ef=r(28443);function em(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ep(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ep(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ep(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var eh=function(e){var t=e.trigger,r=e.participants,a=e.currentSelection,i=e.targetSlot,s=e.onSelectParticipant,o=em((0,n.useState)(!1),2),l=o[0],c=o[1],u=em((0,n.useState)([]),2),d=(u[0],u[1]);(0,n.useEffect)(function(){r&&d(r)},[r]);var f=function(e){s(i,e),c(!1)},m=Object.values(a).filter(function(e){return!!e}).filter(function(e){return"member"===e.type}).map(function(e){return e.uid}),p=r.filter(function(e){return!m.includes(e.uid||"")});return(0,I.jsxs)(ed.AM,{open:l,onOpenChange:c,children:[(0,I.jsx)(ed.Wv,{asChild:!0,children:t}),(0,I.jsx)(ed.hl,{className:"p-0 w-72",align:"start",children:(0,I.jsx)("div",{className:"max-h-80 overflow-auto",children:(0,I.jsxs)("div",{className:"p-4 space-y-2",children:[(0,I.jsx)("h4",{className:"text-sm font-medium leading-none",children:"Teilnehmer ausw\xe4hlen"}),(0,I.jsxs)("p",{className:"text-sm text-gray-500",children:["W\xe4hle einen Spieler f\xfcr Position ",i,"."]}),0===p.length&&(0,I.jsx)("p",{className:"text-sm text-gray-500",children:"Keine weiteren Teilnehmer verf\xfcgbar."}),(0,I.jsx)("div",{className:"space-y-2 mt-2",children:p.map(function(e){var t;return(0,I.jsxs)("div",{onClick:function(){return f(e)},className:(0,U.cn)("flex items-center px-2 py-2 rounded-md hover:bg-gray-100 cursor-pointer"),children:[(0,I.jsx)(ef.A,{src:e.photoURL||void 0,alt:e.displayName||"",size:"sm",className:"mr-2 flex-shrink-0",fallbackClassName:"bg-gray-600 text-gray-300 text-xs",fallbackText:(null==(t=e.displayName)?void 0:t.substring(0,2).toUpperCase())||"??"}),(0,I.jsx)("div",{className:"flex-grow",children:(0,I.jsx)("p",{className:"text-sm",children:e.displayName||"Unbekannt"})})]},e.uid)})})]})})})]})},ey=r(23513);function eg(e){return(eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ex(){ex=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(t,r,n,i){var s,o,l,c,u=Object.create((r&&r.prototype instanceof y?r:y).prototype);return a(u,"_invoke",{value:(s=t,o=n,l=new k(i||[]),c=f,function(t,r){if(c===m)throw Error("Generator is already running");if(c===p){if("throw"===t)throw r;return{value:e,done:!0}}for(l.method=t,l.arg=r;;){var n=l.delegate;if(n){var a=function t(r,n){var a=n.method,i=r.iterator[a];if(i===e)return n.delegate=null,"throw"===a&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+a+"' method")),h;var s=d(i,r.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,h;var o=s.arg;return o?o.done?(n[r.resultName]=o.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):o:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,h)}(n,l);if(a){if(a===h)continue;return a}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if(c===f)throw c=p,l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);c=m;var i=d(s,o,l);if("normal"===i.type){if(c=l.done?p:"suspendedYield",i.arg===h)continue;return{value:i.arg,done:l.done}}"throw"===i.type&&(c=p,l.method="throw",l.arg=i.arg)}})}),u}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function y(){}function g(){}function x(){}var v={};c(v,s,function(){return this});var b=Object.getPrototypeOf,j=b&&b(b(A([])));j&&j!==r&&n.call(j,s)&&(v=j);var w=x.prototype=y.prototype=Object.create(v);function N(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){var r;a(this,"_invoke",{value:function(a,i){function s(){return new t(function(r,s){!function r(a,i,s,o){var l=d(e[a],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==eg(u)&&n.call(u,"__await")?t.resolve(u.__await).then(function(e){r("next",e,s,o)},function(e){r("throw",e,s,o)}):t.resolve(u).then(function(e){c.value=e,s(c)},function(e){return r("throw",e,s,o)})}o(l.arg)}(a,i,r,s)})}return r=r?r.then(s,s):s()}})}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw TypeError(eg(t)+" is not iterable")}return g.prototype=x,a(w,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:g,configurable:!0}),g.displayName=c(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},N(S.prototype),c(S.prototype,o,function(){return this}),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new S(u(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},N(w),c(w,l,"Generator"),c(w,s,function(){return this}),c(w,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;P(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),h}},t}function ev(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function eb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ej(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eb(Object(r),!0).forEach(function(t){ew(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eb(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ew(e,t,r){var n;return(n=function(e,t){if("object"!=eg(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=eg(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==eg(n)?n:n+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eS(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?eS(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eS(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var eO={initial:{opacity:0,scale:.95},visible:{opacity:1,scale:1},exit:{opacity:0,scale:.95}};let eP=function(e){var t,r,a=e.isVisible,i=e.onClose,s=e.tournamentId,l=e.tournamentParticipants,d=e.currentPasseNumber,f=e.onPasseStarted,h=e.members,y=void 0===h?[]:h,g=(0,c.useAuthStore)().user,v=(0,o.yu)(function(e){return e.startNewPasse}),b=(0,u.useUIStore)(function(e){return e.showNotification}),j=eN((0,n.useState)({1:null,2:null,3:null,4:null}),2),w=j[0],N=j[1],S=eN((0,n.useState)(null),2),O=S[0],P=S[1],k=eN((0,n.useState)(!1),2),A=k[0],E=k[1],T=eN((0,n.useState)(!1),2),L=T[0],D=T[1],C=eN((0,n.useState)(null),2),U=C[0],_=C[1],M=eN((0,n.useState)(!1),2),R=M[0],z=M[1];(0,n.useEffect)(function(){a||(N({1:null,2:null,3:null,4:null}),P(null),E(!1),D(!1),_(null),z(!1))},[a]),(0,n.useEffect)(function(){if(null!=g&&g.uid){console.log("[TournamentStartScreen] Pr\xfcfe Teilnahme:",{userUid:g.uid,selectedPlayers:Object.values(w).map(function(e){return(null==e?void 0:e.type)==="member"?{uid:e.uid,name:e.name}:null}).filter(Boolean)});var e=Object.values(w).some(function(e){var t=(null==e?void 0:e.type)==="member"&&e.uid&&e.uid.toString()===g.uid.toString();return t&&console.log("[TournamentStartScreen] Benutzer ".concat(g.uid," nimmt an Passe teil als ").concat(e.name)),t});z(e),console.log("[TournamentStartScreen] isCurrentUserInSelectedPasse gesetzt auf: ".concat(e))}else z(!1),console.log("[TournamentStartScreen] Kein Benutzer angemeldet, isCurrentUserInSelectedPasse = false")},[w,g]);var G=function(e,t){if(!t.uid)return void b({type:"error",message:"Fehler bei der Spielerauswahl: Spieler-ID fehlt."});var r=Number(e),n=Object.values(w).some(function(e){return(null==e?void 0:e.type)==="member"&&e.uid===t.uid}),a=w[r];if(n&&((null==a?void 0:a.type)!=="member"||a.uid!==t.uid))return void b({type:"warning",message:"Dieser Spieler ist bereits einem anderen Slot zugewiesen."});N(function(e){return ej(ej({},e),{},ew({},r,{type:"member",uid:t.uid,name:t.displayName||"Spieler ".concat(r)}))})},F=function(e){var t=Number(e);N(function(e){return ej(ej({},e),{},ew({},t,null))}),O===t&&(P(null),E(!1))},B=function(){return Object.values(w).every(function(e){return null!==e})},K=function(e){B()&&(P(Number(e)),E(!0))},$=function(e){var t=Number(e),r=B(),n=A&&r&&O===t,a=1===t||3===t,i=w[t],s="relative w-full p-3 pl-4 pr-10 outline-none border-l-4 transition-all duration-150 rounded-xl text-white text-left ".concat(a?"bg-gray-500":"bg-gray-700"," ").concat(a?"border-l-yellow-400":"border-l-blue-400");return n?s+=" border-yellow-500 ring-2 ring-yellow-500":s+=" border-gray-600",r?s+=" ".concat(a?"hover:bg-gray-600":"hover:bg-gray-800"," cursor-pointer"):i||(s+=" text-gray-400 italic cursor-pointer"),s},H=(t=ex().mark(function e(){var t,r,n;return ex().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(B()){e.next=1;break}return b({type:"warning",message:"Alle Spielerpositionen m\xfcssen besetzt sein, um das Spiel starten zu k\xf6nnen."}),e.abrupt("return");case 1:if(!(!A||null===O)){e.next=2;break}return b({type:"warning",message:"Bitte w\xe4hle einen Startspieler aus (auf einen Spieler klicken)."}),e.abrupt("return");case 2:if(console.log("[TournamentStartScreen] Start-Check:",{isCurrentUserInSelectedPasse:R,userUid:null==g?void 0:g.uid}),R){e.next=3;break}return b({type:"error",message:"Nur Spieler, die an dieser Passe teilnehmen, d\xfcrfen sie starten.",preventClose:!0,actions:[{label:"Verstanden",onClick:function(){}}]}),e.abrupt("return");case 3:return D(!0),_(null),e.prev=4,t=Object.entries(w).filter(function(e){var t=eN(e,2);return null!==(t[0],t[1])}).map(function(e){var t=eN(e,2),r=t[0],n=t[1];if(!n||"member"!==n.type)throw Error("Ung\xfcltiger Spieler in Slot ".concat(r));var a=l.find(function(e){return e.uid===n.uid});if(!a)throw Error("Teilnehmer mit uid ".concat(n.uid," wurde nicht gefunden"));return{uid:n.uid,name:n.name,playerNumber:Number(r),completedPassesCount:a.completedPassesCount||0,photoURL:a.photoURL}}),e.next=5,v(s,t,O);case 5:r=e.sent,f&&r&&f(r),i(),e.next=7;break;case 6:e.prev=6,console.error("Fehler beim Starten des Spiels:",n=e.catch(4)),_("Fehler beim Starten des Spiels: ".concat(n instanceof Error?n.message:"Unbekannter Fehler"));case 7:return e.prev=7,D(!1),e.finish(7);case 8:case"end":return e.stop()}},e,null,[[4,6,7,8]])}),r=function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function s(e){ev(i,n,a,s,o,"next",e)}function o(e){ev(i,n,a,s,o,"throw",e)}s(void 0)})},function(){return r.apply(this,arguments)});return a?L?(0,I.jsx)(ey.A,{message:"Passe wird gestartet..."}):(0,I.jsx)(ec.N,{children:a&&(0,I.jsx)(eu.P.div,{className:"fixed inset-0 flex flex-col items-center justify-center bg-gray-900 bg-opacity-95 z-50 p-4 overflow-y-auto",initial:"initial",animate:"visible",exit:"exit",variants:eO,transition:{duration:.2,ease:"easeInOut"},children:(0,I.jsxs)("div",{className:"relative bg-gray-800 bg-opacity-95 rounded-xl p-6 w-full max-w-xs space-y-6 shadow-lg text-center max-h-[95vh] overflow-y-auto",children:[(0,I.jsx)(m.$,{variant:"ghost",size:"icon",onClick:i,className:"absolute top-3 right-3 text-gray-400 hover:text-white transition-colors z-10","aria-label":"Schliessen",children:(0,I.jsx)(x.A,{size:24})}),(0,I.jsx)("h2",{className:"text-2xl font-bold ".concat(B()?"text-yellow-400":"text-white"," text-center mb-0"),children:B()?"Startspieler w\xe4hlen":"Passe starten"}),(0,I.jsx)("h3",{className:"text-lg font-semibold text-white pt-0",children:"Sitzreihenfolge:"}),(0,I.jsx)("div",{className:"space-y-4",children:Object.keys(w).map(function(e){var t,r=Number(e),n=w[r],a=(t=1===r||3===r?"Team 1":"Team 2","Spieler ".concat(r," (").concat(t,") w\xe4hlen...")),i=(0,I.jsx)("div",{onClick:function(){return K(r)},className:$(r),children:n?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:"flex items-center",children:[(0,I.jsx)(ef.A,{src:function(){if("member"===n.type){var e=y.find(function(e){return e.displayName===n.name});return null==e?void 0:e.photoURL}}(),alt:n.name,size:"sm",className:"mr-3 flex-shrink-0",fallbackClassName:"bg-gray-600 text-gray-300 text-sm",fallbackText:n.name.charAt(0).toUpperCase()}),(0,I.jsxs)("span",{className:"text-white font-medium",children:[n.name," ",(0,I.jsxs)("span",{className:"text-sm font-bold ".concat(1===r||3===r?"text-yellow-400":"text-blue-400"),children:["(",1===r||3===r?"Team 1":"Team 2",")"]})]})]}),(0,I.jsx)(m.$,{variant:"ghost",size:"icon",onClick:function(e){e.stopPropagation(),F(r)},className:"absolute top-1/2 right-2 transform -translate-y-1/2 text-gray-400 hover:text-white flex-shrink-0 p-1 h-8 w-8","aria-label":"Spieler entfernen",children:(0,I.jsx)(x.A,{size:18})})]}):(0,I.jsx)("span",{className:"text-gray-400 italic",children:a})},"slotdisplay-".concat(r));return(0,I.jsx)("div",{children:n?i:(0,I.jsx)(eh,{trigger:i,participants:l,currentSelection:w,targetSlot:r,onSelectParticipant:G})},r)})}),U&&(0,I.jsx)("p",{className:"text-red-400 text-sm text-center mb-4",children:U}),(0,I.jsxs)(eu.P.button,{initial:{scale:.9},animate:{scale:1},whileTap:{scale:.95},onClick:H,className:"w-full text-white text-lg font-bold py-3 px-8 rounded-xl shadow-lg transition-colors border-b-4 min-h-[56px] flex items-center justify-center ".concat(B()&&!L&&A&&R?"bg-green-600 hover:bg-green-700 border-green-900 cursor-pointer":"bg-gray-500 border-gray-700 cursor-not-allowed opacity-70"),disabled:!B()||L||!A||!R,title:B()?A?R?L?"Passe wird gestartet...":"Passe starten":"Nur Spieler, die an dieser Passe teilnehmen, d\xfcrfen sie starten":"Bitte w\xe4hle einen Startspieler (auf einen Spieler klicken)":"Bitte w\xe4hle alle vier Spieler aus",children:[L?(0,I.jsx)(p.A,{className:"animate-spin mr-2"}):null,d,". Passe starten"]}),!R&&B()&&A&&(0,I.jsx)("p",{className:"text-amber-400 text-sm mt-2 text-center",children:"Hinweis: Nur teilnehmende Spieler k\xf6nnen die Passe starten."})]})})}):null};function ek(e){return(ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eE(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eA(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!=ek(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ek(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ek(t)?t:t+""}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eA(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let eT=function(e){e.instanceId;var t=e.settings,r=e.participants,a=e.games,i=e.onParticipantClick,s=(0,n.useMemo)(function(){var e={};return r.forEach(function(t){null!=t&&t.uid&&(e[t.uid]={score:0,striche:0,weis:0})}),Array.isArray(a)&&a.forEach(function(t){Array.isArray(t.playerDetails)&&t.playerDetails.forEach(function(r){var n=r.playerId;if(n&&e[n]&&r){e[n].score+=r.scoreInPasse||0,e[n].weis+=r.weisInPasse||0;var a=0;r.team&&t.teamStrichePasse&&t.teamStrichePasse[r.team]&&(a=Object.values(t.teamStrichePasse[r.team]).reduce(function(e,t){return e+(t||0)},0)),e[n].striche+=a}})}),e},[r,a]),o=(0,n.useMemo)(function(){console.log("[TournamentRankingList] Ranking Mode from settings:",null==t?void 0:t.rankingMode);var e=r.map(function(e){return eE(eE({},e),{},{totals:null!=e&&e.uid?s[e.uid]:{score:0,striche:0,weis:0}})}).filter(function(e){return e.uid});e.sort(function(e,r){var n=(null==t?void 0:t.rankingMode)||"total_points";return"total_points"===n?r.totals.score!==e.totals.score?r.totals.score-e.totals.score:r.totals.striche-e.totals.striche:r.totals.striche!==e.totals.striche?r.totals.striche-e.totals.striche:r.totals.score-e.totals.score});var n=1;return e.map(function(e,r,a){if(r>0){var i=a[r-1],s=(null==t?void 0:t.rankingMode)||"total_points",o=!1;(o="total_points"===s?e.totals.score===i.totals.score&&e.totals.striche===i.totals.striche:e.totals.striche===i.totals.striche&&e.totals.score===i.totals.score)||(n=r+1)}return eE(eE({},e),{},{rank:n})})},[r,s,t]),l=(0,n.useMemo)(function(){return null==t||!t.strokeSettings||Object.values(t.strokeSettings).some(function(e){return e>0})},[null==t?void 0:t.strokeSettings]),c=function(e){i&&i(e)};return(0,I.jsxs)("div",{className:"bg-gray-800/50 p-4 rounded-lg shadow-inner border border-gray-700/50",children:[(0,I.jsx)("h3",{className:"text-lg font-semibold text-center mb-4 text-purple-300",children:"Rangliste"}),0===o.length?(0,I.jsx)("p",{className:"text-center text-gray-400",children:"Noch keine Teilnehmerdaten oder Ergebnisse vorhanden."}):(0,I.jsxs)("table",{className:"w-full text-sm text-left table-fixed",children:[(0,I.jsx)("thead",{className:"border-b border-gray-600",children:(0,I.jsxs)("tr",{children:[(0,I.jsx)("th",{className:"w-8 py-2 px-1 text-center font-medium text-gray-400",children:"#"}),(0,I.jsx)("th",{className:"py-2 px-2 font-medium text-gray-400",children:"Spieler"}),l&&(0,I.jsx)("th",{className:"w-16 py-2 px-1 text-center font-medium text-gray-400",children:"Striche"}),(0,I.jsx)("th",{className:"w-16 py-2 px-1 text-center font-medium text-gray-400",children:"Punkte"})]})}),(0,I.jsx)("tbody",{children:o.map(function(e){var r;return(0,I.jsxs)("tr",{onClick:function(){return c(e)},className:(0,U.cn)("border-b border-gray-700/50 hover:bg-gray-700/60 transition-colors",i?"cursor-pointer":""),children:[(0,I.jsx)("td",{className:"py-2 px-1 text-center font-medium text-gray-300",children:e.rank}),(0,I.jsxs)("td",{className:"py-2 px-2 flex items-center space-x-2 truncate",children:[(0,I.jsx)(ef.A,{src:e.photoURL,alt:e.displayName||"Spieler",size:"sm",className:"mr-2",fallbackClassName:"bg-gray-700 text-gray-300 text-xs",fallbackText:(null==(r=e.displayName)?void 0:r.charAt(0).toUpperCase())||"?"}),(0,I.jsx)("span",{className:"text-white truncate flex-grow min-w-0",title:e.displayName,children:e.displayName||"Unbekannt"})]}),l&&(0,I.jsx)("td",{className:"py-2 px-1 text-center font-semibold ".concat((null==t?void 0:t.rankingMode)==="striche"?"text-xl text-purple-300":"text-white"),children:e.totals.striche}),(0,I.jsx)("td",{className:"py-2 px-1 text-center ".concat((null==t?void 0:t.rankingMode)==="total_points"?"text-xl font-semibold text-purple-300":"text-xs text-gray-400"),children:e.totals.score})]},e.uid)})})]})]})};function eL(e,t){if(e){if("string"==typeof e)return eD(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?eD(e,t):void 0}}function eD(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}let eC=function(e){var t=e.instanceId,r=e.games,i=e.playerPhotoUrlMapping,o=e.playerNamesMapping,l=(0,a.useRouter)(),c=(0,n.useMemo)(function(){return Array.isArray(r)?((function(e){if(Array.isArray(e))return eD(e)})(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||eL(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,t){return(e.passeNumber||0)-(t.passeNumber||0)}):[]},[r]),u=function(e){t&&e&&l.push("/tournaments/".concat(t,"/passe/").concat(e))};return(0,I.jsx)("div",{className:"space-y-2",children:0===c.length?(0,I.jsx)("p",{className:"text-center text-gray-500 py-6",children:"Noch keine Passen gespielt."}):c.map(function(e){var t,r,n,a,l,c=(null==(r=e.playerDetails)?void 0:r.filter(function(e){return"top"===e.team}).map(function(e){return e.playerName}).join(" & "))||"Team Oben",d=(null==(n=e.playerDetails)?void 0:n.filter(function(e){return"bottom"===e.team}).map(function(e){return e.playerName}).join(" & "))||"Team Unten",f=null==(a=e.teamStrichePasse)?void 0:a.top,m=null==(l=e.teamStrichePasse)?void 0:l.bottom,p=f?(f.sieg||0)+(f.berg||0)+(f.matsch||0)+(f.schneider||0)+(f.kontermatsch||0):0,h=m?(m.sieg||0)+(m.berg||0)+(m.matsch||0)+(m.schneider||0)+(m.kontermatsch||0):0,y=(t=e.completedAt)instanceof P.Timestamp?(0,O.GP)(t.toDate(),"dd.MM.yy, HH:mm"):"-";return(0,I.jsxs)("button",{onClick:function(){return u(e.passeId)},className:"block w-full text-left p-3 bg-gray-800/50 rounded-lg hover:bg-gray-700/50 transition-colors duration-150 cursor-pointer border border-gray-700/50",children:[(0,I.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,I.jsxs)("span",{className:"text-sm font-semibold text-purple-300",children:["Passe ",e.passeNumber]}),(0,I.jsx)("span",{className:"text-sm text-gray-400",children:y})]}),(0,I.jsxs)("div",{className:"text-sm space-y-1",children:[(0,I.jsxs)("div",{className:"flex justify-between",children:[(0,I.jsx)("span",{className:"text-sm text-gray-300 truncate pr-2",title:d,children:d}),(0,I.jsx)("span",{className:"text-lg font-medium text-white",children:h})]}),(0,I.jsxs)("div",{className:"flex justify-between",children:[(0,I.jsx)("span",{className:"text-sm text-gray-300 truncate pr-2",title:c,children:c}),(0,I.jsx)("span",{className:"text-lg font-medium text-white",children:p})]})]}),e.playerDetails&&e.playerDetails.length>0&&(0,I.jsx)("div",{className:"mt-2 flex -space-x-1.5 overflow-hidden",children:e.playerDetails.map(function(e,t){var r=void 0,n=e.playerName||"Spieler";if(e.playerId&&i&&i[e.playerId])r=i[e.playerId];else if(n&&o&&i){for(var a=void 0,l=0,c=Object.entries(o);l<c.length;l++){var u,d=(u=c[l],function(e){if(Array.isArray(e))return e}(u)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{i=(r=r.call(e)).next,!1;for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(u,2)||eL(u,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0];if(d[1]===n){a=f;break}}a&&i[a]&&(r=i[a])}return(0,I.jsx)(en.eu,{className:"h-6 w-6 border-2 border-gray-800 bg-gray-700",children:r?(0,I.jsx)(s(),{src:r,alt:n,width:20,height:20,className:"rounded-full object-cover"}):(0,I.jsx)(en.q5,{className:"bg-gray-600 text-gray-300 text-xs",children:(null==n?void 0:n.charAt(0).toUpperCase())||"?"})},t)})})]},e.passeId)})})};var eU=r(83587),eI=r(39930),e_=r(93504),eM=r(66534),eR=r(38791);function ez(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eG(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ez(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!=eV(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=eV(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eV(t)?t:t+""}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ez(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function eF(){eF=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(t,r,n,i){var s,o,l,c,u=Object.create((r&&r.prototype instanceof y?r:y).prototype);return a(u,"_invoke",{value:(s=t,o=n,l=new k(i||[]),c=f,function(t,r){if(c===m)throw Error("Generator is already running");if(c===p){if("throw"===t)throw r;return{value:e,done:!0}}for(l.method=t,l.arg=r;;){var n=l.delegate;if(n){var a=function t(r,n){var a=n.method,i=r.iterator[a];if(i===e)return n.delegate=null,"throw"===a&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+a+"' method")),h;var s=d(i,r.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,h;var o=s.arg;return o?o.done?(n[r.resultName]=o.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):o:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,h)}(n,l);if(a){if(a===h)continue;return a}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if(c===f)throw c=p,l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);c=m;var i=d(s,o,l);if("normal"===i.type){if(c=l.done?p:"suspendedYield",i.arg===h)continue;return{value:i.arg,done:l.done}}"throw"===i.type&&(c=p,l.method="throw",l.arg=i.arg)}})}),u}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function y(){}function g(){}function x(){}var v={};c(v,s,function(){return this});var b=Object.getPrototypeOf,j=b&&b(b(A([])));j&&j!==r&&n.call(j,s)&&(v=j);var w=x.prototype=y.prototype=Object.create(v);function N(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){var r;a(this,"_invoke",{value:function(a,i){function s(){return new t(function(r,s){!function r(a,i,s,o){var l=d(e[a],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==eV(u)&&n.call(u,"__await")?t.resolve(u.__await).then(function(e){r("next",e,s,o)},function(e){r("throw",e,s,o)}):t.resolve(u).then(function(e){c.value=e,s(c)},function(e){return r("throw",e,s,o)})}o(l.arg)}(a,i,r,s)})}return r=r?r.then(s,s):s()}})}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw TypeError(eV(t)+" is not iterable")}return g.prototype=x,a(w,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:g,configurable:!0}),g.displayName=c(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},N(S.prototype),c(S.prototype,o,function(){return this}),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new S(u(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},N(w),c(w,l,"Generator"),c(w,s,function(){return this}),c(w,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;P(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),h}},t}function eB(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function eK(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function s(e){eB(i,n,a,s,o,"next",e)}function o(e){eB(i,n,a,s,o,"throw",e)}s(void 0)})}}function e$(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eH(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?eH(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eH(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function eV(e){return(eV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eW(e){return e&&"object"===eV(e)&&"toDate"in e&&"function"==typeof e.toDate}var eX=function(e){switch(e.toLowerCase()){case"active":return"Aktiv";case"completed":return"Abgeschlossen";case"upcoming":return"Anstehend";case"archived":return"Archiviert";default:return e.charAt(0).toUpperCase()+e.slice(1)}};let eZ=function(){var e,t,r,i,T,L,_,M,R,z,G,F,B,K,$,H,V,W,X=(0,a.useRouter)(),Z=X.query.instanceId,q=(0,c.useAuthStore)(),Y=q.user;q.status;var J=(0,l.Q5)().currentGroup,Q=(0,o.yu)(function(e){return e.fetchTournamentInstanceDetails}),er=(0,o.yu)(function(e){return e.setupTournamentListener});(0,o.yu)(function(e){return e.clearTournamentListener});var en=(0,o.yu)(function(e){return e.currentTournamentInstance}),ea=(0,o.yu)(function(e){return e.error}),ei=(0,o.yu)(o.FH),es=(0,o.yu)(o.nX),eo=(0,u.useUIStore)(function(e){return e.showNotification}),ec=e$((0,n.useState)(!1),2),eu=ec[0],ed=ec[1],ef=e$((0,n.useState)("ranking"),2),em=ef[0],ep=ef[1],eh=e$((0,n.useState)(!1),2),eg=eh[0],ex=eh[1],ev=e$((0,n.useState)(!1),2),eb=ev[0],ej=ev[1],ew=e$((0,n.useState)(null),2),eN=ew[0],eS=ew[1],eO=(0,o.yu)(function(e){return e.currentTournamentGames}),ek=(0,o.yu)(function(e){return e.loadTournamentGames}),eA=(0,o.yu)(o.cK),eE=(0,o.yu)(function(e){return e.loadTournamentParticipants}),eL=(0,o.yu)(o.At),eD=(0,o.yu)(o.jl),ez=e$((0,n.useState)(null),2),eB=ez[0],eH=ez[1],eV=e$((0,n.useState)(!0),2),eZ=eV[0],eq=eV[1],eY=(0,n.useRef)(null),eJ=(0,n.useRef)(null),eQ=e$((0,n.useState)(null),2),e0=eQ[0],e1=eQ[1],e2=e$((0,n.useState)(null),2),e4=e2[0],e3=e2[1],e5=e$((0,n.useState)(!1),2),e8=e5[0],e6=e5[1],e7=e$((0,n.useState)(!1),2),e9=e7[0],te=e7[1],tt=e$((0,n.useState)(null),2),tr=tt[0],tn=tt[1],ta=(0,n.useMemo)(function(){return Z},[Z]),ti=e$((0,n.useState)(!1),2),ts=ti[0],to=ti[1],tl=e$((0,n.useState)([]),2),tc=tl[0],tu=tl[1];(0,n.useEffect)(function(){if(ta&&"string"==typeof ta){var e="success"===ei&&(null==en?void 0:en.id)===ta,t="loading"===ei&&es===ta;e||t||Q(ta)}},[ta,Q,ei,null==en?void 0:en.id,es,!1]),(0,n.useEffect)(function(){return function(){o.yu.getState().clearCurrentTournamentInstance()}},[]),(0,n.useEffect)(function(){ta&&"string"==typeof ta&&(null==en?void 0:en.id)===ta&&"success"===ei&&"loading"!==eA&&"success"!==eA&&ek(ta)},[ta,null==en?void 0:en.id,ei,eA,ek,!1]),(0,n.useEffect)(function(){if(ta&&"string"==typeof ta)((null==en?void 0:en.id)!==ta||"success"!==eD&&"loading"!==eD)&&(null==en?void 0:en.id)===ta&&"success"===ei&&eE(ta)},[ta,null==en?void 0:en.id,ei,eD,eE,!1,null==en?void 0:en.status]),(0,n.useEffect)(function(){if(ta&&"string"==typeof ta)return"success"===ei&&(null==en?void 0:en.id)===ta&&er(ta),function(){}},[ta,ei,null==en?void 0:en.id,er,!1]),(0,n.useEffect)(function(){var e,t=(0,P.getFirestore)(k.firebaseApp),r=function(){},n=(e=eK(eF().mark(function e(){var r,n,a,i,s,o,l,c,u;return eF().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!ta||!Y||!Y.uid||"success"!==ei||(null==en?void 0:en.status)!=="active")){e.next=1;break}return eB&&eH(null),eq(!1),e.abrupt("return");case 1:if(eq(!0),r=d.useJassStore.getState().activeGameId,e.prev=2,!r){e.next=4;break}return n=(0,P.doc)(t,"activeGames",r),e.next=3,(0,P.getDoc)(n);case 3:(a=e.sent).exists()&&(o=a.data()).tournamentInstanceId===ta&&"live"===o.status&&null!=(i=o.participantUids)&&null!=(s=i.includes)&&s.call(i,Y.uid)&&eH(r);case 4:e.next=6;break;case 5:e.prev=5,u=e.catch(2),console.error("Error fetching game ".concat(r," from jassStore:"),u);case 6:try{l=(0,P.collection)(t,"activeGames"),c=(0,P.query)(l,(0,P.where)("tournamentInstanceId","==",ta),(0,P.where)("participantUids","array-contains",Y.uid),(0,P.where)("status","==","live")),eY.current=(0,P.onSnapshot)(c,function(e){try{if(e.empty)eB&&eH(null);else{var t=e.docs[0].id;eB!==t&&eH(t)}eq(!1)}catch(e){console.error("Error in active passe listener processing:",e),eB&&eH(null),eq(!1)}},function(e){console.error("Error in active passe listener:",e),eq(!1),eH(null)})}catch(e){console.error("Error setting up active passe listener:",e),eq(!1)}case 7:case"end":return e.stop()}},e,null,[[2,5]])})),function(){return e.apply(this,arguments)}),a=setTimeout(function(){n()},100);return function(){clearTimeout(a),r(),eY.current&&(eY.current(),eY.current=null)}},[ta,null==Y?void 0:Y.uid,ei,null==en?void 0:en.status,eB,!1]),(0,n.useEffect)(function(){return function(){e4&&URL.revokeObjectURL(e4),tr&&URL.revokeObjectURL(tr)}},[]);var td=(0,n.useMemo)(function(){return eL&&0!==eL.length?eL.reduce(function(e,t){return t&&t.uid&&t.displayName&&(e[t.uid]=t.displayName),e},{}):{}},[eL]),tf=(0,n.useMemo)(function(){return eL&&0!==eL.length?eL.reduce(function(e,t){return t&&t.uid&&t.photoURL&&(e[t.uid]=t.photoURL),e},{}):{}},[eL]),tm=function(){J?X.push("/start"):X.push("/tournaments")},tp=(e=eK(eF().mark(function e(){var t;return eF().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=en&&en.groupId){e.next=1;break}return eo({type:"error",message:"Turnier-Gruppe nicht gefunden. Passe kann nicht gestartet werden."}),e.abrupt("return");case 1:return to(!0),e.prev=2,e.next=3,(0,eM.getGroupMembersSortedByGames)(en.groupId);case 3:tu(e.sent),ed(!0),e.next=5;break;case 4:e.prev=4,console.error("Fehler beim Laden der Gruppenmitglieder f\xfcr Passe:",t=e.catch(2)),eo({message:t instanceof Error?t.message:"Gruppenmitglieder konnten nicht geladen werden.",type:"error"});case 5:return e.prev=5,to(!1),e.finish(5);case 6:case"end":return e.stop()}},e,null,[[2,4,5,6]])})),function(){return e.apply(this,arguments)}),th="loading"===ei,ty="loading"===eA,tg="loading"===eD,tx=th||tg,tv=!!en&&!!Y&&(null==(T=en.adminIds)?void 0:T.includes(Y.uid)),tb=((null==eO?void 0:eO.length)||0)+1;(null==en||null==(L=en.settings)?void 0:L.strokeSettings)||D.zh,eG(eG({},eR.$d),(null==en||null==(_=en.settings)?void 0:_.scoreSettings)||{});var tj=(t=eK(eF().mark(function e(t){var r,n;return eF().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=t.target.files)&&r.length>0)){e.next=3;break}if((n=r[0]).type.startsWith("image/")){e.next=1;break}return eo({message:"Bitte w\xe4hlen Sie eine Bilddatei (JPEG oder PNG).",type:"error"}),e.abrupt("return");case 1:if(!(n.size>5242880)){e.next=2;break}return eo({message:"Die Datei ist zu gro\xdf (max. 5 MB).",type:"error"}),e.abrupt("return");case 2:e4&&URL.revokeObjectURL(e4),e3(null),e1(null),tn(URL.createObjectURL(n)),te(!0);case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),tw=(r=eK(eF().mark(function e(t){var r,n;return eF().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(te(!1),tr&&(URL.revokeObjectURL(tr),tn(null)),t){e.next=1;break}return console.log("Cropping abgebrochen oder fehlgeschlagen."),eJ.current&&(eJ.current.value=""),e6(!1),e.abrupt("return");case 1:return e6(!0),console.log("[TournamentView] Zugeschnittenes Bild erhalten, Gr\xf6\xdfe: ".concat((t.size/1024).toFixed(2)," KB")),r={maxSizeMB:.2,maxWidthOrHeight:500,useWebWorker:!0,fileType:"image/jpeg",initialQuality:.8},e.prev=2,console.log("[TournamentView] Komprimiere zugeschnittenes Bild..."),e.next=3,(0,eU.A)(new File([t],"tournament_logo.jpg",{type:"image/jpeg"}),r);case 3:n=e.sent,console.log("[TournamentView] Komprimiertes Bild, Gr\xf6\xdfe: ".concat((n.size/1024).toFixed(2)," KB")),e3(URL.createObjectURL(n)),e1(new File([n],"tournament_logo_final.jpg",{type:"image/jpeg"})),e6(!1),e.next=5;break;case 4:e.prev=4,console.error("Fehler bei der Komprimierung:",e.catch(2)),eo({message:"Fehler bei der Bildkomprimierung.",type:"error"}),e1(null),e3(null),eJ.current&&(eJ.current.value=""),e6(!1);case 5:case"end":return e.stop()}},e,null,[[2,4]])})),function(e){return r.apply(this,arguments)}),tN=(i=eK(eF().mark(function e(){var t,r;return eF().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!e0||!en)){e.next=1;break}return e.abrupt("return");case 1:if(null!=Y&&Y.uid){e.next=2;break}return eo({message:"Benutzer-Authentifizierung erforderlich f\xfcr Logo-Upload.",type:"error"}),e.abrupt("return");case 2:return e6(!0),e.prev=3,e.next=4,(0,e_.uploadTournamentLogoFirebase)(en.id,e0,Y.uid);case 4:return t=e.sent,e.next=5,(0,e_.updateTournamentSettings)(en.id,{logoUrl:t});case 5:eo({message:"Turnierbild erfolgreich aktualisiert.",type:"success"}),e4&&URL.revokeObjectURL(e4),e1(null),e3(null),eJ.current&&(eJ.current.value=""),e6(!1),e.next=7;break;case 6:e.prev=6,console.error("Fehler beim Hochladen des Turnierbildes:",r=e.catch(3)),eo({message:r instanceof Error?r.message:"Hochladen fehlgeschlagen.",type:"error"}),e6(!1);case 7:case"end":return e.stop()}},e,null,[[3,6]])})),function(){return i.apply(this,arguments)});(0,n.useMemo)(function(){var e;return!!Y&&!!en&&((null==(e=en.adminIds)?void 0:e.includes(Y.uid))||!1)},[Y,en]);var tS=(0,n.useCallback)(function(e){eS(e),ej(!0)},[]);return th?(0,I.jsx)(f.A,{children:(0,I.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:[(0,I.jsx)(p.A,{className:"h-12 w-12 animate-spin text-purple-400"}),(0,I.jsx)("p",{className:"mt-4 text-lg",children:"Turnierdaten werden geladen..."}),tx&&(0,I.jsx)("p",{className:"text-sm text-gray-400",children:"Lade Details..."}),ty&&(0,I.jsx)("p",{className:"text-sm text-gray-400",children:"Lade Passen..."}),tg&&(0,I.jsx)("p",{className:"text-sm text-gray-400",children:"Lade Teilnehmer..."})]})}):ea&&!tx?(0,I.jsx)(f.A,{children:(0,I.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:(0,I.jsxs)("div",{className:"bg-red-900/50 border border-red-700 text-red-300 px-6 py-4 rounded-lg shadow-lg text-center",children:[(0,I.jsx)(h.A,{className:"h-10 w-10 mx-auto mb-3 text-red-400"}),(0,I.jsx)("p",{className:"font-bold text-xl mb-2",children:"Fehler beim Laden des Turniers"}),(0,I.jsx)("p",{className:"text-sm",children:ea}),(0,I.jsx)(m.$,{onClick:tm,variant:"outline",className:"mt-6 text-white border-white/50 hover:bg-white/10",children:"Zur\xfcck"})]})})}):en||tx||!ta?en?ts?(0,I.jsx)(f.A,{children:(0,I.jsx)(ey.A,{message:"Lade Spieler f\xfcr neue Passe..."})}):(0,I.jsx)(f.A,{children:(0,I.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-900 text-white pt-8 pb-20",children:[en&&(0,I.jsxs)("div",{className:"flex flex-col items-center mb-4 mt-12",children:[(0,I.jsxs)("div",{className:"relative w-32 h-32 rounded-full overflow-hidden transition-all duration-300 flex items-center justify-center bg-gray-800 shadow-lg hover:shadow-xl hover:scale-105 border-4",style:{borderColor:"#a855f7",boxShadow:e0&&e4?"0 0 25px rgba(168, 85, 247, 0.3)":"0 0 20px rgba(168, 85, 247, 0.2), 0 4px 20px rgba(0,0,0,0.3)"},children:[e4?(0,I.jsx)(s(),{src:e4,alt:"Vorschau Turnierbild",fill:!0,style:{objectFit:"cover"}}):null!=en&&en.logoUrl||null!=en&&null!=(M=en.settings)&&M.logoUrl?(0,I.jsx)(s(),{src:en.logoUrl||(null==(R=en.settings)?void 0:R.logoUrl)||"",alt:"Logo ".concat(en.name),fill:!0,style:{objectFit:"cover"},priority:!0,sizes:"(max-width: 768px) 128px, 128px",onError:function(e){e.target.src="/placeholder-logo.png"}}):(0,I.jsx)("span",{className:"text-4xl font-bold text-gray-500",children:(null!=(z=en.name)?z:"?").charAt(0).toUpperCase()}),tv&&(0,I.jsx)("button",{onClick:function(){tv&&eJ.current&&eJ.current.click()},className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 hover:bg-opacity-60 transition-all duration-200",disabled:e8,"aria-label":"Turnierbild \xe4ndern",children:(0,I.jsx)(y.A,{className:"text-white ".concat(e8?"opacity-50":"opacity-0"," group-hover:opacity-100 transition-opacity duration-200"),size:32})})]}),e0&&e4&&(0,I.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,I.jsxs)(m.$,{onClick:tN,className:"bg-green-600 hover:bg-green-700 text-xs px-3 py-1.5 h-auto flex items-center gap-1",disabled:!e0||e8,children:[e8?(0,I.jsx)(p.A,{className:"h-4 w-4 animate-spin mr-1"}):(0,I.jsx)(g.A,{size:14}),"Hochladen"]}),(0,I.jsxs)(m.$,{onClick:function(){e4&&URL.revokeObjectURL(e4),e1(null),e3(null),eJ.current&&(eJ.current.value=""),e6(!1)},variant:"secondary",className:"text-xs px-3 py-1.5 h-auto flex items-center gap-1 bg-gray-600 hover:bg-gray-500 text-gray-100 border-gray-700",disabled:e8,children:[(0,I.jsx)(x.A,{size:14})," Abbrechen"]})]})]}),(0,I.jsxs)("div",{className:"w-full text-center mb-6 px-4",children:[(0,I.jsx)("h1",{className:"text-3xl font-bold mb-1 text-white break-words",children:null!=(G=null==en?void 0:en.name)?G:"Turnier laden..."}),(0,I.jsx)("p",{className:"text-sm text-gray-400 mx-auto max-w-xl break-words",children:null!=(F=null==en?void 0:en.description)?F:th?"":"Keine Beschreibung vorhanden."})]}),(0,I.jsxs)("div",{className:"flex justify-center items-center gap-3 mb-6 px-4",children:[tv&&(0,I.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:function(){tv&&ex(!0)},className:"hover:bg-gray-700/30 text-gray-300 hover:text-white",title:"Teilnehmer einladen",children:[(0,I.jsx)(v.A,{className:"h-4 w-4 mr-1.5"})," Einladen"]}),tv&&(0,I.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:function(){return X.push("/tournaments/".concat(ta,"/settings"))},className:"hover:bg-gray-700/30 text-gray-300 hover:text-white",title:"Einstellungen",children:[(0,I.jsx)(b.A,{className:"h-4 w-4 mr-1.5"})," Einstellungen"]})]}),en&&(0,I.jsxs)("div",{className:"text-xs text-gray-500 text-center mb-6",children:[(0,I.jsxs)("span",{children:["Status:",(0,I.jsx)("span",{className:(0,U.cn)("font-medium","upcoming"===en.status&&"text-yellow-400","active"===en.status&&"text-green-400","completed"===en.status&&"text-blue-400","archived"===en.status&&"text-gray-500"),children:eX(en.status)})]}),en.instanceDate&&eW(en.instanceDate)&&(0,I.jsx)("span",{className:"ml-3",children:(0,O.GP)(en.instanceDate.toDate(),"dd.MM.yyyy")}),"completed"===en.status&&en.completedAt&&eW(en.completedAt)&&(0,I.jsx)("span",{className:"ml-1",children:"(Abgeschlossen am ".concat((0,O.GP)(en.completedAt.toDate(),"dd.MM.yyyy"),")")})]}),(0,I.jsxs)(A.tU,{value:em,onValueChange:ep,className:"flex-grow flex flex-col w-full max-w-2xl mx-auto",children:[(0,I.jsxs)(A.j7,{className:"grid w-full grid-cols-3 bg-gray-800 sticky top-0 z-10 rounded-md mb-4",children:[(0,I.jsxs)(A.Xi,{value:"ranking",className:"py-2.5 data-[state=active]:bg-purple-600 data-[state=active]:text-white data-[state=active]:shadow-md text-gray-400 hover:text-white rounded-l-md",children:[(0,I.jsx)(j.A,{className:"w-4 h-4 mr-1.5"})," Rangliste"]}),(0,I.jsxs)(A.Xi,{value:"archive",className:"py-2.5 data-[state=active]:bg-purple-600 data-[state=active]:text-white data-[state=active]:shadow-md text-gray-400 hover:text-white",children:[(0,I.jsx)(w.A,{className:"w-4 h-4 mr-1.5"})," Passen"]}),(0,I.jsxs)(A.Xi,{value:"participants",className:"py-2.5 data-[state=active]:bg-purple-600 data-[state=active]:text-white data-[state=active]:shadow-md text-gray-400 hover:text-white rounded-r-md",children:[(0,I.jsx)(N.A,{className:"w-4 h-4 mr-1.5"})," Teilnehmer"]})]}),(0,I.jsxs)("div",{className:"flex-grow p-0 md:p-4 overflow-y-auto",children:[(0,I.jsx)(A.av,{value:"ranking",children:tx||ty?(0,I.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,I.jsx)(p.A,{className:"h-8 w-8 animate-spin text-purple-400"}),(0,I.jsx)("span",{className:"ml-3 text-gray-400",children:"Lade Rangliste..."})]}):"error"===ei||"error"===eA||"error"===eD?(0,I.jsxs)("div",{className:"bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-md flex items-center",children:[(0,I.jsx)(h.A,{className:"h-5 w-5 mr-3"}),(0,I.jsx)("span",{children:"Fehler beim Laden der Ranglistendaten."})]}):en&&en.settings&&Array.isArray(eL)&&Array.isArray(eO)?(0,I.jsx)(eT,{instanceId:ta,settings:en.settings,participants:eL,games:eO,onParticipantClick:tS}):(0,I.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Rangliste konnte nicht geladen werden (fehlende Daten oder Einstellungen)."})}),(0,I.jsx)(A.av,{value:"archive",children:ty?(0,I.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,I.jsx)(p.A,{className:"h-8 w-8 animate-spin text-purple-400"}),(0,I.jsx)("span",{className:"ml-3 text-gray-400",children:"Lade Passen..."})]}):"error"===eA?(0,I.jsxs)("div",{className:"bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-md flex items-center",children:[(0,I.jsx)(h.A,{className:"h-5 w-5 mr-3"}),(0,I.jsx)("span",{children:"Fehler beim Laden der Passen."})]}):Array.isArray(eO)?(0,I.jsx)(eC,{instanceId:ta,games:eO,playerPhotoUrlMapping:tf,playerNamesMapping:td}):(0,I.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Passen konnten nicht geladen werden."})}),(0,I.jsx)(A.av,{value:"participants",children:"success"===ei&&en&&("success"===eD||"loading"!==eD&&(null==eL?void 0:eL.length)>0)?(0,I.jsx)(el,{participants:eL,tournamentAdminId:null==(B=en.adminIds)?void 0:B[0],onParticipantClick:tS,tournamentGames:eO}):tg?(0,I.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,I.jsx)(p.A,{className:"h-8 w-8 animate-spin text-purple-400"}),(0,I.jsx)("span",{className:"ml-3 text-gray-400",children:"Lade Teilnehmer..."})]}):(0,I.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Teilnehmerliste ist noch nicht verf\xfcgbar oder es gibt keine Teilnehmer."})})]})]}),"active"===en.status&&(0,I.jsx)("div",{className:"sticky bottom-0 left-0 right-0 p-3 bg-gray-900/90 backdrop-blur-sm border-t border-gray-700/60",children:eZ?(0,I.jsxs)(m.$,{className:"w-full bg-gray-600 hover:bg-gray-500 text-white py-3 px-6 rounded-lg shadow-lg text-base font-semibold flex items-center justify-center transition-colors duration-150 ease-in-out",disabled:!0,children:[(0,I.jsx)(p.A,{className:"animate-spin h-5 w-5 mr-2"}),"Suche laufende Passe..."]}):eB?(0,I.jsxs)(m.$,{onClick:function(){return X.push("/game/".concat(eB))},className:"w-full h-14 text-lg font-bold rounded-xl shadow-lg bg-blue-600 hover:bg-blue-700 border-b-4 border-blue-900 text-white active:scale-95 transition duration-100 ease-in-out",children:[(0,I.jsx)(S.A,{className:"h-5 w-5 mr-2"}),"Aktive Passe fortsetzen"]}):(0,I.jsxs)(m.$,{onClick:tp,className:"w-full h-14 text-lg font-bold rounded-xl shadow-lg bg-green-600 hover:bg-green-700 border-b-4 border-green-900 text-white active:scale-95 transition duration-100 ease-in-out",disabled:"loading"===eD||eL.length<1||tx,children:[("loading"===eD||tx)&&(0,I.jsx)(p.A,{className:"animate-spin h-5 w-5 mr-2"}),tb,". Passe starten","loading"!==eD&&!tx&&eL.length<1&&" (Ben\xf6tigt Teilnehmer)"]})}),"upcoming"===en.status&&(0,I.jsxs)("div",{className:"sticky bottom-0 left-0 right-0 p-4 bg-gray-800 border-t border-gray-700 text-center",children:[(0,I.jsx)("p",{className:"text-lg font-semibold text-yellow-400 mb-2",children:null!=(K=en.settings)&&K.scheduledStartTime?function(e){if(!e||"function"!=typeof e.toDate)return"";try{var t=e.toDate();return"Beginnt am ".concat(t.toLocaleDateString("de-CH",{day:"2-digit",month:"2-digit",year:"numeric"})," um ").concat(t.toLocaleTimeString("de-CH",{hour:"2-digit",minute:"2-digit"})," Uhr")}catch(e){return console.error("Error formatting scheduled time:",e),"Ung\xfcltige Startzeit"}}(en.settings.scheduledStartTime):"Das Turnier hat noch nicht begonnen."}),tv&&(0,I.jsx)(m.$,{onClick:function(){return X.push("/tournaments/".concat(ta,"/settings"))},size:"sm",variant:"link",className:"mt-1 text-purple-400 hover:text-purple-300",children:"Turnierdetails bearbeiten / Starten"})]}),eu&&ta&&(0,I.jsx)(eP,{isVisible:eu,onClose:function(){return ed(!1)},tournamentId:ta,tournamentParticipants:eL,currentPasseNumber:tb,onPasseStarted:function(e){X.push("/game/".concat(e)),ed(!1),u.useUIStore.getState().showNotification({type:"success",message:"Passe gestartet! Auf zum Jass!"})},members:tc}),tv&&ta&&en&&(0,I.jsx)(et.A,{isOpen:eg,onClose:function(){return ex(!1)},tournamentId:ta,tournamentName:null==en?void 0:en.name,onGenerateNew:function(){console.log("[TournamentViewPage] User requested new invite token.")}}),(0,I.jsx)(eI.A,{isOpen:e9,onClose:function(){return tw(null)},imageSrc:tr,onCropComplete:tw}),(0,I.jsx)("input",{type:"file",ref:eJ,onChange:tj,accept:"image/jpeg, image/jpg, image/png, image/webp, image/gif, image/heic, image/heif",className:"hidden",disabled:e8}),eN&&en&&(0,I.jsx)(E.lG,{open:eb,onOpenChange:ej,children:(0,I.jsxs)(E.Cf,{className:"max-w-3xl bg-gray-850 border-gray-700 text-white",children:[(0,I.jsxs)(E.c7,{className:"mb-0 pb-2",children:[(0,I.jsxs)(E.L3,{className:"text-xl text-purple-300",children:["Spielerfortschritt: ",eN.displayName]}),(0,I.jsxs)(E.HM,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,I.jsx)(x.A,{className:"h-4 w-4"}),(0,I.jsx)("span",{className:"sr-only",children:"Schliessen"})]})]}),(0,I.jsx)("div",{className:"max-h-[80vh] overflow-y-auto p-1 pr-2",children:(0,I.jsx)(ee,{tournamentGames:eO,playerUid:eN.uid,playerName:eN.displayName,playerPhotoUrl:null!=($=eN.photoURL)?$:void 0,strokeSettings:(null==(H=en.settings)?void 0:H.strokeSettings)||D.zh,scoreSettings:eG(eG({},eR.$d),(null==(V=en.settings)?void 0:V.scoreSettings)||{}),cardStyle:(null==(W=en.settings)||null==(W=W.farbeSettings)?void 0:W.cardStyle)||C.FT.cardStyle})})]})})]})}):(0,I.jsx)(f.A,{children:(0,I.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:"Keine Turnierdaten verf\xfcgbar."})}):(0,I.jsx)(f.A,{children:(0,I.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:(0,I.jsxs)("div",{className:"bg-yellow-900/50 border border-yellow-700 text-yellow-300 px-6 py-4 rounded-lg shadow-lg text-center",children:[(0,I.jsx)(h.A,{className:"h-10 w-10 mx-auto mb-3 text-yellow-400"}),(0,I.jsx)("p",{className:"font-bold text-xl",children:"Turnier nicht gefunden"}),(0,I.jsxs)("p",{className:"text-sm",children:['Das Turnier mit der ID "',ta,'" konnte nicht gefunden werden oder der Zugriff wurde verweigert.']}),(0,I.jsx)(m.$,{onClick:tm,variant:"outline",className:"mt-6 text-white border-white/50 hover:bg-white/10",children:"Zur\xfcck"})]})})})}}},e=>{e.O(0,[8230,4587,9517,4455,3546,9732,5643,6738,1629,5047,6536,4231,9491,1744,5593,636,6593,8792],()=>e(e.s=76520)),_N_E=e.O()}]);