"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8166],{41877:(e,t,n)=>{n.d(t,{A:()=>r});var r=(0,n(11037).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},48166:(e,t,n)=>{n.d(t,{A:()=>eP});var r=n(14232),a=n(19732),i=n(42009),o=n(7110),s=n(89143),c=n(50582),l=n(42471),u=n(85253),h=n(38791),m=n(43028),p=n.n(m),f=n(94566);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){g=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(t,n,r,i){var o,s,c,l,u=Object.create((n&&n.prototype instanceof v?n:v).prototype);return a(u,"_invoke",{value:(o=t,s=r,c=new P(i||[]),l=m,function(t,n){if(l===p)throw Error("Generator is already running");if(l===f){if("throw"===t)throw n;return{value:e,done:!0}}for(c.method=t,c.arg=n;;){var r=c.delegate;if(r){var a=function t(n,r){var a=r.method,i=n.iterator[a];if(i===e)return r.delegate=null,"throw"===a&&n.iterator.return&&(r.method="return",r.arg=e,t(n,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+a+"' method")),y;var o=h(i,n.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[n.resultName]=s.value,r.next=n.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):s:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,y)}(r,c);if(a){if(a===y)continue;return a}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=f,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var i=h(o,s,c);if("normal"===i.type){if(l=c.done?f:"suspendedYield",i.arg===y)continue;return{value:i.arg,done:c.done}}"throw"===i.type&&(l=f,c.method="throw",c.arg=i.arg)}})}),u}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",p="executing",f="completed",y={};function v(){}function b(){}function S(){}var w={};l(w,o,function(){return this});var x=Object.getPrototypeOf,N=x&&x(x(z([])));N&&N!==n&&r.call(N,o)&&(w=N);var k=S.prototype=v.prototype=Object.create(w);function j(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function M(e,t){var n;a(this,"_invoke",{value:function(a,i){function o(){return new t(function(n,o){!function n(a,i,o,s){var c=h(e[a],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==d(u)&&r.call(u,"__await")?t.resolve(u.__await).then(function(e){n("next",e,o,s)},function(e){n("throw",e,o,s)}):t.resolve(u).then(function(e){l.value=e,o(l)},function(e){return n("throw",e,o,s)})}s(c.arg)}(a,i,n,o)})}return n=n?n.then(o,o):o()}})}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function z(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw TypeError(d(t)+" is not iterable")}return b.prototype=S,a(k,"constructor",{value:S,configurable:!0}),a(S,"constructor",{value:b,configurable:!0}),b.displayName=l(S,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,l(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},j(M.prototype),l(M.prototype,s,function(){return this}),t.AsyncIterator=M,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new M(u(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},j(k),l(k,c,"Generator"),l(k,o,function(){return this}),l(k,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=z,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return s.type="throw",s.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;T(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:z(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function y(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var b=16/9,S=function(){var e,t,n,a=function(e){if(Array.isArray(e))return e}(e=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,l=!1;try{i=(n=n.call(e)).next,!1;for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}(e,2)||function(e,t){if(e){if("string"==typeof e)return v(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=a[0],o=a[1],s=(0,f.useUIStore)(function(e){return e.showNotification});return{isSharing:i,handleShare:(t=g().mark(function e(t,n,r,a){var i,c,l,u,h,m,f,d,y,v,S,w,x,N,k,j,M,E,T,P,z,C,A,_=arguments;return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=_.length>4&&void 0!==_[4]?_[4]:"jass-resultat.png",c=_.length>5&&void 0!==_[5]&&_[5],o(!0),e.next=1,new Promise(function(e){return setTimeout(e,50)});case 1:if(l=null,u={maxHeight:"",overflowY:"",height:""},h=[],m=null,f="",d=[],y=[],e.prev=2,m=document.querySelector(t)){e.next=3;break}throw Error('Screenshot-Element "'.concat(t,'" nicht gefunden.'));case 3:if(m.querySelectorAll(".inline-flex.items-center").forEach(function(e){var t=[];Array.from(e.children).forEach(function(e){t.push({element:e,originalDisplay:e.style.display,originalVerticalAlign:e.style.verticalAlign}),e.style.display="inline-block",e.style.verticalAlign="middle"}),y.push({element:e,originalDisplay:e.style.display,children:t}),e.style.display="block"}),m.querySelectorAll(".overflow-hidden, .text-ellipsis, img, svg").forEach(function(e){var t=window.getComputedStyle(e),n={element:e,originalOverflow:e.style.overflow,originalTextOverflow:e.style.textOverflow,originalWhiteSpace:e.style.whiteSpace};("IMG"===e.tagName||"SVG"===e.tagName)&&(n.originalObjectFit=e.style.objectFit,n.originalFlexShrink=e.style.flexShrink,n.originalVerticalAlign=e.style.verticalAlign),d.push(n),"ellipsis"===t.textOverflow&&(e.style.overflow="visible",e.style.textOverflow="clip"),"hidden"===t.overflow&&e.classList.contains("overflow-hidden")&&(e.style.overflow="visible"),("IMG"===e.tagName||"SVG"===e.tagName)&&"contain"===t.objectFit&&(e.style.objectFit="none")}),v=m.offsetWidth,f=m.style.width,m.style.width="".concat(v,"px"),r.forEach(function(e){var t=document.querySelector(e);t&&(h.push({element:t,originalDisplay:t.style.display}),t.style.display="none")}),!(l=m.querySelector(n))){e.next=4;break}return u.maxHeight=l.style.maxHeight,u.overflowY=l.style.overflowY,u.height=l.style.height,l.style.maxHeight="none",l.style.overflowY="visible",l.style.height="".concat(l.scrollHeight,"px"),e.next=4,new Promise(function(e){return setTimeout(e,250)});case 4:return e.next=5,p()(m,{backgroundColor:"#1F2937",useCORS:!0,logging:!1,scale:3});case 5:if(S=e.sent,w=[],x=i.replace(/\.png$/,""),N=S.width,k=S.height,j=Math.floor(N*b),!(c&&k>j)){e.next=9;break}M=0,E=1,T=g().mark(function e(){var t,n,r,a;return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=document.createElement("canvas")).getContext("2d"),t.width=N,t.height=j,!n){e.next=2;break}return n.fillStyle="#1F2937",n.fillRect(0,0,t.width,t.height),r=Math.min(j,k-M),n.drawImage(S,0,M,N,r,0,0,N,r),e.next=1,new Promise(function(e){return t.toBlob(e,"image/png")});case 1:(a=e.sent)&&w.push(new File([a],"".concat(x,"-seite-").concat(E,".png"),{type:"image/png"}));case 2:M+=j,E++;case 3:case"end":return e.stop()}},e)});case 6:if(!(M<k)){e.next=8;break}return e.delegateYield(T(),"t0",7);case 7:e.next=6;break;case 8:e.next=11;break;case 9:return e.next=10,new Promise(function(e){return S.toBlob(e,"image/png")});case 10:(P=e.sent)&&w.push(new File([P],i,{type:"image/png"}));case 11:if(0!==w.length){e.next=12;break}throw Error("Keine Bilder zum Teilen erstellt.");case 12:if(z=w.length>1?"":a,!(navigator.share&&navigator.canShare&&navigator.canShare({files:w}))){e.next=17;break}return e.prev=13,e.next=14,navigator.share({files:w,text:z});case 14:e.next=16;break;case 15:if(e.prev=15,!("AbortError"!==(A=e.catch(13)).name&&!(null!=(C=A.message)&&C.includes("abort")))||(console.warn("Teilen mit Dateien fehlgeschlagen, versuche Text-only:",A),!(1===w.length&&z))){e.next=16;break}return e.next=16,navigator.share({text:z});case 16:e.next=18;break;case 17:s({type:"warning",message:"Dein Browser unterst\xfctzt das Teilen von Bildern nicht."});case 18:e.next=20;break;case 19:e.prev=19,console.error("Fehler im Screenshot-Prozess:",e.catch(2)),s({type:"error",message:"Fehler beim Erstellen des Screenshots."});case 20:return e.prev=20,y.forEach(function(e){e.children.forEach(function(e){e.element.style.display=e.originalDisplay,e.element.style.verticalAlign=e.originalVerticalAlign}),e.element.style.display=e.originalDisplay}),l&&(l.style.maxHeight=u.maxHeight||"",l.style.overflowY=u.overflowY||"",l.style.height=u.height||""),h.forEach(function(e){var t=e.element,n=e.originalDisplay;t.style.display=n}),d.forEach(function(e){var t=e.element,n=e.originalOverflow,r=e.originalTextOverflow,a=e.originalWhiteSpace,i=e.originalObjectFit,o=e.originalFlexShrink,s=e.originalVerticalAlign;t.style.overflow=n,t.style.textOverflow=r,t.style.whiteSpace=a,("IMG"===t.tagName||"SVG"===t.tagName)&&(void 0!==i&&(t.style.objectFit=i),void 0!==o&&(t.style.flexShrink=o),void 0!==s&&(t.style.verticalAlign=s))}),m&&(m.style.width=f),o(!1),e.finish(20);case 21:case"end":return e.stop()}},e,null,[[2,19,20,21],[13,15]])}),n=function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(e){y(i,r,a,o,s,"next",e)}function s(e){y(i,r,a,o,s,"throw",e)}o(void 0)})},function(e,t,r,a){return n.apply(this,arguments)})}},w=n(35365);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return k(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var j=function(){var e,t;return e=function e(t,n){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");this.groupStats=t,this.playerNames=n},t=[{key:"analyzeStats",value:function(){var e=[];return e.push.apply(e,N(this.analyzeMatschStats())),e.push.apply(e,N(this.analyzeSchneiderStats())),e.push.apply(e,N(this.analyzeWinRateStats())),e.push.apply(e,N(this.analyzeSpeedStats())),e.push.apply(e,N(this.analyzeVeteranStats())),e.push.apply(e,N(this.analyzeTeamStats())),e.push.apply(e,N(this.analyzeSessionStats())),e.sort(function(e,t){return t.relevanceScore-e.relevanceScore}),e}},{key:"analyzeMatschStats",value:function(){var e=[];if(this.groupStats.avgMatschPerGame&&this.groupStats.avgMatschPerGame>0){var t=this.groupStats.avgMatschPerGame;t>=1.5&&e.push({category:"matsch",subcategory:"high",relevanceScore:Math.min(85,60+10*t),playerName:void 0,data:{value:t,displayValue:"".concat(t.toFixed(1)),eventsPlayed:this.groupStats.gameCount||0,context:{sessionType:"team",eventType:"matsch"}},contextType:"team",isPositive:!1,isSurprising:t>2})}if(this.groupStats.playerWithHighestMatschBilanz&&this.groupStats.playerWithHighestMatschBilanz.length>0){var n=this.groupStats.playerWithHighestMatschBilanz[0],r=this.playerNames.get(n.playerId)||n.playerName||"Unbekannt",a=n.value;Math.abs(a)>8&&e.push({category:"matsch",subcategory:a>0?"veteran_positive":"veteran_negative",relevanceScore:Math.min(75,50+2*Math.abs(a)),playerName:r,data:{value:a,displayValue:a>0?"+".concat(a):"".concat(a),eventsPlayed:this.groupStats.gameCount||0,context:{type:"veteran_stat",isHistorical:!0}},contextType:"player",isPositive:a>0,isSurprising:Math.abs(a)>12})}return e}},{key:"analyzeSchneiderStats",value:function(){var e=[];if(this.groupStats.playerWithHighestSchneiderBilanz&&this.groupStats.playerWithHighestSchneiderBilanz.length>0){var t=this.groupStats.playerWithHighestSchneiderBilanz[0],n=t.value;if(Math.abs(n)>5){var r=this.playerNames.get(t.playerId)||t.playerName||"Unbekannt";e.push({category:"schneider",subcategory:n>0?"veteran_positive":"veteran_negative",relevanceScore:Math.min(70,40+5*Math.abs(n)),playerName:r,data:{value:n,displayValue:n>0?"+".concat(n):"".concat(n),eventsPlayed:this.groupStats.gameCount||0,context:{type:"veteran_stat",isHistorical:!0}},contextType:"player",isPositive:n>0,isSurprising:Math.abs(n)>8})}}return e}},{key:"analyzeWinRateStats",value:function(){var e=[];if(this.groupStats.playerWithHighestWinRateGame&&this.groupStats.playerWithHighestWinRateGame.length>0){var t=this.groupStats.playerWithHighestWinRateGame[0],n=this.playerNames.get(t.playerId)||t.playerName||"Unbekannt",r=100*t.value;r>60&&e.push({category:"winrate",subcategory:"high",relevanceScore:Math.min(85,50+(r-50)),playerName:n,data:{value:r,displayValue:"".concat(Math.round(r),"%"),eventsPlayed:t.eventsPlayed||0,context:{value:t.value}},contextType:"player",isPositive:!0,isSurprising:r>80}),r<40&&e.push({category:"winrate",subcategory:"low",relevanceScore:Math.min(70,40+(50-r)),playerName:n,data:{value:r,displayValue:"".concat(Math.round(r),"%"),eventsPlayed:t.eventsPlayed||0,context:{value:t.value}},contextType:"player",isPositive:!1,isSurprising:r<20})}return e}},{key:"analyzeSpeedStats",value:function(){var e=[];if(this.groupStats.playerWithFastestRounds&&this.groupStats.playerWithFastestRounds.length>0){var t=this.groupStats.playerWithFastestRounds[0],n=this.playerNames.get(t.playerId)||t.playerName||"Unbekannt",r=t.value;r<300&&e.push({category:"speed",subcategory:"fastest",relevanceScore:Math.min(60,40+(300-r)/10),playerName:n,data:{value:r,displayValue:this.formatDuration(r),eventsPlayed:t.eventsPlayed||0,context:{type:"fast"}},contextType:"player",isPositive:!0,isSurprising:r<180})}if(this.groupStats.playerWithSlowestRounds&&this.groupStats.playerWithSlowestRounds.length>0){var a=this.groupStats.playerWithSlowestRounds[0],i=this.playerNames.get(a.playerId)||a.playerName||"Unbekannt",o=a.value;o>360&&e.push({category:"speed",subcategory:"slowest",relevanceScore:Math.min(55,30+(o-360)/20),playerName:i,data:{value:o,displayValue:this.formatDuration(o),eventsPlayed:a.eventsPlayed||0,context:{type:"slow"}},contextType:"player",isPositive:!1,isSurprising:o>600})}return e}},{key:"analyzeVeteranStats",value:function(){var e=[];if(this.groupStats.playerWithMostGames&&this.groupStats.playerWithMostGames.length>0){var t=this.groupStats.playerWithMostGames[0],n=this.playerNames.get(t.playerId)||t.playerName||"Unbekannt",r=t.value;r>30&&e.push({category:"veteran",subcategory:"experienced",relevanceScore:Math.min(50,20+r),playerName:n,data:{value:r,displayValue:"".concat(r),eventsPlayed:r,context:{status:"veteran"}},contextType:"player",isPositive:!0,isSurprising:r>100}),r<5&&e.push({category:"veteran",subcategory:"newcomer",relevanceScore:30,playerName:n,data:{value:r,displayValue:"".concat(r),eventsPlayed:r,context:{status:"newcomer"}},contextType:"player",isPositive:!1,isSurprising:!1})}return e}},{key:"analyzeTeamStats",value:function(){var e=[];if(this.groupStats.teamWithHighestWinRateGame&&this.groupStats.teamWithHighestWinRateGame.length>0){var t=this.groupStats.teamWithHighestWinRateGame[0],n=t.names||["Team"],r=("number"==typeof t.value?t.value:0)*100;r>60&&(t.eventsPlayed||0)>3&&e.push({category:"team",subcategory:"chemistry",relevanceScore:Math.min(65,35+(r-50)),teamNames:n,data:{value:r,displayValue:"".concat(Math.round(r),"%"),eventsPlayed:t.eventsPlayed||0,context:{made:t.eventsMade||0,received:t.eventsReceived||0}},contextType:"team",isPositive:!0,isSurprising:r>80}),r<35&&(t.eventsPlayed||0)>3&&e.push({category:"team",subcategory:"chemistry",relevanceScore:Math.min(60,30+(50-r)),teamNames:n,data:{value:r,displayValue:"".concat(Math.round(r),"%"),eventsPlayed:t.eventsPlayed||0,context:{made:t.eventsMade||0,received:t.eventsReceived||0}},contextType:"team",isPositive:!1,isSurprising:r<20})}return e}},{key:"analyzeSessionStats",value:function(){var e=[];if(this.groupStats.avgGamesPerSession>4){var t=this.groupStats.avgGamesPerSession;e.push({category:"session",subcategory:"marathon",relevanceScore:Math.min(40,20+3*t),data:{value:t,displayValue:"".concat(Math.round(t)),eventsPlayed:this.groupStats.gameCount||0,context:{type:"marathon"}},contextType:"session",isPositive:!0,isSurprising:t>8})}if(this.groupStats.avgGamesPerSession<2){var n=this.groupStats.avgGamesPerSession;e.push({category:"session",subcategory:"short",relevanceScore:25,data:{value:n,displayValue:"".concat(Math.round(n)),eventsPlayed:this.groupStats.gameCount||0,context:{type:"short"}},contextType:"session",isPositive:!1,isSurprising:!1})}return e}},{key:"formatDuration",value:function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60);return t>0?"".concat(t,":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")):"".concat(n,":").concat(r.toString().padStart(2,"0"))}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){var t=function(e,t){if("object"!=x(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=x(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==x(t)?t:t+""}(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function T(e){var t=function(e,t){if("object"!=M(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=M(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==M(t)?t:t+""}var P={matsch:[{id:"matsch_witzig_1",template:"{playerName} sammelt {value} Matsch-Punkte wie ein Profi!",tonality:"witzig",priority:80,context:["high_matsch","individual_dominance"]},{id:"matsch_statistisch_1",template:"{playerName} f\xfchrt mit {value} Matsch-Ereignissen (+{diff} zum Durchschnitt)",tonality:"statistisch",priority:70,context:["statistical_comparison"]},{id:"matsch_witzig_2",template:"{playerName} ist heute der ungekr\xf6nte Matsch-K\xf6nig mit {value} Treffern!",tonality:"witzig",priority:85,context:["high_matsch","individual_dominance"]},{id:"matsch_witzig_3",template:"Matsch-Alarm! {playerName} r\xe4umt mit {value} Matschen ab wie ein Staubsauger!",tonality:"witzig",priority:80,context:["high_matsch","session_highlight"]},{id:"matsch_witzig_4",template:"{playerName} macht {value} Matsche - das ist schon fast eine Kunst!",tonality:"witzig",priority:75,context:["high_matsch","appreciation"]},{id:"matsch_witzig_5",template:"Matsch-Meister {playerName} zeigt heute, wie es geht: {value} perfekte Nullrunden!",tonality:"witzig",priority:85,context:["high_matsch","mastery"]},{id:"matsch_dramatisch_1",template:"{playerName} dominiert mit {value} Matschen - eine Demonstration der Macht!",tonality:"dramatisch",priority:90,context:["high_matsch","dominance"]},{id:"matsch_dramatisch_2",template:"Historisch! {playerName} erzielt {value} Matsche und schreibt Jass-Geschichte!",tonality:"dramatisch",priority:95,context:["record_breaking","historical"]},{id:"matsch_dramatisch_3",template:"Episch! {playerName} mit {value} Matschen - so entstehen Legenden!",tonality:"dramatisch",priority:88,context:["legendary_performance"]},{id:"matsch_statistisch_2",template:"Matsch-Statistik: {playerName} liegt mit {value} Ereignissen {diff}% \xfcber dem Gruppenschnitt",tonality:"statistisch",priority:75,context:["statistical_comparison","group_benchmark"]},{id:"matsch_statistisch_3",template:"Datenanalyse: {playerName} erzielt {value} Matsche (Erwartung: {expected})",tonality:"statistisch",priority:70,context:["expectation_vs_reality"]},{id:"matsch_motivierend_1",template:"{playerName} zeigt mit {value} Matschen, dass auch R\xfcckschl\xe4ge zum Erfolg f\xfchren!",tonality:"motivierend",priority:80,context:["resilience","positive_spin"]},{id:"matsch_motivierend_2",template:"Respekt! {playerName} macht aus {value} Matschen eine Tugend!",tonality:"motivierend",priority:85,context:["respect","character_building"]},{id:"matsch_l\xe4ssig_1",template:"{playerName} sammelt entspannt {value} Matsche - alles unter Kontrolle!",tonality:"l\xe4ssig",priority:70,context:["casual_excellence"]},{id:"matsch_l\xe4ssig_2",template:"Easy going: {playerName} macht {value} Matsche, als w\xe4re es das Normalste der Welt",tonality:"l\xe4ssig",priority:75,context:["effortless_performance"]}],schneider:[{id:"schneider_witzig_1",template:"{playerName} schneidet die Konkurrenz mit {value} Schneidern kurz und klein!",tonality:"witzig",priority:90,context:["high_schneider","competitive_edge"]},{id:"schneider_witzig_2",template:"Schneider-Alarm! {playerName} zerschnippelt mit {value} Schneidern die Hoffnungen der Gegner!",tonality:"witzig",priority:92,context:["high_schneider","devastation"]},{id:"schneider_witzig_3",template:"{playerName} ist heute der Schneider-Schneider mit {value} perfekten Schnitten!",tonality:"witzig",priority:85,context:["wordplay","perfection"]},{id:"schneider_witzig_4",template:"Schnipp-schnapp! {playerName} macht {value} Schneider - die Schere sitzt!",tonality:"witzig",priority:88,context:["sound_effect","precision"]},{id:"schneider_witzig_5",template:"{playerName} n\xe4ht heute {value} Schneider-Kost\xfcme - ma\xdfgeschneidert f\xfcr jeden Gegner!",tonality:"witzig",priority:80,context:["metaphor","customization"]},{id:"schneider_dramatisch_1",template:"SENSATION! {playerName} erzielt {value} Schneider - das ist Jass-Geschichte!",tonality:"dramatisch",priority:98,context:["sensation","historical"]},{id:"schneider_dramatisch_2",template:"Unglaublich! {playerName} dominiert mit {value} Schneidern - eine Machtdemonstration!",tonality:"dramatisch",priority:95,context:["dominance","power_display"]},{id:"schneider_dramatisch_3",template:"Spektakul\xe4r! {playerName} mit {value} Schneidern - so wird Geschichte geschrieben!",tonality:"dramatisch",priority:93,context:["spectacular","legacy"]},{id:"schneider_statistisch_1",template:"Schneider-Analyse: {playerName} erreicht {value} Ereignisse ({diff}% \xfcber Erwartung)",tonality:"statistisch",priority:75,context:["statistical_analysis","expectation_exceeded"]},{id:"schneider_statistisch_2",template:"Datenbasiert: {playerName} mit {value} Schneidern - Effizienz auf h\xf6chstem Niveau",tonality:"statistisch",priority:80,context:["efficiency","data_driven"]},{id:"schneider_motivierend_1",template:"{playerName} zeigt mit {value} Schneidern, wie man Perfektion anstrebt!",tonality:"motivierend",priority:85,context:["perfection_pursuit","inspiration"]},{id:"schneider_motivierend_2",template:"Vorbildlich! {playerName} macht {value} Schneider - ein Beispiel f\xfcr alle!",tonality:"motivierend",priority:82,context:["role_model","exemplary"]},{id:"schneider_l\xe4ssig_1",template:"{playerName} macht entspannt {value} Schneider - sieht einfach aus, ist aber Kunst!",tonality:"l\xe4ssig",priority:78,context:["effortless_mastery"]}],winrate:[{id:"winrate_statistisch_1",template:"{playerName} dominiert mit {value}% Siegquote - mathematisch \xfcberlegen!",tonality:"statistisch",priority:85,context:["statistical_dominance"]},{id:"winrate_witzig_1",template:"{playerName} gewinnt {value}% der Spiele - fast wie ein Cheat-Code!",tonality:"witzig",priority:85,context:["gaming_reference","dominance"]}],speed:[{id:"speed_witzig_1",template:"{playerName} spielt in {value} - Zeit ist Geld!",tonality:"witzig",priority:75,context:["time_value"]}],veteran:[{id:"veteran_respektvoll_1",template:"{playerName} bringt {value} Spiele Erfahrung mit - ein wahrer Veteran!",tonality:"respektvoll",priority:85,context:["experience_value"]}],team:[{id:"team_witzig_1",template:"{teamNames} harmonieren perfekt - ein eingespieltes Team!",tonality:"witzig",priority:80,context:["harmony","teamwork"]}],session:[{id:"session_witzig_1",template:"Diese Session: {value} - ein Marathon der Extraklasse!",tonality:"witzig",priority:75,context:["marathon_session"]}]},z=function(){var e,t;return e=function e(t){var n,r;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");n="templates",r=new Map,(n=T(n))in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this.config=t,this.initializeTemplates()},t=[{key:"initializeTemplates",value:function(){var e=this;Object.entries(P).forEach(function(t){var n=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,l=!1;try{i=(n=n.call(e)).next,!1;for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}(t,2)||function(e,t){if(e){if("string"==typeof e)return E(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=n[0],a=n[1].map(function(t){return{category:r,condition:function(){return!0},templates:[function(e,n){var r=t.template;return e.playerName&&(r=r.replace(/\{playerName\}/g,e.playerName)),void 0!==e.data.value&&(r=r.replace(/\{value\}/g,String(e.data.value))),e.data.displayValue&&(r=r.replace(/\{displayValue\}/g,e.data.displayValue)),r}],tones:[t.tonality],minRelevance:e.config.minRelevance}});e.templates.set(r,a)})}},{key:"generateContext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.selectSmartTemplate(e,t,n);if(!r)return null;var a=t[0];return a?(0,r.templates[0])(a,r.tones[0]):null}},{key:"getAvailableTemplates",value:function(){return this.templates}},{key:"selectSmartTemplate",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=this.templates.get(e)||[];return 0===n.length?null:n[0]||null}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=O(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function O(e,t){if(e){if("string"==typeof e)return W(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=C(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}var G=function(){var e,t;return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(this instanceof e))throw TypeError("Cannot call a class as a function");this.rules=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){var r,a,i;r=e,a=t,i=n[t],(a=R(a))in r?Object.defineProperty(r,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({maxContexts:6,minRelevanceScore:50,diversityBonus:10,surpriseBonus:15,categoryPriority:new Map([["matsch",100],["schneider",90],["winrate",80],["team",70],["veteran",60],["speed",50],["session",40]]),redundancyThreshold:.7},t),this.commonWords=new Set(["der","die","das","und","oder","mit","ein","eine","einen","einer","eines","ist","sind","war","waren","hat","haben","wird","werden","kann","k\xf6nnte","sehr","mehr","auch","nur","noch","schon","aber","doch","dann","wenn","bei","von","zu","f\xfcr","auf","an","in","um","\xfcber","unter","vor","nach","spiel","spiele","spielen","spieler","runde","runden","jass","heute","hier"])},t=[{key:"composeOptimalSprueche",value:function(e,t){var n=this.prepareCandidates(e,t),r=this.removeRedundantSprueche(n),a=this.optimizeForDiversity(r);return this.selectFinalSprueche(a).map(function(e){return e.text})}},{key:"prepareCandidates",value:function(e,t){var n=this,r=[];return e.forEach(function(e){r.push({text:e,category:n.categorizeExistingSpruch(e),relevanceScore:100,source:"existing",keywords:n.extractKeywords(e)})}),t.forEach(function(e){r.push({text:e.text,category:e.category,relevanceScore:e.relevanceScore,source:"context",keywords:n.extractKeywords(e.text),metadata:e.insight})}),r}},{key:"removeRedundantSprueche",value:function(e){for(var t=[],n=new Set,r=0;r<e.length;r++)if(!n.has(r)){var a,i=e[r],o=!0,s=_(t);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(this.calculateSimilarity(i,c).score>this.rules.redundancyThreshold){if(i.relevanceScore>c.relevanceScore){var l=t.indexOf(c);t[l]=i}o=!1;break}}}catch(e){s.e(e)}finally{s.f()}o&&t.push(i),n.add(r)}return t}},{key:"optimizeForDiversity",value:function(e){var t,n=this,r=new Map,a=[],i=_(A(e).sort(function(e,t){var a=n.calculateFinalScore(e,r);return n.calculateFinalScore(t,r)-a}));try{for(i.s();!(t=i.n()).done;){var o=t.value,s=r.get(o.category)||0;(s<2||o.relevanceScore>90)&&(a.push(o),r.set(o.category,s+1))}}catch(e){i.e(e)}finally{i.f()}return a}},{key:"selectFinalSprueche",value:function(e){var t=this;return A(e).sort(function(e,n){var r=t.calculateFinalScore(e,new Map);return t.calculateFinalScore(n,new Map)-r}).slice(0,this.rules.maxContexts)}},{key:"calculateSimilarity",value:function(e,t){var n=new Set(e.keywords),r=new Set(t.keywords),a=Array.from(n).filter(function(e){return r.has(e)}),i=new Set([].concat(A(n),A(r))).size;return{score:Math.min(1,a.length/i+.2*(e.category===t.category)+this.calculateThematicSimilarity(e.text,t.text)),keywords:a,sharedTokens:a}}},{key:"calculateThematicSimilarity",value:function(e,t){var n=0,r=(e.match(/\d+/g)||[]).map(Number),a=(t.match(/\d+/g)||[]).map(Number);r.filter(function(e){return a.includes(e)}).length>0&&(n+=.3);var i=["matsch","schneider","konter","weis","trumpf","marathon","schnell","langsam","veteran","newcomer","champion","bilanz","win-rate","team","dream-team"],o=i.filter(function(t){return e.toLowerCase().includes(t)}),s=i.filter(function(e){return t.toLowerCase().includes(e)}),c=o.filter(function(e){return s.includes(e)});return c.length>0&&(n+=.2*c.length),Math.min(.5,n)}},{key:"extractKeywords",value:function(e){var t=this;return Array.from(new Set(e.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(function(e){return e.length>2&&!t.commonWords.has(e)})))}},{key:"categorizeExistingSpruch",value:function(e){var t=e.toLowerCase();return t.includes("matsch")?"matsch":t.includes("schneider")?"schneider":t.includes("konter")?"matsch":t.includes("win-rate")||t.includes("siege")?"winrate":t.includes("team")||t.includes("duo")?"team":t.includes("veteran")||t.includes("spiele")?"veteran":t.includes("schnell")||t.includes("langsam")||t.includes("tempo")?"speed":t.includes("marathon")||t.includes("session")?"session":"general"}},{key:"calculateFinalScore",value:function(e,t){var n,r=e.relevanceScore;return r+=.1*(this.rules.categoryPriority.get(e.category)||50),0===(t.get(e.category)||0)&&(r+=this.rules.diversityBonus),null!=(n=e.metadata)&&n.isSurprising&&(r+=this.rules.surpriseBonus),"existing"===e.source&&(r+=5),r}},{key:"analyzeRedundancy",value:function(e){}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t,n){return(t=F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=I(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:t+""}var V=function(){var e,t;return e=function e(t,n,r){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");L(this,"sessionCharacteristics",null),this.groupStats=t,this.playerNames=n,this.config=r;var a=new Map(Object.entries(n));this.analyzer=new j(t,a),this.templateSystem=new z({minRelevance:r.minRelevance,maxTemplatesPerCategory:r.maxContexts,defaultTone:"witzig"}),this.compositor=new G({maxContexts:r.maxContexts,minRelevanceScore:r.minRelevance,redundancyThreshold:r.redundancyThreshold,diversityBonus:0,surpriseBonus:0,categoryPriority:new Map})},t=[{key:"generateEnhancedSprueche",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Date.now();this.sessionCharacteristics=this.calculateSessionCharacteristics();var n=this.analyzer.analyzeStats(),r=this.filterInsightsByContext(n),a=this.selectSmartCandidates(r),i=this.simplifyComposition(a,e),o=Date.now()-t;return{sprueche:i,metadata:{totalInsights:n.length,contextualInsights:r.length,redundancyRemoved:a.length-i.length,processingTime:o,sessionCharacteristics:this.sessionCharacteristics}}}},{key:"simplifyComposition",value:function(e,t){var n=this;return e.filter(function(e){return!t.some(function(t){return n.calculateSimpleSimilarity(e,t)>.7})}).slice(0,this.config.maxContexts)}},{key:"calculateSimpleSimilarity",value:function(e,t){var n=function(e){return e.toLowerCase().replace(/[^\w]/g,"")},r=n(e),a=n(t);return r===a?1:r.includes(a)||a.includes(r)?.8:0}},{key:"calculateSessionCharacteristics",value:function(){var e=this.groupStats.playerWithHighestMatschBilanz,t=this.groupStats.playerWithHighestSchneiderBilanz,n=this.groupStats.playerWithFastestRounds,r=this.groupStats.playerWithHighestWinRateGame,a=this.calculateMatschIntensity(e||void 0),i=this.calculateSchneiderActivity(t||void 0),o=this.calculateSpeedVariance(n||void 0),s=this.calculateCompetitiveness(r||void 0),c=this.calculateDominance(r||void 0);return{matschIntensity:a,schneiderActivity:i,speedVariance:o,competitiveness:s,dominance:c,isEventRich:a>=70||i>=65,isBalanced:s>=75&&c<50,isSpeedFocused:o>=60}}},{key:"filterInsightsByContext",value:function(e){var t=this.sessionCharacteristics;return t?e.filter(function(e){return("matsch"!==e.category||!(t.matschIntensity<65))&&("schneider"!==e.category||!(t.schneiderActivity<55))&&("speed"!==e.category||!(t.speedVariance<50))&&("winrate"!==e.category||!(t.competitiveness<60)||!(t.dominance<70))}):e}},{key:"selectSmartCandidates",value:function(e){var t,n=[],r=new Set,a=new Set,i=new Set,o=new Map,s=new Map,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return H(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}(e))){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}(e.sort(function(e,t){var n=e.relevanceScore+10*!!e.isSurprising,r=t.relevanceScore+10*!!t.isSurprising,a=o.get(e.category)||100;return r+.3*(o.get(t.category)||100)-(n+.3*a)}));try{for(c.s();!(t=c.n()).done;){var l=t.value;if(!r.has(l.category)||!(l.relevanceScore<95)){var u="".concat(l.category,"_").concat(l.subcategory);if(!(a.has(u)||l.playerName&&i.has(l.playerName))){var h="".concat(l.category,"_").concat(l.subcategory);if(!(60>(s.get(h)||100))||!(l.relevanceScore<90)){var m=this.buildSessionContext(),p=this.templateSystem.generateContext(l.category,[l],m);if(p&&p.length>10&&(n.push(p),r.add(l.category),a.add(u),l.playerName&&i.add(l.playerName),o.set(l.category,(o.get(l.category)||100)-30),s.set(h,(s.get(h)||100)-40),n.length>=3))break}}}}}catch(e){c.e(e)}finally{c.f()}return n}},{key:"buildSessionContext",value:function(){var e=[];if(!this.sessionCharacteristics)return e;var t=this.sessionCharacteristics;return t.matschIntensity>=60&&e.push("high_matsch","event_rich"),t.schneiderActivity>=60&&e.push("high_schneider","sensation"),t.schneiderActivity>=90&&e.push("schneider_sensation","historical"),t.isEventRich&&e.push("event_rich","dramatic"),t.isBalanced&&e.push("balanced","competitive"),t.isSpeedFocused&&e.push("speed_focused","efficiency"),t.dominance>=80?e.push("dominance","one_sided"):t.competitiveness>=70&&e.push("competitive","close_match"),e}},{key:"calculateMatschIntensity",value:function(e){if(!this.groupStats.avgMatschPerGame)return 0;var t=this.groupStats.avgMatschPerGame,n=this.groupStats.gameCount||1,r=0;return t>=2.5?r+=40:t>=2?r+=30:t>=1.5?r+=20:t>=1&&(r+=10),n>=3&&(r+=Math.min(20,2*n)),n<2&&(r*=.5),Math.min(100,r)}},{key:"calculateSchneiderActivity",value:function(e){if(!e||0===e.length)return 0;var t=Math.abs(e[0].value||0),n=this.groupStats.gameCount||1,r=0;return t>=5?r+=40:t>=3?r+=25:t>=2?r+=15:t>=1&&(r+=5),n>=3&&(r+=Math.min(25,3*n)),n<2&&(r*=.6),Math.min(100,r)}},{key:"calculateSpeedVariance",value:function(e){if(!e||0===e.length)return 0;var t=e[0].value||0,n=this.groupStats.gameCount||1,r=0;return t<30?r+=35:t<45?r+=25:t>180?r+=35:t>120&&(r+=25),n>=3&&(r+=Math.min(20,2*n)),Math.min(100,r)}},{key:"calculateCompetitiveness",value:function(e){if(!e||0===e.length)return 0;var t=e[0].value||0,n=this.groupStats.gameCount||1,r=0;return t>=.4&&t<=.6?r+=40:t>=.35&&t<=.65?r+=25:t>=.3&&t<=.7&&(r+=15),n>=4&&(r+=Math.min(30,3*n)),Math.min(100,r)}},{key:"calculateDominance",value:function(e){if(!e||0===e.length)return 0;var t=e[0].value||0,n=this.groupStats.gameCount||1,r=0;return t>=.8?r+=50:t>=.7?r+=35:t>=.6&&(r+=20),n>=3&&(r+=Math.min(25,2*n)),Math.min(100,r)}},{key:"getDebugInfo",value:function(){return{sessionCharacteristics:this.sessionCharacteristics,groupStats:{avgMatschPerGame:this.groupStats.avgMatschPerGame,sessionCount:this.groupStats.sessionCount,gameCount:this.groupStats.gameCount},config:this.config}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(),K=n(54573),J=[function(e){return{text:"".concat(e.winnerNames.join(" & ")," lassen keine Zweifel am Sieg - das war deutlich!"),icon:"\uD83D\uDCAA"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," m\xfcssen sich geschlagen geben - da war mehr drin!"),icon:"\uD83E\uDD37"}},function(e){return{text:"Klarer Sieg f\xfcr ".concat(e.winnerNames.join(" & ")," - die Karten haben heute gesprochen!"),icon:""}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben den Jass im Griff gehabt!"),icon:"✊"}},function(e){return{text:"Da hilft auch kein Jammern mehr - ".concat(e.winnerNames.join(" & ")," waren einfach besser!"),icon:"\uD83D\uDE24"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," haben heute mit Trump statt Trumpf gespielt!"),icon:"\uD83C\uDCCF"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," zeigen, wie man einen Jass nach Hause bringt!"),icon:"\uD83C\uDFC6"}},function(e){return{text:"Die Rechnung geht auf: ".concat(e.winnerNames.join(" & ")," gewinnen souver\xe4n!"),icon:"\uD83E\uDDEE"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," haben beim Ablupfen die Nerven verloren!"),icon:"\uD83C\uDFAF"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben das Spiel diktiert - verdienter Sieg!"),icon:"\uD83D\uDC4A"}}],U=[function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben mit EINEM Strich Vorsprung gewonnen - knappe Siege sind die sch\xf6nsten!"),icon:"\uD83D\uDD7A"}},function(e){return{text:"Knapper ging's nicht! ".concat(e.winnerNames.join(" & ")," gewinnen mit einem Strich!"),icon:"\uD83C\uDFAF"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," h\xe4tten nur EINEN Strich mehr gebraucht... bitter!"),icon:"\uD83D\uDE24"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," gewinnen hauchzart - das war Millimeterarbeit!"),icon:"\uD83D\uDCCF"}},function(e){return{text:"Ein Wimpernschlag entscheidet - ".concat(e.loserNames.join(" & ")," fehlt genau EIN Punkt!"),icon:"\uD83D\uDC41️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben das Qu\xe4ntchen Gl\xfcck auf ihrer Seite!"),icon:"\uD83C\uDF40"}},function(e){return{text:"Autsch! ".concat(e.loserNames.join(" & ")," verlieren um Haaresbreite"),icon:"\uD83E\uDD2C"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," zittern sich zum Sieg - knapper geht's nicht!"),icon:"\uD83D\uDE30"}},function(e){return{text:"Ein Strich zwischen Himmel und H\xf6lle - ".concat(e.loserNames.join(" & ")," fehlt haarscharf der Sieg"),icon:"\uD83D\uDE2B"}}],Z=[function(e){return{text:"".concat(e.winnerNames.join(" & ")," dominieren den Jass!"),icon:"\uD83D\uDC51"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," haben vergeblich auf ein Comeback gehofft..."),icon:"\uD83D\uDE14"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben heute alle Tr\xfcmpfe in der Hand gehabt!"),icon:"\uD83C\uDFAF"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden regelrecht \xfcbertrumpft!"),icon:"\uD83D\uDCA5"}},function(e){return{text:"Eine Jass-Lektion von ".concat(e.winnerNames.join(" & "),"!"),icon:""}},function(e){return{text:"".concat(e.loserNames.join(" & ")," hatten heute keine Chance gegen diese Kartenkunst!"),icon:""}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben die Karten heute tanzen lassen!"),icon:"\uD83D\uDC83"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden heute richtig alt aussehen gelassen!"),icon:"\uD83D\uDC74"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben heute alle Register gezogen!"),icon:"\uD83C\uDFAA"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden heute regelrecht vorgef\xfchrt!"),icon:"\uD83C\uDFAD"}}],q=[function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben den Jass knapp f\xfcr sich entschieden!"),icon:""}},function(e){return{text:"Die W\xfcrfel sind knapp zu Gunsten von ".concat(e.winnerNames.join(" & ")," gefallen!"),icon:"\uD83C\uDFB2"}},function(e){return{text:"Ein Kopf-an-Kopf-Rennen, aber ".concat(e.winnerNames.join(" & ")," haben die Nase vorn!"),icon:"\uD83C\uDFC3"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," schnuppern am Sieg - aber es reicht nicht ganz"),icon:"\uD83D\uDC43"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," klettern knapp auf den Siegerthron."),icon:"\uD83D\uDC51"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben den l\xe4ngeren Atem bewiesen!"),icon:"\uD83C\uDF2C️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben etwas besser abglupft!"),icon:""}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben die wichtigen Tr\xfcmpfe zur richtigen Zeit gespielt!"),icon:"♠️"}},function(e){return{text:"Knapp gewonnen ist auch gewonnen - gut gespielt, ".concat(e.winnerNames.join(" & "),"!"),icon:"\uD83C\uDFAF"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben die entscheidenden Stiche gemacht!"),icon:"\uD83C\uDCCF"}}],Y=[function(e){return{text:"".concat(e.winnerNames.join(" & ")," machen kurzen Prozess!"),icon:"☠️"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," kriegen heute einen Einlauf!"),icon:" \uD83D\uDCA6"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden heute in Grund und Boden gejasst!"),icon:"⚰️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," spielen in einer anderen Liga!"),icon:"\uD83C\uDFC6"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," sollten vielleicht UNO spielen statt Jassen..."),icon:"\uD83C\uDCCF"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," zeigen keine Gnade - brutaler Sieg!"),icon:"\uD83D\uDD25"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden heute regelrecht zerlegt!"),icon:"\uD83E\uDE9A"}},function(e){return{text:"Das grenzt an K\xf6rperverletzung, was ".concat(e.winnerNames.join(" & ")," hier abziehen!"),icon:"\uD83E\uDD15"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden heute zum Jass-Statisten degradiert!"),icon:"\uD83C\uDFAC"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," f\xfchrten heute eine \xf6ffentliche Jass-Hinrichtung durch!"),icon:"⚔️"}}],$=[function(){return{text:"Was f\xfcr ein Jass! Am Ende steht es unentschieden!",icon:"\uD83E\uDD1D"}},function(){return{text:"Unglaublich - nach all den Spielen steht es gleich!",icon:"\uD83E\uDD2F"}},function(){return{text:"Wie die Zwillinge im Horoskop - perfekt ausgeglichen!",icon:"⚖️"}},function(){return{text:"Keiner gewinnt, keiner verliert - Jass-Zen in Perfektion!",icon:"☯️"}},function(){return{text:"Ein Unentschieden? Das muss man auch erst mal schaffen!",icon:"\uD83C\uDFAF"}},function(){return{text:"Gleichstand nach epischem Kampf - Salomon w\xe4re stolz!",icon:"\uD83D\uDC51"}},function(){return{text:"Zwei Teams, ein Punktestand - das ist Jass-Poesie!",icon:"\uD83D\uDCDD"}},function(){return{text:"Punktgleichheit? Da mussten die Mathematiker zweimal rechnen!",icon:"\uD83E\uDDEE"}},function(){return{text:"Ein historischer Moment - selbst die Jass-G\xf6tter applaudieren!",icon:"\uD83D\uDC4F"}},function(){return{text:"Beide Teams waren so gut, dass sich sogar die Punkte nicht entscheiden konnten!",icon:"\uD83C\uDFAD"}}],X=[function(e){return{text:"".concat(e.winnerNames.join(" & ")," richten ein Massaker an!"),icon:"\uD83D\uDD2A"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden gerade \xf6ffentlich hingerichtet!"),icon:"⚰️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," zermalmen alles zu Staub!"),icon:"\uD83D\uDCA3"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden atomisiert - das tat beim Zuschauen weh!"),icon:"☢️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," veranstalten hier ein Blutbad!"),icon:"\uD83E\uDE78"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden gerade aus dem Jass-Universum geschossen!"),icon:"\uD83D\uDE80"}},function(e){return{text:"Brutaler geht's nicht! ".concat(e.winnerNames.join(" & ")," zerst\xf6ren alles!"),icon:"\uD83D\uDCA5"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," sollten sich einen neuen Sport suchen..."),icon:"\uD83C\uDFF3️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," spielen wie die G\xf6tter - das ist Jass-Perfektion!"),icon:"\uD83D\uDC79"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden gerade aus allen Dimensionen gejasst!"),icon:"\uD83C\uDF2A️"}},function(e){return{text:"APOKALYPSE NOW! ".concat(e.winnerNames.join(" & ")," haben ").concat(e.loserNames.join(" & ")," dem Erdboden gleichgemacht!"),icon:"\uD83C\uDF0B"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," wurden soeben ins Mittelalter zur\xfcckgejasst!"),icon:"⚔️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben die Genfer Konvention des Jassens verletzt!"),icon:"\uD83D\uDEA8"}},function(e){return{text:"NOTARZT! ".concat(e.loserNames.join(" & ")," brauchen psychologische Betreuung nach dieser Dem\xfctigung!"),icon:"\uD83D\uDE91"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben ").concat(e.loserNames.join(" & ")," in ihre Einzelteile zerlegt!"),icon:"\uD83D\uDD28"}},function(e){return{text:"Das war kein Jass, das war eine EXEKUTION! ".concat(e.loserNames.join(" & ")," R.I.P."),icon:"\uD83D\uDC80"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben den JASS-THRON bestiegen - ").concat(e.loserNames.join(" & ")," knien!"),icon:"\uD83D\uDC51"}},function(e){return{text:"UNFASSBAR! ".concat(e.loserNames.join(" & ")," wurden gerade live im TV vernichtet!"),icon:"\uD83D\uDCFA"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben ").concat(e.loserNames.join(" & ")," ins Schattenreich verbannt!"),icon:"\uD83C\uDF11"}},function(e){return{text:"GAME OVER! ".concat(e.loserNames.join(" & ")," wurden aus dem Spiel gel\xf6scht!"),icon:"\uD83C\uDFAE"}}],Q=[function(e){return{text:"Autsch! ".concat(e.loserNames.join(" & ")," wurden beschneidert! Das tut weh!"),icon:"✂️"}},function(e){return{text:"".concat(e.loserNames.join(" & ")," haben gek\xe4mpft wie das tapfere Schneiderlein... am Ende wurden sie trotzdem beschnitten!"),icon:"✂️"}},function(e){return{text:"Schnipp, schnapp, Schneider! ".concat(e.loserNames.join(" & ")," wurden zurechtgestutzt!"),icon:"✂️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben ").concat(e.loserNames.join(" & ")," regelrecht filetiert - Schneider!"),icon:"\uD83C\uDF7D️"}},function(e){return{text:"Brutal! ".concat(e.winnerNames.join(" & ")," haben die Schere richtig angesetzt!"),icon:"\uD83D\uDC87‍♂️"}},function(e){return{text:"Schneider! ".concat(e.loserNames.join(" & ")," wurden von ").concat(e.winnerNames.join(" & ")," regelrecht zerschnippelt!"),icon:"\uD83E\uDD9E"}},function(e){return{text:"Eine messerscharfe Vorstellung von ".concat(e.winnerNames.join(" & ")," - Beschneiderung f\xfcr die Gegner!"),icon:"\uD83D\uDD2A"}},function(e){return{text:"Das war chirurgisch pr\xe4zise! ".concat(e.loserNames.join(" & ")," wurden sauber beschnitten!"),icon:"✂️"}},function(e){return{text:"".concat(e.winnerNames.join(" & ")," haben die Schneider-Schere ausgepackt - autsch!"),icon:"✂️"}},function(e){return{text:"Schneiderei deluxe! ".concat(e.loserNames.join(" & ")," wurden fachgerecht gestutzt!"),icon:"\uD83E\uDD9E"}}],ee=function(e){var t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4);return t>0?"".concat(t," ").concat(1===t?"Stunde":"Stunden"," und ").concat(n," ").concat(1===n?"Minute":"Minuten"):"".concat(n," ").concat(1===n?"Minute":"Minuten")},et=function(e,t){return function(n){return{text:e(ee(n.timerAnalytics.totalJassTime)),icon:t}}},en={blitz_schnell:[et(function(e){return"Rasanter Jass in nur ".concat(e,"!")},"\uD83C\uDFC3"),et(function(e){return"Schneller als der Blitz: ".concat(e," von Start bis Ziel!")},"⚡"),et(function(e){return"Express-Jass in ".concat(e," - Rekordverd\xe4chtig!")},"\uD83D\uDCA8")],schnell:[et(function(e){return"Z\xfcgig durchgespielt in ".concat(e,"!")},"\uD83D\uDC07"),et(function(e){return"Ein flottes Spielchen von ".concat(e)},"\uD83D\uDC07"),et(function(e){return"".concat(e," - das nenne ich effizientes Jassen!")},"\uD83D\uDC07")],normal:[et(function(e){return"Ein perfekt getakteter Jass von ".concat(e)},"⏱"),et(function(e){return"".concat(e," geselliges Jassen - wie es sein soll!")},"\uD83E\uDD73"),et(function(e){return"".concat(e," Jassvergn\xfcgen in bester Gesellschaft")},"\uD83C\uDF7B")],gemütlich:[et(function(e){return"Gem\xfctliche ".concat(e," mit viel Zeit zum \xdcberlegen")},"\uD83E\uDDA5"),et(function(e){return"".concat(e," entspanntes Jassen - Qualit\xe4t braucht Zeit!")},"\uD83D\uDC22"),et(function(e){return"Ein gediegener Jass von ".concat(e," - herrlich!")},"\uD83D\uDC0C")],marathon:[et(function(e){return"Ein epischer Jass-Marathon von ".concat(e,"!")},"\uD83C\uDFC3"),et(function(e){return"Legend\xe4re ".concat(e," Jassvergn\xfcgen!")},"\uD83D\uDC51"),et(function(e){return"".concat(e," purer Jass-Genuss - ein Fest!")},"\uD83C\uDFC3"),et(function(e){return"Ein Marathon-Jass f\xfcr die Geschichtsb\xfccher: ".concat(e,"!")},"")]};function er(e){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ea(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=eo(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function ei(e){return function(e){if(Array.isArray(e))return es(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||eo(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eo(e,t){if(e){if("string"==typeof e)return es(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?es(e,t):void 0}}function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ec(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function el(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ec(Object(n),!0).forEach(function(t){var r,a,i;r=e,a=t,i=n[t],(a=function(e){var t=function(e,t){if("object"!=er(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=er(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==er(t)?t:t+""}(a))in r?Object.defineProperty(r,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ec(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eu(e,t){return"top"===t?"".concat(e[2]||"Spieler 2"," & ").concat(e[4]||"Spieler 4"):"".concat(e[1]||"Spieler 1"," & ").concat(e[3]||"Spieler 3")}function eh(e,t,n){if(0===e)return"null ".concat(n||t);if(1===e)return t;var r=n||"".concat(t,"e");switch(e){case 1:return"einen ".concat(t);case 2:return"zwei ".concat(r);case 3:return"drei ".concat(r);case 4:return"vier ".concat(r);case 5:return"f\xfcnf ".concat(r);case 6:return"sechs ".concat(r);case 7:return"sieben ".concat(r);case 8:return"acht ".concat(r);case 9:return"neun ".concat(r);case 10:return"zehn ".concat(r);default:return"".concat(e," ").concat(r)}}function em(e){var t=e.games[e.games.length-1],n=el({},e);t&&"eventCounts"in t&&(n=el(el({},e),{},{eventCounts:t.eventCounts,aggregatedTrumpfCountsByPlayer:t.trumpfCountsByPlayer,aggregatedRoundDurationsByPlayer:t.roundDurationsByPlayer,sessionTotalWeisPoints:t.weisPoints,participantPlayerIds:t.participantUids,gameResults:t.gameResults,gameWinsByTeam:t.gameWinsByTeam,gamesPlayed:t.gamesPlayed,durationSeconds:t.durationSeconds,finalStriche:t.finalStriche,winnerTeamKey:t.winnerTeamKey}));var r=n,a=r.games,i=r.playerNames,o=r.currentTotals,s=0,c=0;if(n.finalStriche){var l=n.finalStriche.top,u=n.finalStriche.bottom;s=(l.berg||0)+(l.sieg||0)+(l.matsch||0)+(l.schneider||0)+(l.kontermatsch||0),c=(u.berg||0)+(u.sieg||0)+(u.matsch||0)+(u.schneider||0)+(u.kontermatsch||0)}var h=s>0||c>0,m=h?s:o.top||0,p=h?c:o.bottom||0,f=Math.abs(m-p),d=n.winnerTeamKey?"top"===n.winnerTeamKey:m>p,g=m===p,y=eu(i,"top"),v=eu(i,"bottom"),b=g?[]:d?[i[2],i[4]]:[i[1],i[3]],S=g?[]:d?[i[1],i[3]]:[i[2],i[4]],w=(E=n.eventCounts,T={topTeamErzielte:{schneider:0,matsch:0,kontermatsch:0,berg:0,sieg:0},bottomTeamErzielte:{schneider:0,matsch:0,kontermatsch:0,berg:0,sieg:0},topTeamErhielt:{schneider:0,matsch:0,kontermatsch:0},bottomTeamErhielt:{schneider:0,matsch:0,kontermatsch:0},gameSpecificEvents:[]},E&&(T.topTeamErzielte=el({},E.top),T.bottomTeamErzielte=el({},E.bottom),T.topTeamErhielt={schneider:E.bottom.schneider,matsch:E.bottom.matsch,kontermatsch:E.bottom.kontermatsch},T.bottomTeamErhielt={schneider:E.top.schneider,matsch:E.top.matsch,kontermatsch:E.top.kontermatsch}),a.forEach(function(e,t){if("teams"in e&&e.teams){var n=e.teams.top,r=e.teams.bottom;if(n&&"total"in n&&r&&"total"in r){var a=n.total||0,i=r.total||0;if(Math.abs(a-i)>=500){var o=a>i?"top":"bottom";T.gameSpecificEvents.push({gameNumber:t+1,event:"schneider",erzielendTeam:o,empfangendesTeam:"top"===o?"bottom":"top",score:{top:a,bottom:i}})}if(0===a||0===i){var s=a>0?"top":"bottom";T.gameSpecificEvents.push({gameNumber:t+1,event:"matsch",erzielendTeam:s,empfangendesTeam:"top"===s?"bottom":"top",score:{top:a,bottom:i}})}}}}),T),x=function(e,t,n){if(!e||0===e.length)return{momentum:[],pattern:null,criticalGames:[],dramaSummary:""};var r=[],a=[],i=0,o=0,s="tied",c=0,l=0,u=null,h=0,m=0,p=0,f=null,d=null,g=e.slice(0,2).every(function(e){return"bottom"===e.winnerTeam})?"bottom":e.slice(0,2).every(function(e){return"top"===e.winnerTeam})?"top":null,y=!1;g&&e.length>=4&&(n||(i>o?"top":"bottom"))===("top"===g?"bottom":"top")&&(y=!0),e.forEach(function(t,n){var g="top"===t.winnerTeam?"top":"bottom";"top"===g?i++:o++,g===d?m++:(m>p&&(p=m,f=d),m=1),d=g;var y=i>o?"top":o>i?"bottom":"tied",v=Math.abs(i-o),b="tied"!==s&&y!==s&&"tied"!==y,S=n+1,w=e.length-S,x=b||"tied"!==s&&"tied"===y||v>w&&v>1||S===e.length&&v<=1;x&&a.push(S),b&&c++,v>l&&(l=v,u="tied"===y?null:y,h=S),r.push({game:S,leader:y,leadSize:v,isSwing:b,isCritical:x}),s=y}),m>p&&(p=m,f=d);var v=null,b=n&&"draw"!==n?n:i>o?"top":o>i?"bottom":null,S=e.length;if(y&&b&&g)b!==g&&(v={type:"comeback",description:"Unglaubliches Comeback nach 0:2-R\xfcckstand!",keyMoments:[3,4],intensity:10,details:"Nach 2 Spielen noch 0:2 zur\xfcck, dann ".concat(S-2," Spiele in Folge gewonnen!")});else if(b&&e.length>=3){var w=e.slice(0,2),x=w.filter(function(e){return"bottom"===e.winnerTeam}).length,N=w.filter(function(e){return"top"===e.winnerTeam}).length;(2===x&&"top"===b||2===N&&"bottom"===b)&&(v={type:"comeback",description:"FANTASTISCHES COMEBACK!",keyMoments:[3,4],intensity:10,details:"bottom"==(2===x?"bottom":"top")?"Marc & Roger f\xfchrten nach 2 Spielen klar, dann holten Claudia & Frank ".concat(S-2," Spiele in Folge!"):"Claudia & Frank f\xfchrten nach 2 Spielen klar, dann holten Marc & Roger ".concat(S-2," Spiele in Folge!")})}else if(b&&u&&u!==b&&l>=2){var k=h;v={type:"collapse",description:"".concat(l,"-Spiele-Vorsprung verspielt!"),keyMoments:[k,S],intensity:Math.min(10,7+l),details:"Nach ".concat(k," Spielen noch ").concat(l,":").concat(i<o?i:o," gef\xfchrt, dann ").concat(S-k," Spiele in Folge verloren!")}}else b&&u&&u!==b&&l>=2?v={type:"comeback",description:"".concat(l,"-Spiele-R\xfcckstand gedreht!"),keyMoments:a,intensity:Math.min(10,6+l)}:p>=4?v={type:"streak",description:"".concat(p," Siege in Serie!"),keyMoments:Array.from({length:p},function(e,t){return S-p+t+1}),intensity:Math.min(10,5+p),details:f===b?"Unaufhaltsam bis zum Schluss!":"Aber am Ende doch verloren..."}:c>=3?v={type:"backAndForth",description:"".concat(c," F\xfchrungswechsel!"),keyMoments:a,intensity:9,details:"Ein Hin und Her bis zum Schluss!"}:1>=Math.abs(i-o)&&S>=5?v={type:"thriller",description:"Nervenkrimi bis zum letzten Spiel!",keyMoments:[S],intensity:8,details:"".concat(i,":").concat(o," - jedes Spiel z\xe4hlte!")}:u===b&&h<=Math.ceil(S/3)?v={type:"blitzstart",description:"Blitzstart und souver\xe4n durchgezogen!",keyMoments:[1,h],intensity:5,details:"Nach ".concat(h," Spielen schon ").concat(l," vorne!")}:0===c&&b&&Math.abs(i-o)>=3?v={type:"dominance",description:"Durchmarsch ohne Gegenwehr!",keyMoments:[1],intensity:4,details:"".concat(Math.max(i,o),":").concat(Math.min(i,o)," - keine Chance gelassen!")}:t&&0===t.topTeamErzielte.matsch+t.bottomTeamErzielte.matsch+t.topTeamErzielte.schneider+t.bottomTeamErzielte.schneider&&S>=4&&(v={type:"boring",description:"Solides Spiel ohne grosse H\xf6hepunkte",keyMoments:[],intensity:2,details:"Keine Matsche, keine Schneider - nur ehrliches Jassen"});var j="";if(v){if(j=v.description,v.details&&(j+=" ".concat(v.details)),"collapse"===v.type&&t){var M=t.gameSpecificEvents.filter(function(e){return("matsch"===e.event||"schneider"===e.event)&&e.gameNumber>h});if(M.length>0){var E=M.map(function(e){return"".concat("matsch"===e.event?"Matsch":"Schneider"," in Spiel ").concat(e.gameNumber)}).join(", ");j+=" Besonders bitter: ".concat(E," w\xe4hrend des Zusammenbruchs!")}}if("comeback"===v.type&&t){var T=t.gameSpecificEvents.filter(function(e){return("matsch"===e.event||"kontermatsch"===e.event)&&a.includes(e.gameNumber)});T.length>0&&(j+=" Der ".concat("matsch"===T[0].event?"Matsch":"Kontermatsch"," in Spiel ").concat(T[0].gameNumber," war der Wendepunkt!"))}}return{momentum:r,pattern:v,criticalGames:a,dramaSummary:j}}(n.gameResults,w,n.winnerTeamKey),N=[];if(w.topTeamErzielte.kontermatsch>0||w.bottomTeamErzielte.kontermatsch>0){var k=w.topTeamErzielte.kontermatsch>0?y:v,j=Math.max(w.topTeamErzielte.kontermatsch,w.bottomTeamErzielte.kontermatsch);N.push({kategorie:"KONTERMATSCH",prioritaet:1e3,spruchText:"".concat(k," machen ").concat(1===j?"einen Kontermatsch":"".concat(j," Kontermatsche")," - ABSOLUT BRUTAL!"),emoji:"\uD83D\uDC80",details:["Das ist ein Kontermatsch - passiert sehr selten!"]})}if(w.topTeamErzielte.schneider>0||w.bottomTeamErzielte.schneider>0){var M=w.gameSpecificEvents.find(function(e){return"schneider"===e.event});if(M){var E,T,P,z,C="top"===M.erzielendTeam?[i[2],i[4]]:[i[1],i[3]],A="top"===M.empfangendesTeam?[i[2],i[4]]:[i[1],i[3]],_=(0,Q[Math.floor(Math.random()*Q.length)])({winnerNames:C.filter(Boolean),loserNames:A.filter(Boolean),isUnentschieden:!1,isStricheMode:!0,type:"jassEnd",isSchneider:!0,stricheDifference:f,pointDifference:M.score[M.erzielendTeam]-M.score[M.empfangendesTeam],timerAnalytics:{totalJassTime:1e3*(n.durationSeconds||0),currentGameDuration:0},matchCount:{team1:(null==(P=n.gameWinsByTeam)?void 0:P.bottom)||0,team2:(null==(z=n.gameWinsByTeam)?void 0:z.top)||0},gameStats:{currentGameNumber:a.length,totalGames:a.length,isComeback:!1,führungsWechsel:!1,höchsterVorsprung:{team:"team1",differenz:0}},gesamtStand:{team1:p,team2:m},previousGesamtStand:{team1:0,team2:0},totalMatsche:0});N.push({kategorie:"SCHNEIDER",prioritaet:900,spruchText:_?_.text:"Schnipp, schnapp, Schneider! ".concat(A.join(" & ")," wurden zerschnippelt!"),emoji:_?_.icon:"✂️",details:["Spiel ".concat(M.gameNumber,": ").concat(M.score[M.erzielendTeam],":").concat(M.score[M.empfangendesTeam])]})}}if(h&&f>=14||!h&&f>=20)N.push({kategorie:"EXTREME_VERNICHTUNG",prioritaet:800,spruchText:"".concat(f," Striche Unterschied - HISTORISCHE DEM\xdcTIGUNG!"),emoji:"☢️",details:["Das ist eine ".concat(f,"-Striche-Vernichtung der Extraklasse!")]});else if(h&&f>=10||!h&&f>=15){var O=(0,X[Math.floor(Math.random()*X.length)])(ep());N.push({kategorie:"VERNICHTEND",prioritaet:700,spruchText:O?O.text:"Vernichtender Sieg! ".concat(b.join(" & ")," dem\xfctigen ").concat(S.join(" & "),"!"),emoji:O?O.icon:"\uD83D\uDCA5",details:["".concat(f," Striche Unterschied sprechen eine deutliche Sprache!")]})}else if(h&&f>=8||!h&&f>=10){var W=(0,Y[Math.floor(Math.random()*Y.length)])(ep());N.push({kategorie:"SEHR_HOCH",prioritaet:600,spruchText:W?W.text:"Hoher Sieg! ".concat(b.join(" & ")," dominierten klar!"),emoji:W?W.icon:"\uD83C\uDFC6"})}else if(h&&f>=6||!h&&f>=7){var D=(0,Z[Math.floor(Math.random()*Z.length)])(ep());N.push({kategorie:"HOCH",prioritaet:500,spruchText:D?D.text:"Hoher Sieg! ".concat(b.join(" & ")," dominierten!"),emoji:D?D.icon:"\uD83D\uDC51"})}else if(h&&f>=5||!h&&f>=5){var R=(0,J[Math.floor(Math.random()*J.length)])(ep());N.push({kategorie:"DEUTLICH",prioritaet:400,spruchText:R?R.text:"Deutlicher Sieg! ".concat(b.join(" & ")," setzten ein Zeichen!"),emoji:R?R.icon:"\uD83C\uDF96️"})}else if(1===f){var G=(0,U[Math.floor(Math.random()*U.length)])(ep());N.push({kategorie:"HAUCHD\xdcNN",prioritaet:300,spruchText:G?G.text:"Hauchd\xfcnner Sieg! ".concat(b.join(" & ")," mit nur einem ").concat(h?"Strich":"Punkt"," Vorsprung!"),emoji:G?G.icon:"\uD83C\uDFAF"})}else if(!g){var I=(0,q[Math.floor(Math.random()*q.length)])(ep());N.push({kategorie:"KNAPP",prioritaet:200,spruchText:I?I.text:"Knapper Sieg! ".concat(b.join(" & ")," mit ").concat(f," ").concat(h?"Strichen":"Punkten"," Vorsprung!"),emoji:I?I.icon:"\uD83D\uDD25"})}if(g){var H=(0,$[Math.floor(Math.random()*$.length)])(ep());N.push({kategorie:"UNENTSCHIEDEN",prioritaet:999,spruchText:H?H.text:"Unentschieden! ".concat(y," und ").concat(v," trennten sich ehrenhaft!"),emoji:H?H.icon:"\uD83E\uDD1D"})}N.sort(function(e,t){return t.prioritaet-e.prioritaet});var F=N.slice(0,Math.min(4,N.length));if(F.length<3){if(!F.find(function(e){return"ZEIT"===e.kategorie})&&n.durationSeconds){var ee=(0,K.a3)(n.durationSeconds);F.push({kategorie:"ZEIT",prioritaet:100,spruchText:"Nach ".concat(ee," intensivem Jassen!"),emoji:"⏱️"})}if(!F.find(function(e){return"SPIELE"===e.kategorie})&&n.gamesPlayed&&F.push({kategorie:"SPIELE",prioritaet:90,spruchText:"".concat(n.gamesPlayed," Spiele wurden heute gespielt!"),emoji:"\uD83C\uDCCF"}),!F.find(function(e){return"BERG"===e.kategorie})){var et=w.topTeamErzielte.berg,er=w.bottomTeamErzielte.berg,eo=Math.abs(et-er);if(eo>0){var es=et>er?y:v,ec=eh(eo,"Berg","Berge");F.push({kategorie:"BERG",prioritaet:80,spruchText:"".concat(es," holten ").concat(ec," mehr! Bilanz: ").concat(Math.max(et,er),":").concat(Math.min(et,er)),emoji:"⛰️"})}}F.length<3&&F.push({kategorie:"SESSION",prioritaet:50,spruchText:"Eine ".concat(d?"klare":"spannende"," Angelegenheit heute!"),emoji:"\uD83C\uDFAF"})}var em=w.topTeamErzielte.matsch+w.bottomTeamErzielte.matsch;function ep(){var e,t,r;return{winnerNames:b.filter(Boolean),loserNames:S.filter(Boolean),isUnentschieden:g,isStricheMode:!0,type:"jassEnd",isSchneider:!1,stricheDifference:f,pointDifference:f,timerAnalytics:{totalJassTime:1e3*(n.durationSeconds||0),currentGameDuration:0},matchCount:{team1:(null==(e=n.gameWinsByTeam)?void 0:e.bottom)||0,team2:(null==(t=n.gameWinsByTeam)?void 0:t.top)||0},gameStats:{currentGameNumber:a.length,totalGames:a.length,isComeback:(null==(r=x.pattern)?void 0:r.type)==="comeback",führungsWechsel:x.momentum.filter(function(e){return e.isSwing}).length>0,höchsterVorsprung:{team:d?"team2":"team1",differenz:f}},gesamtStand:{team1:p,team2:m},previousGesamtStand:{team1:0,team2:0},totalMatsche:em}}var ef={hauptspruch:"",emoji:"\uD83C\uDFAF"},ed=g?"".concat(m,":").concat(p):d?"".concat(m,":").concat(p,"!"):"".concat(p,":").concat(m,"!"),eg=d?y:v,ey=d?v:y,ev=x.pattern&&"comeback"===x.pattern.type,eb=x.pattern&&"collapse"===x.pattern.type;if((ev||eb)&&x.pattern&&x.pattern.intensity>=9)ev?(ef.hauptspruch="".concat(ed," SENSATIONELLES COMEBACK! ").concat(eg," drehen das Spiel komplett!"),ef.narrativ=x.pattern.details||x.pattern.description):(ef.hauptspruch="".concat(ed," BITTERE NIEDERLAGE! ").concat(ey," verspielen ").concat(x.pattern.description),ef.narrativ=x.pattern.details||""),ef.emoji=ev?"\uD83D\uDD25":"\uD83D\uDE31",x.pattern.details&&(ef.specialEvents=[x.pattern.details]);else if(0===F.length)ef.hauptspruch="".concat(ed," Ein Jass ist zu Ende!"),ef.emoji="\uD83C\uDFAF";else{var eS=F[0];if(ef.emoji=eS.emoji,"KONTERMATSCH"===eS.kategorie&&F.length>1){var ew=F[1];"SCHNEIDER"===ew.kategorie?ef.hauptspruch="".concat(ed," KONTERMATSCH + SCHNEIDER! Historische Kombination - das passiert vielleicht einmal im Jahr!"):"VERNICHTEND"===ew.kategorie?ef.hauptspruch="".concat(ed," VERNICHTENDER SIEG MIT KONTERMATSCH! ").concat(eg," zeigen keine Gnade!"):ef.hauptspruch="".concat(ed," ").concat(eS.spruchText)}else"SCHNEIDER"===eS.kategorie&&F.length>1?"VERNICHTEND"===F[1].kategorie?ef.hauptspruch="".concat(ed," SCHNEIDER bei vernichtendem Sieg! ").concat(eS.spruchText):ef.hauptspruch="".concat(ed," ").concat(eS.spruchText):(eS.kategorie,ef.hauptspruch="".concat(ed," ").concat(eS.spruchText));var ex=[];F.forEach(function(e){e.details&&"JUBIL\xc4UM"!==e.kategorie&&ex.push.apply(ex,ei(e.details))}),F.length>=2&&F.slice(1,3).forEach(function(e){"KONTERMATSCH"!==e.kategorie&&"SCHNEIDER"!==e.kategorie&&"JUBIL\xc4UM"!==e.kategorie&&ex.push(e.spruchText)}),ef.specialEvents=function(e){var t,n=[],r=new Set,a=new Map,o=ea(e);try{for(o.s();!(t=o.n()).done;){var s=t.value.trim();if(!(!s||r.has(s))){var c=function(e){var t=e.toLowerCase();return t.includes("matsch")?"matsch":t.includes("schneider")?"schneider":t.includes("kontermatsch")?"kontermatsch":t.includes("berg")?"berg":t.includes("weis")?"weis":t.includes("stunde")||t.includes("minute")||t.includes("zeit")?"zeit":t.includes("punkte")||t.includes("striche")?"score":t.includes("bilanz")?"bilanz":"generic"}(s),l=a.get(c)||0;if("generic"===c||"score"===c||!(l>=1)){var u,h=!1,m=ea(n);try{for(m.s();!(u=m.n()).done;){var p=u.value;if(function(e,t){var n=function(e){return e.toLowerCase().replace(/[^\w\s:]/g,"").replace(/\s+/g," ").trim()},r=n(e),a=n(t);if(r===a)return!0;var o=r.length<a.length?r:a,s=r.length>=a.length?r:a;if(o.length>0&&s.includes(o)&&o.length/s.length>=.7)return!0;var c=["matsch","matsche","matschen"],l=c.some(function(e){return r.includes(e)}),u=c.some(function(e){return a.includes(e)});if(l&&u){var h=function(e){return e.match(/\d+/g)||[]},m=h(r),p=h(a);if(m.length>0&&p.length>0&&m.join(",")===p.join(","))return!0;var f=["claudia","frank","marc","roger"],d=f.filter(function(e){return r.includes(e)}),g=f.filter(function(e){return a.includes(e)});if(d.length>0&&g.length>0&&d.join(",")===g.join(","))return!0}if((r.includes("sammeln")||r.includes("holen"))&&(a.includes("sammeln")||a.includes("holen"))){var y=["claudia","frank","marc","roger"],v=y.filter(function(e){return r.includes(e)}),b=y.filter(function(e){return a.includes(e)});if(v.length>0&&b.length>0&&v.join(",")===b.join(","))return!0}if(r.includes("schneider")&&a.includes("schneider")||r.includes("kontermatsch")&&a.includes("kontermatsch"))return!0;var S=/alle \d+ matsche?/;if(S.test(r)&&S.test(a))return!0;var w=/\d+:\d+/,x=r.match(w),N=a.match(w);if(x&&N&&x[0]===N[0])return!0;var k=Object.values(i).filter(Boolean).map(function(e){return e.toLowerCase()}),j=k.filter(function(e){return r.includes(e)}),M=k.filter(function(e){return a.includes(e)});if(j.length>0&&M.length>0&&j.sort().join(",")===M.sort().join(",")){var E=/(sammeln|holen|machen|servieren)/;if(E.test(r)&&E.test(a))return!0}return!1}(s,p)){h=!0;break}}}catch(e){m.e(e)}finally{m.f()}h||(n.push(s),r.add(s),a.set(c,l+1))}}}}catch(e){o.e(e)}finally{o.f()}return n}(ex)}var eN="",ek="",ej=ev||eb||x.pattern&&["thriller","dominance","streak"].includes(x.pattern.type);if(x.pattern&&!ej)switch(x.pattern.type){case"collapse":eN="BITTERE NIEDERLAGE! ",ek=" ".concat(x.pattern.description," ").concat(x.pattern.details||""),ef.emoji="\uD83D\uDE31";break;case"comeback":x.pattern.intensity>=8&&(eN="SENSATIONELLES COMEBACK! ",ef.emoji="\uD83D\uDD25"),ek=" ".concat(x.pattern.description);break;case"streak":x.pattern.intensity>=7&&(eN="UNAUFHALTSAM! ",ef.emoji="\uD83D\uDE80"),ek=" ".concat(x.pattern.description);break;case"thriller":case"backAndForth":case"dominance":case"blitzstart":ek=" ".concat(x.pattern.description);break;case"boring":ek=" Solides Spiel ohne grosse H\xf6hepunkte."}if(ef.hauptspruch=eN+ef.hauptspruch+ek,h){var eM=d?"".concat(m,":").concat(p,"!"):"".concat(p,":").concat(m,"!");ef.hauptspruch.startsWith(eM)||(ef.hauptspruch="".concat(eM," ").concat(ef.hauptspruch))}if(!x.pattern||eN||ek||ef.narrativ||("thriller"===x.pattern.type?ef.narrativ="".concat(x.dramaSummary," Bis zum letzten Spiel blieb es spannend!"):"backAndForth"===x.pattern.type?ef.narrativ=x.dramaSummary:"dominance"===x.pattern.type?ef.narrativ="".concat(x.dramaSummary," Eine klare Angelegenheit."):"blitzstart"===x.pattern.type?ef.narrativ=x.dramaSummary:"boring"===x.pattern.type?ef.narrativ="".concat(x.dramaSummary," Aber Hauptsache gesellig!"):ef.narrativ=x.dramaSummary),x.pattern||0!==em||0!==w.topTeamErzielte.schneider||0!==w.bottomTeamErzielte.schneider||(ef.narrativ="Solides Spiel ohne spektakul\xe4re Momente. ".concat(n.gamesPlayed||a.length," Spiele ehrliches Jassen.")),n.durationSeconds&&n.durationSeconds>0){var eE=en[(0,K.Yz)(n.durationSeconds)];if(eE.length>0){var eT,eP,ez,eC=(0,eE[Math.floor(Math.random()*eE.length)])({winnerNames:b.filter(Boolean),loserNames:S.filter(Boolean),isUnentschieden:g,isStricheMode:!0,type:"jassEnd",isSchneider:!1,stricheDifference:f,pointDifference:f,timerAnalytics:{totalJassTime:1e3*n.durationSeconds,currentGameDuration:0},matchCount:{team1:(null==(eT=n.gameWinsByTeam)?void 0:eT.bottom)||0,team2:(null==(eP=n.gameWinsByTeam)?void 0:eP.top)||0},gameStats:{currentGameNumber:a.length,totalGames:a.length,isComeback:(null==(ez=x.pattern)?void 0:ez.type)==="comeback",führungsWechsel:x.momentum.filter(function(e){return e.isSwing}).length>0,höchsterVorsprung:{team:d?"team2":"team1",differenz:f}},gesamtStand:{team1:p,team2:m},previousGesamtStand:{team1:0,team2:0},totalMatsche:em});eC&&(ef.zeitDetails=eC.text)}else ef.zeitDetails="Nach ".concat((0,K.a3)(n.durationSeconds)," intensivem Jassen!")}var eA=function(e,t,n,r,a,i,o){var s={playerContexts:new Map,teamContexts:[],sessionContext:[]},c=new Set,l=function(e){return c.has(e)},u=function(e){c.add(e)};if(!e.groupStats)return s;var h=e.groupStats,m=e.playerNames;e.participantPlayerIds;var p=[m[1],m[2],m[3],m[4]].filter(Boolean);if(h.playerWithHighestMatschBilanz){if(Math.random()>.35||l("matsch"))return s;var f=h.playerWithHighestMatschBilanz.find(function(e){return e.value<-5&&p.includes(e.playerName)});if(f){var d=a?t.topTeamErzielte.matsch:t.bottomTeamErzielte.matsch;if(d>0){var g=s.playerContexts.get(f.playerName)||[];f.value<=-10?g.push("".concat(f.playerName," verschlechtert seine katastrophale ").concat(f.value," Matsch-Bilanz weiter!")):f.value<=-5?g.push("".concat(f.playerName," baut an seiner ").concat(f.value," Matsch-Bilanz weiter!")):g.push("".concat(f.playerName,' "verbessert" seine ').concat(f.value," Bilanz mit ").concat(d," ").concat(1===d?"Matsch":"Matschen","!")),s.playerContexts.set(f.playerName,g),u("matsch")}}var y=h.playerWithHighestMatschBilanz.find(function(e){return e.value>=5&&p.includes(e.playerName)});if(y&&r.includes(y.playerName)&&t.bottomTeamErhielt.matsch+t.topTeamErhielt.matsch>0){var v=[m[2],m[4]].includes(y.playerName)?t.topTeamErhielt.matsch:t.bottomTeamErhielt.matsch;if(v>0){var b=1===v?"einen Matsch":function(e){switch(e){case 1:return"einen";case 2:return"zwei";case 3:return"drei";case 4:return"vier";case 5:return"f\xfcnf";case 6:return"sechs";case 7:return"sieben";case 8:return"acht";case 9:return"neun";case 10:return"zehn";default:return"".concat(e)}}(v)+" Matsche",S=s.playerContexts.get(y.playerName)||[];S.push("Ausgerechnet ".concat(y.playerName," (Matsch-K\xf6nig mit +").concat(y.value,") kassiert heute ").concat(b,"!")),s.playerContexts.set(y.playerName,S),u("matsch")}}}if(h.playerWithHighestWinRateGame&&.25>=Math.random()){var w=h.playerWithHighestWinRateGame.find(function(e){return e.value<.3&&e.eventsPlayed&&e.eventsPlayed>=10&&p.includes(e.playerName)});if(w&&n.includes(w.playerName)){var x=s.playerContexts.get(w.playerName)||[],N=Math.round(100*w.value);x.push("".concat(w.playerName," siegt! Bei nur ").concat(N,"% Siegquote eine Seltenheit!")),s.playerContexts.set(w.playerName,x)}var k=h.playerWithHighestWinRateGame.find(function(e){return e.value>.7&&e.eventsPlayed&&e.eventsPlayed>=10&&p.includes(e.playerName)});if(k&&r.includes(k.playerName)){var j=s.playerContexts.get(k.playerName)||[],M=Math.round(100*k.value);j.push("".concat(k.playerName," verliert? Mit ").concat(M,"% Siegquote normalerweise undenkbar!")),s.playerContexts.set(k.playerName,j)}}if(h.playerWithHighestPointsDiff){var E=h.playerWithHighestPointsDiff.find(function(e){return e.value<-5e3&&p.includes(e.playerName)});if(E&&n.includes(E.playerName)&&o>=5){var T=s.playerContexts.get(E.playerName)||[];T.push("".concat(E.playerName," dreht den Spiess um! Historisch ").concat(Math.abs(E.value)," Punkte im Minus!")),s.playerContexts.set(E.playerName,T)}}if(h.playerWithMostWeisPointsAvg&&e.sessionTotalWeisPoints){var P=h.playerWithMostWeisPointsAvg.find(function(e){return e.value>=100&&p.includes(e.playerName)});if(P){var z=e.sessionTotalWeisPoints.top||0,C=e.sessionTotalWeisPoints.bottom||0;if(0===("top"==([m[2],m[4]].includes(P.playerName)?"top":"bottom")?z:C)){var A=s.playerContexts.get(P.playerName)||[];A.push("".concat(P.playerName," ohne Weis? Der Weis-K\xf6nig (\xd8 ").concat(Math.round(P.value),") schw\xe4chelt!")),s.playerContexts.set(P.playerName,A)}}}var _=[m[2],m[4]].sort().join("_"),O=[m[1],m[3]].sort().join("_");if(h.teamWithHighestWinRateGame){var W=h.teamWithHighestWinRateGame.find(function(e){return e.names.sort().join("_")===_&&e.eventsPlayed&&e.eventsPlayed>=3}),D=h.teamWithHighestWinRateGame.find(function(e){return e.names.sort().join("_")===O&&e.eventsPlayed&&e.eventsPlayed>=3});if(W&&W.value>=.8&&!a){var R=Math.round(100*W.value);s.teamContexts.push("".concat(m[2]," & ").concat(m[4]," verlieren? Das Dream-Team mit ").concat(R,"% Siegquote strauchelt!"))}if(D&&D.value>=.8&&a){var G=Math.round(100*D.value);s.teamContexts.push("".concat(m[1]," & ").concat(m[3]," geschlagen! Normalerweise mit ").concat(G,"% Siegquote unschlagbar!"))}if(W&&W.value<=.2&&a){var I=Math.round(100*W.value);s.teamContexts.push("Sensation! ".concat(m[2]," & ").concat(m[4]," gewinnen trotz nur ").concat(I,"% historischer Siegquote!"))}if(D&&D.value<=.2&&!a){var B=Math.round(100*D.value);s.teamContexts.push("\xdcberraschung! ".concat(m[1]," & ").concat(m[3]," siegen mit nur ").concat(B,"% Siegquote!"))}}if(h.teamWithHighestStricheDiff){var H=h.teamWithHighestStricheDiff.find(function(e){var t=e.names.sort().join("_");return(t===_||t===O)&&e.eventsPlayed&&e.eventsPlayed>=5});if(H&&Math.abs(H.value)>=10){var L=H.value>0,F=H.names.join(" & "),V=H.names.sort().join("_")===_&&a||H.names.sort().join("_")===O&&!a;L&&!V?s.teamContexts.push("".concat(F," verlieren! Nach +").concat(H.value," Striche Dominanz eine Dem\xfctigung!")):!L&&V&&s.teamContexts.push("".concat(F," drehen die Serie! Von ").concat(H.value," Striche R\xfcckstand zum Sieg!"))}}e.gamesPlayed&&h.avgGamesPerSession&&.4>=Math.random()&&e.gamesPlayed>=2*h.avgGamesPerSession&&s.sessionContext.push("Marathon-Session mit ".concat(e.gamesPlayed," Spielen!"));var K=t.topTeamErzielte.matsch+t.bottomTeamErzielte.matsch;if(K>0&&h.avgMatschPerGame&&e.gamesPlayed&&.3>=Math.random()&&!l("matsch")){var J=Math.round(h.avgMatschPerGame*e.gamesPlayed);if(K>=2*J&&J>0){var U=t.topTeamErzielte.matsch,Z=t.bottomTeamErzielte.matsch;K>=4?(s.sessionContext.push("".concat(K," Matsche heute (").concat(U,":").concat(Z,") - doppelt so viel wie \xfcblich!")),u("matsch")):K>=3&&J<=1&&(s.sessionContext.push("".concat(K," Matsche (").concat(U,":").concat(Z,") - mehr Action als gew\xf6hnlich!")),u("matsch"))}}return el(el({},s),{},{usedEventTypes:c})}(n,w,b,S,d,0,f),e_=eA.usedEventTypes||new Set;if(ef.specialEvents=[],h&&f>=14&&ef.specialEvents.push("\uD83D\uDEA8 ACHTUNG: ".concat(f," Striche Differenz - das gab's noch nie! \uD83D\uDEA8")),em>0){var eO=w.topTeamErzielte.matsch,eW=w.bottomTeamErzielte.matsch;if(h&&f>=10)if(eO>0&&0===eW){var eD=1===eO?"den einzigen Matsch":"alle ".concat(eO," Matsche");ef.specialEvents.push("".concat(y," servieren ").concat(eD," - ").concat(v," gehen leer aus!"))}else if(eW>0&&0===eO){var eR=1===eW?"den einzigen Matsch":"alle ".concat(eW," Matsche");ef.specialEvents.push("".concat(v," holen ").concat(eR," - ").concat(y," schauen in die R\xf6hre!"))}else em>=4?ef.specialEvents.push("MATSCH-FESTIVAL! ".concat(em," Matsche verteilt (").concat(eO,":").concat(eW,") - ein wilder Ritt!")):eO>eW?ef.specialEvents.push("".concat(y," dominieren mit ").concat(eO," von ").concat(em," Matschen (").concat(eO,":").concat(eW,")!")):eW>eO&&ef.specialEvents.push("".concat(v," sichern sich ").concat(eW," von ").concat(em," Matschen (").concat(eW,":").concat(eO,")!"));else if(em>=3){if(eO>0&&0===eW){var eG=eh(eO,"Matsch","Matsche");ef.specialEvents.push("".concat(y," sammeln ").concat(eO===em?"alle":""," ").concat(eG," - ").concat(v," bleiben matschfrei!"))}else if(eW>0&&0===eO){var eI=eh(eW,"Matsch","Matsche");ef.specialEvents.push("".concat(v," holen ").concat(eW===em?"alle":""," ").concat(eI," - ").concat(y," mit leeren H\xe4nden!"))}else if(Math.abs(eO-eW)>=3){var eB=eO>eW?y:v;ef.specialEvents.push("".concat(eB," klar vorne beim Matsch-Sammeln! Bilanz: ").concat(Math.max(eO,eW),":").concat(Math.min(eO,eW)))}else if(em>=5&&!e_.has("matsch")){var eH=["Matsch-Party! ".concat(em," Matsche insgesamt (").concat(eO,":").concat(eW,") - das war ein wildes Fest!"),"MATSCH-FESTIVAL! ".concat(em," Matsche verteilt (").concat(eO,":").concat(eW,") - ein denkw\xfcrdiger Abend!"),"".concat(em," Matsche heute (").concat(eO,":").concat(eW,") - das gibt's nicht alle Tage!"),"Matsch-Wahnsinn! ".concat(em,"x wurde heute gematschelt (").concat(eO,":").concat(eW,")!"),"".concat(em," Matsche im Protokoll (").concat(eO,":").concat(eW,") - was f\xfcr eine Session!"),"Rekordverd\xe4chtig! ".concat(em," Matsche gez\xe4hlt (").concat(eO,":").concat(eW,")!"),"".concat(em," Matsche auf dem Konto (").concat(eO,":").concat(eW,") - intensives Jassen!"),"Matsch-Marathon mit ".concat(em," Eintr\xe4gen (").concat(eO,":").concat(eW,")!")];ef.specialEvents.push(eH[Math.floor(Math.random()*eH.length)])}}}if(!(ef.hauptspruch.includes("KONTERMATSCH")||ef.hauptspruch.includes("Kontermatsch"))){if(w.topTeamErzielte.kontermatsch>0){var eL=1===w.topTeamErzielte.kontermatsch?"einen Kontermatsch":"".concat(w.topTeamErzielte.kontermatsch," Kontermatsche");ef.specialEvents.push("".concat(y," machen ").concat(eL," - was f\xfcr eine Dem\xfctigung!"))}if(w.bottomTeamErzielte.kontermatsch>0){var eF=1===w.bottomTeamErzielte.kontermatsch?"einen Kontermatsch":"".concat(w.bottomTeamErzielte.kontermatsch," Kontermatsche");ef.specialEvents.push("".concat(v," machen ").concat(eF," - absolut brutal!"))}}if(.1>Math.random()){var eV=w.topTeamErzielte.berg,eK=w.bottomTeamErzielte.berg,eJ=Math.abs(eV-eK);if(eV>eK&&eJ>0){var eU=eh(eJ,"Berg","Berge");ef.specialEvents.push("".concat(y," sind Bergk\xf6nige! ").concat(eU," mehr gemacht (").concat(eV,":").concat(eK,")!"))}else if(eK>eV&&eJ>0){var eZ=eh(eJ,"Berg","Berge");ef.specialEvents.push("".concat(v," dominieren die Berge! ").concat(eZ," mehr gemacht (").concat(eK,":").concat(eV,")!"))}}var eq=[];eA.playerContexts.forEach(function(e,t){e.length>0&&eq.length<2&&eq.push(e[0])}),eA.teamContexts.length>0&&eq.length<3&&eq.push(eA.teamContexts[0]),eA.sessionContext.length>0&&eq.length<3&&eq.push(eA.sessionContext[0]),eq.length>0&&(ef.specialEvents=ef.specialEvents||[],eq.forEach(function(e){ef.specialEvents.push("• ".concat(e))}));var eY=function(e,t){if(!t.groupStats)return e;try{var n,r,a,i,o,s,c,l,u,h,m,p,f,d,g,y,v,b,S,w,x,N,k,j,M,E,T=(n=t,c=((null==(r=n.eventCounts)?void 0:r.top.matsch)||0)+((null==(a=n.eventCounts)?void 0:a.bottom.matsch)||0),l=((null==(i=n.eventCounts)?void 0:i.top.schneider)||0)+((null==(o=n.eventCounts)?void 0:o.bottom.schneider)||0),u=(null==(s=n.groupStats)?void 0:s.avgMatschPerGame)||0,h=n.gamesPlayed||1,m=n.gameResults||[],{matschIntensity:Math.min(100,Math.max(0,c>0?c/Math.max(u*h,1)*50:0)),schneiderActivity:0===l?0:1===l?40:Math.min(100,40+(l-1)*30),speedVariance:function(e){if(!(null!=(t=e.groupStats)&&t.playerWithFastestRounds)||!(null!=(n=e.groupStats)&&n.playerWithSlowestRounds))return 0;var t,n,r=e.groupStats.playerWithFastestRounds[0],a=e.groupStats.playerWithSlowestRounds[0];return r&&a?Math.min(100,Math.max(0,(a.value/r.value-1)*50)):0}(n),competitiveness:function(e){if(!e||0===e.length)return 0;var t,n=0,r=0,a="",i=ea(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,s=o.winnerTeam;a&&s!==a&&n++,a=s,50>Math.abs(o.topScore-o.bottomScore)&&r++}}catch(e){i.e(e)}finally{i.f()}return Math.min(100,n/Math.max(e.length-1,1)*60+r/e.length*40)}(m),dominance:(p=m)&&0!==p.length?Math.min(100,100*(Math.abs(p.filter(function(e){return"top"===e.winnerTeam}).length-p.filter(function(e){return"bottom"===e.winnerTeam}).length)/p.length)):0}),P={groupId:null,groupName:t.groupStats.groupName||null,lastUpdateTimestamp:null,memberCount:4,sessionCount:t.groupStats.sessionCount||1,tournamentCount:0,gameCount:t.groupStats.gameCount||t.gamesPlayed||1,totalPlayTimeSeconds:t.durationSeconds||0,avgSessionDurationSeconds:0,avgGameDurationSeconds:0,avgGamesPerSession:t.groupStats.avgGamesPerSession||1,avgRoundsPerGame:0,avgRoundDurationSeconds:0,avgMatschPerGame:t.groupStats.avgMatschPerGame||0,firstJassTimestamp:null,lastJassTimestamp:null,hauptspielortName:null,totalTrumpfCount:0,trumpfStatistik:null,playerWithHighestMatschBilanz:(null==(w=t.groupStats.playerWithHighestMatschBilanz)?void 0:w.map(function(e){return{playerId:"unknown",playerName:e.playerName,value:e.value,eventsPlayed:e.eventsPlayed,displayValue:e.value.toString(),lastPlayedTimestamp:null,eventsMade:e.eventsMade,eventsReceived:e.eventsReceived}}))||null,playerWithHighestSchneiderBilanz:(null==(x=t.groupStats.playerWithHighestSchneiderBilanz)?void 0:x.map(function(e){return{playerId:"unknown",playerName:e.playerName,value:e.value,eventsPlayed:e.eventsPlayed,displayValue:e.value.toString(),lastPlayedTimestamp:null,eventsMade:e.eventsMade,eventsReceived:e.eventsReceived}}))||null,playerWithHighestWinRateGame:(null==(N=t.groupStats.playerWithHighestWinRateGame)?void 0:N.map(function(e){return{playerId:"unknown",playerName:e.playerName,value:e.value,eventsPlayed:e.eventsPlayed,displayValue:"".concat((100*e.value).toFixed(1),"%"),lastPlayedTimestamp:null}}))||null,playerWithFastestRounds:(null==(k=t.groupStats.playerWithFastestRounds)?void 0:k.map(function(e){return{playerId:e.playerId,playerName:e.playerName,value:e.value,eventsPlayed:e.eventsPlayed,displayValue:e.displayValue,lastPlayedTimestamp:null}}))||null,playerWithSlowestRounds:(null==(j=t.groupStats.playerWithSlowestRounds)?void 0:j.map(function(e){return{playerId:e.playerId,playerName:e.playerName,value:e.value,eventsPlayed:e.eventsPlayed,displayValue:e.displayValue,lastPlayedTimestamp:null}}))||null,playerWithMostGames:(null==(M=t.groupStats.playerWithMostGames)?void 0:M.map(function(e){return{playerId:"unknown",playerName:e.playerName,value:e.value,eventsPlayed:e.value,displayValue:e.value.toString(),lastPlayedTimestamp:null}}))||null,teamWithHighestWinRateGame:(null==(E=t.groupStats.teamWithHighestWinRateGame)?void 0:E.map(function(e){return{names:e.names,value:e.value,eventsPlayed:e.eventsPlayed}}))||null,playerWithHighestStricheDiff:null,playerWithHighestPointsDiff:null,playerWithHighestWinRateSession:null,playerWithHighestKontermatschBilanz:null,playerWithMostWeisPointsAvg:null,playerAllRoundTimes:null,teamWithHighestWinRateSession:null,teamWithHighestPointsDiff:null,teamWithHighestStricheDiff:null,teamWithHighestMatschBilanz:null,teamWithHighestSchneiderBilanz:null,teamWithHighestKontermatschBilanz:null,teamWithMostWeisPointsAvg:null,teamWithFastestRounds:null},z=(f=T,d=t,v=f.matschIntensity>=70||f.schneiderActivity>=65,f.competitiveness>=75&&f.dominance,b={maxContexts:v?2:1,minRelevance:v?75:80,redundancyThreshold:.5,enableContextSensitivity:!0,enableAntiRepetition:!0},f.dominance>=85&&(b.maxContexts=Math.max(b.maxContexts,2),b.minRelevance=Math.max(b.minRelevance-5,75)),((null==(g=d.eventCounts)?void 0:g.top.schneider)||0)+((null==(y=d.eventCounts)?void 0:y.bottom.schneider)||0)>=2&&(b.maxContexts=Math.max(b.maxContexts,2),b.minRelevance=Math.max(b.minRelevance-10,70)),b),C=(S=t.playerNames,new V(P,S,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach(function(t){L(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({enableContextSensitivity:!0,enableAntiRepetition:!0},z))),A=[e.text],_=C.generateEnhancedSprueche(A);if(_.sprueche.length>1){var O=_.sprueche.filter(function(t){return t!==e.text});if(O.length>0)return{text:e.text+" "+O.map(function(e){return"• ".concat(e)}).join(" "),icon:e.icon}}}catch(e){}return e}(function(e,t){for(var n=e.text,r=Array.from(n.matchAll(/alle (\d+) Matsche?/gi)),a=0;a<r.length;a++){var i=r[a],o=parseInt(i[1]),s=t.eventAnalysis.topTeamErzielte.matsch,c=t.eventAnalysis.bottomTeamErzielte.matsch;if(o===t.totalMatscheErzielt)if(s===o&&0===c);else if(c===o&&0===s);else{var l="".concat(Math.max(s,c)," von ").concat(o," Matschen (").concat(s,":").concat(c,")");n=n.replace(i[0],l)}}for(var u=Array.from(n.matchAll(/(\d+):(\d+)!/g)),h=0;h<u.length;h++){var m=u[h],p=parseInt(m[1]),f=parseInt(m[2]),d=t.topTotal,g=t.bottomTotal;if(p===d&&f===g||p===g&&f===d);else{var y=t.isTopWinner?"".concat(d,":").concat(g,"!"):"".concat(g,":").concat(d,"!");n=n.replace(m[0],y)}}for(var v=Array.from(n.matchAll(/(sammeln|holen|machen|servieren) (\d+) (von \d+)? ?Matsche?/gi)),b=0;b<v.length;b++){var S=v[b],w=parseInt(S[2]),x=t.eventAnalysis.topTeamErzielte.matsch,N=t.eventAnalysis.bottomTeamErzielte.matsch,k=S.index||0,j=n.substring(Math.max(0,k-50),k),M=j.includes(t.playerNames[2])||j.includes(t.playerNames[4]),E=j.includes(t.playerNames[1])||j.includes(t.playerNames[3]);M&&w!==x?n=n.replace(S[2],x.toString()):E&&w!==N&&(n=n.replace(S[2],N.toString()))}if(t.groupStats){for(var T=Array.from(n.matchAll(/(\d+)% Siegquote/gi)),P=0;P<T.length;P++)!function(){var e=T[P],r=parseInt(e[1]),a=e.index||0,i=n.substring(Math.max(0,a-100),a),o=[t.playerNames[1],t.playerNames[2],t.playerNames[3],t.playerNames[4]].filter(function(e){return e&&i.includes(e)});if(o.length>0&&t.groupStats.playerWithHighestWinRateGame){var s=o[0],c=t.groupStats.playerWithHighestWinRateGame.find(function(e){return e.playerName===s});if(c){var l=Math.round(100*c.value);Math.abs(r-l)>5&&(n=n.replace(e[0],"".concat(l,"% Siegquote")))}}}();for(var z=Array.from(n.matchAll(/Marathon-Session mit (\d+) Spielen/gi)),C=0;C<z.length;C++){var A=z[C],_=parseInt(A[1]),O=t.gamesPlayed||0;_!==O&&(n=n.replace(A[0],"Marathon-Session mit ".concat(O," Spielen"))),t.groupStats.avgGamesPerSession&&(O>=2*t.groupStats.avgGamesPerSession||(n=n.replace(A[0],"L\xe4ngere Session mit ".concat(O," Spielen"))))}for(var W=Array.from(n.matchAll(/(\d+) Matsche.*doppelt so viel wie üblich/gi)),D=0;D<W.length;D++){var R=W[D],G=parseInt(R[1]),I=t.totalMatscheErzielt;G!==I&&(n=n.replace(R[1],I.toString())),t.groupStats.avgMatschPerGame&&t.gamesPlayed&&(I>=2*Math.round(t.groupStats.avgMatschPerGame*t.gamesPlayed)||(n=n.replace("doppelt so viel wie \xfcblich","\xfcberdurchschnittlich viel")))}for(var B=Array.from(n.matchAll(/historischen ([+-]?\d+) Matsch-Bilanz/gi)),H=0;H<B.length;H++)!function(){var e=B[H],r=parseInt(e[1]),a=e.index||0,i=n.substring(Math.max(0,a-100),a),o=[t.playerNames[1],t.playerNames[2],t.playerNames[3],t.playerNames[4]].filter(function(e){return e&&i.includes(e)});if(o.length>0&&t.groupStats.playerWithHighestMatschBilanz){var s=o[0],c=t.groupStats.playerWithHighestMatschBilanz.find(function(e){return e.playerName===s});c&&c.value!==r&&(n=n.replace(e[1],c.value.toString()))}}();for(var L=Array.from(n.matchAll(/\+(\d+) Striche Dominanz/gi)),F=0;F<L.length;F++)!function(){var e=L[F],r=parseInt(e[1]),a=e.index||0,i=n.substring(Math.max(0,a-100),a),o=i.includes(t.playerNames[2])&&i.includes(t.playerNames[4]),s=i.includes(t.playerNames[1])&&i.includes(t.playerNames[3]);if((o||s)&&t.groupStats.teamWithHighestStricheDiff){var c=o?[t.playerNames[2],t.playerNames[4]].sort().join("_"):[t.playerNames[1],t.playerNames[3]].sort().join("_"),l=t.groupStats.teamWithHighestStricheDiff.find(function(e){return e.names.sort().join("_")===c});l&&Math.abs(l.value)!==r&&(n=n.replace(e[1],Math.abs(l.value).toString()))}}();for(var V=Array.from(n.matchAll(/(\d+) Punkte im Minus/gi)),K=0;K<V.length;K++)!function(){var e=V[K],r=parseInt(e[1]),a=e.index||0,i=n.substring(Math.max(0,a-100),a),o=[t.playerNames[1],t.playerNames[2],t.playerNames[3],t.playerNames[4]].filter(function(e){return e&&i.includes(e)});if(o.length>0&&t.groupStats.playerWithHighestPointsDiff){var s=o[0],c=t.groupStats.playerWithHighestPointsDiff.find(function(e){return e.playerName===s});if(c&&c.value<0){var l=Math.abs(c.value);l!==r&&(n=n.replace(e[1],l.toString()))}}}()}return{text:n.trim(),icon:e.icon}}(function(e){var t=[];t.push(e.hauptspruch);var n=e.hauptspruch.includes("16:")||e.hauptspruch.includes("15:")||e.hauptspruch.includes("14:")||e.hauptspruch.includes(":16")||e.hauptspruch.includes(":15")||e.hauptspruch.includes(":14"),r=e.hauptspruch.includes("vernicht")||e.hauptspruch.includes("Massaker")||e.hauptspruch.includes("atomisiert")||e.hauptspruch.includes("Blutbad")||"\uD83D\uDCA5"===e.emoji||"☢️"===e.emoji||"\uD83D\uDD2A"===e.emoji;if(e.narrativ&&t.push(e.narrativ),e.matchDetails&&(n||r||.5>Math.random())&&t.push(e.matchDetails),e.specialEvents&&e.specialEvents.length>0){var a=n?e.specialEvents:e.specialEvents.slice(0,.5>Math.random()?1:2);t.push.apply(t,ei(a))}e.gruppenContext&&(n||Math.random()<(r?.8:.4))&&t.push(e.gruppenContext),e.zeitDetails&&(n||Math.random()<(r?.7:.3))&&t.push(e.zeitDetails);var i=t[0];if(t.length>1)for(var o=1;o<t.length;o++)t[o].startsWith("-")||t[o].startsWith("•"),i+=" ".concat(t[o]);return{text:i.trim(),icon:e.emoji}}(ef),{eventAnalysis:w,playerNames:i,isTopWinner:d,topTotal:m,bottomTotal:p,useStriche:h,totalMatscheErzielt:em,groupStats:n.groupStats,gamesPlayed:n.gamesPlayed,winnerNames:b,loserNames:S}),n),e$=eY.text;if(Object.values(i).includes("Marc")){for(var eX=0,eQ=1;eQ<=4;eQ++)if("Marc"===i[eQ]){eX=eQ;break}if(eX>0){var e0=2===eX||4===eX,e1=e0&&!d&&f>=5||!e0&&d&&f>=5,e2=e0&&d&&f>=5||!e0&&!d&&f>=5,e5=0;if(n.eventCounts&&(e5=e0?n.eventCounts.top.matsch||0:n.eventCounts.bottom.matsch||0),e1)e$+=" • Marcs Augen wurden magnetisch: Sie starren jetzt noch aufs Handy.";else if(e2&&e5>=2){var e3=Math.floor(21*Math.random())+30;e$+=" • Marc kam nach seinen Matschen ins totale Schwelgen: ".concat(e3," x gemischelt!!!")}}}return{text:e$,icon:eY.icon}}var ep=n(99087),ef=n(41877),ed=n(37537),eg=n(62602),ey=n(37876);function ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ev(Object(n),!0).forEach(function(t){var r,a,i;r=e,a=t,i=n[t],(a=function(e){var t=function(e,t){if("object"!=ek(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ek(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ek(t)?t:t+""}(a))in r?Object.defineProperty(r,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ev(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eS(e){return function(e){if(Array.isArray(e))return eE(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||eM(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ew(){ew=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(t,n,r,i){var o,s,c,l,u=Object.create((n&&n.prototype instanceof g?n:g).prototype);return a(u,"_invoke",{value:(o=t,s=r,c=new E(i||[]),l=m,function(t,n){if(l===p)throw Error("Generator is already running");if(l===f){if("throw"===t)throw n;return{value:e,done:!0}}for(c.method=t,c.arg=n;;){var r=c.delegate;if(r){var a=function t(n,r){var a=r.method,i=n.iterator[a];if(i===e)return r.delegate=null,"throw"===a&&n.iterator.return&&(r.method="return",r.arg=e,t(n,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+a+"' method")),d;var o=h(i,n.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,d;var s=o.arg;return s?s.done?(r[n.resultName]=s.value,r.next=n.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,d):s:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,d)}(r,c);if(a){if(a===d)continue;return a}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===m)throw l=f,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=p;var i=h(o,s,c);if("normal"===i.type){if(l=c.done?f:"suspendedYield",i.arg===d)continue;return{value:i.arg,done:c.done}}"throw"===i.type&&(l=f,c.method="throw",c.arg=i.arg)}})}),u}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",p="executing",f="completed",d={};function g(){}function y(){}function v(){}var b={};l(b,o,function(){return this});var S=Object.getPrototypeOf,w=S&&S(S(T([])));w&&w!==n&&r.call(w,o)&&(b=w);var x=v.prototype=g.prototype=Object.create(b);function N(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function k(e,t){var n;a(this,"_invoke",{value:function(a,i){function o(){return new t(function(n,o){!function n(a,i,o,s){var c=h(e[a],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==ek(u)&&r.call(u,"__await")?t.resolve(u.__await).then(function(e){n("next",e,o,s)},function(e){n("throw",e,o,s)}):t.resolve(u).then(function(e){l.value=e,o(l)},function(e){return n("throw",e,o,s)})}s(c.arg)}(a,i,n,o)})}return n=n?n.then(o,o):o()}})}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw TypeError(ek(t)+" is not iterable")}return y.prototype=v,a(x,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:y,configurable:!0}),y.displayName=l(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},N(k.prototype),l(k.prototype,s,function(){return this}),t.AsyncIterator=k,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new k(u(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},N(x),l(x,c,"Generator"),l(x,o,function(){return this}),l(x,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return s.type="throw",s.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;M(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}function ex(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function eN(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){ex(i,r,a,o,s,"next",e)}function s(e){ex(i,r,a,o,s,"throw",e)}o(void 0)})}}function ek(e){return(ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ej(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}(e,t)||eM(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eM(e,t){if(e){if("string"==typeof e)return eE(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eE(e,t):void 0}}function eE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eT=function(e){var t=e.name,n=e.isStarter;return(0,ey.jsx)("div",{className:"text-center text-gray-400 px-1 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,ey.jsxs)("span",{className:"inline-block",children:[t,n&&(0,ey.jsx)("span",{children:"❀"})]})})};let eP=function(e){var t,n,m,p,d,g,y,v,b,x,N=e.gameData,k=e.gameTypeLabel,j=e.onBackClick,M=ej((0,r.useState)(null!=(t=null==(n=o.D[0])?void 0:n.id)?t:"striche"),2),E=M[0],T=M[1],P=S(),z=P.isSharing,C=P.handleShare,A=ej((0,r.useState)("points"),2);A[0],A[1];var _=ej((0,r.useState)(void 0),2),O=_[0],W=_[1],D=ej((0,r.useState)(!1),2);D[0],D[1];var R=ej((0,r.useState)(!1),2),G=R[0],I=R[1],B=(0,w.h)().user;(0,f.useUIStore)().showJassFinishNotification;var H=(0,r.useMemo)(function(){return N.games[N.games.length-1]},[N.games]);(0,r.useMemo)(function(){return H&&"gameNumber"in H&&"number"==typeof H.gameNumber?H.gameNumber:1},[H]);var L=(0,r.useMemo)(function(){N.startedAt?e=N.startedAt:H&&"timestamp"in H?e=H.timestamp:H&&"timestampCompleted"in H&&(e=H.timestampCompleted);var e,t,n=(t=e)?t instanceof i.Timestamp?t.toMillis():"function"==typeof t.toDate?t.toDate().getTime():"object"===ek(t)&&"seconds"in t&&"nanoseconds"in t?new i.Timestamp(t.seconds,t.nanoseconds).toMillis():"number"==typeof t?t:Date.now():Date.now();return(0,a.GP)(new Date(n),"d.M.yyyy")},[H,N.startedAt]),F=null!=(m=N.strokeSettings)?m:l.zh,V=null!=(p=N.cardStyle)?p:u.FT.cardStyle,K=null!=(d=N.scoreSettings)?d:h.$d,J=(0,r.useMemo)(function(){var e=function(e,t,n){var r=0;return n.berg&&"number"==typeof e.berg&&(r+=e.berg),"number"==typeof e.sieg&&(r+=e.sieg),n.schneider&&"number"==typeof e.schneider&&(r+=e.schneider),"number"==typeof e.matsch&&(r+=e.matsch),"number"==typeof e.kontermatsch&&(r+=e.kontermatsch),r};return N.games.reduce(function(t,n){var r,a,i,o,s,c,l,u,h,m,p,f,d=null,g=null,y=0,v=0;"teams"in n&&n.teams?n.teams.top&&n.teams.bottom&&(d=n.teams.top.striche,g=n.teams.bottom.striche,y=(null!=(r=n.teams.top.jassPoints)?r:0)+(null!=(a=n.teams.top.weisPoints)?a:0),v=(null!=(i=n.teams.bottom.jassPoints)?i:0)+(null!=(o=n.teams.bottom.weisPoints)?o:0)):"finalStriche"in n&&n.finalStriche&&(d=null!=(s=null==(c=n.finalStriche)?void 0:c.top)?s:null,g=null!=(l=null==(u=n.finalStriche)?void 0:u.bottom)?l:null,y=null!=(h=null==(m=n.finalScores)?void 0:m.top)?h:0,v=null!=(p=null==(f=n.finalScores)?void 0:f.bottom)?p:0);var b=d?e(d,F,K.enabled):0,S=g?e(g,F,K.enabled):0;return{striche:{top:t.striche.top+b,bottom:t.striche.bottom+S},punkte:{top:t.punkte.top+y,bottom:t.punkte.bottom+v}}},{striche:{top:0,bottom:0},punkte:{top:0,bottom:0}})},[N.games,F,K]),U=(0,r.useMemo)(function(){var e=function(e){var t,n,r,a,i,o,s,c,l,u=N.games.length>0?N.games[N.games.length-1]:null,h={berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},m=0,p=0;return u&&("teams"in u&&u.teams?u.teams[e]&&(h=u.teams[e].striche,m=(null!=(t=u.teams[e].jassPoints)?t:0)+(null!=(n=u.teams[e].weisPoints)?n:0),p=null!=(r=u.teams[e].weisPoints)?r:0):"finalStriche"in u&&u.finalStriche&&u.finalScores&&(h=null!=(a=null==(i=u.finalStriche)?void 0:i[e])?a:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0},m=null!=(o=null==(s=u.finalScores)?void 0:s[e])?o:0,p=null!=(c=null==(l=u.weisPoints)?void 0:l[e])?c:0)),{striche:h,jassPoints:m-p,weisPoints:p,total:m,bergActive:!1,bedankenActive:!1,isSigned:!1,playerStats:{1:{striche:0,points:0,weisPoints:0},2:{striche:0,points:0,weisPoints:0},3:{striche:0,points:0,weisPoints:0},4:{striche:0,points:0,weisPoints:0}}}};return{top:e("top"),bottom:e("bottom")}},[N.games]),Z=(0,r.useCallback)(function(e){var t,n=o.D.findIndex(function(e){return e.id===E});t="right"===e?(n+1)%o.D.length:(n-1+o.D.length)%o.D.length,T(o.D[t].id)},[E]),q=(0,c.uh)({onSwipedLeft:function(){return Z("right")},onSwipedRight:function(){return Z("left")},preventScrollOnSwipe:!0,trackMouse:!0,touchEventOptions:{passive:!1}}),Y=(0,s.zh)({from:{opacity:0,transform:"translateX(20px)"},to:{opacity:1,transform:"translateX(0px)"},key:E,config:{tension:280,friction:25}}),$=o.D.find(function(e){return e.id===E}),X=(0,r.useMemo)(function(){if(N.games&&N.games.length>0){var e,t;return null!=(e=null==(t=N.games[0])?void 0:t.initialStartingPlayer)?e:1}return 1},[N.games]),Q=(0,r.useCallback)(eN(ew().mark(function e(){var t,n;return ew().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat((null==O?void 0:O.text)||"Jass-Ergebnis","\n\ngeneriert von:\n\uD83D\uDC49 jassguru.ch"),n=["#screenshot-hide-dots"],e.abrupt("return",C("#game-viewer-kreidetafel",".scrollable-content",n,t,"jass-session.png",!0));case 1:case"end":return e.stop()}},e)})),[O,C]);(0,r.useEffect)(function(){O&&"object"===ek(O)&&!G?(console.log("[GameViewer] Auto-showing JassFinishNotification for spruch"),f.useUIStore.setState(function(e){return{jassFinishNotification:{isOpen:!0,mode:"share",message:O,onShare:Q,onRegenerate:ee,onBack:function(){},onBackLabel:"Schliessen"}}}),I(!0)):N.sessionId||G||!(N.games.length>0)||(console.log("[GameViewer] Legacy session detected, no auto-notification (use share button)"),I(!0))},[O,G,null==B?void 0:B.uid,N.sessionId,N.games.length]);var ee=(0,r.useCallback)(eN(ew().mark(function e(){var t,n,r,a,i;return ew().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[GameViewer] ✅ REGENERATE CALLBACK REACHED - generating fresh spruch"),console.log("[GameViewer] gameData:",N),console.log("[GameViewer] user:",null==B?void 0:B.uid);try{n=(t=N.sessionLevelData)?[].concat(eS(N.games.slice(0,-1)),[eb(eb({},N.games[N.games.length-1]),{},{eventCounts:t.eventCounts,gameResults:t.gameResults,gameWinsByTeam:t.gameWinsByTeam,gameWinsByPlayer:t.gameWinsByPlayer,gamesPlayed:t.gamesPlayed,durationSeconds:t.durationSeconds,finalStriche:t.finalStriche,winnerTeamKey:t.winnerTeamKey,aggregatedTrumpfCountsByPlayer:t.aggregatedTrumpfCountsByPlayer,aggregatedRoundDurationsByPlayer:t.aggregatedRoundDurationsByPlayer,sessionTotalWeisPoints:t.sessionTotalWeisPoints,totalRounds:t.totalRounds})]):N.games,r=em({games:n,playerNames:N.playerNames,currentTotals:J.striche,legacy:!N.sessionId,groupStats:N.groupStats}),a=eb(eb({},r),{},{generatedAt:new Date,version:"v2",generatedBy:(null==B?void 0:B.uid)||"manual"}),console.log("[GameViewer] Generated fresh spruch for regeneration:",a),W(a),f.useUIStore.setState(function(e){return{jassFinishNotification:{isOpen:!0,mode:"share",message:a,onShare:Q,onRegenerate:ee,onBack:function(){},onBackLabel:"Abbrechen"}}})}catch(e){console.error("[GameViewer] Failed to regenerate spruch:",e),W(i={text:"Was f\xfcr ein spannender Jass!",icon:"\uD83C\uDFAF",generatedAt:new Date,version:"v2",generatedBy:(null==B?void 0:B.uid)||"fallback"}),f.useUIStore.setState(function(e){return{jassFinishNotification:{isOpen:!0,mode:"share",message:i,onShare:Q,onRegenerate:ee,onBack:function(){},onBackLabel:"Abbrechen"}}})}case 1:case"end":return e.stop()}},e)})),[N.games,N.playerNames,J,N.sessionId,N.groupStats,B,Q,W]),et=(0,r.useCallback)(eN(ew().mark(function e(){var t,n,r,a;return ew().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[GameViewer] Manual share clicked - generating fresh spruch");try{n=(t=N.sessionLevelData)?[].concat(eS(N.games.slice(0,-1)),[eb(eb({},N.games[N.games.length-1]),{},{eventCounts:t.eventCounts,gameResults:t.gameResults,gameWinsByTeam:t.gameWinsByTeam,gameWinsByPlayer:t.gameWinsByPlayer,gamesPlayed:t.gamesPlayed,durationSeconds:t.durationSeconds,finalStriche:t.finalStriche,winnerTeamKey:t.winnerTeamKey,aggregatedTrumpfCountsByPlayer:t.aggregatedTrumpfCountsByPlayer,aggregatedRoundDurationsByPlayer:t.aggregatedRoundDurationsByPlayer,sessionTotalWeisPoints:t.sessionTotalWeisPoints,totalRounds:t.totalRounds})]):N.games,r=em({games:n,playerNames:N.playerNames,currentTotals:J.striche,legacy:!N.sessionId,groupStats:N.groupStats}),a=eb(eb({},r),{},{generatedAt:new Date,version:"v2",generatedBy:(null==B?void 0:B.uid)||"manual"}),console.log("[GameViewer] Generated fresh spruch:",a),W(a),f.useUIStore.setState(function(e){return{jassFinishNotification:{isOpen:!0,mode:"share",message:a,onShare:Q,onRegenerate:ee,onBack:function(){},onBackLabel:"Abbrechen"}}})}catch(e){console.error("[GameViewer] Failed to generate fresh spruch:",e),C("#game-viewer-kreidetafel",".scrollable-content",["#screenshot-hide-dots"],"\n\ngeneriert von:\n\uD83D\uDC49 jassguru.ch","jass-session.png",!0)}case 1:case"end":return e.stop()}},e)})),[N.games,N.playerNames,J,N.sessionId,N.groupStats,B,Q,C,W]);return(0,ey.jsxs)(ey.Fragment,{children:[(0,ey.jsxs)("div",eb(eb({id:"game-viewer-kreidetafel"},q),{},{className:"relative flex flex-col bg-gradient-radial from-gray-800 to-gray-900 text-white p-4 md:p-6 max-w-md mx-auto h-full touch-action-pan-x pt-24",children:[j&&(0,ey.jsx)(ed.$,{variant:"ghost",className:"absolute top-12 left-4 text-white hover:bg-gray-700 p-3","aria-label":"Zur\xfcck",onClick:j,children:(0,ey.jsx)(ef.A,{size:28})}),(0,ey.jsx)("button",{onClick:et,disabled:z,className:"absolute top-12 right-4 z-10 p-2 text-gray-300 hover:text-white transition-colors duration-200 rounded-full bg-gray-700/50 hover:bg-gray-600/70 disabled:opacity-50 disabled:cursor-wait","aria-label":"Ergebnis teilen",children:z?(0,ey.jsx)(ep.TwU,{className:"w-5 h-5 animate-spin"}):(0,ey.jsx)(ep.Pum,{className:"w-5 h-5"})}),(0,ey.jsxs)("div",{className:"text-center mb-4 flex-shrink-0",children:[(0,ey.jsx)("h2",{className:"text-2xl font-bold text-white",children:(null==$?void 0:$.title)||"Jassergebnis"}),(0,ey.jsx)("p",{className:"text-gray-400",children:L})]}),(0,ey.jsxs)("div",{className:"mb-4 flex-shrink-0",children:[(0,ey.jsxs)("div",{className:"grid grid-cols-[1fr_4fr_4fr] gap-4 mb-2",children:[(0,ey.jsx)("div",{})," ",(0,ey.jsx)("div",{className:"text-center text-white font-semibold",children:"Team 1"}),(0,ey.jsx)("div",{className:"text-center text-white font-semibold",children:"Team 2"})]}),(0,ey.jsxs)("div",{className:"grid grid-cols-[1fr_4fr_4fr] gap-4",children:[(0,ey.jsx)("div",{})," ",(0,ey.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[(0,ey.jsx)(eT,{name:null!=(g=N.playerNames[1])?g:"Spieler 1",isStarter:1===X}),(0,ey.jsx)(eT,{name:null!=(y=N.playerNames[3])?y:"Spieler 3",isStarter:3===X})]}),(0,ey.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[(0,ey.jsx)(eT,{name:null!=(v=N.playerNames[2])?v:"Spieler 2",isStarter:2===X}),(0,ey.jsx)(eT,{name:null!=(b=N.playerNames[4])?b:"Spieler 4",isStarter:4===X})]})]})]}),(0,ey.jsx)("div",{className:"scrollable-content flex-grow overflow-y-auto scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800 touch-action-pan-y",children:(0,ey.jsx)("div",{className:"border-t border-b border-gray-700",children:(0,ey.jsx)("div",{className:"py-2 px-1",children:(0,ey.jsx)(s.CS.div,{style:Y,children:$&&r.createElement($.component,{games:N.games,teams:U,playerNames:N.playerNames,cardStyle:V,strokeSettings:F,scoreSettings:K,activeGameScores:H&&"finalScores"in H&&H.finalScores?H.finalScores:H&&"teams"in H&&H.teams&&"total"in H.teams.top&&"total"in H.teams.bottom?{top:H.teams.top.total,bottom:H.teams.bottom.total}:{top:0,bottom:0},currentGameId:null!=(x=null==H?void 0:H.gameNumber)?x:0,onSwipe:Z,gameTypeLabel:void 0===k?"Spiel":k})})})})}),(0,ey.jsx)("div",{id:"screenshot-hide-totals",className:"flex-shrink-0 pt-4 pb-8",children:(0,ey.jsxs)("div",{className:"grid grid-cols-[1fr_4fr_4fr] gap-4",children:[(0,ey.jsx)("div",{className:"text-gray-400 text-center pr-4",children:"Total:"}),(0,ey.jsx)("div",{className:"flex justify-center -ml-[30px]",children:(0,ey.jsx)("div",{className:"text-2xl font-bold text-white w-[100px] text-center",children:"striche"===E?J.striche.bottom:J.punkte.bottom})}),(0,ey.jsx)("div",{className:"flex justify-center -ml-[12px]",children:(0,ey.jsx)("div",{className:"text-2xl font-bold text-white w-[100px] text-center",children:"striche"===E?J.striche.top:J.punkte.top})})]})}),(0,ey.jsx)("div",{id:"screenshot-hide-dots",className:"flex justify-center mt-4 mb-2 flex-shrink-0",children:(0,ey.jsx)("div",{className:"flex justify-center items-center space-x-2 bg-gray-700/50 px-1.5 py-1 rounded-full",children:o.D.map(function(e){return(0,ey.jsx)("div",{onClick:function(){return T(e.id)},className:"w-2.5 h-2.5 rounded-full transition-all duration-200 cursor-pointer ".concat(E===e.id?"bg-white shadow-sm":"bg-gray-500 hover:bg-gray-400")},e.id)})})})]})),(0,ey.jsx)(eg.A,{})]})}}}]);