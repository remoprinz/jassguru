(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8124],{417:(e,t,r)=>{"use strict";r.d(t,{AM:()=>u,Wv:()=>d,hl:()=>p});var n=r(4232),a=r(3178),i=r(6722),s=r(7876);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=["className","align","sideOffset"];function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var u=a.bL,d=a.l9;a.Mz;var p=n.forwardRef(function(e,t){var r=e.className,n=e.align,u=e.sideOffset,d=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,l);return(0,s.jsx)(a.ZL,{children:(0,s.jsx)(a.UC,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==o(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({ref:t,align:void 0===n?"center":n,sideOffset:void 0===u?4:u,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",r)},d))})});p.displayName=a.UC.displayName},1032:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(3122).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1566:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(3122).A)("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])},3178:(e,t,r)=>{"use strict";r.d(t,{Mz:()=>$,UC:()=>V,ZL:()=>H,bL:()=>K,l9:()=>q});var n=r(4232),a=r(3716),i=r(714),s=r(1844),o=r(3520),l=r(2658),c=r(870),u=r(294),d=r(8212),p=r(1893),h=r(6822),f=r(6326),m=r(2987),y=r(8162),g=r(4769),x=r(6324),v=r(7876),b="Popover",[j,w]=(0,s.A)(b,[d.Bk]),N=(0,d.Bk)(),[S,k]=j(b),P=e=>{let{__scopePopover:t,children:r,open:a,defaultOpen:i,onOpenChange:s,modal:o=!1}=e,l=N(t),c=n.useRef(null),[p,h]=n.useState(!1),[f,m]=(0,y.i)({prop:a,defaultProp:i??!1,onChange:s,caller:b});return(0,v.jsx)(d.bL,{...l,children:(0,v.jsx)(S,{scope:t,contentId:(0,u.B)(),triggerRef:c,open:f,onOpenChange:m,onOpenToggle:n.useCallback(()=>m(e=>!e),[m]),hasCustomAnchor:p,onCustomAnchorAdd:n.useCallback(()=>h(!0),[]),onCustomAnchorRemove:n.useCallback(()=>h(!1),[]),modal:o,children:r})})};P.displayName=b;var O="PopoverAnchor",A=n.forwardRef((e,t)=>{let{__scopePopover:r,...a}=e,i=k(O,r),s=N(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=i;return n.useEffect(()=>(o(),()=>l()),[o,l]),(0,v.jsx)(d.Mz,{...s,...a,ref:t})});A.displayName=O;var T="PopoverTrigger",E=n.forwardRef((e,t)=>{let{__scopePopover:r,...n}=e,s=k(T,r),o=N(r),l=(0,i.s)(t,s.triggerRef),c=(0,v.jsx)(f.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":B(s.open),...n,ref:l,onClick:(0,a.m)(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?c:(0,v.jsx)(d.Mz,{asChild:!0,...o,children:c})});E.displayName=T;var L="PopoverPortal",[C,U]=j(L,{forceMount:void 0}),D=e=>{let{__scopePopover:t,forceMount:r,children:n,container:a}=e,i=k(L,t);return(0,v.jsx)(C,{scope:t,forceMount:r,children:(0,v.jsx)(h.C,{present:r||i.open,children:(0,v.jsx)(p.Z,{asChild:!0,container:a,children:n})})})};D.displayName=L;var I="PopoverContent",M=n.forwardRef((e,t)=>{let r=U(I,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,i=k(I,e.__scopePopover);return(0,v.jsx)(h.C,{present:n||i.open,children:i.modal?(0,v.jsx)(R,{...a,ref:t}):(0,v.jsx)(z,{...a,ref:t})})});M.displayName=I;var _=(0,m.TL)("PopoverContent.RemoveScroll"),R=n.forwardRef((e,t)=>{let r=k(I,e.__scopePopover),s=n.useRef(null),o=(0,i.s)(t,s),l=n.useRef(!1);return n.useEffect(()=>{let e=s.current;if(e)return(0,g.Eq)(e)},[]),(0,v.jsx)(x.A,{as:_,allowPinchZoom:!0,children:(0,v.jsx)(G,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,a.m)(e.onCloseAutoFocus,e=>{e.preventDefault(),l.current||r.triggerRef.current?.focus()}),onPointerDownOutside:(0,a.m)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;l.current=2===t.button||r},{checkForDefaultPrevented:!1}),onFocusOutside:(0,a.m)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),z=n.forwardRef((e,t)=>{let r=k(I,e.__scopePopover),a=n.useRef(!1),i=n.useRef(!1);return(0,v.jsx)(G,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(a.current||r.triggerRef.current?.focus(),t.preventDefault()),a.current=!1,i.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(a.current=!0,"pointerdown"===t.detail.originalEvent.type&&(i.current=!0));let n=t.target;r.triggerRef.current?.contains(n)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}})}),G=n.forwardRef((e,t)=>{let{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:h,onInteractOutside:f,...m}=e,y=k(I,r),g=N(r);return(0,l.Oh)(),(0,v.jsx)(c.n,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:(0,v.jsx)(o.qW,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:f,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:h,onDismiss:()=>y.onOpenChange(!1),children:(0,v.jsx)(d.UC,{"data-state":B(y.open),role:"dialog",id:y.contentId,...g,...m,ref:t,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),F="PopoverClose";function B(e){return e?"open":"closed"}n.forwardRef((e,t)=>{let{__scopePopover:r,...n}=e,i=k(F,r);return(0,v.jsx)(f.sG.button,{type:"button",...n,ref:t,onClick:(0,a.m)(e.onClick,()=>i.onOpenChange(!1))})}).displayName=F,n.forwardRef((e,t)=>{let{__scopePopover:r,...n}=e,a=N(r);return(0,v.jsx)(d.i3,{...a,...n,ref:t})}).displayName="PopoverArrow";var K=P,$=A,q=E,H=D,V=M},3723:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(3122).A)("chart-no-axes-column",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]])},3815:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eq});var n=r(4232),a=r(9099),i=r(4587),s=r.n(i),o=r(6602),l=r(2322),c=r(950),u=r(3649),d=r(4536),p=r(5881),h=r(9770),f=r(7947),m=r(1032),y=r(744),g=r(7758),x=r(9961),v=r(5527),b=r(5954),j=r(7256),w=r(5143),N=r(6133),S=r(3122),k=(0,S.A)("circle-play",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),P=r(7887),O=r(2009),A=r(5519),T=r(1322),E=r(4790),L=r(9143),C=r(582),U=r(7044),D=r(132),I=r(6722),M=r(7876),_=function(e,t){var r,n=null==(r=e.playerDetails)?void 0:r.find(function(e){return e.playerId===t});return(null==n?void 0:n.team)||null},R=function(e){var t=e.label,r=e.value,n=e.highlight;return(0,M.jsxs)("div",{className:(0,I.cn)("text-xs px-2 py-1 rounded",n?"bg-purple-600/30 text-purple-200":"bg-gray-700/50 text-gray-300"),children:[(0,M.jsxs)("span",{className:"font-medium",children:[t,":"]})," ",r]})};let z=function(e){var t=e.playerGames,r=e.playerUid,n=e.playerName;return(void 0===e.strokeSettings&&U.zh,t&&0!==t.length)?(0,M.jsx)("div",{className:"space-y-4",children:t.map(function(e){var t,a,i=_(e,r);if(!i)return null;var s=null==(t=e.teamStrichePasse)?void 0:t[i],o=null==(a=e.teamStrichePasse)?void 0:a["top"===i?"bottom":"top"];return(0,M.jsxs)("div",{className:"bg-gray-800/60 p-3 rounded-lg shadow",children:[(0,M.jsxs)("h4",{className:"text-sm font-semibold text-purple-300 mb-2",children:["Passe ",e.passeNumber]}),(0,M.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,M.jsxs)("div",{children:[(0,M.jsxs)("p",{className:"text-xs text-gray-400 mb-1",children:["Striche f\xfcr ",n," (Team ","top"===i?"Oben":"Unten",")"]}),s?(0,M.jsxs)("div",{className:"space-y-1",children:[(0,M.jsx)(R,{label:"Berg",value:s.berg,highlight:s.berg>0}),(0,M.jsx)(R,{label:"Sieg",value:s.sieg,highlight:s.sieg>0}),(0,M.jsx)(R,{label:"Matsch",value:s.matsch,highlight:s.matsch>0}),(0,M.jsx)(R,{label:"Schneider",value:s.schneider,highlight:s.schneider>0}),(0,M.jsx)(R,{label:"Konterm.",value:s.kontermatsch,highlight:s.kontermatsch>0})]}):(0,M.jsx)("p",{className:"text-xs text-gray-500",children:"Keine Strichdaten."})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Striche Gegnerteam"}),o?(0,M.jsxs)("div",{className:"space-y-1",children:[(0,M.jsx)(R,{label:"Berg",value:o.berg,highlight:!1}),(0,M.jsx)(R,{label:"Sieg",value:o.sieg,highlight:!1}),(0,M.jsx)(R,{label:"Matsch",value:o.matsch,highlight:!1}),(0,M.jsx)(R,{label:"Schneider",value:o.schneider,highlight:!1}),(0,M.jsx)(R,{label:"Konterm.",value:o.kontermatsch,highlight:!1})]}):(0,M.jsx)("p",{className:"text-xs text-gray-500",children:"Keine Strichdaten."})]})]})]},e.passeId)})}):(0,M.jsx)("div",{className:"text-center text-gray-400 py-8",children:"Keine Passen-Daten f\xfcr die Strich-Details verf\xfcgbar."})};var G=r(1163),F=function(e){if(e){var t=e.toLowerCase();if("mis\xe8re"===t)return"Mis\xe8re";if("eicheln"===t||"eichel"===t)return"Eicheln";if("rosen"===t||"rose"===t)return"Rosen";if("schellen"===t||"schelle"===t)return"Schellen";if("schilten"===t||"schilte"===t)return"Schilten";if("obe"===t)return"Obe";if("une"===t||"unde"===t)return"Une";if("3x3"===t)return"3x3";if("quer"===t)return"Quer";if("slalom"===t)return"Slalom";if("trumpf"===t)return"Obe";console.warn("[mapDbValueToJassColorType] Unbekannter DB-Wert: '".concat(e,"' in TournamentRoundHistoryDisplay, konnte nicht zu JassColor gemappt werden."))}},B=function(e,t){var r,n,a,i,s,o,l,c,u=null!=(r=null==(n=e.scores)?void 0:n.top)?r:0,d=null!=(a=null==(i=e.scores)?void 0:i.bottom)?a:0;return{top:u-(null!=(s=null==t||null==(o=t.scores)?void 0:o.top)?s:0),bottom:d-(null!=(l=null==t||null==(c=t.scores)?void 0:c.bottom)?l:0)}},K=function(e){return"jass"===e.actionType&&!0===e.isRoundFinalized&&"number"==typeof e.startingPlayer&&("string"==typeof e.farbe&&e.farbe.length>0||void 0===e.farbe)&&(void 0===e.isActive||!0===e.isActive)},$=function(e){var t,r=e.passe,a=(e.globalPlayerNames,e.cardStyle),i=(e.playerPhotoUrlMapping,e.focusedPlayerId),s=null!=(t=r.roundHistory)?t:[],o=(0,n.useMemo)(function(){var e="Team Oben",t="Team Unten",n=null;if(r.playerDetails&&r.playerDetails.length>0){var a=[],s=[];r.playerDetails.forEach(function(e){e.playerId===i&&(n=e.team),"top"===e.team&&e.playerName?a.push(e.playerName):"bottom"===e.team&&e.playerName&&s.push(e.playerName)}),a.length>0&&(e=a.join(" & ")),s.length>0&&(t=s.join(" & "))}return{teamTopDisplay:e,teamBottomDisplay:t,playerTeam:n}},[r.playerDetails,i]),l=o.teamTopDisplay,c=o.teamBottomDisplay,u=o.playerTeam,d=s.filter(K);return d.sort(function(e,t){var r,n;return((null==(r=e.roundState)?void 0:r.roundNumber)||0)-((null==(n=t.roundState)?void 0:n.roundNumber)||0)}),(0,M.jsxs)("div",{className:"pt-3 pb-2 bg-gray-800/50 rounded-lg mb-3",children:[(0,M.jsxs)("div",{className:"px-3 mb-2 border-b border-gray-700 pb-2",children:[(0,M.jsxs)("h3",{className:"text-md font-semibold text-purple-300",children:["Passe ",r.passeNumber]}),(0,M.jsxs)("div",{className:"text-xs text-gray-400",children:[(0,M.jsxs)("span",{className:i&&"top"===u?"font-bold text-white":"",children:["Team Oben: ",l]}),(0,M.jsx)("br",{}),(0,M.jsxs)("span",{className:i&&"bottom"===u?"font-bold text-white":"",children:["Team Unten: ",c]})]})]}),d.length>0?(0,M.jsx)("div",{className:"space-y-0 px-2",children:d.map(function(e,t){var r,n,s,o,l,c=B(e,t>0?d[t-1]:void 0),p=null!=(r=e.jassPoints)?r:c,h=null!=(n=e.weisPoints)?n:{top:0,bottom:0};h.top>0||h.bottom;var f=void 0===(l=e.startingPlayer)?null:1===l||3===l?"bottom":2===l||4===l?"top":null,m=F(e.farbe),y=(null==(s=e.strichInfo)?void 0:s.type)==="matsch",g=(null==(o=e.strichInfo)?void 0:o.type)==="kontermatsch",x=i&&u===f;return(0,M.jsxs)("div",{className:"grid grid-cols-[auto_1fr_1fr] gap-x-2 items-center text-xs py-0.5 hover:bg-gray-700/30 rounded px-1",children:[(0,M.jsxs)("div",{className:"text-center font-medium text-gray-400 w-6",children:["R",t+1]}),(0,M.jsx)("div",{className:"text-left ".concat("bottom"===f?"font-bold text-white":"text-gray-400"," ").concat(x&&"bottom"===f?"ring-1 ring-purple-400 rounded px-0.5":""," truncate"),children:(0,M.jsxs)("span",{className:"inline-flex items-center",children:["bottom"===f&&m&&(0,M.jsx)(G.h,{farbe:m,cardStyle:a,className:"w-3 h-3 mr-1"}),(0,M.jsx)("span",{className:y?"text-purple-400":g?"text-red-400":"",children:p.bottom})]})}),(0,M.jsx)("div",{className:"text-right ".concat("top"===f?"font-bold text-white":"text-gray-400"," ").concat(x&&"top"===f?"ring-1 ring-purple-400 rounded px-0.5":""," truncate"),children:(0,M.jsxs)("span",{className:"inline-flex items-center justify-end",children:[(0,M.jsx)("span",{className:y?"text-purple-400":g?"text-red-400":"",children:p.top}),"top"===f&&m&&(0,M.jsx)(G.h,{farbe:m,cardStyle:a,className:"w-3 h-3 ml-1"})]})})]},"runde-".concat(e.roundId||t))})}):(0,M.jsx)("p",{className:"text-xs text-gray-500 text-center px-3 py-2",children:"Keine abgeschlossenen Runden f\xfcr diese Passe."})]})},q=function(e){var t=e.tournamentGames,r=e.playerNames,n=e.cardStyle,a=e.playerPhotoUrlMapping,i=e.focusedPlayerId;return t&&0!==t.length?(0,M.jsx)("div",{className:"flex flex-col w-full space-y-4 min-w-max",children:t.map(function(e,t){return(0,M.jsx)($,{passe:e,globalPlayerNames:r,cardStyle:n,playerPhotoUrlMapping:a,focusedPlayerId:i},"passe-details-".concat(e.passeId||t))})}):(0,M.jsx)("div",{className:"text-center text-gray-400 py-8",children:"Keine Passen-Daten f\xfcr die Rundenhistorie verf\xfcgbar."})},H=(0,S.A)("list-checks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),V=r(3723),W=r(2348);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach(function(t){Y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Y(e,t,r){var n;return(n=function(e,t){if("object"!==Z(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Z(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"===Z(n)?n:String(n))in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ee=[{id:"player_passe_details",displayName:"Passen-Details",component:q,icon:H},{id:"player_striche_history",displayName:"Striche-Verlauf",component:z,icon:V.A}];let et=function(e){var t,r,a=e.tournamentGames,i=e.playerUid,s=e.playerName,o=e.playerPhotoUrl,l=e.strokeSettings,c=(e.scoreSettings,e.cardStyle),u=void 0===c?D.FT.cardStyle:c,d=function(e){if(Array.isArray(e))return e}(t=(0,n.useState)(null==(r=ee[0])?void 0:r.id))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{i=(r=r.call(e)).next,!1;for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(t,2)||function(e,t){if(e){if("string"==typeof e)return Q(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),p=d[0],h=d[1],f=(0,n.useMemo)(function(){return a.filter(function(e){var t;return null==(t=e.participantUidsForPasse)?void 0:t.includes(i)})},[a,i]),m=(0,n.useMemo)(function(){return f.length>0?f[f.length-1]:null},[f]);(0,n.useMemo)(function(){return m&&"number"==typeof m.passeNumber?m.passeNumber:f.length},[m,f.length]);var y=(0,n.useMemo)(function(){m&&m.completedAt&&(e=m.completedAt);var e,t=e instanceof O.Timestamp?e.toMillis():e instanceof Date?e.getTime():"number"==typeof e?e:Date.now();return(0,P.GP)(new Date(t),"d.M.yyyy")},[m]),g=null!=l?l:U.zh,x=(0,n.useCallback)(function(e){var t,r=ee.findIndex(function(e){return e.id===p});t="right"===e?(r+1)%ee.length:(r-1+ee.length)%ee.length,h(ee[t].id)},[p]),v=(0,C.uh)({onSwipedLeft:function(){return x("right")},onSwipedRight:function(){return x("left")},preventScrollOnSwipe:!0,trackMouse:!0,touchEventOptions:{passive:!1}}),b=(0,L.zh)({from:{opacity:0,transform:"translateX(20px)"},to:{opacity:1,transform:"translateX(0px)"},key:p,config:{tension:280,friction:25}}),j=ee.find(function(e){return e.id===p}),w=null==j?void 0:j.component,N=null==j?void 0:j.displayName,S=(0,n.useMemo)(function(){if(!m||!m.playerDetails)return null;var e={};m.playerDetails.forEach(function(t){t.seat&&t.playerName&&(e[t.seat]=t.playerName)});for(var t=1;t<=4;t++)e[t]||(e[t]="Spieler ".concat(t));return e},[m]);return(0,M.jsxs)("div",{className:"bg-gray-800 text-white shadow-xl rounded-lg overflow-hidden w-full mx-auto my-4",children:[(0,M.jsxs)("div",{className:"p-3 bg-gray-750",children:[(0,M.jsxs)("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[(0,M.jsx)("span",{children:f.length>0?"".concat(f.length," ").concat(1===f.length?"Passe":"Passen"," gespielt"):"Keine Passen gespielt"}),m&&(0,M.jsxs)("span",{children:["Letzte am: ",y]})]}),(0,M.jsx)("div",{className:"mt-1 text-center",children:(0,M.jsxs)("h2",{className:"text-lg font-semibold text-white flex items-center justify-center",children:[(0,M.jsx)(W.A,{size:20,className:"mr-2 text-purple-400"})," Passen\xfcbersicht f\xfcr ",s]})})]}),(0,M.jsxs)("div",{className:"flex justify-between items-center px-2 py-1 bg-gray-750",children:[(0,M.jsx)("button",{onClick:function(){return x("left")},className:"p-1 text-gray-400 hover:text-white transition-colors rounded-md","aria-label":"Vorherige Statistik",disabled:ee.length<=1,children:"<"}),(0,M.jsx)("span",{className:"text-sm font-medium text-gray-300",children:null!=N?N:"Statistik"}),(0,M.jsx)("button",{onClick:function(){return x("right")},className:"p-1 text-gray-400 hover:text-white transition-colors rounded-md","aria-label":"N\xe4chste Statistik",disabled:ee.length<=1,children:">"})]}),(0,M.jsx)("div",J(J({},v),{},{className:"overflow-hidden relative min-h-[200px]",children:w&&j&&f.length>0?(0,M.jsx)(L.CS.div,{style:b,className:"p-3",children:"player_striche_history"===j.id?(0,M.jsx)(z,{playerGames:f,playerUid:i,playerName:s,strokeSettings:g}):"player_passe_details"===j.id&&S?(0,M.jsx)(q,{tournamentGames:f,playerNames:S,playerPhotoUrlMapping:o?Y({},i,o):{},cardStyle:u,focusedPlayerId:i}):(0,M.jsx)("div",{className:"p-3 text-center text-gray-500",children:"Statistik-Modul nicht anwendbar oder Daten fehlen."})}):0===f.length?(0,M.jsx)("div",{className:"p-3 text-center text-gray-500",children:"Dieser Spieler hat noch an keiner Passe teilgenommen."}):(0,M.jsx)("div",{className:"p-3 text-center text-gray-500",children:"Statistik-Modul nicht gefunden oder nicht konfiguriert."})}))]})};var er=r(9712),en=r(4612),ea=r(2269),ei=(0,S.A)("user-check",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);let es=function(e){var t=e.participants,r=e.tournamentAdminId,n=e.onParticipantClick;if(!t||0===t.length)return(0,M.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Keine Teilnehmer f\xfcr dieses Turnier gefunden oder Teilnehmerdaten werden noch geladen."});var a=function(e){n?n(e):console.log("Participant clicked, but no onParticipantClick handler provided. UID:",e.uid)};return(0,M.jsx)("div",{className:"p-0 md:p-4",children:(0,M.jsxs)(en.Zp,{className:"bg-gray-800/70 border-gray-700/50 shadow-lg",children:[(0,M.jsx)(en.aR,{className:"pb-3 pt-4 px-4 md:px-5",children:(0,M.jsxs)(en.ZB,{className:"text-lg text-white",children:["Teilnehmer (",t.length,")"]})}),(0,M.jsx)(en.Wu,{className:"space-y-3 px-2 py-2 md:px-4 md:pb-4 max-h-[400px] overflow-y-auto",children:t.map(function(e){var t,n=e.uid;return(0,M.jsx)("div",{onClick:function(){return a(e)},className:"block rounded-md ".concat(n?"cursor-pointer":"cursor-default"," bg-gray-700/40 hover:bg-gray-700/70 transition-colors duration-150 relative"),children:(0,M.jsxs)("div",{className:"flex items-center justify-between p-2.5",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-3 min-w-0",children:[(0,M.jsx)(ea.eu,{className:"h-10 w-10 mr-3",children:e.photoURL?(0,M.jsx)(s(),{src:e.photoURL,alt:e.displayName||"Teilnehmer",width:40,height:40,className:"rounded-full object-cover"}):(0,M.jsx)(ea.q5,{className:"bg-gray-700 text-gray-300",children:(null==(t=e.displayName)?void 0:t.charAt(0).toUpperCase())||"?"})}),(0,M.jsxs)("div",{className:"min-w-0",children:[(0,M.jsx)("p",{className:"font-medium text-sm text-white truncate",title:e.displayName||"Unbekannter Spieler",children:e.displayName||"Unbekannter Spieler"}),e.uid===r&&(0,M.jsxs)("span",{className:"text-xs text-purple-400 flex items-center",children:[(0,M.jsx)(ei,{className:"w-3 h-3 mr-1"}),"Turnier-Admin"]}),(0,M.jsxs)("span",{className:"text-xs text-gray-400",children:[e.completedPassesCount," ",1===e.completedPassesCount?"Passe":"Passen"," abgeschlossen"]})]})]}),n&&(0,M.jsx)("div",{className:"text-gray-400 group-hover:text-white flex items-center text-xs pr-1"})]})},n||"player-".concat(e.displayName))})})]})})};var eo=r(7212),el=r(3355),ec=r(417),eu=r(6176);function ed(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ep(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ep(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ep(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var eh=function(e){var t=e.trigger,r=e.participants,a=e.currentSelection,i=e.targetSlot,s=e.onSelectParticipant,o=ed((0,n.useState)(!1),2),l=o[0],c=o[1],u=ed((0,n.useState)([]),2),d=(u[0],u[1]);(0,n.useEffect)(function(){r&&d(r)},[r]);var p=function(e){s(i,e),c(!1)},h=Object.values(a).filter(function(e){return!!e}).filter(function(e){return"member"===e.type}).map(function(e){return e.uid}),f=r.filter(function(e){return!h.includes(e.uid||"")});return(0,M.jsxs)(ec.AM,{open:l,onOpenChange:c,children:[(0,M.jsx)(ec.Wv,{asChild:!0,children:t}),(0,M.jsx)(ec.hl,{className:"p-0 w-72",align:"start",children:(0,M.jsx)("div",{className:"max-h-80 overflow-auto",children:(0,M.jsxs)("div",{className:"p-4 space-y-2",children:[(0,M.jsx)("h4",{className:"text-sm font-medium leading-none",children:"Teilnehmer ausw\xe4hlen"}),(0,M.jsxs)("p",{className:"text-sm text-gray-500",children:["W\xe4hle einen Spieler f\xfcr Position ",i,"."]}),0===f.length&&(0,M.jsx)("p",{className:"text-sm text-gray-500",children:"Keine weiteren Teilnehmer verf\xfcgbar."}),(0,M.jsx)("div",{className:"space-y-2 mt-2",children:f.map(function(e){var t;return(0,M.jsxs)("div",{onClick:function(){return p(e)},className:(0,I.cn)("flex items-center px-2 py-2 rounded-md hover:bg-gray-100 cursor-pointer"),children:[(0,M.jsx)(eu.A,{src:e.photoURL||void 0,alt:e.displayName||"",size:"sm",className:"mr-2 flex-shrink-0",fallbackClassName:"bg-gray-600 text-gray-300 text-xs",fallbackText:(null==(t=e.displayName)?void 0:t.substring(0,2).toUpperCase())||"??"}),(0,M.jsx)("div",{className:"flex-grow",children:(0,M.jsx)("p",{className:"text-sm",children:e.displayName||"Unbekannt"})})]},e.uid)})})]})})})]})},ef=r(7078);function em(e){return(em="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ey(){ey=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(t,r,n,i){var s,o,l,c,u=Object.create((r&&r.prototype instanceof y?r:y).prototype);return a(u,"_invoke",{value:(s=t,o=n,l=new O(i||[]),c=p,function(t,r){if(c===h)throw Error("Generator is already running");if(c===f){if("throw"===t)throw r;return{value:e,done:!0}}for(l.method=t,l.arg=r;;){var n=l.delegate;if(n){var a=function t(r,n){var a=n.method,i=r.iterator[a];if(i===e)return n.delegate=null,"throw"===a&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+a+"' method")),m;var s=d(i,r.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var o=s.arg;return o?o.done?(n[r.resultName]=o.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,m)}(n,l);if(a){if(a===m)continue;return a}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if(c===p)throw c=f,l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);c=h;var i=d(s,o,l);if("normal"===i.type){if(c=l.done?f:"suspendedYield",i.arg===m)continue;return{value:i.arg,done:l.done}}"throw"===i.type&&(c=f,l.method="throw",l.arg=i.arg)}})}),u}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="executing",f="completed",m={};function y(){}function g(){}function x(){}var v={};c(v,s,function(){return this});var b=Object.getPrototypeOf,j=b&&b(b(A([])));j&&j!==r&&n.call(j,s)&&(v=j);var w=x.prototype=y.prototype=Object.create(v);function N(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){var r;a(this,"_invoke",{value:function(a,i){function s(){return new t(function(r,s){!function r(a,i,s,o){var l=d(e[a],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==em(u)&&n.call(u,"__await")?t.resolve(u.__await).then(function(e){r("next",e,s,o)},function(e){r("throw",e,s,o)}):t.resolve(u).then(function(e){c.value=e,s(c)},function(e){return r("throw",e,s,o)})}o(l.arg)}(a,i,r,s)})}return r=r?r.then(s,s):s()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw TypeError(em(t)+" is not iterable")}return g.prototype=x,a(w,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:g,configurable:!0}),g.displayName=c(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},N(S.prototype),c(S.prototype,o,function(){return this}),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new S(u(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},N(w),c(w,l,"Generator"),c(w,s,function(){return this}),c(w,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;P(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function eg(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){r(e);return}o.done?t(l):Promise.resolve(l).then(n,a)}function ex(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ev(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ex(Object(r),!0).forEach(function(t){eb(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ex(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function eb(e,t,r){var n;return(n=function(e,t){if("object"!==em(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==em(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"===em(n)?n:String(n))in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ej(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ew(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ew(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ew(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var eN={initial:{opacity:0,scale:.95},visible:{opacity:1,scale:1},exit:{opacity:0,scale:.95}};let eS=function(e){var t,r,a=e.isVisible,i=e.onClose,s=e.tournamentId,l=e.tournamentParticipants,d=e.currentPasseNumber,p=e.onPasseStarted,m=e.members,y=void 0===m?[]:m,g=(0,c.useAuthStore)().user,v=(0,o.yu)(function(e){return e.startNewPasse}),b=(0,u.useUIStore)(function(e){return e.showNotification}),j=ej((0,n.useState)({1:null,2:null,3:null,4:null}),2),w=j[0],N=j[1],S=ej((0,n.useState)(null),2),k=S[0],P=S[1],O=ej((0,n.useState)(!1),2),A=O[0],T=O[1],E=ej((0,n.useState)(!1),2),L=E[0],C=E[1],U=ej((0,n.useState)(null),2),D=U[0],I=U[1],_=ej((0,n.useState)(!1),2),R=_[0],z=_[1];(0,n.useEffect)(function(){a||(N({1:null,2:null,3:null,4:null}),P(null),T(!1),C(!1),I(null),z(!1))},[a]),(0,n.useEffect)(function(){if(null!=g&&g.uid){console.log("[TournamentStartScreen] Pr\xfcfe Teilnahme:",{userUid:g.uid,selectedPlayers:Object.values(w).map(function(e){return(null==e?void 0:e.type)==="member"?{uid:e.uid,name:e.name}:null}).filter(Boolean)});var e=Object.values(w).some(function(e){var t=(null==e?void 0:e.type)==="member"&&e.uid&&e.uid.toString()===g.uid.toString();return t&&console.log("[TournamentStartScreen] Benutzer ".concat(g.uid," nimmt an Passe teil als ").concat(e.name)),t});z(e),console.log("[TournamentStartScreen] isCurrentUserInSelectedPasse gesetzt auf: ".concat(e))}else z(!1),console.log("[TournamentStartScreen] Kein Benutzer angemeldet, isCurrentUserInSelectedPasse = false")},[w,g]);var G=function(e,t){if(!t.uid)return void b({type:"error",message:"Fehler bei der Spielerauswahl: Spieler-ID fehlt."});var r=Number(e),n=Object.values(w).some(function(e){return(null==e?void 0:e.type)==="member"&&e.uid===t.uid}),a=w[r];if(n&&((null==a?void 0:a.type)!=="member"||a.uid!==t.uid))return void b({type:"warning",message:"Dieser Spieler ist bereits einem anderen Slot zugewiesen."});N(function(e){return ev(ev({},e),{},eb({},r,{type:"member",uid:t.uid,name:t.displayName||"Spieler ".concat(r)}))})},F=function(e){var t=Number(e);N(function(e){return ev(ev({},e),{},eb({},t,null))}),k===t&&(P(null),T(!1))},B=function(){return Object.values(w).every(function(e){return null!==e})},K=function(e){B()&&(P(Number(e)),T(!0))},$=function(e){var t=Number(e),r=B(),n=A&&r&&k===t,a=1===t||3===t,i=w[t],s="relative w-full p-3 pl-4 pr-10 outline-none border-l-4 transition-all duration-150 rounded-xl text-white text-left ".concat(a?"bg-gray-500":"bg-gray-700"," ").concat(a?"border-l-yellow-400":"border-l-blue-400");return n?s+=" border-yellow-500 ring-2 ring-yellow-500":s+=" border-gray-600",r?s+=" ".concat(a?"hover:bg-gray-600":"hover:bg-gray-800"," cursor-pointer"):i||(s+=" text-gray-400 italic cursor-pointer"),s},q=(t=ey().mark(function e(){var t,r,n;return ey().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(B()){e.next=1;break}return b({type:"warning",message:"Alle Spielerpositionen m\xfcssen besetzt sein, um das Spiel starten zu k\xf6nnen."}),e.abrupt("return");case 1:if(!(!A||null===k)){e.next=2;break}return b({type:"warning",message:"Bitte w\xe4hle einen Startspieler aus (auf einen Spieler klicken)."}),e.abrupt("return");case 2:if(console.log("[TournamentStartScreen] Start-Check:",{isCurrentUserInSelectedPasse:R,userUid:null==g?void 0:g.uid}),R){e.next=3;break}return b({type:"error",message:"Nur Spieler, die an dieser Passe teilnehmen, d\xfcrfen sie starten.",preventClose:!0,actions:[{label:"Verstanden",onClick:function(){}}]}),e.abrupt("return");case 3:return C(!0),I(null),e.prev=4,t=Object.entries(w).filter(function(e){var t=ej(e,2);return null!==(t[0],t[1])}).map(function(e){var t=ej(e,2),r=t[0],n=t[1];if(!n||"member"!==n.type)throw Error("Ung\xfcltiger Spieler in Slot ".concat(r));var a=l.find(function(e){return e.uid===n.uid});if(!a)throw Error("Teilnehmer mit uid ".concat(n.uid," wurde nicht gefunden"));return{uid:n.uid,name:n.name,playerNumber:Number(r),completedPassesCount:a.completedPassesCount||0,photoURL:a.photoURL}}),e.next=5,v(s,t,k);case 5:r=e.sent,p&&r&&p(r),i(),e.next=7;break;case 6:e.prev=6,console.error("Fehler beim Starten des Spiels:",n=e.catch(4)),I("Fehler beim Starten des Spiels: ".concat(n instanceof Error?n.message:"Unbekannter Fehler"));case 7:return e.prev=7,C(!1),e.finish(7);case 8:case"end":return e.stop()}},e,null,[[4,6,7,8]])}),r=function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function s(e){eg(i,n,a,s,o,"next",e)}function o(e){eg(i,n,a,s,o,"throw",e)}s(void 0)})},function(){return r.apply(this,arguments)});return a?L?(0,M.jsx)(ef.A,{message:"Passe wird gestartet..."}):(0,M.jsx)(eo.N,{children:a&&(0,M.jsx)(el.P.div,{className:"fixed inset-0 flex flex-col items-center justify-center bg-gray-900 bg-opacity-95 z-50 p-4 overflow-y-auto",initial:"initial",animate:"visible",exit:"exit",variants:eN,transition:{duration:.2,ease:"easeInOut"},children:(0,M.jsxs)("div",{className:"relative bg-gray-800 bg-opacity-95 rounded-xl p-6 w-full max-w-xs space-y-6 shadow-lg text-center max-h-[95vh] overflow-y-auto",children:[(0,M.jsx)(h.$,{variant:"ghost",size:"icon",onClick:i,className:"absolute top-3 right-3 text-gray-400 hover:text-white transition-colors z-10","aria-label":"Schliessen",children:(0,M.jsx)(x.A,{size:24})}),(0,M.jsx)("h2",{className:"text-2xl font-bold ".concat(B()?"text-yellow-400":"text-white"," text-center mb-0"),children:B()?"Startspieler w\xe4hlen":"Passe starten"}),(0,M.jsx)("h3",{className:"text-lg font-semibold text-white pt-0",children:"Sitzreihenfolge:"}),(0,M.jsx)("div",{className:"space-y-4",children:Object.keys(w).map(function(e){var t,r=Number(e),n=w[r],a=(t=1===r||3===r?"Team 1":"Team 2","Spieler ".concat(r," (").concat(t,") w\xe4hlen...")),i=(0,M.jsx)("div",{onClick:function(){return K(r)},className:$(r),children:n?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsx)(eu.A,{src:function(){if("member"===n.type){var e=y.find(function(e){return e.displayName===n.name});return null==e?void 0:e.photoURL}}(),alt:n.name,size:"sm",className:"mr-3 flex-shrink-0",fallbackClassName:"bg-gray-600 text-gray-300 text-sm",fallbackText:n.name.charAt(0).toUpperCase()}),(0,M.jsxs)("span",{className:"text-white font-medium",children:[n.name," ",(0,M.jsxs)("span",{className:"text-sm font-bold ".concat(1===r||3===r?"text-yellow-400":"text-blue-400"),children:["(",1===r||3===r?"Team 1":"Team 2",")"]})]})]}),(0,M.jsx)(h.$,{variant:"ghost",size:"icon",onClick:function(e){e.stopPropagation(),F(r)},className:"absolute top-1/2 right-2 transform -translate-y-1/2 text-gray-400 hover:text-white flex-shrink-0 p-1 h-8 w-8","aria-label":"Spieler entfernen",children:(0,M.jsx)(x.A,{size:18})})]}):(0,M.jsx)("span",{className:"text-gray-400 italic",children:a})},"slotdisplay-".concat(r));return(0,M.jsx)("div",{children:n?i:(0,M.jsx)(eh,{trigger:i,participants:l,currentSelection:w,targetSlot:r,onSelectParticipant:G})},r)})}),D&&(0,M.jsx)("p",{className:"text-red-400 text-sm text-center mb-4",children:D}),(0,M.jsxs)(el.P.button,{initial:{scale:.9},animate:{scale:1},whileTap:{scale:.95},onClick:q,className:"w-full text-white text-lg font-bold py-3 px-8 rounded-xl shadow-lg transition-colors border-b-4 min-h-[56px] flex items-center justify-center ".concat(B()&&!L&&A&&R?"bg-green-600 hover:bg-green-700 border-green-900 cursor-pointer":"bg-gray-500 border-gray-700 cursor-not-allowed opacity-70"),disabled:!B()||L||!A||!R,title:B()?A?R?L?"Passe wird gestartet...":"Passe starten":"Nur Spieler, die an dieser Passe teilnehmen, d\xfcrfen sie starten":"Bitte w\xe4hle einen Startspieler (auf einen Spieler klicken)":"Bitte w\xe4hle alle vier Spieler aus",children:[L?(0,M.jsx)(f.A,{className:"animate-spin mr-2"}):null,d,". Passe starten"]}),!R&&B()&&A&&(0,M.jsx)("p",{className:"text-amber-400 text-sm mt-2 text-center",children:"Hinweis: Nur teilnehmende Spieler k\xf6nnen die Passe starten."})]})})}):null};function ek(e){return(ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eP(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!==ek(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ek(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ek(t)?t:String(t)}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eP(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let eA=function(e){e.instanceId;var t=e.settings,r=e.participants,a=e.games,i=e.onParticipantClick,s=(0,n.useMemo)(function(){var e={};return r.forEach(function(t){null!=t&&t.uid&&(e[t.uid]={score:0,striche:0,weis:0})}),Array.isArray(a)&&a.forEach(function(t){Array.isArray(t.playerDetails)&&t.playerDetails.forEach(function(r){var n=r.playerId;if(n&&e[n]&&r){e[n].score+=r.scoreInPasse||0,e[n].weis+=r.weisInPasse||0;var a=0;r.team&&t.teamStrichePasse&&t.teamStrichePasse[r.team]&&(a=Object.values(t.teamStrichePasse[r.team]).reduce(function(e,t){return e+(t||0)},0)),e[n].striche+=a}})}),e},[r,a]),o=(0,n.useMemo)(function(){console.log("[TournamentRankingList] Ranking Mode from settings:",null==t?void 0:t.rankingMode);var e=r.map(function(e){return eO(eO({},e),{},{totals:null!=e&&e.uid?s[e.uid]:{score:0,striche:0,weis:0}})}).filter(function(e){return e.uid});e.sort(function(e,r){var n=(null==t?void 0:t.rankingMode)||"total_points";return"total_points"===n?r.totals.score!==e.totals.score?r.totals.score-e.totals.score:r.totals.striche-e.totals.striche:r.totals.striche!==e.totals.striche?r.totals.striche-e.totals.striche:r.totals.score-e.totals.score});var n=1;return e.map(function(e,r,a){if(r>0){var i=a[r-1],s=(null==t?void 0:t.rankingMode)||"total_points",o=!1;(o="total_points"===s?e.totals.score===i.totals.score&&e.totals.striche===i.totals.striche:e.totals.striche===i.totals.striche&&e.totals.score===i.totals.score)||(n=r+1)}return eO(eO({},e),{},{rank:n})})},[r,s,t]),l=(0,n.useMemo)(function(){return null==t||!t.strokeSettings||Object.values(t.strokeSettings).some(function(e){return e>0})},[null==t?void 0:t.strokeSettings]),c=function(e){i&&i(e)};return(0,M.jsxs)("div",{className:"bg-gray-800/50 p-4 rounded-lg shadow-inner border border-gray-700/50",children:[(0,M.jsx)("h3",{className:"text-lg font-semibold text-center mb-4 text-purple-300",children:"Rangliste"}),0===o.length?(0,M.jsx)("p",{className:"text-center text-gray-400",children:"Noch keine Teilnehmerdaten oder Ergebnisse vorhanden."}):(0,M.jsxs)("table",{className:"w-full text-sm text-left table-fixed",children:[(0,M.jsx)("thead",{className:"border-b border-gray-600",children:(0,M.jsxs)("tr",{children:[(0,M.jsx)("th",{className:"w-8 py-2 px-1 text-center font-medium text-gray-400",children:"#"}),(0,M.jsx)("th",{className:"py-2 px-2 font-medium text-gray-400",children:"Spieler"}),l&&(0,M.jsx)("th",{className:"w-16 py-2 px-1 text-center font-medium text-gray-400",children:"Striche"}),(0,M.jsx)("th",{className:"w-16 py-2 px-1 text-center font-medium text-gray-400",children:"Punkte"})]})}),(0,M.jsx)("tbody",{children:o.map(function(e){var r;return(0,M.jsxs)("tr",{onClick:function(){return c(e)},className:(0,I.cn)("border-b border-gray-700/50 hover:bg-gray-700/60 transition-colors",i?"cursor-pointer":""),children:[(0,M.jsx)("td",{className:"py-2 px-1 text-center font-medium text-gray-300",children:e.rank}),(0,M.jsxs)("td",{className:"py-2 px-2 flex items-center space-x-2 truncate",children:[(0,M.jsx)(eu.A,{src:e.photoURL,alt:e.displayName||"Spieler",size:"sm",className:"mr-2",fallbackClassName:"bg-gray-700 text-gray-300 text-xs",fallbackText:(null==(r=e.displayName)?void 0:r.charAt(0).toUpperCase())||"?"}),(0,M.jsx)("span",{className:"text-white truncate flex-grow min-w-0",title:e.displayName,children:e.displayName||"Unbekannt"})]}),l&&(0,M.jsx)("td",{className:"py-2 px-1 text-center font-semibold ".concat((null==t?void 0:t.rankingMode)==="striche"?"text-xl text-purple-300":"text-white"),children:e.totals.striche}),(0,M.jsx)("td",{className:"py-2 px-1 text-center ".concat((null==t?void 0:t.rankingMode)==="total_points"?"text-xl font-semibold text-purple-300":"text-xs text-gray-400"),children:e.totals.score})]},e.uid)})})]})]})};function eT(e,t){if(e){if("string"==typeof e)return eE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eE(e,t)}}function eE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}let eL=function(e){var t=e.instanceId,r=e.games,i=e.playerPhotoUrlMapping,o=e.playerNamesMapping,l=(0,a.useRouter)(),c=(0,n.useMemo)(function(){return Array.isArray(r)?((function(e){if(Array.isArray(e))return eE(e)})(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||eT(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,t){return(e.passeNumber||0)-(t.passeNumber||0)}):[]},[r]),u=function(e){t&&e&&l.push("/tournaments/".concat(t,"/passe/").concat(e))};return(0,M.jsx)("div",{className:"space-y-2",children:0===c.length?(0,M.jsx)("p",{className:"text-center text-gray-500 py-6",children:"Noch keine Passen gespielt."}):c.map(function(e){var t,r,n,a,l,c=(null==(r=e.playerDetails)?void 0:r.filter(function(e){return"top"===e.team}).map(function(e){return e.playerName}).join(" & "))||"Team Oben",d=(null==(n=e.playerDetails)?void 0:n.filter(function(e){return"bottom"===e.team}).map(function(e){return e.playerName}).join(" & "))||"Team Unten",p=null==(a=e.teamStrichePasse)?void 0:a.top,h=null==(l=e.teamStrichePasse)?void 0:l.bottom,f=p?(p.sieg||0)+(p.berg||0)+(p.matsch||0)+(p.schneider||0)+(p.kontermatsch||0):0,m=h?(h.sieg||0)+(h.berg||0)+(h.matsch||0)+(h.schneider||0)+(h.kontermatsch||0):0,y=(t=e.completedAt)instanceof O.Timestamp?(0,P.GP)(t.toDate(),"dd.MM.yy, HH:mm"):"-";return(0,M.jsxs)("button",{onClick:function(){return u(e.passeId)},className:"block w-full text-left p-3 bg-gray-800/50 rounded-lg hover:bg-gray-700/50 transition-colors duration-150 cursor-pointer border border-gray-700/50",children:[(0,M.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,M.jsxs)("span",{className:"text-sm font-semibold text-purple-300",children:["Passe ",e.passeNumber]}),(0,M.jsx)("span",{className:"text-xs text-gray-400",children:y})]}),(0,M.jsxs)("div",{className:"text-xs space-y-1",children:[(0,M.jsxs)("div",{className:"flex justify-between",children:[(0,M.jsx)("span",{className:"text-gray-300 truncate pr-2",title:d,children:d}),(0,M.jsx)("span",{className:"font-medium text-white",children:m})]}),(0,M.jsxs)("div",{className:"flex justify-between",children:[(0,M.jsx)("span",{className:"text-gray-300 truncate pr-2",title:c,children:c}),(0,M.jsx)("span",{className:"font-medium text-white",children:f})]})]}),e.playerDetails&&e.playerDetails.length>0&&(0,M.jsx)("div",{className:"mt-2 flex -space-x-1.5 overflow-hidden",children:e.playerDetails.map(function(e,t){var r=void 0,n=e.playerName||"Spieler";if(e.playerId&&i&&i[e.playerId])r=i[e.playerId];else if(n&&o&&i){for(var a=void 0,l=0,c=Object.entries(o);l<c.length;l++){var u,d=(u=c[l],function(e){if(Array.isArray(e))return e}(u)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{i=(r=r.call(e)).next,!1;for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(u,2)||eT(u,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=d[0];if(d[1]===n){a=p;break}}a&&i[a]&&(r=i[a])}return(0,M.jsx)(ea.eu,{className:"h-6 w-6 border-2 border-gray-800 bg-gray-700",children:r?(0,M.jsx)(s(),{src:r,alt:n,width:20,height:20,className:"rounded-full object-cover"}):(0,M.jsx)(ea.q5,{className:"bg-gray-600 text-gray-300 text-xs",children:(null==n?void 0:n.charAt(0).toUpperCase())||"?"})},t)})})]},e.passeId)})})};var eC=r(3587),eU=r(8838),eD=r(7133),eI=r(1411),eM=r(8310);function e_(){e_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(t,r,n,i){var s,o,l,c,u=Object.create((r&&r.prototype instanceof y?r:y).prototype);return a(u,"_invoke",{value:(s=t,o=n,l=new O(i||[]),c=p,function(t,r){if(c===h)throw Error("Generator is already running");if(c===f){if("throw"===t)throw r;return{value:e,done:!0}}for(l.method=t,l.arg=r;;){var n=l.delegate;if(n){var a=function t(r,n){var a=n.method,i=r.iterator[a];if(i===e)return n.delegate=null,"throw"===a&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+a+"' method")),m;var s=d(i,r.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var o=s.arg;return o?o.done?(n[r.resultName]=o.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,m)}(n,l);if(a){if(a===m)continue;return a}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if(c===p)throw c=f,l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);c=h;var i=d(s,o,l);if("normal"===i.type){if(c=l.done?f:"suspendedYield",i.arg===m)continue;return{value:i.arg,done:l.done}}"throw"===i.type&&(c=f,l.method="throw",l.arg=i.arg)}})}),u}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="executing",f="completed",m={};function y(){}function g(){}function x(){}var v={};c(v,s,function(){return this});var b=Object.getPrototypeOf,j=b&&b(b(A([])));j&&j!==r&&n.call(j,s)&&(v=j);var w=x.prototype=y.prototype=Object.create(v);function N(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){var r;a(this,"_invoke",{value:function(a,i){function s(){return new t(function(r,s){!function r(a,i,s,o){var l=d(e[a],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==eB(u)&&n.call(u,"__await")?t.resolve(u.__await).then(function(e){r("next",e,s,o)},function(e){r("throw",e,s,o)}):t.resolve(u).then(function(e){c.value=e,s(c)},function(e){return r("throw",e,s,o)})}o(l.arg)}(a,i,r,s)})}return r=r?r.then(s,s):s()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw TypeError(eB(t)+" is not iterable")}return g.prototype=x,a(w,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:g,configurable:!0}),g.displayName=c(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},N(S.prototype),c(S.prototype,o,function(){return this}),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new S(u(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},N(w),c(w,l,"Generator"),c(w,s,function(){return this}),c(w,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;P(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function eR(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){r(e);return}o.done?t(l):Promise.resolve(l).then(n,a)}function ez(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function s(e){eR(i,n,a,s,o,"next",e)}function o(e){eR(i,n,a,s,o,"throw",e)}s(void 0)})}}function eG(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eF(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eF(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function eB(e){return(eB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eK(e){return e&&"object"===eB(e)&&"toDate"in e&&"function"==typeof e.toDate}var e$=function(e){switch(e.toLowerCase()){case"active":return"Aktiv";case"completed":return"Abgeschlossen";case"upcoming":return"Anstehend";case"archived":return"Archiviert";default:return e.charAt(0).toUpperCase()+e.slice(1)}};let eq=function(){var e,t,r,i,S,L,C,_,R,z,G,F,B,K,$,q,H,V,W=(0,a.useRouter)(),Z=W.query.instanceId,X=(0,c.useAuthStore)(),J=X.user;X.status;var Y=(0,l.Q5)().currentGroup,Q=(0,o.yu)(function(e){return e.fetchTournamentInstanceDetails}),ee=(0,o.yu)(function(e){return e.currentTournamentInstance}),en=(0,o.yu)(function(e){return e.error}),ea=(0,o.yu)(o.FH),ei=(0,o.yu)(o.nX),eo=(0,u.useUIStore)(function(e){return e.showNotification}),el=eG((0,n.useState)(!1),2),ec=el[0],eu=el[1],ed=eG((0,n.useState)("ranking"),2),ep=ed[0],eh=ed[1],em=eG((0,n.useState)(!1),2),ey=em[0],eg=em[1],ex=eG((0,n.useState)(!1),2),ev=ex[0],eb=ex[1],ej=eG((0,n.useState)(null),2),ew=ej[0],eN=ej[1],ek=(0,o.yu)(function(e){return e.currentTournamentGames}),eP=(0,o.yu)(function(e){return e.loadTournamentGames}),eO=(0,o.yu)(o.cK),eT=(0,o.yu)(function(e){return e.loadTournamentParticipants}),eE=(0,o.yu)(o.At),eR=(0,o.yu)(o.jl),eF=eG((0,n.useState)(null),2),eB=eF[0],eq=eF[1],eH=eG((0,n.useState)(!0),2),eV=eH[0],eW=eH[1],eZ=(0,n.useRef)(null),eX=(0,n.useRef)(null),eJ=eG((0,n.useState)(null),2),eY=eJ[0],eQ=eJ[1],e0=eG((0,n.useState)(null),2),e1=e0[0],e2=e0[1],e4=eG((0,n.useState)(!1),2),e3=e4[0],e5=e4[1],e8=eG((0,n.useState)(!1),2),e7=e8[0],e6=e8[1],e9=eG((0,n.useState)(null),2),te=e9[0],tt=e9[1],tr=(0,n.useMemo)(function(){return Z},[Z]),tn=eG((0,n.useState)(!1),2),ta=tn[0],ti=tn[1],ts=eG((0,n.useState)([]),2),to=ts[0],tl=ts[1];(0,n.useEffect)(function(){if(tr&&"string"==typeof tr){var e="success"===ea&&(null==ee?void 0:ee.id)===tr,t="loading"===ea&&ei===tr;e||t||Q(tr)}},[tr,Q,ea,null==ee?void 0:ee.id,ei,!1]),(0,n.useEffect)(function(){return function(){o.yu.getState().clearCurrentTournamentInstance()}},[]),(0,n.useEffect)(function(){tr&&"string"==typeof tr&&(null==ee?void 0:ee.id)===tr&&"success"===ea&&"loading"!==eO&&"success"!==eO&&eP(tr)},[tr,null==ee?void 0:ee.id,ea,eO,eP,!1]),(0,n.useEffect)(function(){if(tr&&"string"==typeof tr)((null==ee?void 0:ee.id)!==tr||"success"!==eR&&"loading"!==eR)&&(null==ee?void 0:ee.id)===tr&&"success"===ea&&eT(tr)},[tr,null==ee?void 0:ee.id,ea,eR,eT,!1,null==ee?void 0:ee.status]),(0,n.useEffect)(function(){var e,t=(0,O.getFirestore)(A.xv),r=function(){},n=(e=ez(e_().mark(function e(){var r,n,a,i,s,o,l,c,u;return e_().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!tr||!J||!J.uid||"success"!==ea||(null==ee?void 0:ee.status)!=="active")){e.next=1;break}return eB&&eq(null),eW(!1),e.abrupt("return");case 1:if(eW(!0),r=d.useJassStore.getState().activeGameId,e.prev=2,!r){e.next=4;break}return n=(0,O.doc)(t,"activeGames",r),e.next=3,(0,O.getDoc)(n);case 3:(a=e.sent).exists()&&(o=a.data()).tournamentInstanceId===tr&&"live"===o.status&&null!=(i=o.participantUids)&&null!=(s=i.includes)&&s.call(i,J.uid)&&eq(r);case 4:e.next=6;break;case 5:e.prev=5,u=e.catch(2),console.error("Error fetching game ".concat(r," from jassStore:"),u);case 6:try{l=(0,O.collection)(t,"activeGames"),c=(0,O.query)(l,(0,O.where)("tournamentInstanceId","==",tr),(0,O.where)("participantUids","array-contains",J.uid),(0,O.where)("status","==","live")),eZ.current=(0,O.onSnapshot)(c,function(e){try{if(e.empty)eB&&eq(null);else{var t=e.docs[0].id;eB!==t&&eq(t)}eW(!1)}catch(e){console.error("Error in active passe listener processing:",e),eB&&eq(null),eW(!1)}},function(e){console.error("Error in active passe listener:",e),eW(!1),eq(null)})}catch(e){console.error("Error setting up active passe listener:",e),eW(!1)}case 7:case"end":return e.stop()}},e,null,[[2,5]])})),function(){return e.apply(this,arguments)}),a=setTimeout(function(){n()},100);return function(){clearTimeout(a),r(),eZ.current&&(eZ.current(),eZ.current=null)}},[tr,null==J?void 0:J.uid,ea,null==ee?void 0:ee.status,eB,!1]),(0,n.useEffect)(function(){return function(){e1&&URL.revokeObjectURL(e1),te&&URL.revokeObjectURL(te)}},[]);var tc=(0,n.useMemo)(function(){return eE&&0!==eE.length?eE.reduce(function(e,t){return t&&t.uid&&t.displayName&&(e[t.uid]=t.displayName),e},{}):{}},[eE]),tu=(0,n.useMemo)(function(){return eE&&0!==eE.length?eE.reduce(function(e,t){return t&&t.uid&&t.photoURL&&(e[t.uid]=t.photoURL),e},{}):{}},[eE]),td=function(){Y?W.push("/start"):W.push("/tournaments")},tp=(e=ez(e_().mark(function e(){var t;return e_().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=ee&&ee.groupId){e.next=1;break}return eo({type:"error",message:"Turnier-Gruppe nicht gefunden. Passe kann nicht gestartet werden."}),e.abrupt("return");case 1:return ti(!0),e.prev=2,e.next=3,(0,eI.getGroupMembersSortedByGames)(ee.groupId);case 3:tl(e.sent),eu(!0),e.next=5;break;case 4:e.prev=4,console.error("Fehler beim Laden der Gruppenmitglieder f\xfcr Passe:",t=e.catch(2)),eo({message:t instanceof Error?t.message:"Gruppenmitglieder konnten nicht geladen werden.",type:"error"});case 5:return e.prev=5,ti(!1),e.finish(5);case 6:case"end":return e.stop()}},e,null,[[2,4,5,6]])})),function(){return e.apply(this,arguments)}),th="loading"===ea,tf="loading"===eO,tm="loading"===eR,ty=th||tm,tg=!!ee&&!!J&&(null==(S=ee.adminIds)?void 0:S.includes(J.uid)),tx=((null==ek?void 0:ek.length)||0)+1;(null==ee||null==(L=ee.settings)?void 0:L.strokeSettings)||U.zh,(null==ee||null==(C=ee.settings)?void 0:C.scoreSettings)||eM.$d;var tv=(t=ez(e_().mark(function e(t){var r,n;return e_().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=t.target.files)&&r.length>0)){e.next=3;break}if((n=r[0]).type.startsWith("image/")){e.next=1;break}return eo({message:"Bitte w\xe4hlen Sie eine Bilddatei (JPEG oder PNG).",type:"error"}),e.abrupt("return");case 1:if(!(n.size>5242880)){e.next=2;break}return eo({message:"Die Datei ist zu gro\xdf (max. 5 MB).",type:"error"}),e.abrupt("return");case 2:e1&&URL.revokeObjectURL(e1),e2(null),eQ(null),tt(URL.createObjectURL(n)),e6(!0);case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),tb=(r=ez(e_().mark(function e(t){var r,n;return e_().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e6(!1),te&&(URL.revokeObjectURL(te),tt(null)),t){e.next=1;break}return console.log("Cropping abgebrochen oder fehlgeschlagen."),eX.current&&(eX.current.value=""),e5(!1),e.abrupt("return");case 1:return e5(!0),console.log("[TournamentView] Zugeschnittenes Bild erhalten, Gr\xf6\xdfe: ".concat((t.size/1024).toFixed(2)," KB")),r={maxSizeMB:.2,maxWidthOrHeight:500,useWebWorker:!0,fileType:"image/jpeg",initialQuality:.8},e.prev=2,console.log("[TournamentView] Komprimiere zugeschnittenes Bild..."),e.next=3,(0,eC.A)(new File([t],"tournament_logo.jpg",{type:"image/jpeg"}),r);case 3:n=e.sent,console.log("[TournamentView] Komprimiertes Bild, Gr\xf6\xdfe: ".concat((n.size/1024).toFixed(2)," KB")),e2(URL.createObjectURL(n)),eQ(new File([n],"tournament_logo_final.jpg",{type:"image/jpeg"})),e5(!1),e.next=5;break;case 4:e.prev=4,console.error("Fehler bei der Komprimierung:",e.catch(2)),eo({message:"Fehler bei der Bildkomprimierung.",type:"error"}),eQ(null),e2(null),eX.current&&(eX.current.value=""),e5(!1);case 5:case"end":return e.stop()}},e,null,[[2,4]])})),function(e){return r.apply(this,arguments)}),tj=(i=ez(e_().mark(function e(){var t,r;return e_().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!eY||!ee)){e.next=1;break}return e.abrupt("return");case 1:return e5(!0),e.prev=2,e.next=3,(0,eD.uploadTournamentLogoFirebase)(ee.id,eY);case 3:return console.log("[TournamentViewPage DEBUG] Erhaltene Download-URL direkt nach Upload:",t=e.sent),e.next=4,(0,eD.updateTournamentSettings)(ee.id,{logoUrl:t});case 4:eo({message:"Turnierbild erfolgreich aktualisiert.",type:"success"}),e1&&URL.revokeObjectURL(e1),eQ(null),e2(null),eX.current&&(eX.current.value=""),e5(!1),tr&&Q(tr),e.next=6;break;case 5:e.prev=5,console.error("Fehler beim Hochladen des Turnierbildes:",r=e.catch(2)),eo({message:r instanceof Error?r.message:"Hochladen fehlgeschlagen.",type:"error"}),e5(!1);case 6:case"end":return e.stop()}},e,null,[[2,5]])})),function(){return i.apply(this,arguments)});(0,n.useMemo)(function(){var e;return!!J&&!!ee&&((null==(e=ee.adminIds)?void 0:e.includes(J.uid))||!1)},[J,ee]);var tw=(0,n.useCallback)(function(e){eN(e),eb(!0)},[]);return th?(0,M.jsx)(p.A,{children:(0,M.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:[(0,M.jsx)(f.A,{className:"h-12 w-12 animate-spin text-purple-400"}),(0,M.jsx)("p",{className:"mt-4 text-lg",children:"Turnierdaten werden geladen..."}),ty&&(0,M.jsx)("p",{className:"text-sm text-gray-400",children:"Lade Details..."}),tf&&(0,M.jsx)("p",{className:"text-sm text-gray-400",children:"Lade Passen..."}),tm&&(0,M.jsx)("p",{className:"text-sm text-gray-400",children:"Lade Teilnehmer..."})]})}):en&&!ty?(0,M.jsx)(p.A,{children:(0,M.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:(0,M.jsxs)("div",{className:"bg-red-900/50 border border-red-700 text-red-300 px-6 py-4 rounded-lg shadow-lg text-center",children:[(0,M.jsx)(m.A,{className:"h-10 w-10 mx-auto mb-3 text-red-400"}),(0,M.jsx)("p",{className:"font-bold text-xl mb-2",children:"Fehler beim Laden des Turniers"}),(0,M.jsx)("p",{className:"text-sm",children:en}),(0,M.jsx)(h.$,{onClick:td,variant:"outline",className:"mt-6 text-white border-white/50 hover:bg-white/10",children:"Zur\xfcck"})]})})}):ee||ty||!tr?ee?ta?(0,M.jsx)(p.A,{children:(0,M.jsx)(ef.A,{message:"Lade Spieler f\xfcr neue Passe..."})}):(0,M.jsx)(p.A,{children:(0,M.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-900 text-white pt-6 pb-20",children:[ee&&(0,M.jsxs)("div",{className:"flex flex-col items-center mb-4",children:[(0,M.jsxs)("div",{className:"relative w-32 h-32 rounded-full overflow-hidden border-2 ".concat(eY&&e1?"border-purple-500":"border-gray-700"," flex items-center justify-center bg-gray-800"),children:[e1?(0,M.jsx)(s(),{src:e1,alt:"Vorschau Turnierbild",fill:!0,style:{objectFit:"cover"}}):null!=ee&&ee.logoUrl||null!=ee&&null!=(_=ee.settings)&&_.logoUrl?(0,M.jsx)(s(),{src:ee.logoUrl||(null==(R=ee.settings)?void 0:R.logoUrl)||"",alt:"Logo ".concat(ee.name),fill:!0,style:{objectFit:"cover"},priority:!0,sizes:"(max-width: 768px) 128px, 128px",onError:function(e){e.target.src="/placeholder-logo.png"}}):(0,M.jsx)("span",{className:"text-4xl font-bold text-gray-500",children:(null!=(z=ee.name)?z:"?").charAt(0).toUpperCase()}),tg&&(0,M.jsx)("button",{onClick:function(){tg&&eX.current&&eX.current.click()},className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 hover:bg-opacity-60 transition-all duration-200",disabled:e3,"aria-label":"Turnierbild \xe4ndern",children:(0,M.jsx)(y.A,{className:"text-white ".concat(e3?"opacity-50":"opacity-0"," group-hover:opacity-100 transition-opacity duration-200"),size:32})})]}),eY&&e1&&(0,M.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,M.jsxs)(h.$,{onClick:tj,className:"bg-green-600 hover:bg-green-700 text-xs px-3 py-1.5 h-auto flex items-center gap-1",disabled:!eY||e3,children:[e3?(0,M.jsx)(f.A,{className:"h-4 w-4 animate-spin mr-1"}):(0,M.jsx)(g.A,{size:14}),"Hochladen"]}),(0,M.jsxs)(h.$,{onClick:function(){e1&&URL.revokeObjectURL(e1),eQ(null),e2(null),eX.current&&(eX.current.value=""),e5(!1)},variant:"secondary",className:"text-xs px-3 py-1.5 h-auto flex items-center gap-1 bg-gray-600 hover:bg-gray-500 text-gray-100 border-gray-700",disabled:e3,children:[(0,M.jsx)(x.A,{size:14})," Abbrechen"]})]})]}),(0,M.jsxs)("div",{className:"w-full text-center mb-6 px-4",children:[(0,M.jsx)("h1",{className:"text-3xl font-bold mb-1 text-white break-words",children:null!=(G=null==ee?void 0:ee.name)?G:"Turnier laden..."}),(0,M.jsx)("p",{className:"text-sm text-gray-400 mx-auto max-w-xl break-words",children:null!=(F=null==ee?void 0:ee.description)?F:th?"":"Keine Beschreibung vorhanden."})]}),(0,M.jsxs)("div",{className:"flex justify-center items-center gap-3 mb-6 px-4",children:[tg&&(0,M.jsxs)(h.$,{variant:"ghost",size:"sm",onClick:function(){tg&&eg(!0)},className:"hover:bg-gray-700/30 text-gray-300 hover:text-white",title:"Teilnehmer einladen",children:[(0,M.jsx)(v.A,{className:"h-4 w-4 mr-1.5"})," Einladen"]}),tg&&(0,M.jsxs)(h.$,{variant:"ghost",size:"sm",onClick:function(){return W.push("/tournaments/".concat(tr,"/settings"))},className:"hover:bg-gray-700/30 text-gray-300 hover:text-white",title:"Einstellungen",children:[(0,M.jsx)(b.A,{className:"h-4 w-4 mr-1.5"})," Einstellungen"]})]}),ee&&(0,M.jsxs)("div",{className:"text-xs text-gray-500 text-center mb-6",children:[(0,M.jsxs)("span",{children:["Status:",(0,M.jsx)("span",{className:(0,I.cn)("font-medium","upcoming"===ee.status&&"text-yellow-400","active"===ee.status&&"text-green-400","completed"===ee.status&&"text-blue-400","archived"===ee.status&&"text-gray-500"),children:e$(ee.status)})]}),ee.instanceDate&&eK(ee.instanceDate)&&(0,M.jsx)("span",{className:"ml-3",children:(0,P.GP)(ee.instanceDate.toDate(),"dd.MM.yyyy")}),"completed"===ee.status&&ee.completedAt&&eK(ee.completedAt)&&(0,M.jsx)("span",{className:"ml-1",children:"(Abgeschlossen am ".concat((0,P.GP)(ee.completedAt.toDate(),"dd.MM.yyyy"),")")})]}),(0,M.jsxs)(T.tU,{value:ep,onValueChange:eh,className:"flex-grow flex flex-col w-full max-w-2xl mx-auto",children:[(0,M.jsxs)(T.j7,{className:"grid w-full grid-cols-3 bg-gray-800 sticky top-0 z-10 rounded-md mb-4",children:[(0,M.jsxs)(T.Xi,{value:"ranking",className:"py-2.5 data-[state=active]:bg-purple-600 data-[state=active]:text-white data-[state=active]:shadow-md text-gray-400 hover:text-white rounded-l-md",children:[(0,M.jsx)(j.A,{className:"w-4 h-4 mr-1.5"})," Rangliste"]}),(0,M.jsxs)(T.Xi,{value:"archive",className:"py-2.5 data-[state=active]:bg-purple-600 data-[state=active]:text-white data-[state=active]:shadow-md text-gray-400 hover:text-white",children:[(0,M.jsx)(w.A,{className:"w-4 h-4 mr-1.5"})," Passen"]}),(0,M.jsxs)(T.Xi,{value:"participants",className:"py-2.5 data-[state=active]:bg-purple-600 data-[state=active]:text-white data-[state=active]:shadow-md text-gray-400 hover:text-white rounded-r-md",children:[(0,M.jsx)(N.A,{className:"w-4 h-4 mr-1.5"})," Teilnehmer"]})]}),(0,M.jsxs)("div",{className:"flex-grow p-0 md:p-4 overflow-y-auto",children:[(0,M.jsx)(T.av,{value:"ranking",children:ty||tf?(0,M.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,M.jsx)(f.A,{className:"h-8 w-8 animate-spin text-purple-400"}),(0,M.jsx)("span",{className:"ml-3 text-gray-400",children:"Lade Rangliste..."})]}):"error"===ea||"error"===eO||"error"===eR?(0,M.jsxs)("div",{className:"bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-md flex items-center",children:[(0,M.jsx)(m.A,{className:"h-5 w-5 mr-3"}),(0,M.jsx)("span",{children:"Fehler beim Laden der Ranglistendaten."})]}):ee&&ee.settings&&Array.isArray(eE)&&Array.isArray(ek)?(0,M.jsx)(eA,{instanceId:tr,settings:ee.settings,participants:eE,games:ek,onParticipantClick:tw}):(0,M.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Rangliste konnte nicht geladen werden (fehlende Daten oder Einstellungen)."})}),(0,M.jsx)(T.av,{value:"archive",children:tf?(0,M.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,M.jsx)(f.A,{className:"h-8 w-8 animate-spin text-purple-400"}),(0,M.jsx)("span",{className:"ml-3 text-gray-400",children:"Lade Passen..."})]}):"error"===eO?(0,M.jsxs)("div",{className:"bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-md flex items-center",children:[(0,M.jsx)(m.A,{className:"h-5 w-5 mr-3"}),(0,M.jsx)("span",{children:"Fehler beim Laden der Passen."})]}):Array.isArray(ek)?(0,M.jsx)(eL,{instanceId:tr,games:ek,playerPhotoUrlMapping:tu,playerNamesMapping:tc}):(0,M.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Passen konnten nicht geladen werden."})}),(0,M.jsx)(T.av,{value:"participants",children:"success"===ea&&ee&&("success"===eR||"loading"!==eR&&(null==eE?void 0:eE.length)>0)?(0,M.jsx)(es,{participants:eE,tournamentAdminId:null==(B=ee.adminIds)?void 0:B[0],onParticipantClick:tw}):tm?(0,M.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,M.jsx)(f.A,{className:"h-8 w-8 animate-spin text-purple-400"}),(0,M.jsx)("span",{className:"ml-3 text-gray-400",children:"Lade Teilnehmer..."})]}):(0,M.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Teilnehmerliste ist noch nicht verf\xfcgbar oder es gibt keine Teilnehmer."})})]})]}),"active"===ee.status&&(0,M.jsx)("div",{className:"sticky bottom-0 left-0 right-0 p-3 bg-gray-900/90 backdrop-blur-sm border-t border-gray-700/60",children:eV?(0,M.jsxs)(h.$,{className:"w-full bg-gray-600 hover:bg-gray-500 text-white py-3 px-6 rounded-lg shadow-lg text-base font-semibold flex items-center justify-center transition-colors duration-150 ease-in-out",disabled:!0,children:[(0,M.jsx)(f.A,{className:"animate-spin h-5 w-5 mr-2"}),"Suche laufende Passe..."]}):eB?(0,M.jsxs)(h.$,{onClick:function(){return W.push("/game/".concat(eB))},className:"w-full h-14 text-lg font-bold rounded-xl shadow-lg bg-blue-600 hover:bg-blue-700 border-b-4 border-blue-900 text-white active:scale-95 transition duration-100 ease-in-out",children:[(0,M.jsx)(k,{className:"h-5 w-5 mr-2"}),"Aktive Passe fortsetzen"]}):(0,M.jsxs)(h.$,{onClick:tp,className:"w-full h-14 text-lg font-bold rounded-xl shadow-lg bg-green-600 hover:bg-green-700 border-b-4 border-green-900 text-white active:scale-95 transition duration-100 ease-in-out",disabled:"loading"===eR||eE.length<1||ty,children:[("loading"===eR||ty)&&(0,M.jsx)(f.A,{className:"animate-spin h-5 w-5 mr-2"}),tx,". Passe starten","loading"!==eR&&!ty&&eE.length<1&&" (Ben\xf6tigt Teilnehmer)"]})}),"upcoming"===ee.status&&(0,M.jsxs)("div",{className:"sticky bottom-0 left-0 right-0 p-4 bg-gray-800 border-t border-gray-700 text-center",children:[(0,M.jsx)("p",{className:"text-lg font-semibold text-yellow-400 mb-2",children:null!=(K=ee.settings)&&K.scheduledStartTime?function(e){if(!e||"function"!=typeof e.toDate)return"";try{var t=e.toDate();return"Beginnt am ".concat(t.toLocaleDateString("de-CH",{day:"2-digit",month:"2-digit",year:"numeric"})," um ").concat(t.toLocaleTimeString("de-CH",{hour:"2-digit",minute:"2-digit"})," Uhr")}catch(e){return console.error("Error formatting scheduled time:",e),"Ung\xfcltige Startzeit"}}(ee.settings.scheduledStartTime):"Das Turnier hat noch nicht begonnen."}),tg&&(0,M.jsx)(h.$,{onClick:function(){return W.push("/tournaments/".concat(tr,"/settings"))},size:"sm",variant:"link",className:"mt-1 text-purple-400 hover:text-purple-300",children:"Turnierdetails bearbeiten / Starten"})]}),("completed"===ee.status||"archived"===ee.status)&&(0,M.jsx)("div",{className:"sticky bottom-0 left-0 right-0 p-4 bg-gray-800 border-t border-gray-700 text-center",children:(0,M.jsx)("p",{className:"text-sm text-gray-400",children:"completed"===ee.status?"Dieses Turnier ist abgeschlossen.":"Dieses Turnier ist archiviert."})}),ec&&tr&&(0,M.jsx)(eS,{isVisible:ec,onClose:function(){return eu(!1)},tournamentId:tr,tournamentParticipants:eE,currentPasseNumber:tx,onPasseStarted:function(e){W.push("/game/".concat(e)),eu(!1),u.useUIStore.getState().showNotification({type:"success",message:"Passe gestartet! Auf zum Jass!"})},members:to}),tg&&tr&&ee&&(0,M.jsx)(er.A,{isOpen:ey,onClose:function(){return eg(!1)},tournamentId:tr,tournamentName:null==ee?void 0:ee.name,onGenerateNew:function(){console.log("[TournamentViewPage] User requested new invite token.")}}),(0,M.jsx)(eU.A,{isOpen:e7,onClose:function(){return tb(null)},imageSrc:te,onCropComplete:tb}),(0,M.jsx)("input",{type:"file",ref:eX,onChange:tv,accept:"image/jpeg, image/jpg, image/png, image/webp, image/gif, image/heic, image/heif",className:"hidden",disabled:e3}),ew&&ee&&(0,M.jsx)(E.lG,{open:ev,onOpenChange:eb,children:(0,M.jsxs)(E.Cf,{className:"max-w-3xl bg-gray-850 border-gray-700 text-white",children:[(0,M.jsxs)(E.c7,{className:"mb-0 pb-2",children:[(0,M.jsxs)(E.L3,{className:"text-xl text-purple-300",children:["Spielerfortschritt: ",ew.displayName]}),(0,M.jsxs)(E.HM,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,M.jsx)(x.A,{className:"h-4 w-4"}),(0,M.jsx)("span",{className:"sr-only",children:"Schliessen"})]})]}),(0,M.jsx)("div",{className:"max-h-[80vh] overflow-y-auto p-1 pr-2",children:(0,M.jsx)(et,{tournamentGames:ek,playerUid:ew.uid,playerName:ew.displayName,playerPhotoUrl:null!=($=ew.photoURL)?$:void 0,strokeSettings:(null==(q=ee.settings)?void 0:q.strokeSettings)||U.zh,scoreSettings:(null==(H=ee.settings)?void 0:H.scoreSettings)||eM.$d,cardStyle:(null==(V=ee.settings)||null==(V=V.farbeSettings)?void 0:V.cardStyle)||D.FT.cardStyle})})]})})]})}):(0,M.jsx)(p.A,{children:(0,M.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:"Keine Turnierdaten verf\xfcgbar."})}):(0,M.jsx)(p.A,{children:(0,M.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gray-900 p-4 text-white",children:(0,M.jsxs)("div",{className:"bg-yellow-900/50 border border-yellow-700 text-yellow-300 px-6 py-4 rounded-lg shadow-lg text-center",children:[(0,M.jsx)(m.A,{className:"h-10 w-10 mx-auto mb-3 text-yellow-400"}),(0,M.jsx)("p",{className:"font-bold text-xl",children:"Turnier nicht gefunden"}),(0,M.jsxs)("p",{className:"text-sm",children:['Das Turnier mit der ID "',tr,'" konnte nicht gefunden werden oder der Zugriff wurde verweigert.']}),(0,M.jsx)(h.$,{onClick:td,variant:"outline",className:"mt-6 text-white border-white/50 hover:bg-white/10",children:"Zur\xfcck"})]})})})}},5143:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(3122).A)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]])},6520:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/view/tournament/[instanceId]",function(){return r(3815)}])},7078:(e,t,r)=>{"use strict";r.d(t,{A:()=>i}),r(4232);var n=r(7947),a=r(7876);let i=function(e){var t=e.message,r=e.color,i=void 0===r?"white":r;return(0,a.jsxs)("div",{className:"fixed inset-0 flex flex-col items-center justify-center bg-gray-900 bg-opacity-80 z-[9999]",children:[(0,a.jsx)(n.A,{className:"h-16 w-16 ".concat("white"===i?"text-white":"purple"===i?"text-purple-400":"text-".concat(i)," animate-spin")}),(0,a.jsx)("p",{className:"mt-4 text-white text-lg",children:t||"Wird geladen..."})]})}},7305:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(3122).A)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},7758:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var n=(0,r(3122).A)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},9773:(e,t,r)=>{"use strict";r.d(t,{b:()=>o});var n=r(4232),a=r(6326),i=r(7876),s=n.forwardRef((e,t)=>(0,i.jsx)(a.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));s.displayName="Label";var o=s}},e=>{var t=t=>e(e.s=t);e.O(0,[227,8230,1111,4455,8714,7887,6035,6738,732,3834,3587,5881,7788,5854,735,636,6593,8792],()=>t(6520)),_N_E=e.O()}]);