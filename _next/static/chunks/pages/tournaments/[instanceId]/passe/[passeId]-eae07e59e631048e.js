(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2894],{390:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var r=(0,n(3122).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},391:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var r=n(4232),s=n(9099),a=n(6602),i=n(950),l=n(5881),o=n(9370),c=n(3668),u=n(9770),d=n(1032),m=n(390),f=n(8310),h=n(7044),p=n(2009),y=n(132),x=n(7876);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e,t){if(!e)return null;var n,r=t||{scoreSettings:f.$d,strokeSettings:h.zh},s={1:"",2:"",3:"",4:""},a={1:null,2:null,3:null,4:null};return e.playerDetails.forEach(function(e){s[e.seat]=e.playerName,a[e.seat]={userId:e.playerId,displayName:e.playerName}}),{games:[{id:e.passeId,gameNumber:e.passeNumber,teams:{top:{striche:e.teamStrichePasse.top,jassPoints:e.teamScoresPasse.top-e.playerDetails.filter(function(e){return"top"===e.team}).reduce(function(e,t){return e+(t.weisInPasse||0)},0),weisPoints:e.playerDetails.filter(function(e){return"top"===e.team}).reduce(function(e,t){return e+(t.weisInPasse||0)},0),total:e.teamScoresPasse.top,playerStats:{1:null,2:null,3:null,4:null},bergActive:!1,bedankenActive:!1,isSigned:!1},bottom:{striche:e.teamStrichePasse.bottom,jassPoints:e.teamScoresPasse.bottom-e.playerDetails.filter(function(e){return"bottom"===e.team}).reduce(function(e,t){return e+(t.weisInPasse||0)},0),weisPoints:e.playerDetails.filter(function(e){return"bottom"===e.team}).reduce(function(e,t){return e+(t.weisInPasse||0)},0),total:e.teamScoresPasse.bottom,playerStats:{1:null,2:null,3:null,4:null},bergActive:!1,bedankenActive:!1,isSigned:!1}},timestamp:e.startedAt instanceof p.Timestamp?e.startedAt.toMillis():Date.now(),sessionId:e.tournamentInstanceId,currentRound:e.roundHistory?e.roundHistory.length+1:1,startingPlayer:e.startingPlayer,initialStartingPlayer:e.startingPlayer,currentPlayer:e.startingPlayer,roundHistory:null!=(n=e.roundHistory)?n:[],currentHistoryIndex:e.roundHistory?e.roundHistory.length-1:-1,historyState:{lastNavigationTimestamp:Date.now()},isGameStarted:!0,isRoundCompleted:!0,isGameCompleted:!0,scoreSettings:r.scoreSettings,strokeSettings:r.strokeSettings}],playerNames:s,currentScores:e.teamScoresPasse,currentStriche:e.teamStrichePasse,weisPoints:{top:e.playerDetails.filter(function(e){return"top"===e.team}).reduce(function(e,t){return e+(t.weisInPasse||0)},0),bottom:e.playerDetails.filter(function(e){return"bottom"===e.team}).reduce(function(e,t){return e+(t.weisInPasse||0)},0)},scoreSettings:r.scoreSettings,strokeSettings:r.strokeSettings}};let v=function(){var e,t,n=(0,s.useRouter)(),f=n.query,h=f.instanceId,p=f.passeId;(0,i.useAuthStore)().user;var v=(0,a.yu)(function(e){return e.fetchTournamentInstanceDetails}),S=(0,a.yu)(function(e){return e.fetchTournamentGameById}),P=(0,a.yu)(function(e){return e.currentTournamentInstance}),j=(0,a.yu)(function(e){return e.currentViewingPasse}),w=(0,a.yu)(function(e){return e.detailsStatus}),A=(0,a.yu)(function(e){return e.passeDetailsStatus}),N=(0,a.yu)(function(e){return e.error}),I=function(e){if(Array.isArray(e))return e}(e=(0,r.useState)(null))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,s,a,i,l=[],o=!0,c=!1;try{a=(n=n.call(e)).next,!1;for(;!(o=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);o=!0);}catch(e){c=!0,s=e}finally{try{if(!o&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return l}}(e,2)||function(e,t){if(e){if("string"==typeof e)return g(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),k=I[0],D=I[1];(0,r.useEffect)(function(){h&&!P&&(console.log("[PasseDetailPage] Fetching tournament details for instance: ".concat(h)),v(h))},[h,P,v]),(0,r.useEffect)(function(){h&&p&&(!j||j.passeId!==p)&&"loading"!==A&&(console.log("[PasseDetailPage修正] Fetching passe details for: ".concat(p," in tournament ").concat(h,". CurrentPasseId: ").concat(null==j?void 0:j.passeId)),S(h,p))},[h,p,null==j?void 0:j.passeId,S,A]),(0,r.useEffect)(function(){j&&P&&P.settings?D(b(j,P.settings)):D(null)},[j,P]);var T=function(){n.push("/view/tournament/".concat(h))};return"loading"===w||"loading"===A?(0,x.jsx)(c.A,{text:"Lade Passen-Details..."}):N&&("error"===w||"error"===A)?(0,x.jsx)(l.A,{children:(0,x.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen p-4",children:[(0,x.jsx)(d.A,{className:"w-16 h-16 text-red-500 mb-4"}),(0,x.jsx)("h1",{className:"text-xl font-semibold mb-2",children:"Fehler beim Laden"}),(0,x.jsx)("p",{className:"text-red-400 text-center mb-6",children:N}),(0,x.jsxs)(u.$,{onClick:T,variant:"outline",children:[(0,x.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Zur\xfcck zur Turnier\xfcbersicht"]})]})}):j&&k?(k.playerNames,(null==P||null==(t=P.settings)||null==(t=t.farbeSettings)?void 0:t.cardStyle)||y.FT.cardStyle,(0,x.jsx)(l.A,{children:(0,x.jsxs)("div",{className:"pb-4 h-screen flex flex-col",children:[(0,x.jsx)("div",{className:"p-3 flex-shrink-0",children:(0,x.jsx)(u.$,{variant:"ghost",size:"icon",onClick:T,className:"bg-gray-800/50 hover:bg-gray-700/80 text-white rounded-full",children:(0,x.jsx)(m.A,{className:"h-5 w-5"})})}),(0,x.jsxs)("div",{className:"flex-shrink-0 px-4 md:px-0",children:[" ",(0,x.jsx)(o.A,{gameData:k,gameTypeLabel:"Passe"})]})]})})):(0,x.jsx)(l.A,{children:(0,x.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen p-4",children:[(0,x.jsx)(d.A,{className:"w-16 h-16 text-yellow-500 mb-4"}),(0,x.jsx)("h1",{className:"text-xl font-semibold mb-2",children:"Passen-Details nicht gefunden"}),(0,x.jsx)("p",{className:"text-yellow-300 text-center mb-6",children:"Die Details f\xfcr diese Passe konnten nicht geladen werden oder die Passe existiert nicht."}),(0,x.jsxs)(u.$,{onClick:T,variant:"outline",children:[(0,x.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Zur\xfcck zur Turnier\xfcbersicht"]})]})})}},1032:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var r=(0,n(3122).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3668:(e,t,n)=>{"use strict";n.d(t,{A:()=>a}),n(4232);var r=n(7947),s=n(7876);let a=function(e){var t=e.text;return(0,s.jsxs)("div",{className:"fixed inset-0 z-[100] flex flex-col items-center justify-center bg-gray-900 bg-opacity-90 text-white",children:[(0,s.jsx)(r.A,{className:"h-12 w-12 animate-spin text-white mb-4"}),(0,s.jsx)("p",{className:"text-lg font-medium",children:void 0===t?"Laden...":t})]})}},7947:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var r=(0,n(3122).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9928:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tournaments/[instanceId]/passe/[passeId]",function(){return n(391)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[7141,2366,227,8230,1111,4455,8714,7887,6738,4264,5881,1451,9370,636,6593,8792],()=>t(9928)),_N_E=e.O()}]);