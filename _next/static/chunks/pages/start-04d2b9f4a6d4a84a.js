(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3876],{900:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var n=/^[a-f0-9]{48}$/i,a=function(e,t){var r,a=e.trim(),o="invalid",s=null;try{if(a.toLowerCase().startsWith("http")||a.includes("?")){var i=new URL(a.startsWith("http")?a:"https://dummybase".concat(a.startsWith("/")?"":"/").concat(a)),u=i.searchParams.get("token"),c=i.searchParams.get("tournamentToken");if(u)o="group",a=u;else{if(!c)return{type:"invalid",token:null,error:"Link enth\xe4lt keinen g\xfcltigen Einladungscode."};o="tournament",a=c}}else o=t||"ambiguous";if(48!==a.length?r="Ung\xfcltige Code-L\xe4nge. Erwartet: ".concat(48," Zeichen."):n.test(a)||(r="Ung\xfcltiges Code-Format. Nur Zahlen (0-9) und Buchstaben (a-f) erlaubt."),r)return{type:"invalid",token:null,error:r};if(s=a,"ambiguous"===o)return{type:"ambiguous",token:s,error:"Der Typ des Codes (Gruppe/Turnier) konnte nicht automatisch bestimmt werden."};return{type:o,token:s}}catch(e){return{type:"invalid",token:null,error:"Eingabe konnte nicht verarbeitet werden. Ist es ein g\xfcltiger Link oder Code?"}}}},4733:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/start",function(){return r(7603)}])},7603:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>$});var n=r(4232),a=r(9099),o=r(950),s=r(2322),i=r(4277),u=r(4536),c=r(3649),l=r(5881),d=r(9229),m=r(6806);(0,r(3122).A)("circle-minus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);var p=r(7256),f=r(3587),g=r(1223),h=r(7746),v=r(1411),b=r(2009),y=r(5519),S=r(4415),w=r(5510),x=r(8230),k=r.n(x),E=r(7887),I=r(7133),G=r(8310),P=r(132),j=r(7044),T=r(6405),R=r(900),N=r(5844),C=r(2561),O=r(3129),L=r(7876),A=["joined","newMember"];function F(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||H(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){var n,a,o;n=e,a=t,o=r[t],(a=function(e){var t=function(e,t){if("object"!==V(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==V(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===V(t)?t:String(t)}(a))in n?Object.defineProperty(n,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[a]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _(){_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var s,i,u,c,l=Object.create((r&&r.prototype instanceof h?r:h).prototype);return a(l,"_invoke",{value:(s=t,i=n,u=new P(o||[]),c=m,function(t,r){if(c===p)throw Error("Generator is already running");if(c===f){if("throw"===t)throw r;return{value:e,done:!0}}for(u.method=t,u.arg=r;;){var n=u.delegate;if(n){var a=function t(r,n){var a=n.method,o=r.iterator[a];if(o===e)return n.delegate=null,"throw"===a&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+a+"' method")),g;var s=d(o,r.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,g;var i=s.arg;return i?i.done?(n[r.resultName]=i.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,g)}(n,u);if(a){if(a===g)continue;return a}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(c===m)throw c=f,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c=p;var o=d(s,i,u);if("normal"===o.type){if(c=u.done?f:"suspendedYield",o.arg===g)continue;return{value:o.arg,done:u.done}}"throw"===o.type&&(c=f,u.method="throw",u.arg=o.arg)}})}),l}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var m="suspendedStart",p="executing",f="completed",g={};function h(){}function v(){}function b(){}var y={};c(y,s,function(){return this});var S=Object.getPrototypeOf,w=S&&S(S(j([])));w&&w!==r&&n.call(w,s)&&(y=w);var x=b.prototype=h.prototype=Object.create(y);function k(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){var r;a(this,"_invoke",{value:function(a,o){function s(){return new t(function(r,s){!function r(a,o,s,i){var u=d(e[a],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==V(l)&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,s,i)},function(e){r("throw",e,s,i)}):t.resolve(l).then(function(e){c.value=e,s(c)},function(e){return r("throw",e,s,i)})}i(u.arg)}(a,o,r,s)})}return r=r?r.then(s,s):s()}})}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function G(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw TypeError(V(t)+" is not iterable")}return v.prototype=b,a(x,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:v,configurable:!0}),v.displayName=c(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},k(E.prototype),c(E.prototype,i,function(){return this}),t.AsyncIterator=E,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var s=new E(l(e,r,n,a),o);return t.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},k(x),c(x,u,"Generator"),c(x,s,function(){return this}),c(x,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(G),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return i.type="throw",i.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],i=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),G(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;G(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function M(e,t,r,n,a,o,s){try{var i=e[o](s),u=i.value}catch(e){r(e);return}i.done?t(u):Promise.resolve(u).then(n,a)}function z(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){M(o,n,a,s,i,"next",e)}function i(e){M(o,n,a,s,i,"throw",e)}s(void 0)})}}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,s,i=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(i.push(n.value),i.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return i}}(e,t)||H(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){if(e){if("string"==typeof e)return W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W(e,t)}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){if(e&&null!=t&&t.length){var r=t.find(function(t){var r;return(null==(r=t.displayName)?void 0:r.toLowerCase())===e.toLowerCase()});return(null==r?void 0:r.photoURL)||void 0}}function Y(e){return!!(e&&"object"===V(e)&&"toDate"in e&&"function"==typeof e.toDate)}var q=function(e){return"loading"===e||"idle"===e};function Z(e,t){if(null!=t&&t.length)return t.find(function(t){var r;return(null==(r=t.displayName)?void 0:r.toLowerCase())===e.toLowerCase()})}let $=function(){var e,t,x,D,M,H,W=(0,o.useAuthStore)(),V=W.user,$=W.status,K=W.isAuthenticated,Q=W.isGuest,X=(0,s.Q5)(),ee=X.currentGroup,et=X.userGroups,er=X.status,en=X.error,ea=X.clearError;X.setCurrentGroupId,X.setError,X.lastSettingsUpdateTimestamp;var eo=(0,i.useGameStore)(),es=(0,u.useJassStore)(),ei=(0,i.useGameStore)(function(e){return e.isGameStarted&&!e.isGameCompleted}),eu=(0,a.useRouter)(),ec=(0,c.useUIStore)(function(e){return e.setPageCta}),el=(0,c.useUIStore)(function(e){return e.resetPageCta}),ed=(0,c.useUIStore)(function(e){return e.showNotification}),em=(0,c.useUIStore)(function(e){return e.setResumableGameId}),ep=(0,c.useUIStore)(function(e){return e.clearResumableGameId}),ef=(0,c.useUIStore)(function(e){return e.resumableGameId});(0,c.useUIStore)(function(e){return e.setLoading});var eg=(0,n.useRef)(null),eh=B((0,n.useState)(null),2),ev=eh[0],eb=eh[1],ey=B((0,n.useState)(null),2),eS=ey[0],ew=ey[1],ex=B((0,n.useState)(!1),2),ek=ex[0],eE=ex[1],eI=B((0,n.useState)(!1),2),eG=eI[0],eP=eI[1],ej=B((0,n.useState)(null),2),eT=ej[0],eR=ej[1],eN=B((0,n.useState)(!1),2),eC=eN[0],eO=eN[1],eL=B((0,n.useState)(null),2),eA=eL[0],eF=eL[1],eD=B((0,n.useState)(!1),2),eU=eD[0],e_=eD[1],eM=B((0,n.useState)(null),2),ez=eM[0],eB=eM[1],eH=B((0,n.useState)([]),2),eW=eH[0],eV=eH[1],eJ=B((0,n.useState)(!0),2),eY=eJ[0],eq=eJ[1],eZ=B((0,n.useState)(null),2),e$=eZ[0],eK=eZ[1],eQ=B((0,n.useState)([]),2),eX=eQ[0],e0=eQ[1],e1=B((0,n.useState)(!0),2),e2=e1[0],e3=e1[1],e5=B((0,n.useState)(null),2),e4=e5[0],e8=e5[1],e7=B((0,n.useState)([]),2),e6=e7[0],e9=e7[1],te=B((0,n.useState)(!0),2),tt=te[0],tr=te[1],tn=B((0,n.useState)(null),2),ta=tn[0],to=tn[1],ts=B((0,n.useState)(null),2),ti=ts[0],tu=ts[1],tc=B((0,n.useState)(!0),2),tl=tc[0],td=tc[1],tm=B((0,n.useState)(null),2),tp=tm[0],tf=tm[1],tg=B((0,n.useState)(!1),2),th=tg[0],tv=tg[1],tb=ee&&V&&ee.adminIds.includes(V.uid),ty=B((0,n.useState)(!1),2),tS=ty[0],tw=ty[1],tx=B((0,n.useState)(!1),2),tk=tx[0],tE=tx[1],tI=(null==ee?void 0:ee.theme)||"yellow",tG=N.lt[tI]||N.lt.yellow,tP=(0,n.useRef)(null),tj=(0,n.useRef)(null),tT=(0,n.useRef)(null),tR=(0,n.useRef)(null),tN=(0,n.useRef)(null),tC=(0,n.useRef)(null),tO=(0,n.useRef)(null),tL=(0,n.useRef)(null),tA=(0,n.useRef)(null),tF=(0,n.useRef)(null),tD=(0,n.useRef)(null),tU=(0,n.useRef)(null),t_=(0,n.useRef)(null),tM=(0,n.useRef)(null),tz=(0,n.useRef)(null),tB=(0,n.useRef)(null),tH=(0,n.useRef)(null),tW=(0,n.useRef)(null);(0,C.F)(tP),(0,C.F)(tj),(0,C.F)(tT),(0,C.F)(tR),(0,C.F)(tN),(0,C.F)(tC),(0,C.F)(tO),(0,C.F)(tL),(0,C.F)(tA),(0,C.F)(tF),(0,C.F)(tD),(0,C.F)(tU),(0,C.F)(t_),(0,C.F)(tM),(0,C.F)(tz),(0,C.F)(tB),(0,C.F)(tH),(0,C.F)(tW),(0,n.useMemo)(function(){if(!(null!=ti&&ti.trumpfStatistik)||0===ti.totalTrumpfCount)return[];var e={};return Object.entries(ti.trumpfStatistik).forEach(function(t){var r=B(t,2),n=r[0],a=r[1],o=n.toLowerCase(),s=o;"eicheln"===o?s="eichel":"une"===o&&(s="unde"),e[s]=(e[s]||0)+a}),Object.entries(e).map(function(e){var t=B(e,2),r=t[0],n=t[1];return{farbe:r,anzahl:n,anteil:n/ti.totalTrumpfCount}}).sort(function(e,t){return t.anzahl-e.anzahl})},[ti]),(0,n.useEffect)(function(){if(null!=ee&&ee.id){td(!0),tf(null);var e=(0,T.q$)(ee.id,function(e){tu(e),td(!1)},null==ee?void 0:ee.mainLocationZip);return function(){return e()}}},[ee]),(0,n.useEffect)(function(){if("loading"!==$&&"idle"!==$)return"unauthenticated"!==$||o.useAuthStore.getState().isGuest||eu.push("/"),ea(),function(){ea(),eK(null),eS&&URL.revokeObjectURL(eS),ep()}},[$,eu,ea,eS,ep]),(0,n.useEffect)(function(){var e;(e=z(_().mark(function e(){var t,r;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ee){e.next=1;break}return eV([]),eq(!1),e.abrupt("return");case 1:return eq(!0),eK(null),e.prev=2,e.next=3,(0,v.getGroupMembersSortedByGames)(ee.id);case 3:eV(e.sent),e.next=5;break;case 4:e.prev=4,console.error("Fehler beim Laden der Gruppenmitglieder:",r=e.catch(2)),eK(t=r instanceof Error?r.message:"Mitglieder konnten nicht geladen werden."),ed({message:t,type:"error"});case 5:return e.prev=5,eq(!1),e.finish(5);case 6:case"end":return e.stop()}},e,null,[[2,4,5,6]])})),function(){return e.apply(this,arguments)})()},[null==ee?void 0:ee.id,ed]),(0,n.useEffect)(function(){var e;(e=z(_().mark(function e(){var t,r;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!ee){e.next=11;break}return e3(!0),e8(null),e.prev=1,e.next=2,(0,w.CI)(ee.id);case 2:e0(e.sent),e.next=4;break;case 3:e.prev=3,console.error("Fehler beim Laden der abgeschlossenen Gruppensessions:",t=e.catch(1)),e8(t instanceof Error?t.message:"Abgeschlossene Partien konnten nicht geladen werden.");case 4:return e.prev=4,e3(!1),e.finish(4);case 5:return tr(!0),to(null),e.prev=6,e.next=7,(0,I.fetchTournamentInstancesForGroup)(ee.id);case 7:e9(e.sent.filter(function(e){return"active"===e.status||"upcoming"===e.status||"completed"===e.status})),e.next=9;break;case 8:e.prev=8,console.error("Fehler beim Laden der Gruppen-Turniere:",r=e.catch(6)),to(r instanceof Error?r.message:"Turniere konnten nicht geladen werden.");case 9:return e.prev=9,tr(!1),e.finish(9);case 10:e.next=12;break;case 11:e0([]),e9([]),e3(!1),tr(!1);case 12:case"end":return e.stop()}},e,null,[[1,3,4,5],[6,8,9,10]])})),function(){return e.apply(this,arguments)})()},[ee,ed]),(0,n.useEffect)(function(){if("authenticated"===$&&V){(e=z(_().mark(function e(){var t,n,a,o,s,i,u,c,l,d,m,p,f,g,h,v,S,w,x,k,E;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,b.getFirestore)(y.xv),n=(0,b.collection)(t,"activeGames"),a=(0,b.query)(n,(0,b.where)("participantUids","array-contains",V.uid)),e.next=1,(0,b.getDocs)(a);case 1:if((o=e.sent).empty||!((s=o.docs.filter(function(e){var t=e.data();return"aborted"!==t.status&&"completed"!==t.status})).length>0)){e.next=6;break}if(g=(f=(p=s.sort(function(e,t){var r,n,a=e.data(),o=t.data(),s=function(e){var t,r,n,a,o=0+100*(e.currentRound||1)+(((null==(t=e.scores)?void 0:t.top)||0)+((null==(r=e.scores)?void 0:r.bottom)||0)),s=(null==(n=e.striche)?void 0:n.top)||{},i=(null==(a=e.striche)?void 0:a.bottom)||{};return o+(Object.values(s).reduce(function(e,t){return e+(t||0)},0)+Object.values(i).reduce(function(e,t){return e+(t||0)},0))*50},i=s(a),u=s(o);if(i!==u)return u-i;var c=(null==(r=a.createdAt)?void 0:r.toMillis())||0;return((null==(n=o.createdAt)?void 0:n.toMillis())||0)-c}))[0]).id,h=f.data(),console.log("[StartPage] \uD83C\uDFAF CONTENT-BASED DETECTION: Selected game ".concat(g," (Round: ").concat(h.currentRound,", Scores: ").concat((null==(i=h.scores)?void 0:i.top)||0,":").concat((null==(u=h.scores)?void 0:u.bottom)||0,")")),v=h.currentRound>1||(null==(c=h.scores)?void 0:c.top)>0||(null==(l=h.scores)?void 0:l.bottom)>0||Object.values((null==(d=h.striche)?void 0:d.top)||{}).some(function(e){return e>0})||Object.values((null==(m=h.striche)?void 0:m.bottom)||{}).some(function(e){return e>0}),w=(S=h.createdAt?Date.now()-(h.createdAt.toMillis?h.createdAt.toMillis():h.createdAt):0)<12e4,x=h.gameStartTime&&h.gameStartTime!==h.createdAt||S>3e5||w,v||x){e.next=4;break}if(console.log("[StartPage] ⚠️ EMPTY GAME DETECTED: Game ".concat(g," appears to be empty, marking as aborted and skipping")),Promise.resolve().then(r.bind(r,3558)).then(function(e){(0,e.updateGameStatus)(g,"aborted").catch(function(e){return console.warn("[StartPage] Failed to mark empty game as aborted:",e)})}),!(p.length>1)){e.next=2;break}E=(k=p[1]).id,k.data(),em(E);try{sessionStorage.setItem("resumableGameId_".concat(V.uid),E)}catch(e){console.warn("[StartPage] Could not persist resumableGameId to sessionStorage:",e)}return e.abrupt("return");case 2:ep();try{sessionStorage.removeItem("resumableGameId_".concat(V.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}return e.abrupt("return");case 3:e.next=5;break;case 4:console.log("[StartPage] \uD83C\uDFAF INITIAL: Game ".concat(g," has content or activity (content=").concat(v,", activity=").concat(x,", newGame=").concat(w,", age=").concat(Math.round(S/1e3),"s), setting as resumable"));case 5:em(g);try{sessionStorage.setItem("resumableGameId_".concat(V.uid),g)}catch(e){console.warn("[StartPage] Could not persist resumableGameId to sessionStorage:",e)}return e.abrupt("return");case 6:ep();try{sessionStorage.removeItem("resumableGameId_".concat(V.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}e.next=8;break;case 7:e.prev=7,console.error("[StartPage] Error checking for resumable games:",e.catch(0));case 8:case"end":return e.stop()}},e,null,[[0,7]])})),function(){return e.apply(this,arguments)})();var e,t,n=null;(t=z(_().mark(function e(){var t,a,o;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=(0,b.getFirestore)(y.xv),a=(0,b.collection)(t,"activeGames"),o=(0,b.query)(a,(0,b.where)("participantUids","array-contains",V.uid)),n=(0,b.onSnapshot)(o,function(e){if(e.empty){ep();try{sessionStorage.removeItem("resumableGameId_".concat(V.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}}else{var t=e.docs.filter(function(e){var t=e.data();return"aborted"!==t.status&&"completed"!==t.status});if(t.length>0){var n=t.sort(function(e,t){var r,n,a=e.data(),o=t.data(),s=function(e){var t,r,n,a,o=0+100*(e.currentRound||1),s=((null==(t=e.scores)?void 0:t.top)||0)+((null==(r=e.scores)?void 0:r.bottom)||0);o+=s;var i=(null==(n=e.striche)?void 0:n.top)||{},u=(null==(a=e.striche)?void 0:a.bottom)||{},c=Object.values(i).reduce(function(e,t){return e+(t||0)},0),l=Object.values(u).reduce(function(e,t){return e+(t||0)},0);return o+=(c+l)*50},i=s(a),u=s(o);if(i!==u)return u-i;var c=(null==(r=a.createdAt)?void 0:r.toMillis())||0;return((null==(n=o.createdAt)?void 0:n.toMillis())||0)-c})[0],a=n.id,o=n.data();if(c.useUIStore.getState().resumableGameId!==a){console.log("[StartPage] Real-time update: Setting resumable game ".concat(a));var s,i,u,l,d=o.currentRound>1||(null==(s=o.scores)?void 0:s.top)>0||(null==(i=o.scores)?void 0:i.bottom)>0||Object.values((null==(u=o.striche)?void 0:u.top)||{}).some(function(e){return e>0})||Object.values((null==(l=o.striche)?void 0:l.bottom)||{}).some(function(e){return e>0}),m=o.createdAt?Date.now()-(o.createdAt.toMillis?o.createdAt.toMillis():o.createdAt):0,p=m<12e4,f=o.roundHistory&&o.roundHistory.length>0||o.gameStartTime&&o.gameStartTime!==o.createdAt||m>3e5||p;if(d||f)console.log("[StartPage] Real-time: Game ".concat(a," has content or activity (content=").concat(d,", activity=").concat(f,", newGame=").concat(p,", age=").concat(Math.round(m/1e3),"s), keeping as resumable"));else{console.log("[StartPage] Real-time: Empty game ".concat(a," detected (no content AND no activity), marking as aborted")),Promise.resolve().then(r.bind(r,3558)).then(function(e){(0,e.updateGameStatus)(a,"aborted").catch(function(e){return console.warn("[StartPage] Real-time: Failed to mark empty game as aborted:",e)})}),ep();try{sessionStorage.removeItem("resumableGameId_".concat(V.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}return}em(a);try{sessionStorage.setItem("resumableGameId_".concat(V.uid),a)}catch(e){console.warn("[StartPage] Could not persist resumableGameId to sessionStorage:",e)}}}else{ep();try{sessionStorage.removeItem("resumableGameId_".concat(V.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}}}},function(e){console.error("[StartPage] Error in resumable games listener:",e)})}catch(e){console.error("[StartPage] Error setting up resumable games listener:",e)}case 1:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})();try{var a=sessionStorage.getItem("resumableGameId_".concat(V.uid));if(a&&!c.useUIStore.getState().resumableGameId){console.log("[StartPage] \uD83D\uDD04 PERSISTENCE RECOVERY: Found stored resumable game ".concat(a));var o=(0,b.getFirestore)(y.xv),s=(0,b.doc)(o,"activeGames",a);(0,b.getDoc)(s).then(function(e){var t,r,n;e.exists()&&(null==(t=e.data())?void 0:t.status)!=="aborted"&&(null==(r=e.data())?void 0:r.status)!=="completed"&&null!=(n=e.data())&&null!=(n=n.participantUids)&&n.includes(V.uid)?(console.log("[StartPage] ✅ PERSISTENCE RECOVERY: Restored resumable game ".concat(a)),em(a)):(console.log("[StartPage] ❌ PERSISTENCE RECOVERY: Stored game ".concat(a," is no longer valid, removing")),sessionStorage.removeItem("resumableGameId_".concat(V.uid)))}).catch(function(e){console.error("[StartPage] Error verifying stored resumable game ".concat(a,":"),e)})}}catch(e){console.warn("[StartPage] Could not check sessionStorage for resumableGameId:",e)}return function(){n&&n()}}if(ep(),V)try{sessionStorage.removeItem("resumableGameId_".concat(V.uid))}catch(e){console.warn("[StartPage] Could not clear resumableGameId from sessionStorage:",e)}return function(){}},[$,V,em,ep]),(0,n.useEffect)(function(){var e=!q($),t="authenticated"!==$||!q(er);e&&t?tv(!0):tv(!1)},[$,er]),(0,n.useEffect)(function(){if(th)return"unauthenticated"!==$||o.useAuthStore.getState().isGuest||eu.push("/"),ea(),function(){ea(),eK(null),eS&&URL.revokeObjectURL(eS),ep()}},[th,$,eu,ea,eS,ep]);var tV=(e=z(_().mark(function e(t){var n,a,o,l,d,m,p,f,g,h,v,w,x,k,E,I,T,R,N,C,O,L,A,F,D,M,z,B,H,W,V,J,Y,q,Z,$,K,Q;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return tw(!0),e.prev=1,n=(0,b.getFirestore)(y.xv),a=(0,b.doc)(n,"activeGames",t),e.next=2,(0,b.getDoc)(a);case 2:if((o=e.sent).exists()){e.next=3;break}throw Error("Aktives Spiel mit ID ".concat(t," nicht gefunden."));case 3:if("aborted"!==(l=o.data()).status&&"completed"!==l.status){e.next=4;break}return console.warn("[StartPage] Versuch, ein bereits beendetes/abgebrochenes Spiel fortzusetzen (ID: ".concat(t,", Status: ").concat(l.status,"). Breche ab.")),ed({type:"warning",message:"Dieses Spiel wurde bereits beendet oder abgebrochen."}),ep(),tw(!1),e.abrupt("return");case 4:if(d=l.sessionId){e.next=5;break}throw Error("Session-ID im aktiven Spiel fehlt.");case 5:return e.prev=5,N=[],e.prev=6,e.next=7,Promise.resolve().then(r.bind(r,3558));case 7:return C=e.sent.fetchCompletedGamesFromFirestore,e.next=8,C(d);case 8:N=e.sent,e.next=10;break;case 9:e.prev=9,Z=e.catch(6),console.error("[StartPage] Fehler beim Laden abgeschlossener Spiele aus jassGameSummaries/".concat(d,"/completedGames:"),Z),ed({type:"warning",message:"Abgeschlossene Spiele konnten nicht vollst\xe4ndig geladen werden."});case 10:return O=[],e.prev=11,e.next=12,Promise.resolve().then(r.bind(r,3558));case 12:return L=e.sent.loadRoundsFromFirestore,e.next=13,L(t);case 13:O=e.sent,e.next=15;break;case 14:e.prev=14,$=e.catch(11),console.error("[StartPage] Error loading rounds from Firestore for game ".concat(t,":"),$),ed({type:"warning",message:"Rundenverlauf konnte nicht vollst\xe4ndig geladen werden."});case 15:return A=l.createdAt instanceof b.Timestamp?l.createdAt.toMillis():Date.now(),F=null,console.log("[StartPage] \uD83D\uDEE1️ VEREINFACHTE FALLBACK-HIERARCHIE f\xfcr Settings wird gestartet..."),e.prev=16,D=(0,b.doc)(n,"sessions",d),e.next=17,(0,b.getDoc)(D);case 17:if(!(M=e.sent).exists()){e.next=20;break}if(!((z=M.data()).currentFarbeSettings&&z.currentScoreSettings&&z.currentStrokeSettings)){e.next=18;break}console.log("[StartPage] ✅ ERSTE PRIORIT\xc4T: Einstellungen aus sessions-Dokument geladen:",{farbeCardStyle:(F={farbeSettings:z.currentFarbeSettings,scoreSettings:z.currentScoreSettings,strokeSettings:z.currentStrokeSettings}).farbeSettings.cardStyle,scoreWerte:F.scoreSettings.values,strokeSchneider:F.strokeSettings.schneider}),e.next=19;break;case 18:throw Error("Einstellungen in sessions unvollst\xe4ndig");case 19:e.next=21;break;case 20:throw Error("sessions-Dokument nicht gefunden");case 21:case 25:case 32:e.next=34;break;case 22:if(e.prev=22,console.warn("[StartPage] ❌ ERSTE PRIORIT\xc4T fehlgeschlagen:",e.catch(16)),e.prev=23,!(l.activeFarbeSettings&&l.activeScoreSettings&&l.activeStrokeSettings)){e.next=24;break}console.log("[StartPage] ✅ ZWEITE PRIORIT\xc4T: Einstellungen aus activeGame-Dokument geladen:",{farbeCardStyle:(F={farbeSettings:l.activeFarbeSettings,scoreSettings:l.activeScoreSettings,strokeSettings:l.activeStrokeSettings}).farbeSettings.cardStyle,scoreWerte:F.scoreSettings.values,strokeSchneider:F.strokeSettings.schneider}),e.next=25;break;case 24:throw Error("Einstellungen in activeGame unvollst\xe4ndig");case 26:if(e.prev=26,console.warn("[StartPage] ❌ ZWEITE PRIORIT\xc4T fehlgeschlagen:",e.catch(23)),e.prev=27,!(B=l.groupId)){e.next=31;break}return console.log("[StartPage] \uD83D\uDD04 DRITTE PRIORIT\xc4T: Lade Gruppen-Settings aus Firestore f\xfcr Gruppe",B),H=(0,b.doc)(n,"groups",B),e.next=28,(0,b.getDoc)(H);case 28:if(!(W=e.sent).exists()){e.next=29;break}console.log("[StartPage] ✅ DRITTE PRIORIT\xc4T: Einstellungen aus Gruppen-Dokument geladen:",{farbeCardStyle:(F={farbeSettings:(V=W.data()).farbeSettings||P.FT,scoreSettings:V.scoreSettings||G.$d,strokeSettings:V.strokeSettings||j.zh}).farbeSettings.cardStyle,scoreWerte:F.scoreSettings.values,strokeSchneider:F.strokeSettings.schneider}),e.next=30;break;case 29:throw Error("Gruppen-Dokument nicht gefunden");case 30:e.next=32;break;case 31:throw Error("Keine groupId verf\xfcgbar");case 33:e.prev=33,console.warn("[StartPage] ❌ DRITTE PRIORIT\xc4T fehlgeschlagen:",e.catch(27)),F={farbeSettings:P.FT,scoreSettings:G.$d,strokeSettings:j.zh},console.log("[StartPage] ⚠️ LETZTE RETTUNG: Default-Einstellungen werden verwendet");case 34:J={id:l.currentGameNumber,activeGameId:t,timestamp:A,teams:{top:U(U({},(0,u.createInitialTeamStand)()),{},{striche:l.striche.top,total:l.scores.top,weisPoints:null!=(m=null==(p=l.weisPoints)?void 0:p.top)?m:0}),bottom:U(U({},(0,u.createInitialTeamStand)()),{},{striche:l.striche.bottom,total:l.scores.bottom,weisPoints:null!=(f=null==(g=l.weisPoints)?void 0:g.bottom)?f:0})},sessionId:d,currentRound:l.currentRound,startingPlayer:l.startingPlayer,initialStartingPlayer:l.initialStartingPlayer,currentPlayer:l.currentPlayer,roundHistory:O,currentHistoryIndex:O.length-1,historyState:{lastNavigationTimestamp:Date.now()},isGameStarted:!0,isRoundCompleted:null!=(h=l.isRoundCompleted)&&h,isGameCompleted:!1},u.useJassStore.setState({isJassStarted:!0,currentGameId:l.currentGameNumber,games:[J],currentSession:{id:d,gruppeId:null!=(v=l.groupId)?v:"",startedAt:A,playerNames:l.playerNames,games:[l.currentGameNumber],currentScoreLimit:null!=(w=null==(x=s.Q5.getState().currentGroup)||null==(x=x.scoreSettings)?void 0:x.values.sieg)?w:G.$d.values.sieg,completedGamesCount:l.currentGameNumber>0?l.currentGameNumber-1:0,metadata:{},participantUids:l.participantUids,statistics:{gamesPlayed:1,scores:{top:0,bottom:0},weisCount:0,stricheCount:{berg:0,sieg:0,matsch:0,schneider:0,kontermatsch:0}},currentFarbeSettings:F.farbeSettings,currentScoreSettings:F.scoreSettings,currentStrokeSettings:F.strokeSettings},isJassCompleted:!1,currentRound:l.currentRound,teams:J.teams,onlineCompletedGames:N,currentGameCache:null,jassSessionId:d}),i.useGameStore.setState({activeGameId:t,currentPlayer:l.currentPlayer,startingPlayer:l.startingPlayer,initialStartingPlayer:l.initialStartingPlayer,isGameStarted:!0,currentRound:l.currentRound,weisPoints:null!=(k=l.weisPoints)?k:{top:0,bottom:0},jassPoints:null!=(E=l.currentJassPoints)?E:{top:0,bottom:0},scores:l.scores,striche:l.striche,roundHistory:O,currentRoundWeis:null!=(I=l.currentRoundWeis)?I:[],isGameCompleted:!1,isRoundCompleted:null!=(T=l.isRoundCompleted)&&T,playerNames:l.playerNames,gamePlayers:null!=(R=l.gamePlayers)?R:null,currentHistoryIndex:O.length-1,historyState:{lastNavigationTimestamp:Date.now()},farbeSettings:F.farbeSettings,scoreSettings:F.scoreSettings,strokeSettings:F.strokeSettings}),Y=l.jassStartTime instanceof b.Timestamp?l.jassStartTime.toMillis():null,q=l.gameStartTime instanceof b.Timestamp?l.gameStartTime.toMillis():null,S.useTimerStore.getState().restoreTimers(Y,q),c.useUIStore.getState().setStartScreenState("complete"),ep(),tw(!1),eu.push("/jass"),e.next=36;break;case 35:throw e.prev=35,console.error("[StartPage] Error in inner try block:",K=e.catch(5)),K;case 36:e.next=38;break;case 37:e.prev=37,console.error("[StartPage] Error resuming game: ",Q=e.catch(1)),ed({type:"error",message:Q instanceof Error?Q.message:"Fehler beim Laden des Spiels."}),ep(),tw(!1);case 38:case"end":return e.stop()}},e,null,[[1,37],[5,35],[6,9],[11,14],[16,22],[23,26],[27,33]])})),function(t){return e.apply(this,arguments)}),tJ=(0,n.useCallback)(function(){if(ef)tV(ef);else{if(!ee&&et.length>0)return void ed({message:"Bitte zuerst eine Gruppe ausw\xe4hlen.",type:"warning"});if(ee&&!eY&&eW.length<4)return void ed({message:"F\xfcr Gruppenspiele mit Statistik braucht es mindestens vier Mitglieder. Du kannst aber trotzdem im Gastmodus jassen.",type:"info",actions:[{label:"Gastmodus",onClick:function(){return eu.push("/")}},{label:"Einladen",onClick:function(){}}]});eu.push("/game/new")}},[ef,eu,tV,ee,et,ed,eW]);(0,n.useEffect)(function(){var e;return tS?void ec({isVisible:!0,text:"Laden...",onClick:function(){},loading:!0,disabled:!0,variant:"info"}):((null==(e=es.currentSession)?void 0:e.isTournamentSession)&&eo.isGameStarted&&!eo.isGameCompleted?el():ef?ec({isVisible:!0,text:"Laufendem Jass beitreten",onClick:tJ,loading:!1,disabled:!1,variant:"info"}):ee?ec({isVisible:!0,text:ei?"Jass fortsetzen":"Neuen Jass starten",onClick:tJ,loading:!1,disabled:!1,variant:ei?"info":"default"}):0!==et.length||ee||"loading"===$?el():ec({isVisible:!0,text:"Neue Gruppe erstellen",onClick:function(){return eu.push("/groups/new")},loading:!1,disabled:!1,variant:"warning"}),function(){el()})},[ee,ei,ec,el,et,eu,ef,$,tJ,tS,es.currentSession,eo.isGameStarted,eo.isGameCompleted]);var tY=(t=z(_().mark(function e(t){var r,n;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=t.target.files)&&r.length>0)){e.next=3;break}if((n=r[0]).type.startsWith("image/")){e.next=1;break}return ed({message:"Bitte w\xe4hlen Sie eine Bilddatei (JPEG oder PNG)..",type:"error"}),e.abrupt("return");case 1:if(!(n.size>5242880)){e.next=2;break}return ed({message:"Die Datei ist zu gro\xdf (max. 5 MB).",type:"error"}),e.abrupt("return");case 2:ea(),eS&&URL.revokeObjectURL(eS),ew(null),eb(null),eR(URL.createObjectURL(n)),eP(!0);case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),tq=(x=z(_().mark(function e(t){var r,n;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(eP(!1),eT&&(URL.revokeObjectURL(eT),eR(null)),t){e.next=1;break}return eg.current&&(eg.current.value=""),eE(!1),e.abrupt("return");case 1:return eE(!0),r={maxSizeMB:.2,maxWidthOrHeight:1024,useWebWorker:!0,fileType:"image/jpeg",initialQuality:.8},e.prev=2,e.next=3,(0,f.A)(new File([t],"cropped_logo.jpg",{type:"image/jpeg"}),r);case 3:n=e.sent,ew(URL.createObjectURL(n)),eb(new File([n],"group_logo.jpg",{type:"image/jpeg"})),eE(!1),e.next=5;break;case 4:e.prev=4,console.error("Fehler bei der Komprimierung des zugeschnittenen Gruppenlogos:",e.catch(2)),ed({message:"Fehler bei der Bildkomprimierung.",type:"error"}),eb(null),ew(null),eg.current&&(eg.current.value=""),eE(!1);case 5:case"end":return e.stop()}},e,null,[[2,4]])})),function(e){return x.apply(this,arguments)}),tZ=(D=z(_().mark(function e(){var t,r;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!ev||!ee)){e.next=1;break}return e.abrupt("return");case 1:if(tb){e.next=2;break}return ed({message:"Nur Gruppenadministratoren k\xf6nnen das Gruppenbild aktualisieren.",type:"warning",actions:[{label:"Verstanden",onClick:function(){}}]}),e.abrupt("return");case 2:return eE(!0),e.prev=3,e.next=4,(0,g.uploadGroupLogo)(ee.id,ev);case 4:ed({message:"Gruppenlogo erfolgreich aktualisiert.",type:"success"}),eb(null),ew(null),eg.current&&(eg.current.value=""),e.next=6;break;case 5:e.prev=5,console.error("Fehler beim Hochladen des Gruppenlogos:",r=e.catch(3)),(t=r instanceof Error?r.message:"Hochladen fehlgeschlagen.").includes("unauthorized")||t.includes("permission")?ed({message:"Keine Berechtigung: Nur Gruppenadministratoren k\xf6nnen das Gruppenbild \xe4ndern.",type:"error"}):ed({message:t,type:"error"});case 6:return e.prev=6,eE(!1),e.finish(6);case 7:case"end":return e.stop()}},e,null,[[3,5,6,7]])})),function(){return D.apply(this,arguments)}),t$=(M=z(_().mark(function e(){var t,r,n,a,o;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ee){e.next=1;break}return e.abrupt("return");case 1:if(tb){e.next=2;break}return ed({message:"Nur Gruppenadministratoren k\xf6nnen Einladungen erstellen.",type:"info",actions:[{label:"Verstanden",onClick:function(){}}]}),e.abrupt("return");case 2:return eO(!0),e_(!0),eB(null),eF(null),e.prev=3,t=(0,h.Uz)(void 0,"europe-west1"),r=(0,h.Qg)(t,"generateGroupInviteToken"),e.next=4,r({groupId:ee.id});case 4:if(n=e.sent.data.token){e.next=5;break}throw Error("Kein Token vom Server erhalten.");case 5:eF(n),e.next=7;break;case 6:e.prev=6,a=(o=e.catch(3))instanceof Error?o.message:"Unbekannter Fehler beim Generieren des Codes.",console.error("Error calling generateGroupInviteToken:",o),eB(a);case 7:return e.prev=7,e_(!1),e.finish(7);case 8:case"end":return e.stop()}},e,null,[[3,6,7,8]])})),function(){return M.apply(this,arguments)}),tK=function(){eO(!1)},tQ=function(){t$()},tX=(0,n.useMemo)(function(){var e=eX.filter(function(e){return("completed"===e.status||"completed_empty"===e.status)&&!e.tournamentId}).map(function(e){return U(U({},e),{},{type:"session"})}),t=e6.map(function(e){return U(U({},e),{},{type:"tournament"})}),r=[].concat(F(e),F(t));return r.sort(function(e,t){var r,n,a="session"===e.type?e.startedAt:null!=(r=e.instanceDate)?r:e.createdAt,o="session"===t.type?t.startedAt:null!=(n=t.instanceDate)?n:t.createdAt,s=Y(a)?a.toMillis():"number"==typeof a?a:a&&"function"==typeof a.isEqual?Date.now():0;return(Y(o)?o.toMillis():"number"==typeof o?o:o&&"function"==typeof o.isEqual?Date.now():0)-s}),r},[eX,e6]),t0=tX.reduce(function(e,t){var r,n="session"===t.type?t.startedAt:null!=(r=t.instanceDate)?r:t.createdAt,a=Y(n)?n.toDate().getFullYear().toString():"number"==typeof n?new Date(n).getFullYear().toString():"Unbekannt";return e[a]||(e[a]=[]),e[a].push(t),e},{}),t1=Object.keys(t0).sort(function(e,t){return parseInt(t)-parseInt(e)}),t2=eu.query,t3=t2.mainTab,t5=t2.statsSubTab,t4=t2.joined,t8=t2.newMember,t7="string"==typeof t3&&["statistics","archive","members"].includes(t3)?t3:"statistics",t6="string"==typeof t5&&["overview","players","teams"].includes(t5)?t5:"overview",t9="string"==typeof t4?t4:null;(0,n.useEffect)(function(){if(t9&&eu.isReady){var e=setTimeout(function(){var e=eu.query,t=(e.joined,e.newMember,function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,A));eu.replace({pathname:eu.pathname,query:t},void 0,{shallow:!0})},3e3);return function(){return clearTimeout(e)}}},[t9,eu]);var re=(0,n.useCallback)((H=z(_().mark(function e(t,r){var n;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!ed||!eu)){e.next=1;break}return console.error("showNotification oder router nicht initialisiert in handleProcessInviteInput"),e.abrupt("return");case 1:tE(!0),(n=(0,R.g)(t,r)).token?"group"===n.type?(console.log("[StartPage] Navigiere zu /join mit Gruppentoken: ".concat(n.token)),eu.push("/join?token=".concat(n.token))):"tournament"===n.type?(console.log("[StartPage] Navigiere zu /join mit Turniertoken: ".concat(n.token)),eu.push("/join?tournamentToken=".concat(n.token))):"ambiguous"===n.type?ed({message:n.error||"Der Typ des Codes (Gruppe/Turnier) ist unklar. Bitte pr\xfcfen Sie Ihre Eingabe.",type:"error"}):ed({message:n.error||"Ung\xfcltige Eingabe.",type:"error"}):ed({message:n.error||"Eingabe konnte nicht verarbeitet werden.",type:"error"}),tE(!1);case 2:case"end":return e.stop()}},e)})),function(e,t){return H.apply(this,arguments)}),[eu,ed]);return th&&eu.isReady?(0,L.jsx)(O.J,{currentGroup:ee,user:V,isGuest:Q,userGroups:et,isAuthenticated:K,isPublicView:!1,handleProcessInviteInput:re,isProcessingInvite:tk,showNotification:ed,groupStatus:er,groupError:en,joinedGroupName:t9,isNewMember:"string"==typeof t8?"true"===t8:null,isAdmin:tb,selectedFile:ev,previewUrl:eS,isUploading:ek,handleSelectClick:function(){if(!tb)return void ed({message:"Nur Gruppenadministratoren k\xf6nnen das Gruppenbild \xe4ndern.",type:"info",actions:[{label:"Verstanden",onClick:function(){}}]});eg.current&&eg.current.click()},handleUpload:tZ,handleCancelSelection:function(){eS&&URL.revokeObjectURL(eS),eb(null),ew(null),eg.current&&(eg.current.value="")},handleInviteClick:t$,router:eu,fileInputRef:eg,handleFileChange:tY,cropModalOpen:eG,imageToCrop:eT,handleCropComplete:tq,activeMainTab:t7,activeStatsSubTab:t6,groupTheme:tI,statsLoading:tl,statsError:tp,members:eW,membersLoading:eY,membersError:e$,completedSessions:eX,groupTournaments:e6,combinedArchiveItems:tX,groupedArchiveByYear:t0,sortedYears:t1,renderArchiveItem:function(e){if("session"===e.type){var t,r=e.id,n=(e.startedAt,e.playerNames),a=e.finalScores,o=e.status,s=e.finalStriche,i=e.participantUids,u=null==V?void 0:V.uid;if("completed"===o&&a&&u&&i.includes(u)){var c=null;n&&null!=V&&V.displayName&&(n["1"]===V.displayName||n["3"]===V.displayName?c="bottom":(n["2"]===V.displayName||n["4"]===V.displayName)&&(c="top")),c&&(a.top===a.bottom||"top"===c&&a.top>a.bottom||"bottom"===c&&(a.bottom,a.top))}d.A,m.A;var l="completed"===o?(0,L.jsx)(d.A,{className:"w-4 h-4 text-green-500"}):(0,L.jsx)(m.A,{className:"w-4 h-4 text-red-500"}),f=(null==ee?void 0:ee.name)||"Partie",g=function(e,t){return e?(e.berg||0)+(e.sieg||0)+(e.matsch||0)+(e.schneider||0)+(e.kontermatsch||0):0},h=null!=(t=null==ee?void 0:ee.strokeSettings)?t:j.zh,v="completed"===o&&s?g(s.bottom,h):null,y="completed"===o&&s?g(s.top,h):null,S=null;"completed"===o&&e.endedAt&&Y(e.endedAt)?S=e.endedAt:e.startedAt&&(S=e.startedAt);var w=Y(S)?S.toDate():"number"==typeof S?new Date(S):null,x=w?(0,E.GP)(w,"dd.MM.yy, HH:mm"):"Unbekannt";return(0,L.jsx)(k(),{href:"/view/session/".concat(r),passHref:!0,children:(0,L.jsxs)("div",{className:"p-3 bg-gray-700/50 rounded-lg hover:bg-gray-600/50 transition-colors duration-150 cursor-pointer mb-2",children:[(0,L.jsx)("div",{className:"flex justify-between items-center mb-1.5",children:(0,L.jsxs)("div",{className:"flex items-center flex-grow",children:[(0,L.jsxs)("span",{className:"text-sm font-medium text-white mr-2",children:[f," - ",x]}),(0,L.jsx)("div",{className:"flex-shrink-0",children:l})]})}),(0,L.jsxs)("div",{className:"space-y-1",children:[(0,L.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[(0,L.jsx)("div",{children:(0,L.jsxs)("span",{className:"block",children:["Team 1:\xa0",(0,L.jsxs)("span",{className:"text-white",children:[n["1"]||"?"," + ",n["3"]||"?"]})]})}),(0,L.jsx)("span",{className:"text-sm font-semibold text-white pl-2",children:null!==v?v:"-"})]}),(0,L.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[(0,L.jsx)("div",{children:(0,L.jsxs)("span",{className:"block",children:["Team 2:\xa0",(0,L.jsxs)("span",{className:"text-white",children:[n["2"]||"?"," + ",n["4"]||"?"]})]})}),(0,L.jsx)("span",{className:"text-sm font-semibold text-white pl-2",children:null!==y?y:"-"})]})]})]})},"session-".concat(r))}if("tournament"===e.type){var I=e.id,G=e.name,P=e.instanceDate,T=e.status,R=P instanceof b.Timestamp?P.toDate():"number"==typeof P?new Date(P):null,N=R?(0,E.GP)(R,"dd.MM.yyyy"):null;return(0,L.jsx)(k(),{href:"/view/tournament/".concat(I),passHref:!0,children:(0,L.jsx)("div",{className:"p-3 bg-purple-900/30 rounded-lg hover:bg-purple-800/40 transition-colors duration-150 cursor-pointer mb-2 border border-purple-700/50",children:(0,L.jsxs)("div",{className:"flex justify-between items-center",children:[(0,L.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,L.jsx)(p.A,{className:"w-5 h-5 text-purple-400 flex-shrink-0"}),(0,L.jsxs)("div",{className:"flex flex-col",children:[(0,L.jsx)("span",{className:"text-sm font-medium text-white",children:G}),N&&(0,L.jsx)("span",{className:"text-sm text-gray-400",children:N})]})]}),(0,L.jsx)("span",{className:"text-sm px-2 py-0.5 rounded-full ".concat("completed"===T?"bg-gray-600 text-gray-300":"active"===T?"bg-green-600 text-white":"bg-blue-500 text-white"),children:"completed"===T?"Abgeschlossen":"active"===T?"Aktiv":"Anstehend"})]})})},"tournament-".concat(I))}return null},sessionsLoading:e2,sessionsError:e4,tournamentsLoading:tt,tournamentsError:ta,groupStats:ti,theme:tG,findPlayerByName:Z,findPlayerPhotoByName:J,isInviteModalOpen:eC,onCloseInviteModal:tK,inviteLoading:eU,inviteError:ez,inviteToken:eA,onGenerateNewInvite:tQ,handleCloseInviteModal:tK,isGeneratingInvite:eU,handleGenerateNewInvite:tQ}):(0,L.jsx)(l.A,{children:(0,L.jsx)("div",{className:"flex flex-1 flex-col items-center justify-center min-h-[calc(100vh-112px)]",children:(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:"mx-auto h-8 w-8 rounded-full border-2 border-t-transparent border-white animate-spin"}),(0,L.jsx)("span",{className:"ml-3 text-white",children:"Laden..."})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[7141,8067,227,8230,1111,4455,8714,7887,6035,732,5038,3834,679,3587,5881,7788,5510,5854,9791,8905,636,6593,8792],()=>t(4733)),_N_E=e.O()}]);